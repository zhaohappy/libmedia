!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AVTranscoder=e():t.AVTranscoder=e()}(self,(()=>(()=>{var t,e,r={92246:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(16030),n=r(4624);class o{constructor(t){(0,i.A)(this,"resampler",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"inputParameters",void 0),(0,i.A)(this,"outputParameters",void 0),this.options=t,this.resampler=new s.A(this.options.resource)}async open(t,e){this.inputParameters=t,this.outputParameters=e,await this.resampler.run(),this.resampler.call("resample_set_input_parameters",t.sampleRate,t.channels,t.format,t.layout||0),this.resampler.call("resample_set_output_parameters",e.sampleRate,e.channels,e.format,e.layout||0);let r=this.resampler.call("resample_init");r<0&&n.h2(`open resampler failed, ret: ${r}`,"src/audioresample/Resampler.ts",84)}resample(t,e,r){return this.resampler.call("resample_process",t,e,r)}getOutputSampleCount(t){return this.resampler.call("resample_nb_sample",t)}close(){this.resampler.call("resample_destroy"),this.resampler.destroy(),this.resampler=null}getInputPCMParameters(){return this.inputParameters}getOutputPCMParameters(){return this.outputParameters}}},51128:(t,e,r)=>{"use strict";r.d(e,{d:()=>i});const i={86017:"mp3",86018:"mp4a.40",86021:"vorbis",86028:"flac",86076:"opus",65542:"ulaw",65543:"alaw",225:"av01",27:"avc1",173:"hev1",196:"vvc1",139:"vp8",167:"vp09",12:"mp4v"}},1984:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(63939),s=r(51128);function n(t){const e=i.f[15](t+4);let r=i.f[15](t+48),n=s.d[e];return 86018===e&&(n=`${n}.${r}`),n||"unknown"}},21233:(t,e,r)=>{"use strict";r.d(e,{C:()=>s});var i=r(86834);function s(t){return t?!i.A.chrome||i.A.checkVersion(i.A.majorVersion,"94",!0)?"prefer-hardware":"allow":!i.A.chrome||i.A.checkVersion(i.A.majorVersion,"94",!0)?"prefer-software":"deny"}},94663:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i=r(63939),s=r(51128),n=r(90412),o=r(14392),a=r(58919),c=r(55611),h=r(20525),u=r(77231),f=r(14686),d=r(90932);function l(t,e){const r=i.f[15](t+4);let l=i.f[15](t+48),p=i.f[15](t+52);!e&&0!==i.f[20](t+12)&&i.f[15](t+16)&&(e=(0,f.s3)(i.f[20](t+12),i.f[15](t+16)));let m=s.d[r],g="";if(27===r)110===l&&(l=100),g=h.GP("%s.%02x00%02x",m,255&l,255&p);else if(173===r){var A;let t=0,r=0,i=0,s=0;(null===(A=e)||void 0===A?void 0:A.length)>13&&(t=e[1]>>>6&3,i=e[1]>>>5&1,r=e[2]|e[3]<<8|e[4]<<16|e[5]<<24,s=240&e[6]);const n={0:"",1:"A",2:"B",3:"C"};g=h.GP("%s.%s%d.%x.%s%d.%x",m,n[t],l,r,0===i?"L":"H",p,s)}else if(196===r){var v;let t=0;if((null===(v=e)||void 0===v?void 0:v.length)>13&&(t=1&e[5]),g=h.GP("%s.%d.%s%d",m,l,0===t?"L":"H",p),e){const t=c.Ui(e);if(t.generalConstraintInfo.length){let e=t.generalConstraintInfo.length-1;for(;e>0&&0===t.generalConstraintInfo[e];)e--;const r=t.generalConstraintInfo.slice(0,e+1);r.length&&(g+=`.C${d.l(new Uint8Array(r),!1)}`)}t.generalSubProfileIdc.length&&(g+=`.S${t.generalSubProfileIdc.map((t=>t.toString(16))).join("+")}`),g+=`.O${t.olsIdx}+${t.numSublayers}`}}else if(225===r)if(e){const t=n.Ui(e);g=h.GP("%s.%d.%02d%s.%02d.%d.%d%d%d",m,t.profile,t.level,t.tier?"H":"M",t.bitDepth,t.monochrome,t.chromaSubsamplingX,t.chromaSubsamplingY,t.chromaSamplePosition)}else g=h.GP("%s.%d.%02dM.08",m,l,p);else if(139===r)if(e){const t=o.U(e);g=h.GP("%s.%02d.%02d.%02d",m,t.profile,t.level,t.bitDepth)}else g=l!==u.N_&&p!==u.N_?h.GP("%s.%02d.%02d.08",m,l,p):m;else if(167===r)if(e){const t=a.Ui(e);g=h.GP("%s.%02d.%02d.%02d.%02d.%02d.%02d.%02d.%02d",m,t.profile,t.level,t.bitDepth,t.chromaSubsampling,t.colorPrimaries,t.colorTrc,t.colorSpace,t.fullRangeFlag)}else g=l!==u.N_&&p!==u.N_?h.GP("%s.%02d.%02d.08.00",m,l,p):h.GP("%s.%02d.%02d.08.00",m,0,40);else g=m||"unknown";return g}},75742:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(16030),n=r(56024),o=r(4624);class a{constructor(t){(0,i.A)(this,"options",void 0),(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"frame",void 0),this.options=t,this.decoder=new s.A(t.resource)}getAVFrame(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,n.FP)()}outputAVFrame(){this.frame&&(this.options.onReceiveFrame?this.options.onReceiveFrame(this.frame):this.options.avframePool?this.options.avframePool.release(this.frame):(0,n.xj)(this.frame),this.frame=0)}receiveAVFrame(){return this.decoder.call("decoder_receive",this.getAVFrame())}async open(t){await this.decoder.run();let e=this.decoder.call("decoder_open",t,0,1);e<0&&o.h2(`open audio decoder failed, ret: ${e}`,"src/avcodec/wasmcodec/AudioDecoder.ts",82)}decode(t){let e=this.decoder.call("decoder_decode",t);if(e)return e;for(;;){if(e=this.receiveAVFrame(),1!==e){if(e<0)return e;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.call("decoder_flush");;){if(this.receiveAVFrame()<1)return;this.outputAVFrame()}}close(){this.decoder.call("decoder_close"),this.decoder.destroy(),this.decoder=null,this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,n.xj)(this.frame),this.frame=0)}}},21910:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i=r(134),s=r(50932),n=r(16030),o=r(71517),a=r(4624),c=r(67672),h=r(36204),u=r(52699),f=r(56024),d=r(14686);class l{constructor(t){(0,i.A)(this,"options",void 0),(0,i.A)(this,"encoder",void 0),(0,i.A)(this,"parameters",void 0),(0,i.A)(this,"timeBase",void 0),(0,i.A)(this,"avpacket",void 0),(0,i.A)(this,"avframe",void 0),this.options=t,this.encoder=new n.A(this.options.resource)}getAVPacket(){return this.avpacket?this.avpacket:this.avpacket=this.options.avpacketPool?this.options.avpacketPool.alloc():(0,o._5)()}outputAVPacket(){this.avpacket&&(this.options.onReceiveAVPacket(this.avpacket),this.avpacket=0)}receiveAVPacket(){return this.encoder.call("encoder_receive",this.getAVPacket())}async open(t,e){await this.encoder.run();const r=u.z(8);s.M[15](r,e.num),s.M[15](r+4,e.den);let i=this.encoder.call("encoder_open",t,r,1);u.t(8),i<0&&a.h2(`open audio encoder failed, ret: ${i}`,"src/avcodec/wasmcodec/AudioEncoder.ts",96),await this.encoder.childrenThreadReady(),this.parameters=t,this.timeBase=e}encode(t){c.ai(t)||(this.avframe?(0,f.to)(this.avframe):this.avframe=(0,f.FP)(),t=(0,h.t)(t,this.avframe));let e=this.encoder.call("encoder_encode",t);if(e)return e;for(;;){if(e=this.receiveAVPacket(),1!==e){if(e<0)return e;break}this.outputAVPacket()}return 0}async flush(){for(this.encoder.call("encoder_flush");;){if(this.receiveAVPacket()<1)return;this.outputAVPacket()}}getExtraData(){const t=this.encoder.call("encoder_get_extradata"),e=this.encoder.call("encoder_get_extradata_size");return t&&e?(0,d.s3)(t,e).slice():null}close(){this.encoder.call("encoder_close"),this.encoder.destroy(),this.encoder=null,this.avpacket&&(this.options.avpacketPool?this.options.avpacketPool.release(this.avpacket):(0,o.Qe)(this.avpacket),this.avpacket=0),this.avframe&&((0,f.xj)(this.avframe),this.avframe=0)}}},40417:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(16030),n=r(56024),o=r(4624);class a{constructor(t){(0,i.A)(this,"options",void 0),(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"frame",void 0),(0,i.A)(this,"parameters",void 0),this.options=t,this.decoder=new s.A(this.options.resource)}getAVFrame(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,n.FP)()}outputAVFrame(){this.frame&&(this.options.onReceiveFrame?this.options.onReceiveFrame(this.frame):this.options.avframePool?this.options.avframePool.release(this.frame):(0,n.xj)(this.frame),this.frame=0)}receiveAVFrame(){return this.decoder.call("decoder_receive",this.getAVFrame())}async open(t,e=1){await this.decoder.run();let r=this.decoder.call("decoder_open",t,0,e);r<0&&o.h2(`open video decoder failed, ret: ${r}`,"src/avcodec/wasmcodec/VideoDecoder.ts",119),this.parameters=t,await this.decoder.childrenThreadReady()}decode(t){let e=this.decoder.call("decoder_decode",t);if(e)return e;for(;;){if(e=this.receiveAVFrame(),1!==e){if(e<0)return e;break}this.outputAVFrame()}return 0}async flush(){for(this.decoder.call("decoder_flush");;){if(this.receiveAVFrame()<1)return;this.outputAVFrame()}}close(){this.decoder.call("decoder_close"),this.decoder.destroy(),this.decoder=null,this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,n.xj)(this.frame),this.frame=0),this.parameters=0}setSkipFrameDiscard(t){this.decoder.call("decoder_discard",t)}}},80105:(t,e,r)=>{"use strict";r.d(e,{A:()=>A});var i=r(134),s=r(63939),n=r(50932),o=r(9599),a=r(29170),c=r(16030),h=r(71517),u=r(4624),f=r(52699),d=r(67672),l=r(37180),p=r(56024),m=r(14686),g=r(44328);class A{constructor(t){(0,i.A)(this,"options",void 0),(0,i.A)(this,"encoder",void 0),(0,i.A)(this,"parameters",void 0),(0,i.A)(this,"timeBase",void 0),(0,i.A)(this,"avpacket",void 0),(0,i.A)(this,"avframe",void 0),(0,i.A)(this,"encodeQueueSize",void 0),(0,i.A)(this,"framerate",void 0),this.options=t,this.encoder=new c.A(this.options.resource)}getAVPacket(){return this.avpacket?this.avpacket:this.avpacket=this.options.avpacketPool?this.options.avpacketPool.alloc():(0,h._5)()}outputAVPacket(){this.avpacket&&(27!==s.f[15](this.parameters+4)&&173!==s.f[15](this.parameters+4)&&196!==s.f[15](this.parameters+4)||n.M[15](this.avpacket+80,s.f[15](this.parameters+160)),this.options.onReceiveAVPacket(this.avpacket),this.avpacket=0,this.encodeQueueSize--)}receiveAVPacket(){return this.encoder.call("encoder_receive",this.getAVPacket())}async open(t,e,r=1){await this.encoder.run();const i=f.z(8);n.M[15](i,e.num),n.M[15](i+4,e.den);let c=this.encoder.call("encoder_open",t,i,r);f.t(8),1===s.f[15](t+160)&&this.encoder.call("encoder_set_flags",4194304),s.f[15](t+104)&&this.encoder.call("encoder_set_max_b_frame",s.f[15](t+104)),c<0&&u.h2(`open video decoder failed, ret: ${c}`,"src/avcodec/wasmcodec/VideoEncoder.ts",117),await this.encoder.childrenThreadReady(),this.encoder.asm.encoder_ready&&this.encoder.call("encoder_ready"),this.parameters=t,this.timeBase=e,this.encodeQueueSize=0,this.framerate=BigInt(Math.floor((0,g.lb)((0,a.A)(t+72,o.P))))}encode(t,e){d.ai(t)||(this.avframe?(0,p.to)(this.avframe):this.avframe=(0,p.FP)(),t=(0,l.lL)(t,this.avframe)),e&&n.M[15](t+88,1),n.M[17](t+312,BigInt(this.timeBase.den>>>0)/this.framerate);let r=this.encoder.call("encoder_encode",t);if(this.encodeQueueSize++,r)return r;for(;;){if(r=this.receiveAVPacket(),1!==r){if(r<0)return r;break}this.outputAVPacket()}return 0}async flush(){for(this.encoder.call("encoder_flush");;){if(this.receiveAVPacket()<1)return;this.outputAVPacket()}}getExtraData(){const t=this.encoder.call("encoder_get_extradata"),e=this.encoder.call("encoder_get_extradata_size");return t&&e?(0,m.s3)(t,e).slice():null}getColorSpace(){return{colorSpace:this.encoder.call("encoder_get_color_space"),colorPrimaries:this.encoder.call("encoder_get_color_primaries"),colorTrc:this.encoder.call("encoder_get_color_trc")}}close(){this.encoder.call("encoder_close"),this.encoder.destroy(),this.encoder=null,this.avpacket&&(this.options.avpacketPool?this.options.avpacketPool.release(this.avpacket):(0,h.Qe)(this.avpacket),this.avpacket=0),this.avframe&&((0,p.xj)(this.avframe),this.avframe=0)}getQueueLength(){return this.encodeQueueSize}}},77104:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(134),s=r(63939),n=r(1984),o=r(14686),a=r(71517),c=r(22898);class h{constructor(t){(0,i.A)(this,"options",void 0),(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"parameters",void 0),(0,i.A)(this,"extradata",void 0),(0,i.A)(this,"currentError",void 0),this.options=t}output(t){this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close()}error(t){this.currentError=t,this.options.onError(t)}async open(t){this.currentError=null,this.parameters=t,this.extradata=null,0!==s.f[20](t+12)&&(this.extradata=(0,o.s3)(s.f[20](t+12),s.f[15](t+16)).slice());const e={codec:(0,n.A)(this.parameters),sampleRate:s.f[15](t+136),numberOfChannels:s.f[15](t+116),description:this.extradata};if(e.description||delete e.description,!(await AudioDecoder.isConfigSupported(e)).supported)throw new Error("not support");if(this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new AudioDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(e),this.currentError)throw this.currentError}changeExtraData(t){if(t.length===this.extradata.length){let e=!0;for(let r=0;r<t.length;r++)if(t[r]!==this.extradata[r]){e=!1;break}if(e)return}if(this.extradata=t.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,n.A)(this.parameters),sampleRate:s.f[15](this.parameters+136),numberOfChannels:s.f[15](this.parameters+116),description:this.extradata}),this.currentError)throw this.currentError}decode(t,e){const r=(0,a.rU)(t,1);0!==r&&this.changeExtraData((0,o.s3)(s.f[20](r),s.f[15](r+4)));const i=(0,c.A)(t,e);try{this.decoder.decode(i)}catch(t){return-1}return 0}async flush(){await this.decoder.flush()}close(){"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=null}getQueueLength(){return this.decoder.decodeQueueSize}}},72308:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(134),s=r(63939),n=r(50932),o=r(1984),a=r(67672),c=r(84716),h=r(71517),u=r(56024),f=r(59944);class d{constructor(t){(0,i.A)(this,"encoder",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"parameters",void 0),(0,i.A)(this,"timeBase",void 0),(0,i.A)(this,"currentError",void 0),(0,i.A)(this,"pts",void 0),(0,i.A)(this,"avframeCache",void 0),(0,i.A)(this,"extradata",void 0),this.options=t,this.avframeCache=[]}async output(t,e){const r=this.options.avpacketPool?this.options.avpacketPool.alloc():(0,h._5)();if(this.extradata)(0,f.A)(t,r,e);else{var i;if(null!=e&&null!==(i=e.decoderConfig)&&void 0!==i&&i.description){let t;t=e.decoderConfig.description instanceof ArrayBuffer?new Uint8Array(e.decoderConfig.description):new Uint8Array(e.decoderConfig.description.buffer),this.extradata=t}(0,f.A)(t,r)}n.M[17](r+8,this.pts),n.M[17](r+16,this.pts),this.pts+=s.f[17](r+48),this.options.onReceivePacket(r);const o=this.avframeCache.shift();o&&(this.options.avframePool?this.options.avframePool.release(o):(0,u.xj)(o))}error(t){this.options.onError(t)}async open(t,e){this.currentError=null;const r={codec:(0,o.A)(t),sampleRate:s.f[15](t+136),numberOfChannels:s.f[15](t+116),bitrate:Number(s.f[17](t+32)),bitrateMode:"constant"};if(!(await AudioEncoder.isConfigSupported(r)).supported)throw new Error("not support");if(this.encoder&&"closed"!==this.encoder.state&&this.encoder.close(),this.encoder=new AudioEncoder({output:this.output.bind(this),error:this.error.bind(this)}),this.encoder.reset(),this.encoder.configure(r),this.currentError)throw this.currentError;this.pts=BigInt(0),this.parameters=t,this.timeBase=e}encode(t){if(a.ai(t)){const e=this.options.avframePool?this.options.avframePool.alloc():(0,u.FP)();(0,u.gg)(e,t),this.avframeCache.push(e),n.M[17](e+104,BigInt(0)),t=(0,c.T)(e)}try{return this.encoder.encode(t),0}catch(t){return-1}}async flush(){await this.encoder.flush()}close(){this.encoder&&"closed"!==this.encoder.state&&this.encoder.close(),this.avframeCache.length&&this.avframeCache.forEach((t=>{this.options.avframePool?this.options.avframePool.release(t):(0,u.xj)(t)})),this.encoder=null}getExtraData(){return this.extradata}getQueueLength(){return this.encoder.encodeQueueSize}}},71039:(t,e,r)=>{"use strict";r.d(e,{A:()=>f});var i=r(134),s=r(63939),n=r(86834),o=r(94663),a=r(14686),c=r(71517),h=r(21233),u=r(28917);class f{constructor(t){(0,i.A)(this,"decoder",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"parameters",void 0),(0,i.A)(this,"extradata",void 0),(0,i.A)(this,"currentError",void 0),(0,i.A)(this,"inputQueue",void 0),(0,i.A)(this,"outputQueue",void 0),(0,i.A)(this,"sort",void 0),(0,i.A)(this,"keyframeRequire",void 0),this.options=t,this.inputQueue=[],this.outputQueue=[],this.sort=n.A.safari}async output(t){if(this.sort){let e=0;for(;e<this.outputQueue.length;e++)if(this.outputQueue[e].timestamp>t.timestamp){this.outputQueue.splice(e,0,t);break}for(e===this.outputQueue.length&&this.outputQueue.push(t);this.outputQueue.length>2&&this.outputQueue[0].timestamp===this.inputQueue[0];){const t=this.outputQueue.shift();this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close(),this.inputQueue.shift()}}else this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close()}error(t){this.currentError=t,this.options.onError(t)}changeExtraData(t){var e;if(t.length===this.extradata.length){let e=!0;for(let r=0;r<t.length;r++)if(t[r]!==this.extradata[r]){e=!1;break}if(e)return}this.extradata=t.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,o.A)(this.parameters,t),description:this.extradata,hardwareAcceleration:(0,h.C)(null===(e=this.options.enableHardwareAcceleration)||void 0===e||e)}),this.keyframeRequire=!0}async open(t){var e;this.currentError=null,this.extradata=null,0!==s.f[20](t+12)&&(this.extradata=(0,a.s3)(s.f[20](t+12),s.f[15](t+16)).slice()),this.parameters=t;const r={codec:(0,o.A)(t),codedWidth:s.f[15](t+56),codedHeight:s.f[15](t+60),description:2!==s.f[15](t+160)?this.extradata:void 0,hardwareAcceleration:(0,h.C)(null===(e=this.options.enableHardwareAcceleration)||void 0===e||e)};if(r.description||delete r.description,!(await VideoDecoder.isConfigSupported(r)).supported)throw new Error("not support");if(this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new VideoDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(r),this.currentError)throw this.currentError;this.keyframeRequire=!0,this.inputQueue.length=0,this.outputQueue.length=0}decode(t){const e=(0,c.rU)(t,1);0!==e&&this.changeExtraData((0,a.s3)(s.f[20](e),s.f[15](e+4)));const r=1&s.f[15](t+36);if(this.keyframeRequire&&!r)return;const i=Number(s.f[17](t+8)),n=(0,u.A)(t);if(this.sort){let t=0;for(;t<this.inputQueue.length;t++)if(this.inputQueue[t]>i){this.inputQueue.splice(t,0,i);break}t===this.inputQueue.length&&this.inputQueue.push(i)}try{this.decoder.decode(n)}catch(t){return-1}return r&&(this.keyframeRequire=!1),0}async flush(){if(await this.decoder.flush(),this.sort)for(;this.outputQueue.length;){const t=this.outputQueue.shift();this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close()}this.keyframeRequire=!0}close(){var t;this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=null,this.currentError=null,null!==(t=this.outputQueue)&&void 0!==t&&t.length&&this.outputQueue.forEach((t=>{t.close()})),this.inputQueue=null,this.outputQueue=null}getQueueLength(){return this.decoder.decodeQueueSize}setSkipFrameDiscard(t){}}},47243:(t,e,r)=>{"use strict";r.d(e,{A:()=>_});var i=r(134),s=r(80662),n=r.n(s),o=r(63939),a=r(50932),c=r(9599),h=r(29170),u=r(94663),f=r(21233),d=r(44328),l=r(67672),p=r(89188),m=r(71517),g=r(77231),A=r(97317),v=r(56024),w=r(26777),y=r(37180),b=r(90412),k=r(58919);class _{constructor(t){(0,i.A)(this,"encoder",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"parameters",void 0),(0,i.A)(this,"timeBase",void 0),(0,i.A)(this,"currentError",void 0),(0,i.A)(this,"avframeMap",void 0),(0,i.A)(this,"framerate",void 0),(0,i.A)(this,"inputCounter",void 0),(0,i.A)(this,"outputCounter",void 0),(0,i.A)(this,"extradata",void 0),this.options=t,this.avframeMap=new(n())}async output(t,e){const r=BigInt(Math.floor(t.timestamp)),i=r*BigInt(1e6)/this.framerate,s=BigInt.asIntN(64,this.outputCounter++)*BigInt(1e6)/this.framerate,n=this.options.avpacketPool?this.options.avpacketPool.alloc():(0,m._5)();if(this.extradata)(0,w.A)(t,n,e);else{var c,h;if(null!=e&&null!==(c=e.decoderConfig)&&void 0!==c&&c.description){let t;t=e.decoderConfig.description instanceof ArrayBuffer?new Uint8Array(e.decoderConfig.description):new Uint8Array(e.decoderConfig.description.buffer),this.extradata=t}if(null!=e&&null!==(h=e.decoderConfig)&&void 0!==h&&h.colorSpace&&(a.M[15](this.parameters+96,(0,y.mt)(e.decoderConfig.colorSpace.matrix)),a.M[15](this.parameters+88,(0,y.ab)(e.decoderConfig.colorSpace.primaries)),a.M[15](this.parameters+92,(0,y.nG)(e.decoderConfig.colorSpace.transfer))),(0,w.A)(t,n),!this.extradata){let t;225===o.f[15](this.parameters+4)?t=b.Yj(this.parameters,(0,m.iI)(n)):167===o.f[15](this.parameters+4)&&(t=k.Yj(this.parameters)),t&&(this.extradata=t)}}a.M[17](n+8,i),a.M[17](n+16,s),27!==o.f[15](this.parameters+4)&&173!==o.f[15](this.parameters+4)&&196!==o.f[15](this.parameters+4)||a.M[15](n+80,o.f[15](this.parameters+160)),this.options.onReceivePacket(n);const u=this.avframeMap.get(r);u&&(this.options.avframePool?this.options.avframePool.release(u):(0,v.xj)(u)),this.avframeMap.delete(r)}error(t){this.currentError=t,this.options.onError(t)}async open(t,e){var r;this.currentError=null;const i=A.g[o.f[15](t+28)];if(!i||i.comp[0].depth>8)throw new Error(`format ${o.f[15](t+28)} not support`);const s={codec:(0,u.A)(t),width:o.f[15](t+56),height:o.f[15](t+60),bitrate:Number(o.f[17](t+32)),framerate:(0,d.lb)((0,h.A)(t+72,c.P)),hardwareAcceleration:(0,f.C)(null===(r=this.options.enableHardwareAcceleration)||void 0===r||r),latencyMode:o.f[15](t+104)?"quality":"realtime",alpha:i&&128&i.flags?"keep":"discard"};if(27!==o.f[15](t+4)&&173!==o.f[15](t+4)&&196!==o.f[15](t+4)||(s.avc={format:1===o.f[15](t+160)?"avc":"annexb"}),!(await VideoEncoder.isConfigSupported(s)).supported)throw new Error("not support");if(this.encoder&&"closed"!==this.encoder.state&&this.encoder.close(),this.encoder=new VideoEncoder({output:this.output.bind(this),error:this.error.bind(this)}),this.encoder.reset(),this.encoder.configure(s),this.currentError)throw this.currentError;this.parameters=t,this.timeBase=e,this.inputCounter=BigInt(0),this.outputCounter=BigInt(0),this.framerate=BigInt(Math.floor((0,d.lb)((0,h.A)(t+72,c.P))))}encode(t,e){if(l.ai(t)){const e=this.options.avframePool?this.options.avframePool.alloc():(0,v.FP)();(0,v.gg)(e,t),a.M[17](e+104,this.inputCounter),o.f[17](e+312)?a.M[17](e+312,(0,d.k)(o.f[17](e+312),this.timeBase,g.KR)):a.M[17](e+312,BigInt(1e6)/this.framerate),this.avframeMap.set(o.f[17](e+104),e),t=(0,p.pt)(e)}else t=new VideoFrame(t,{timestamp:Number(this.inputCounter),duration:Number(BigInt(1e6)/this.framerate)});try{return this.encoder.encode(t,{keyFrame:e}),t.close(),this.inputCounter++,0}catch(e){return t.close(),-1}}async flush(){await this.encoder.flush()}close(){this.encoder&&"closed"!==this.encoder.state&&this.encoder.close(),this.avframeMap.size&&this.avframeMap.forEach((t=>{this.options.avframePool?this.options.avframePool.release(t):(0,v.xj)(t)})),this.encoder=null}getExtraData(){return this.extradata}getColorSpace(){return{colorSpace:o.f[15](this.parameters+96),colorPrimaries:o.f[15](this.parameters+88),colorTrc:o.f[15](this.parameters+92)}}getQueueLength(){return this.encoder.encodeQueueSize}}},18812:(t,e,r)=>{"use strict";r.d(e,{A:()=>l,t:()=>d});var i=r(134),s=r(80662),n=r.n(s),o=r(54001),a=r.n(o),c=r(56024),h=r(84149),u=r(67672),f=r(72739);class d extends h.Ay{constructor(t){super(t instanceof MessageChannel?t.port1:t),(0,i.A)(this,"channel",void 0),(0,i.A)(this,"next",void 0),this.channel=t}connect(t){this.off(),t.off(),this.on(h.S3,(async e=>{try{const r=await t.request(e.method,e.params);this.reply(e,r,null,u.ai(r)||"pull"!==e.method?null:[r])}catch(t){this.reply(e,null,t)}})),this.on(h.Wo,(e=>{t.notify(e.method,e.params)})),t.on(h.S3,(async e=>{try{const r=await this.request(e.method,e.params);t.reply(e,r,null,u.ai(r)||"pull"!==e.method?null:[r])}catch(r){t.reply(e,null,r)}})),t.on(h.Wo,(t=>{this.notify(t.method,t.params)})),this.next=t}disconnect(){this.off(),this.next&&this.next.off(),this.next=null}getInnerPort(){if(this.channel instanceof MessageChannel)return this.channel.port2}}class l{constructor(t,e,r){(0,i.A)(this,"options",void 0),(0,i.A)(this,"inputAVFilterNodePort",void 0),(0,i.A)(this,"outputAVFilterNodePort",void 0),(0,i.A)(this,"inputInnerNodePort",void 0),(0,i.A)(this,"outputInnerNodePort",void 0),(0,i.A)(this,"currentOutput",void 0),(0,i.A)(this,"consumedCount",void 0),(0,i.A)(this,"pending",void 0),(0,i.A)(this,"inputCount",void 0),(0,i.A)(this,"outputCount",void 0),(0,i.A)(this,"inputConnectedMap",void 0),(0,i.A)(this,"outputConnectedMap",void 0),this.options=t,this.inputCount=e,this.outputCount=r,this.inputAVFilterNodePort=[],this.outputAVFilterNodePort=[],this.inputInnerNodePort=[],this.outputInnerNodePort=[];for(let t=0;t<this.inputCount;t++){const t=new d(new MessageChannel);this.inputAVFilterNodePort.push(t),this.inputInnerNodePort.push(new h.Ay(t.getInnerPort()))}for(let t=0;t<this.outputCount;t++){const t=new d(new MessageChannel);this.outputAVFilterNodePort.push(t),this.outputInnerNodePort.push(new h.Ay(t.getInnerPort()))}this.consumedCount=0,this.pending=[],this.currentOutput=[];for(let t=0;t<this.outputCount;t++)this.handlePull(this.outputInnerNodePort[t],t);this.inputConnectedMap=new(n()),this.outputConnectedMap=new(n())}handlePull(t,e){t.on(h.S3,(async r=>{if("pull"===r.method)if(0===this.consumedCount){const i=[];this.currentOutput.length=0;for(let t=0;t<this.inputCount;t++)i.push(await this.inputInnerNodePort[t].request("pull"));await this.process(i,this.currentOutput),i.forEach((t=>{u.ai(t)?t>0&&(this.options.avframePool?this.options.avframePool.release(t):(0,c.xj)(t)):t.close()})),t.reply(r,this.currentOutput[e],null,u.ai(this.currentOutput[e])?null:[this.currentOutput[e]]),this.consumedCount++,this.pending.length&&(this.pending.forEach((t=>{t.resolve()})),this.pending.length=0),this.consumedCount===this.outputCount&&(this.consumedCount=0,this.currentOutput.length=0)}else this.consumedCount===this.outputCount-1?(t.reply(r,this.currentOutput[e],null,u.ai(this.currentOutput[e])?null:[this.currentOutput[e]]),this.consumedCount=0,this.currentOutput.length=0):(await new(a())(((t,e)=>{this.pending.push({resolve:t,reject:e})})),t.reply(r,this.currentOutput[e],null,u.ai(this.currentOutput[e])?null:[this.currentOutput[e]]),this.consumedCount++)}))}getInputNodePort(t){return this.inputAVFilterNodePort[t]}getOutputNodePort(t){return this.outputAVFilterNodePort[t]}getInputCount(){return this.inputCount}getOutputCount(){return this.outputCount}getFreeInputNodePort(){const t=[];this.inputConnectedMap.forEach(((e,r)=>{t.push(e)}));for(let e=0;e<this.inputCount;e++)if(!f.zy(t,e))return{index:e,port:this.getInputNodePort(e)}}getFreeOutputNodePort(){const t=[];this.outputConnectedMap.forEach(((e,r)=>{t.push(e)}));for(let e=0;e<this.outputCount;e++)if(!f.zy(t,e))return{index:e,port:this.getOutputNodePort(e)}}addInputPeer(t,e){this.inputConnectedMap.set(t,e)}removeInputPeer(t){this.inputConnectedMap.delete(t)}addOutputPeer(t,e){this.outputConnectedMap.set(t,e)}removeOutputPeer(t){this.outputConnectedMap.delete(t)}connect(t){if(this.outputConnectedMap.size===this.outputCount)throw new Error("all output has connected");const e=this.getFreeOutputNodePort(),r=t.getFreeInputNodePort();if(!r)throw new Error("next node all input has connected");e.port.connect(r.port),this.outputConnectedMap.set(t,e.index),t.addInputPeer(this,r.index)}disconnectNode(t){this.outputConnectedMap.has(t)&&(this.outputAVFilterNodePort[this.outputConnectedMap.get(t)].disconnect(),this.outputConnectedMap.delete(t),t instanceof l&&t.removeInputPeer(this))}disconnect(t){if(t)return this.disconnectNode(t);this.outputConnectedMap.forEach(((t,e)=>{this.disconnectNode(e)}))}}},53402:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(63939),s=r(18812),n=r(56024),o=r(67672);class a extends s.A{constructor(t){super(t,1,1)}async ready(){}async destroy(){}async process(t,e){let r=t[0];if(o.ai(r)&&r<0)return void(e[0]=r);let s=o.ai(r)?i.f[17](r+104):BigInt(Math.floor(r.timestamp));if(s<this.options.start)for(;;){const t=await this.inputInnerNodePort[0].request("pull");if(o.ai(t)&&t<0)return void(e[0]=t);if(s=o.ai(t)?i.f[17](t+104):BigInt(Math.floor(t.timestamp)),s>=this.options.start)return void(e[0]=t);o.ai(t)?this.options.avframePool?this.options.avframePool.release(t):(0,n.xj)(t):t.close()}else{if(s>this.options.end&&this.options.end>=this.options.start)return void(e[0]=-1048576);if(o.ai(r)){const t=this.options.avframePool?this.options.avframePool.alloc():(0,n.FP)();(0,n.gg)(t,r),e[0]=t}else e[0]=r.clone()}}}},54903:(t,e,r)=>{"use strict";r.d(e,{A:()=>A});var i=r(134),s=r(14686),n=r(63939),o=r(50932),a=r(92246),c=r(18812),h=r(55833),u=r(56024),f=r(37837),d=r(66788),l=r(9705),p=r(37815),m=r(77231),g=r(4624);class A extends c.A{constructor(t){super(t,1,1),(0,i.A)(this,"resampler",void 0),(0,i.A)(this,"pcm",void 0)}async ready(){this.pcm=(0,f.Gy)(40)}async destroy(){this.pcm&&(n.f[20](this.pcm)&&((0,f.aI)(n.f[20](this.pcm)),(0,f.aI)(this.pcm)),(0,f.Eb)(this.pcm)),this.resampler&&(this.resampler.close(),this.resampler=null)}async process(t,e){const r=t[0];if(r<0)return void(e[0]=r);const i=this.options.avframePool?this.options.avframePool.alloc():(0,u.FP)();if(n.f[15](r+152)!==this.options.output.sampleRate||n.f[15](r+292)!==this.options.output.channels||n.f[15](r+80)!==this.options.output.format&&this.options.output.format!==m.N_){if(this.resampler){const t=this.resampler.getInputPCMParameters();t.channels===n.f[15](r+292)&&t.sampleRate===n.f[15](r+152)&&t.format===n.f[15](r+80)||(this.resampler.close(),this.resampler=null)}if(!this.resampler){this.resampler=new a.A({resource:this.options.resource});try{await this.resampler.open({channels:n.f[15](r+292),sampleRate:n.f[15](r+152),format:n.f[15](r+80)},{channels:this.options.output.channels,sampleRate:this.options.output.sampleRate,format:this.options.output.format===m.N_?n.f[15](r+80):this.options.output.format})}catch(t){return g.z3(`open resampler failed, error ${t}`,"src/avfilter/audio/ResampleFilterNode.ts",92),void(e[0]=l.E$)}}this.resampler.resample(n.f[20](r+64),this.pcm,n.f[15](r+76)),o.M[15](i+80,this.options.output.format===m.N_?n.f[15](r+80):this.options.output.format),o.M[15](i+76,n.f[15](this.pcm+8)),o.M[15](i+152,n.f[15](this.pcm+20)),o.M[15](i+292,n.f[15](this.pcm+16)),o.M[15](i+32,n.f[15](this.pcm+4)),o.M[17](i+104,n.f[17](r+104)),o.M[17](i+312,n.f[17](r+312)),o.M[17](i+112,n.f[17](r+112)),(0,s.Mr)(i+120,r+120,8);const t=(0,d.K0)(n.f[15](i+80)),c=t?n.f[15](i+292):1;if(c>h.pu){if(o.M[20](i+64,(0,f.sY)(4*c)),!n.f[20](i+64))return(0,f.aI)(i+64),void(e[0]=l.gR)}else o.M[20](i+64,i);for(let r=0;r<Math.min(c,h.pu);r++){if(0===r&&(o.M[20](i+156+4*r,(0,p.aw)(n.f[20](n.f[20](this.pcm)+r),n.f[15](this.pcm+4)*(t?n.f[15](this.pcm+16):1))),!n.f[20](i+156+4*r)))return(0,u.to)(i),void(e[0]=l.gR);o.M[20](n.f[20](i+64)+4*r,n.f[20](n.f[20](this.pcm)+4*r)),o.M[20](i+4*r,n.f[20](n.f[20](this.pcm)+4*r)),o.M[20](n.f[20](this.pcm)+4*r,0)}for(let t=0;t<c-h.pu;t++)o.M[20](n.f[20](i+64)+(t+h.pu),n.f[20](n.f[20](this.pcm)+4*t)),o.M[20](n.f[20](this.pcm)+4*t,0);o.M[15](this.pcm+12,0),e[0]=i}else(0,u.gg)(i,r),e[0]=i}}},84624:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var i=r(134),s=r(63939),n=r(18812),o=r(67672),a=r(56024),c=r(44328),h=r(77231);class u extends n.A{constructor(t){super(t,1,1),(0,i.A)(this,"lastPts",void 0),(0,i.A)(this,"delta",void 0),(0,i.A)(this,"timeBase",void 0),(0,i.A)(this,"step",void 0)}async ready(){this.lastPts=-BigInt(1),this.delta=BigInt(0),this.timeBase=h.KR,this.step=(0,c.k)(BigInt(1),{den:this.options.framerate.num,num:this.options.framerate.den},this.timeBase)}async destroy(){}async process(t,e){let r=t[0];if(o.ai(r)&&r<0)return void(e[0]=r);let i=(0,c.k)(o.ai(r)?s.f[17](r+104):BigInt(Math.floor(r.timestamp)),this.options.timeBase,this.timeBase),n=i-this.lastPts+this.delta;if(n<this.step&&this.lastPts>-BigInt(1))for(;;){const t=await this.inputInnerNodePort[0].request("pull");if(o.ai(t)&&t<0)return void(e[0]=t);if(i=(0,c.k)(o.ai(t)?s.f[17](t+104):BigInt(Math.floor(t.timestamp)),this.options.timeBase,this.timeBase),n=i-this.lastPts,n>=this.step)return this.delta+=n-this.step,this.lastPts=i,void(e[0]=t);o.ai(t)?this.options.avframePool?this.options.avframePool.release(t):(0,a.xj)(t):t.close()}else if(this.delta=n-this.step,this.lastPts=i,o.ai(r)){const t=this.options.avframePool?this.options.avframePool.alloc():(0,a.FP)();(0,a.gg)(t,r),e[0]=t}else e[0]=r.clone()}}},57473:(t,e,r)=>{"use strict";r.d(e,{A:()=>p});var i=r(134),s=r(63939),n=r(18812),o=r(56024),a=r(49804),c=r(67672),h=r(37180),u=r(77231),f=r(9705),d=r(4624),l="src/avfilter/video/ScaleFilterNode.ts";class p extends n.A{constructor(t){super(t,1,1),(0,i.A)(this,"scaler",void 0)}async ready(){}async destroy(){this.scaler&&(this.scaler.close(),this.scaler=null)}async process(t,e){let r=t[0];if(c.ai(r)&&r<0)return void(e[0]=r);const i=c.ai(r)?s.f[15](r+68):r.displayWidth,n=c.ai(r)?s.f[15](r+72):r.displayHeight,p=c.ai(r)?s.f[15](r+80):(0,h.OB)(r.format);if(i!==this.options.output.width||n!==this.options.output.height||p!==this.options.output.format&&this.options.output.format!==u.N_&&-1!==p){if(-1===p)return d.z3("src avframe format not support",l,58),void(e[0]=f.E$);const s=this.options.avframePool?this.options.avframePool.alloc():(0,o.FP)();if(this.scaler){const t=this.scaler.getInputScaleParameters();t.width===i&&t.height===n&&t.format===p||(this.scaler.close(),this.scaler=null)}if(!this.scaler){this.scaler=new a.A({resource:this.options.resource});try{await this.scaler.open({width:i,height:n,format:p},{width:this.options.output.width,height:this.options.output.height,format:this.options.output.format!==u.N_?this.options.output.format:23!==p||c.ai(r)?p:0})}catch(t){return d.z3(`open scaler failed, error ${t}`,l,100),void(e[0]=f.E$)}}c.ai(r)||(r=(0,h.lL)(t[0],this.options.avframePool?this.options.avframePool.alloc():(0,o.FP)())),this.scaler.scale(r,s),e[0]=s,c.ai(t[0])||(this.options.avframePool?this.options.avframePool.release(r):(0,o.xj)(r))}else if(c.ai(r)){const t=this.options.avframePool?this.options.avframePool.alloc():(0,o.FP)();(0,o.gg)(t,r),e[0]=t}else e[0]=r.clone()}}},44315:(t,e,r)=>{"use strict";r.d(e,{Xv:()=>c,fG:()=>h,oD:()=>a});var i=r(134),s=r(15017),n=r(71517);class o{constructor(){(0,i.A)(this,"packetBuffer",void 0),this.packetBuffer=[]}}class a{constructor(){(0,i.A)(this,"metadataHeaderPadding",-1),(0,i.A)(this,"metadata",void 0),(0,i.A)(this,"streams",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"privateData",void 0),(0,i.A)(this,"processPrivateData",void 0),(0,i.A)(this,"iformat",void 0),(0,i.A)(this,"oformat",void 0),(0,i.A)(this,"ioReader",void 0),(0,i.A)(this,"ioWriter",void 0),(0,i.A)(this,"errorFlag",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"streamIndex",void 0),(0,i.A)(this,"getDecoderResource",null),this.streams=[],this.errorFlag=0,this.streamIndex=0,this.interval=new o,this.options={},this.privateData={},this.metadata={}}get format(){return this.iformat?this.iformat.type:this.oformat?this.oformat.type:-1}getStreamById(t){return this.streams.find((e=>e.id===t))}getStreamByIndex(t){return this.streams.find((e=>e.index===t))}getStreamByMediaType(t){return this.streams.find((e=>{var r;return(null===(r=e.codecpar)||void 0===r?void 0:r.codecType)===t}))}createStream(){const t=new s.A;return t.index=this.streamIndex++,t.id=t.index,this.removeStreamByIndex(t.index),this.streams.push(t),t}addStream(t){this.removeStreamByIndex(t.index),this.streams.push(t)}removeStream(t){this.removeStreamByIndex(t.index)}removeStreamById(t){const e=this.streams.findIndex((e=>e.id===t));if(e>-1){const t=this.streams.splice(e,1);t[0]&&t[0].destroy()}}removeStreamByIndex(t){const e=this.streams.findIndex((e=>e.index===t));if(e>-1){const t=this.streams.splice(e,1);t[0]&&t[0].destroy()}}destroy(){this.oformat&&this.oformat.destroy(this),this.iformat&&this.iformat.destroy(this),this.interval.packetBuffer.length&&this.interval.packetBuffer.forEach((t=>{(0,n.Qe)(t)})),this.streams.forEach((t=>{t.destroy()})),this.streams=[],this.interval=null,this.ioReader=this.ioWriter=null,this.oformat=this.iformat=null}}function c(){return new a}function h(){return new a}},15017:(t,e,r)=>{"use strict";r.d(e,{A:()=>f});var i=r(134),s=r(80662),n=r.n(s),o=r(74503),a=r(94300),c=r(77162),h=r(77231),u=r(9599);class f{constructor(){(0,i.A)(this,"index",h.N_),(0,i.A)(this,"id",h.N_),(0,i.A)(this,"privData",null),(0,i.A)(this,"codecpar",(0,o.A)(c.A,new c.A)),(0,i.A)(this,"sideData",{}),(0,i.A)(this,"nbFrames",BigInt(0)),(0,i.A)(this,"metadata",{}),(0,i.A)(this,"duration",h.Dh),(0,i.A)(this,"startTime",h.Dh),(0,i.A)(this,"firstDTS",BigInt(0)),(0,i.A)(this,"disposition",0),(0,i.A)(this,"timeBase",(0,o.A)(u.P)),(0,i.A)(this,"sampleIndexes",[]),(0,i.A)(this,"sampleIndexesPosMap",new(n()))}destroy(){this.codecpar&&(this.codecpar.destroy(),(0,a.A)(this.codecpar),this.codecpar=null),this.timeBase&&((0,a.A)(this.timeBase),this.timeBase=null),this.sampleIndexes.length=0,this.sampleIndexesPosMap.clear()}}},58469:(t,e,r)=>{"use strict";r.d(e,{En:()=>a,Hm:()=>n,Ij:()=>u,XC:()=>h,_5:()=>c,hY:()=>o,uF:()=>s});var i=r(77231);const s={1:"Main",2:"LC",3:"LC",4:"LC",5:"HE",6:"HE"},n={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,i.N_,i.N_,i.N_],a=[i.N_,1,2,3,4,5,6,7];function c(t){let e=i.N_,r=i.N_,s=i.N_;var n,c;return t.length>=2&&(e=t[0]>>3&31,r=null!==(n=o[(7&t[0])<<1|t[1]>>7])&&void 0!==n?n:48e3,s=null!==(c=a[t[1]>>3&15])&&void 0!==c?c:2),{profile:e,sampleRate:r,channels:s}}function h(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e){const{profile:r,sampleRate:i,channels:s}=c(e);t.codecpar.profile=r,t.codecpar.sampleRate=i,t.codecpar.chLayout.nbChannels=s}}function u(t){const e=n[t.sampleRate],r=t.chLayout.nbChannels,i=new Uint8Array(2);return i[0]=(31&t.profile)<<3|(14&e)>>1,i[1]=(1&e)<<7|(15&r)<<3,i}},90412:(t,e,r)=>{"use strict";r.d(e,{Ui:()=>l,XC:()=>d,Yj:()=>p,k9:()=>f,zk:()=>c});var i=r(63939),s=r(37246),n=r(11573),o=r(83314),a=r(97317);const c={0:"Main",1:"High",2:"Professional"},h=[{level:20,maxResolution:2359296},{level:21,maxResolution:4460544},{level:30,maxResolution:10653696},{level:31,maxResolution:17040384},{level:40,maxResolution:21233664},{level:41,maxResolution:21233664},{level:50,maxResolution:35651584},{level:51,maxResolution:35651584},{level:52,maxResolution:35651584},{level:53,maxResolution:35651584},{level:60,maxResolution:142606336},{level:61,maxResolution:142606336},{level:62,maxResolution:142606336},{level:63,maxResolution:142606336}],u=[20,21,22,23,30,31,32,33,40,41,42,43,50,51,52,53,60,61,62,63,70,71,72,73];function f(t,e,r){const i=t*e;for(const t of h)if(i<=t.maxResolution)return t.level}function d(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=4){const r=l(e);t.codecpar.profile=r.profile,t.codecpar.level=r.level}}function l(t){const e=new s.A(t.length);e.appendBuffer(t),e.readU1(),e.readU(7);const r=e.readU(3),i=e.readU(5),n=e.readU1();let o=e.readU1()?10:8;return e.readU1()&&(o=12),{profile:r,level:i,tier:n,bitDepth:o,monochrome:e.readU1(),chromaSubsamplingX:e.readU1(),chromaSubsamplingY:e.readU1(),chromaSamplePosition:e.readU(2)}}function p(t,e){const r=new o.A(4);r.writeU1(1),r.writeU(7,1);const c=function(t){const e=new s.A;e.appendBuffer(t);const r=[];for(;e.remainingLength();){const i=e.getPos();e.readU1(),e.readU(4);const s=e.readU1(),o=e.readU1();e.readU1(),s&&e.readU(8);const a=o?n.v(e):t.length-1-s,c=e.getPos()-i;r.push(t.subarray(i,i+c+a)),e.skip(8*a)}return r}(e).find((t=>1==(t[0]>>>3&15)));if(c){const t=function(t){const e=new s.A(t.length);e.appendBuffer(t),e.readU1(),e.readU(4);const r=e.readU1(),i=e.readU1();e.readU1(),r&&e.readU(8),i&&n.v(e);const o=n.f(e,3),a=(n.f(e,1),n.f(e,1));let c=0,h=0,f=[0],d=[0],l=[0],p=[0],m=[0],g=[0],A=0,v=[0],w=[0],y=[0];if(a)d[0]=n.f(e,5);else{c=n.f(e,1),c?(n.f(e,32),n.f(e,32),n.f(e,1)&&n.d(e),n.f(e,1)&&(A=n.f(e,5),n.f(e,32),n.f(e,5),n.f(e,5))):h=0;let t=n.f(e,1),r=n.f(e,5);for(let i=0;i<=r;i++){if(f[i]=n.f(e,12),d[i]=n.f(e,5),d[i]>7?l[i]=n.f(e,1):l[i]=0,h){if(p[i]=n.f(e,1),p[i]){let t=A+1;v[i]=n.f(e,t),w[i]=n.f(e,t),y[i]=n.f(e,1)}}else p[i]=0;t&&(m[i]=n.f(e,1),m[i]&&(g[i]=n.f(e,4)))}}let b=n.f(e,4),k=n.f(e,4),_=b+1,x=n.f(e,_);_=k+1;let I=n.f(e,_),M=0,P=0,C=0;M=a?0:n.f(e,1),M&&(n.f(e,4),n.f(e,3)),n.f(e,1),n.f(e,1),n.f(e,1);let B=0,T=0,E=0,U=0,S=0,R=0,L=2,D=2,F=0;a||(n.f(e,1),n.f(e,1),n.f(e,1),n.f(e,1),U=n.f(e,1),U?(S=n.f(e,1),R=n.f(e,1)):(S=0,R=0),L=n.f(e,1)?2:n.f(e,1),L>0?n.f(e,1)?2:n.f(e,1):2,U&&n.f(e,3)),n.f(e,1),n.f(e,1),n.f(e,1);let $=n.f(e,1),z=0,O=0,N=0;2==o&&$?(z=n.f(e,1),O=z?12:10):o<=2&&(O=$?10:8),N=1==o?0:n.f(e,1);let W=0,V=0,j=0;n.f(e,1)?(W=n.f(e,8),V=n.f(e,8),j=n.f(e,8)):(W=2,V=2,j=2);let G=0,H=0,q=0,K=0,Y=0;return N?(G=n.f(e,1),H=1,q=1,K=0,Y=0):1==W&&13==V&&0==j?(G=1,H=0,q=0,Y=n.f(e,1)):(G=n.f(e,1),0==o?(H=1,q=1):1==o?(H=0,q=0):12==O?(H=n.f(e,1),q=H?n.f(e,1):0):(H=1,q=0),H&&q&&(K=n.f(e,2)),Y=n.f(e,1)),n.f(e,1),{width:x+1,height:I+1,profile:o,level:u[d[0]],tier:l[0],bitDepth:O,monoChrome:N,colorRange:G,colorPrimaries:W,transferCharacteristics:V,matrixCoefficients:j,subsamplingX:H,subsamplingY:q,chromaSamplePosition:K}}(c);r.writeU(3,t.profile),r.writeU(5,t.level),r.writeU(1,t.tier),r.writeU(1,t.bitDepth>8?1:0),r.writeU(1,12===t.bitDepth?1:0),r.writeU(1,t.monoChrome),r.writeU(1,t.subsamplingX),r.writeU(1,t.subsamplingY),r.writeU(1,t.chromaSamplePosition)}else{const e=a.g[i.f[15](t+28)];r.writeU(3,i.f[15](t+48)),r.writeU(5,i.f[15](t+52)),r.writeU(1,0),r.writeU(1,e.comp[0].depth>8?1:0),r.writeU(1,12===e.comp[0].depth?1:0),r.writeU(1,0),r.writeU(1,1),r.writeU(1,1),r.writeU(1,0)}return r.writeU(8,0),r.getBuffer()}},20620:(t,e,r)=>{"use strict";r.d(e,{Jk:()=>x,OD:()=>_,XC:()=>M,ci:()=>I,k9:()=>w,oT:()=>k,tZ:()=>A});var i=r(63939),s=r(50932),n=r(72739),o=r(729),a=r(31865),c=r(37246),h=r(4624),u=r(14686),f=r(71517),d=r(60264),l=r(37837),p=r(23991),m="src/avformat/codecs/h264.ts";const g=3,A={66:"Constrained Baseline",77:"Main",100:"High",110:"High10",122:"High422",244:"High444"},v=[{level:10,maxResolution:25344,maxFrameRate:15},{level:11,maxResolution:25344,maxFrameRate:30},{level:12,maxResolution:101376,maxFrameRate:30},{level:13,maxResolution:101376,maxFrameRate:30},{level:20,maxResolution:101376,maxFrameRate:30},{level:21,maxResolution:202752,maxFrameRate:30},{level:22,maxResolution:414720,maxFrameRate:30},{level:30,maxResolution:414720,maxFrameRate:30},{level:31,maxResolution:921600,maxFrameRate:30},{level:32,maxResolution:1310720,maxFrameRate:60},{level:40,maxResolution:2097152,maxFrameRate:30},{level:41,maxResolution:2097152,maxFrameRate:60},{level:42,maxResolution:2228224,maxFrameRate:60},{level:50,maxResolution:8912896,maxFrameRate:30},{level:51,maxResolution:8912896,maxFrameRate:60},{level:52,maxResolution:8912896,maxFrameRate:120},{level:60,maxResolution:35651584,maxFrameRate:30},{level:61,maxResolution:35651584,maxFrameRate:60},{level:62,maxResolution:35651584,maxFrameRate:120}];function w(t,e,r){const i=t*e;for(const t of v)if(i<=t.maxResolution&&r<=t.maxFrameRate)return t.level}function y(t){const e=new a.A(t);e.skip(5);const r=[],i=[],s=[],n=31&e.readUint8();for(let t=0;t<n;t++){const t=e.readUint16();r.push(e.readBuffer(t))}const o=e.readUint8();for(let t=0;t<o;t++){const t=e.readUint16();i.push(e.readBuffer(t))}if(e.remainingSize()>4){e.skip(3);const t=e.readUint8();if(t>0)for(let r=0;r<t;r++){const t=e.readUint16();s.push(e.readBuffer(t))}}return{spss:r,ppss:i,spsExts:s}}function b(t,e,r=[]){t.length>32&&(h.R8(`h264 metadata's sps max length is 32, but get ${t.length}`,m,199),t=t.slice(0,32)),t.length>256&&(h.R8(`h264 metadata's pps max length is 256, but get ${t.length}`,m,203),t=t.slice(0,256));let i=7;i=t.reduce(((t,e)=>t+2+e.length),i),i=e.reduce(((t,e)=>t+2+e.length),i);const s=t[0],a=P(s);66!==a.profile&&77!==a.profile&&88!==a.profile&&(i+=4,r.length&&(i=r.reduce(((t,e)=>t+2+e.length),i)));const c=new Uint8Array(i),u=new o.A(c);return u.writeUint8(1),u.writeUint8(s[1]),u.writeUint8(s[2]),u.writeUint8(s[3]),u.writeUint8(252|g),u.writeUint8(224|31&t.length),n.__(t,(t=>{u.writeUint16(t.length),u.writeBuffer(t)})),u.writeUint8(e.length),n.__(e,(t=>{u.writeUint16(t.length),u.writeBuffer(t)})),66!==a.profile&&77!==a.profile&&88!==a.profile&&(u.writeUint8(252|a.chromaFormatIdc),u.writeUint8(248|a.bitDepthLumaMinus8),u.writeUint8(248|a.bitDepthChromaMinus8),r.length&&n.__(r,(t=>{u.writeUint16(t.length),u.writeBuffer(t)}))),c}function k(t){let e,r=(0,d.py)(t),i=!1;if(r.length>1){const t=[],i=[],s=[];r.forEach((e=>{const r=31&e[0];7===r?t.push(e):8===r?i.push(e):13===r&&s.push(e)})),t.length&&i.length&&(e=b(t,i,s)),r=r.filter((t=>{const e=31&t[0];return 9!==e&&8!==e&&7!==e&&13!==e}))}const s=r.reduce(((t,e)=>t+g+1+e.length),0),a=(0,l.sY)(s),c=(0,u.s3)(a,s),h=new o.A(c);return n.__(r,(t=>{3===g?h.writeUint32(t.length):2===g?h.writeUint24(t.length):1===g?h.writeUint16(t.length):h.writeUint8(t.length),h.writeBuffer(t.subarray(0)),5==(31&t[0])&&(i=!0)})),{bufferPointer:a,length:s,key:i,extradata:e}}function _(t,e){const r=e?3&e[4]:g;let i=[],s=[],c=[],h=!1;if(e){const t=y(e);i=t.spss,s=t.ppss,c=t.spsExts,h=!0}const f=[],d=[],p=new a.A(t);for(;p.remainingSize()>0;){let e=0;e=3===r?p.readUint32():2===r?p.readUint24():1===r?p.readUint16():p.readUint8();const i=t.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+e);p.skip(e);const s=31&i[0];6===s?d.push(i):9!==s&&f.push(i)}let m=i.reduce(((t,e)=>t+4+e.length),0);m=s.reduce(((t,e)=>t+4+e.length),m),m=c.reduce(((t,e)=>t+4+e.length),m),m=d.reduce(((t,e)=>t+4+e.length),m),m=f.reduce(((t,e,r)=>t+(r?3:4)+e.length),m);const A=(0,l.sY)(m+6),v=new o.A((0,u.s3)(A,m+6));return v.writeUint8(0),v.writeUint8(0),v.writeUint8(0),v.writeUint8(1),v.writeUint8(9),v.writeUint8(240),n.__(d,(t=>{v.writeUint8(0),v.writeUint8(0),v.writeUint8(0),v.writeUint8(1),v.writeBuffer(t)})),n.__(i,(t=>{v.writeUint8(0),v.writeUint8(0),v.writeUint8(0),v.writeUint8(1),v.writeBuffer(t)})),n.__(s,(t=>{v.writeUint8(0),v.writeUint8(0),v.writeUint8(0),v.writeUint8(1),v.writeBuffer(t)})),n.__(c,(t=>{v.writeUint8(0),v.writeUint8(0),v.writeUint8(0),v.writeUint8(1),v.writeBuffer(t)})),n.__(f,((t,e)=>{v.writeUint8(0),v.writeUint8(0),e||v.writeUint8(0),v.writeUint8(1),v.writeBuffer(t),5==(31&t[0])&&(h=!0)})),{bufferPointer:A,length:m+6,key:h}}function x(t,e){var r;if(!(1&i.f[15](t+36)))return;const s=(0,f.iI)(t);if((0,d.Bs)(s))return;const n=null!==(r=e.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:g;let o=[],c=[],h=[],p=[];const m=new a.A(s);for(;m.remainingSize()>0;){let t=0;t=3===n?m.readUint32():2===n?m.readUint24():1===n?m.readUint16():m.readUint8();const e=s.subarray(0|Number(0xffffffffn&m.getPos()),(0|Number(0xffffffffn&m.getPos()))+t);m.skip(t);const r=31&e[0];7===r?o.push(e):8===r?c.push(e):13===r?h.push(e):p.push(e)}if(o.length||c.length){const e=b(o,c,h),r=(0,l.sY)(e.length);(0,u.lW)(r,e.length,e),(0,f.Ow)(t,1,r,e.length)}}function I(t,e=!1){if(!(1&i.f[15](t+36)||e))return;const r=(0,f.iI)(t);if(!(0,d.Bs)(r))return;let n=(0,d.py)(r);if(n.length>1){const e=[],r=[],o=[];if(n.forEach((t=>{const i=31&t[0];7===i?e.push(t):8===i?r.push(t):13===i&&o.push(t)})),e.length&&r.length){const n=b(e,r,o),a=(0,l.sY)(n.length);(0,u.lW)(a,n.length,n),(0,f.Ow)(t,1,a,n.length),s.M[15](t+36,1|i.f[15](t+36))}}}function M(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=3&e[4];const{spss:r}=y(e);if(r.length){const{profile:e,level:i,width:s,height:n}=P(r[0]);t.codecpar.profile=e,t.codecpar.level=i,t.codecpar.width=s,t.codecpar.height=n}}}function P(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);const r=(0,d.BN)(t.subarray(e)),i=new c.A(r.length);i.appendBuffer(r),i.readU1(),i.readU(2),i.readU(5);const s=i.readU(8);i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU1(),i.readU(2);const n=i.readU(8);p.xb(i);let o=1,a=0,h=0;if((100==s||110==s||122==s||244==s||44==s||83==s||86==s||118==s||128==s||138==s||139==s||134==s||135==s)&&(o=p.xb(i),3===o&&i.readU1(),a=p.xb(i),h=p.xb(i),i.readU1(),i.readU1())){const t=new Array(8);for(let e=0;e<(3!=o?8:12);e++)t[e]=i.readU1()}p.xb(i);const u=p.xb(i);if(0===u)p.xb(i);else if(1===u){i.readU1(),p.$x(i),p.$x(i);const t=p.xb(i);for(let e=0;e<t;e++)p.$x(i)}p.xb(i),i.readU1();const f=p.xb(i),l=p.xb(i),m=i.readU1();let g=16*(f+1),A=(2-m)*(l+1)*16;m||i.readU1(),i.readU1();const v=i.readU1();if(v){let t=1,e=2-v;1===o?(t=2,e=2*(2-v)):2===v&&(t=2,e=2-v),g-=t*(p.xb(i)+p.xb(i)),A-=e*(p.xb(i)+p.xb(i))}return{profile:s,level:n,width:g,height:A,chromaFormatIdc:o,bitDepthLumaMinus8:a,bitDepthChromaMinus8:h}}},53e3:(t,e,r)=>{"use strict";r.d(e,{Jk:()=>k,OD:()=>b,XC:()=>x,ci:()=>_,dT:()=>p,k9:()=>g,oT:()=>y});var i=r(63939),s=r(50932),n=r(72739),o=r(729),a=r(31865),c=r(37246),h=r(14686),u=r(60264),f=r(71517),d=r(37837),l=r(23991);const p={1:"Main",2:"Main10",3:"MainStillPicture",4:"Main444"},m=[{level:10,maxLumaSamplesPerSecond:552960,maxLumaPictureSize:36864,maxBitRate:{main:128,main10:150}},{level:20,maxLumaSamplesPerSecond:3686400,maxLumaPictureSize:122880,maxBitRate:{main:1500,main10:1875}},{level:21,maxLumaSamplesPerSecond:7372800,maxLumaPictureSize:245760,maxBitRate:{main:3e3,main10:3750}},{level:30,maxLumaSamplesPerSecond:16588800,maxLumaPictureSize:552960,maxBitRate:{main:6e3,main10:7500}},{level:31,maxLumaSamplesPerSecond:33177600,maxLumaPictureSize:983040,maxBitRate:{main:1e4,main10:12500}},{level:40,maxLumaSamplesPerSecond:66846720,maxLumaPictureSize:2228224,maxBitRate:{main:12e3,main10:15e3}},{level:41,maxLumaSamplesPerSecond:133693440,maxLumaPictureSize:2228224,maxBitRate:{main:2e4,main10:25e3}},{level:50,maxLumaSamplesPerSecond:267386880,maxLumaPictureSize:8912896,maxBitRate:{main:25e3,main10:4e4}},{level:51,maxLumaSamplesPerSecond:534773760,maxLumaPictureSize:8912896,maxBitRate:{main:4e4,main10:6e4}},{level:52,maxLumaSamplesPerSecond:1069547520,maxLumaPictureSize:35651584,maxBitRate:{main:6e4,main10:1e5}},{level:60,maxLumaSamplesPerSecond:1069547520,maxLumaPictureSize:35651584,maxBitRate:{main:6e4,main10:1e5}},{level:61,maxLumaSamplesPerSecond:2139095040,maxLumaPictureSize:89128960,maxBitRate:{main:12e4,main10:24e4}},{level:62,maxLumaSamplesPerSecond:4278190080,maxLumaPictureSize:356515840,maxBitRate:{main:24e4,main10:48e4}}];function g(t,e,r,i,s){const n=1===t?"main":"main10",o=e*r*i;for(const t of m)if(o<=t.maxLumaSamplesPerSecond&&e*r<=t.maxLumaPictureSize&&s<=t.maxBitRate[n])return t.level}const A=3;function v(t){const e=new a.A(t,!0);e.skip(22);let r=[],i=[],s=[];const n=e.readUint8();for(let t=0;t<n;t++){const t=63&e.readUint8(),n=e.readUint16(),o=[];for(let t=0;t<n;t++){const t=e.readUint16();o.push(e.readBuffer(t))}32===t?r=o:33===t?i=o:34===t&&(s=o)}return{vpss:r,spss:i,ppss:s}}function w(t,e,r){const i=e[0];let s=23;t.length&&(s+=3,s=t.reduce(((t,e)=>t+2+e.length),s)),e.length&&(s+=3,s=e.reduce(((t,e)=>t+2+e.length),s)),r.length&&(s+=3,s=r.reduce(((t,e)=>t+2+e.length),s));const a=new Uint8Array(s),c=new o.A(a,!0),h=I(i);c.writeUint8(1),c.writeUint8(i[1]),c.writeUint8(i[2]),c.writeUint8(i[3]),c.writeUint8(i[4]),c.writeUint8(i[5]),c.writeUint8(i[6]),c.writeUint8(i[7]),c.writeUint8(i[8]),c.writeUint8(i[9]),c.writeUint8(i[10]),c.writeUint8(i[11]),c.writeUint8(h.level),c.writeUint8(1020),c.writeUint8(0),c.writeUint8(16320),c.writeUint8(16320|h.chromaFormatIdc),c.writeUint8(8160|h.bitDepthLumaMinus8),c.writeUint8(8160|h.bitDepthChromaMinus8),c.writeUint16(0),c.writeUint8(8|(1&i[0])<<2|A);let u=0;return t.length&&u++,e.length&&u++,r.length&&u++,c.writeUint8(u),t.length&&(c.writeUint8(160),c.writeUint16(t.length),n.__(t,(t=>{c.writeUint16(t.length),c.writeBuffer(t)}))),e.length&&(c.writeUint8(161),c.writeUint16(e.length),n.__(e,(t=>{c.writeUint16(t.length),c.writeBuffer(t)}))),r.length&&(c.writeUint8(162),c.writeUint16(r.length),n.__(r,(t=>{c.writeUint16(t.length),c.writeBuffer(t)}))),a}function y(t){let e,r=!1,i=(0,u.py)(t);if(i.length>2){const t=[],r=[],s=[];i.forEach((e=>{const i=e[0]>>>1&63;32===i?t.push(e):33===i?r.push(e):34===i&&s.push(e)})),t.length&&r.length&&s.length&&(e=w(t,r,s),i=i.filter((t=>{const e=t[0]>>>1&63;return 32!==e&&33!==e&&34!==e&&35!==e})))}const s=i.reduce(((t,e)=>t+A+1+e.length),0),a=(0,d.sY)(s),c=(0,h.s3)(a,s),f=new o.A(c);return n.__(i,(t=>{3===A?f.writeUint32(t.length):2===A?f.writeUint24(t.length):1===A?f.writeUint16(t.length):f.writeUint8(t.length),f.writeBuffer(t.subarray(0));const e=t[0]>>>1&63;19!==e&&20!==e&&21!==e||(r=!0)})),{bufferPointer:a,length:s,extradata:e,key:r}}function b(t,e){const r=e?3&e[21]:A;let i=[],s=[],c=[],u=!1;if(e){const t=v(e);i=t.vpss,s=t.spss,c=t.ppss,u=!0}const f=[],l=new a.A(t);for(;l.remainingSize()>0;){let t=0;t=3===r?l.readUint32():2===r?l.readUint24():1===r?l.readUint16():l.readUint8(),f.push(l.readBuffer(t))}let p=i.reduce(((t,e)=>t+4+e.length),0);p=s.reduce(((t,e)=>t+4+e.length),p),p=c.reduce(((t,e)=>t+4+e.length),p),p=f.reduce(((t,e,r)=>t+(r?3:4)+e.length),p);const m=(0,d.sY)(p+7),g=(0,h.s3)(m,p+7),w=new o.A(g);return w.writeUint8(0),w.writeUint8(0),w.writeUint8(0),w.writeUint8(1),w.writeUint8(70),w.writeUint8(0),w.writeUint8(240),n.__(i,(t=>{w.writeUint8(0),w.writeUint8(0),w.writeUint8(0),w.writeUint8(1),w.writeBuffer(t)})),n.__(s,(t=>{w.writeUint8(0),w.writeUint8(0),w.writeUint8(0),w.writeUint8(1),w.writeBuffer(t)})),n.__(c,(t=>{w.writeUint8(0),w.writeUint8(0),w.writeUint8(0),w.writeUint8(1),w.writeBuffer(t)})),n.__(f,((t,e)=>{w.writeUint8(0),w.writeUint8(0),e||w.writeUint8(0),w.writeUint8(1),w.writeBuffer(t);const r=t[0]>>>1&63;19!==r&&20!==r&&21!==r||(u=!0)})),{bufferPointer:m,length:p+7,key:u}}function k(t,e){var r;if(!(1&i.f[15](t+36)))return;const s=(0,f.iI)(t);if((0,u.Bs)(s))return;const n=null!==(r=e.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:A;let o=[],c=[],l=[];const p=new a.A(s);for(;p.remainingSize()>0;){let t=0;t=3===n?p.readUint32():2===n?p.readUint24():1===n?p.readUint16():p.readUint8();const e=s.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+t);p.skip(t);const r=e[0]>>>1&63;33===r?c.push(e):34===r?l.push(e):32===r&&o.push(e)}if(c.length||l.length||o.length){const e=w(o,c,l),r=(0,d.sY)(e.length);(0,h.lW)(r,e.length,e),(0,f.Ow)(t,1,r,e.length)}}function _(t,e=!1){if(!(1&i.f[15](t+36)||e))return;const r=(0,f.iI)(t);if(!(0,u.Bs)(r))return;let n=(0,u.py)(r);if(n.length>2){const e=[],r=[],o=[];if(n.forEach((t=>{const i=t[0]>>>1&63;32===i?e.push(t):33===i?r.push(t):34===i&&o.push(t)})),e.length&&r.length&&o.length){const n=w(e,r,o),a=(0,d.sY)(n.length);(0,h.lW)(a,n.length,n),(0,f.Ow)(t,1,a,n.length),s.M[15](t+36,1|i.f[15](t+36))}}}function x(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=3&e[21];const{spss:r}=v(e);if(r.length){const{profile:e,level:i,width:s,height:n}=I(r[0]);t.codecpar.profile=e,t.codecpar.level=i,t.codecpar.width=s,t.codecpar.height=n}}}function I(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);let r=0,i=0,s=0,n=0,o=0,a=0,h=1,f=0,d=0,p=0,m=0;const g=(0,u.BN)(t.subarray(e)),A=new c.A(g.length);A.appendBuffer(g),A.readU1(),A.readU(6),A.readU(6),A.readU(3),A.readU(4);const v=A.readU(3);if(A.readU1(),v<=6){f=A.readU(2),d=A.readU1(),r=A.readU(5),p=A.readU(32),m=A.readU(48),i=A.readU(8);const t=new Array(6),e=new Array(6);for(let r=0;r<v;r++)t[r]=A.readU1(),e[r]=A.readU1();if(v>0)for(let t=v;t<8;t++)A.readU(2);for(let r=0;r<v;r++)t[r]&&(A.readU(2),A.readU(1),A.readU(5),A.readU(32),A.readU(1),A.readU(1),A.readU(1),A.readU(1),A.readU(44)),e[r]&&A.readU(8);l.xb(A),h=l.xb(A),3===h&&A.readU(1),s=l.xb(A),n=l.xb(A);let c=0,u=0,g=0,w=0;A.readU1()&&(c=l.xb(A),u=l.xb(A),g=l.xb(A),w=l.xb(A)),o=l.xb(A),a=l.xb(A);let y=2,b=2;0===h?y=b=0:2===h?(y=2,b=1):3===h&&(y=b=1),s-=y*(1<<o+1)*(c+u),n-=b*(1<<o+1)*(g+w)}return{profile:r,level:i,width:s,height:n,chromaFormatIdc:h,bitDepthLumaMinus8:o,bitDepthChromaMinus8:a,generalProfileSpace:f,generalTierFlag:d,generalProfileCompatibilityFlag:p,constraintFlags:m}}},89088:(t,e,r)=>{"use strict";r.d(e,{Au:()=>v,He:()=>w,XC:()=>y,Y2:()=>m,hG:()=>g,oz:()=>A});var i=r(77231);const s=[44100,48e3,32e3,0],n=[22050,24e3,16e3,0],o=[11025,12e3,8e3,0],a=[0,1152,1152,384],c=[0,576,1152,384],h=[0,576,1152,384],u=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],f=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],d=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],l=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],p=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function m(t,e){switch(t){case 0:return o[e];case 2:return n[e];case 3:return s[e]}return i.N_}function g(t,e){switch(t){case 0:return h[e];case 2:return c[e];case 3:return a[e]}return i.N_}function A(t,e,r){switch(e){case 1:switch(t){case 0:case 2:return p[r];case 3:return d[r]}break;case 2:switch(t){case 0:case 2:return p[r];case 3:return f[r]}case 3:switch(t){case 0:case 2:return l[r];case 3:return u[r]}}return i.N_}function v(t){switch(t){case 1:return 34;case 2:return 33;case 3:return 32}return i.N_}const w={32:"Layer1",33:"Layer2",34:"Layer3"};function y(t,e){if(e&&e.length>=4){const r=e[1]>>>3&3,i=(6&e[1])>>1,s=(12&e[2])>>>2,n=3&~(e[3]>>>6)?2:1,o=v(i),a=m(r,s);t.codecpar.profile=o,t.codecpar.sampleRate=a,t.codecpar.chLayout.nbChannels=n}}},65451:(t,e,r)=>{"use strict";r.d(e,{Ij:()=>h,XC:()=>c,kt:()=>a});var i=r(31865),s=r(729),n=r(44328);const o=[480,960,1920,2880,480,960,1920,2880,480,960,1920,2880,480,960,480,960,120,240,480,960,120,240,480,960,120,240,480,960,120,240,480,960];function a(t){let e=0,r=0,i=0;if(t.length<1)return 0;switch(e=t[0],r=o[e>>3],3&e){case 0:i=1;break;case 1:case 2:i=2;break;case 3:if(t.length<2)return 0;i=63&t[1]}return i*r}function c(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=19){const r=new i.A(e,!1);r.skip(9),t.codecpar.chLayout.nbChannels=r.readUint8(),t.codecpar.initialPadding=r.readUint16(),t.codecpar.sampleRate=r.readUint32(),t.codecpar.seekPreroll=Number((0,n.k)(BigInt(80),{den:1e3,num:1},{den:48e3,num:1}))}}function h(t){const e=new Uint8Array(19),r=new s.A(e,!1);return r.writeString("OpusHead"),r.writeUint8(1),r.writeUint8(t.chLayout.nbChannels),r.writeUint16(t.initialPadding),r.writeUint32(t.sampleRate),e}},14392:(t,e,r)=>{"use strict";r.d(e,{U:()=>n,X:()=>s});var i=r(37246);function s(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){const r=n(e);t.codecpar.profile=r.profile,t.codecpar.level=r.level}}function n(t){const e=new i.A(t.length);return e.appendBuffer(t.subarray(4)),{profile:e.readU(8),level:e.readU(8),bitDepth:e.readU(4),chromaSubsampling:e.readU(3),fullRangeFlag:e.readU1(),colorPrimaries:e.readU(8),colorTrc:e.readU(8),colorSpace:e.readU(8)}}},58919:(t,e,r)=>{"use strict";r.d(e,{Ui:()=>m,XC:()=>p,Yj:()=>g,k9:()=>l,wN:()=>f});var i=r(63939),s=r(9599),n=r(29170),o=r(37246),a=r(77231),c=r(97317),h=r(44328),u=r(729);const f={0:"Profile0",1:"Profile1",2:"Profile2",3:"Profile3"},d=[{level:10,maxResolution:196608,maxFrameRate:30},{level:11,maxResolution:196608,maxFrameRate:60},{level:20,maxResolution:518400,maxFrameRate:30},{level:21,maxResolution:518400,maxFrameRate:60},{level:30,maxResolution:2073600,maxFrameRate:30},{level:31,maxResolution:2073600,maxFrameRate:60},{level:40,maxResolution:3686400,maxFrameRate:30},{level:41,maxResolution:3686400,maxFrameRate:60},{level:50,maxResolution:8294400,maxFrameRate:30},{level:51,maxResolution:8294400,maxFrameRate:60},{level:60,maxResolution:8847360,maxFrameRate:30},{level:61,maxResolution:8847360,maxFrameRate:60},{level:70,maxResolution:35389440,maxFrameRate:30},{level:71,maxResolution:35389440,maxFrameRate:60}];function l(t,e,r){const i=t*e;for(const t of d)if(i<=t.maxResolution&&r<=t.maxFrameRate)return t.level}function p(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){const r=m(e);t.codecpar.profile=r.profile,t.codecpar.level=r.level}}function m(t){const e=new o.A(t.length);return e.appendBuffer(t),{profile:e.readU(8),level:e.readU(8),bitDepth:e.readU(4),chromaSubsampling:e.readU(3),fullRangeFlag:e.readU1(),colorPrimaries:e.readU(8),colorTrc:e.readU(8),colorSpace:e.readU(8)}}function g(t){const e=new u.A(new Uint8Array(8)),r=function(t){let e=i.f[15](t+48),r=i.f[15](t+52);r===a.N_&&(r=l(i.f[15](t+56),i.f[15](t+60),(0,h.lb)((0,n.A)(t+72,s.P))));const o=c.g[i.f[15](t+28)];let u=i.f[15](t+40),f=1;o&&(u=o.comp[0].depth,1===o.log2ChromaW&&1===o.log2ChromaH?1===i.f[15](t+100)&&(f=0):1===o.log2ChromaW&&0===o.log2ChromaH?f=2:0===o.log2ChromaW&&0===o.log2ChromaH&&(f=3));const d=2===i.f[15](t+84)?1:0;return e===a.N_&&u&&(e=0==f||1==f?8==u?0:2:8==u?1:3),{profile:e,level:r,bitDepth:u,chromaSubsampling:f,fullRange:d}}(t);return e.writeUint8(r.profile),e.writeUint8(r.level),e.writeUint8(r.bitDepth<<4|r.chromaSubsampling<<1|r.fullRange),e.writeUint8(i.f[15](t+88)),e.writeUint8(i.f[15](t+92)),e.writeUint8(i.f[15](t+96)),e.writeUint16(0),e.getWroteBuffer()}},55611:(t,e,r)=>{"use strict";r.d(e,{Jk:()=>b,OD:()=>y,Ui:()=>I,XC:()=>_,ci:()=>k,oT:()=>w});var i=r(63939),s=r(50932),n=r(72739),o=r(729),a=r(31865),c=r(37246),h=r(14686),u=r(60264),f=r(71517),d=r(37837),l=r(23991),p=r(83314);const m=3;function g(t){const e=t.readU(9),r=t.readU(3),i=t.readU(2),s=t.readU(2),n=t.readU(3);t.readU(5),t.readU(2);const o=t.readU(6),a=t.readU(7),c=t.readU(1),h=t.readU(8),u=t.readU(1),f=t.readU(1),d=[],l=[];if(o){for(let e=0;e<o-1;e++)d[e]=t.readU(8);d[o-1]=t.readU(6)}else t.readU(6);if(r>1){let e=0;for(let i=r-2;i>=0;--i)e|=t.readU(1)<<i;for(let e=r;e<=8&&r>1;++e)t.readU(1);for(let i=r-2;i>=0;--i)e&1<<i&&(l[i]=t.readU(8))}const p=t.readU(8),m=[];if(p)for(let e=0;e<p;e++)m.push(t.readU(8));return{olsIdx:e,numSublayers:r,bitDepthMinus8:n,chromaFormatIdc:s,constantFrameRate:i,generalProfileIdc:a,generalTierFlag:c,generalLevelIdc:h,ptlFrameOnlyConstraintFlag:u,ptlMultilayerEnabledFlag:f,generalConstraintInfo:d,sublayerLevelIdc:l,generalSubProfileIdc:m,maxPictureWidth:t.readU(16),maxPictureHeight:t.readU(16),avgFramerate:t.readU(16)}}function A(t){const e=new a.A(t,!0);if(1&e.readUint8()){const r=new c.A;r.appendBuffer(t.subarray(1)),g(r),e.skip(r.getPos())}let r=[],i=[],s=[];const n=e.readUint8();for(let t=0;t<n;t++){const t=31&e.readUint8();let n=1;13!==t&&12!==t&&(n=e.readUint16());const o=[];for(let t=0;t<n;t++){const t=e.readUint16();o.push(e.readBuffer(t))}14===t?r=o:15===t?i=o:16===t&&(s=o)}return{vpss:r,spss:i,ppss:s}}function v(t,e,r){const i=e[0];let s;if(i){const t=x(i),e=new p.A;if(e.writeU(9,0),e.writeU(3,t.spsMaxSublayersMinus1+1),e.writeU(2,1),e.writeU(2,t.chromaFormatIdc),e.writeU(3,t.bitDepthMinus8),e.writeU(5,31),e.writeU(2,3),e.writeU(6,t.generalConstraintInfo.length),e.writeU(7,t.profile),e.writeU1(t.tierFlag),e.writeU(8,t.level),e.writeU1(t.ptlFrameOnlyConstraintFlag),e.writeU1(t.ptlMultilayerEnabledFlag),t.generalConstraintInfo.length){for(let r=0;r<t.generalConstraintInfo.length-1;r++)e.writeU(8,t.generalConstraintInfo[r]);e.writeU(6,t.generalConstraintInfo[t.generalConstraintInfo.length-1])}else e.writeU(6,63);if(t.spsMaxSublayersMinus1+1>1){let r=0;for(let e=t.spsMaxSublayersMinus1-1;e>=0;e--)r=r<<1|t.ptlSublayerLevelPresentFlag[e];e.writeU(8,r)}for(let r=t.spsMaxSublayersMinus1-1;r>=0;r--)t.ptlSublayerLevelPresentFlag[r]&&e.writeU(8,t.sublayerLevelIdc[r]);e.writeU(8,t.generalSubProfileIdc.length);for(let r=0;r<t.generalSubProfileIdc.length;r++)e.writeU(32,t.sublayerLevelIdc[r]);e.writeU(16,t.width),e.writeU(16,t.height),e.writeU(16,0),e.padding(),s=e.getBuffer().subarray(0,e.getPointer())}let a=1+(s?s.length:0);t.length&&(a+=3,a=t.reduce(((t,e)=>t+2+e.length),a)),e.length&&(a+=3,a=e.reduce(((t,e)=>t+2+e.length),a)),r.length&&(a+=3,a=r.reduce(((t,e)=>t+2+e.length),a));const c=new Uint8Array(a),h=new o.A(c,!0);h.writeUint8(m<<1|(s?1:0)|248),s&&h.writeBuffer(s);let u=0;return t.length&&u++,e.length&&u++,r.length&&u++,h.writeUint8(u),t.length&&(h.writeUint8(142),h.writeUint16(t.length),n.__(t,(t=>{h.writeUint16(t.length),h.writeBuffer(t)}))),e.length&&(h.writeUint8(143),h.writeUint16(e.length),n.__(e,(t=>{h.writeUint16(t.length),h.writeBuffer(t)}))),r.length&&(h.writeUint8(144),h.writeUint16(r.length),n.__(r,(t=>{h.writeUint16(t.length),h.writeBuffer(t)}))),c}function w(t){let e,r=!1,i=(0,u.py)(t);if(i.length>2){const t=[],r=[],s=[];i.forEach((e=>{const i=e[0]>>>1&63;14===i?t.push(e):15===i?r.push(e):16===i&&s.push(e)})),t.length&&r.length&&s.length&&(e=v(t,r,s),i=i.filter((t=>{const e=t[0]>>>1&63;return 14!==e&&15!==e&&16!==e&&20!==e})))}const s=i.reduce(((t,e)=>t+m+1+e.length),0),a=(0,d.sY)(s),c=(0,h.s3)(a,s),f=new o.A(c);return n.__(i,(t=>{3===m?f.writeUint32(t.length):2===m?f.writeUint24(t.length):1===m?f.writeUint16(t.length):f.writeUint8(t.length),f.writeBuffer(t.subarray(0));const e=t[0]>>>1&63;8!==e&&7!==e&&9!==e&&10!==e||(r=!0)})),{bufferPointer:a,length:s,extradata:e,key:r}}function y(t,e){const r=e?e[0]>>>1&3:m;let i=[],s=[],c=[],u=!1;if(e){const t=A(e);i=t.vpss,s=t.spss,c=t.ppss,u=!0}const f=[],l=new a.A(t);for(;l.remainingSize()>0;){let t=0;t=3===r?l.readUint32():2===r?l.readUint24():1===r?l.readUint16():l.readUint8(),f.push(l.readBuffer(t))}let p=i.reduce(((t,e)=>t+4+e.length),0);p=s.reduce(((t,e)=>t+4+e.length),p),p=c.reduce(((t,e)=>t+4+e.length),p),p=f.reduce(((t,e,r)=>t+(r?3:4)+e.length),p);const g=(0,d.sY)(p+7),v=(0,h.s3)(g,p+7),w=new o.A(v);return w.writeUint8(0),w.writeUint8(0),w.writeUint8(0),w.writeUint8(1),w.writeUint8(0),w.writeUint8(160),w.writeUint8(240),n.__(i,(t=>{w.writeUint8(0),w.writeUint8(0),w.writeUint8(0),w.writeUint8(1),w.writeBuffer(t)})),n.__(s,(t=>{w.writeUint8(0),w.writeUint8(0),w.writeUint8(0),w.writeUint8(1),w.writeBuffer(t)})),n.__(c,(t=>{w.writeUint8(0),w.writeUint8(0),w.writeUint8(0),w.writeUint8(1),w.writeBuffer(t)})),n.__(f,((t,e)=>{w.writeUint8(0),w.writeUint8(0),e||w.writeUint8(0),w.writeUint8(1),w.writeBuffer(t);const r=t[0]>>>1&63;8!==r&&7!==r&&9!==r&&10!==r||(u=!0)})),{bufferPointer:g,length:p+7,key:u}}function b(t,e){var r;if(!(1&i.f[15](t+36)))return;const s=(0,f.iI)(t);if((0,u.Bs)(s))return;const n=null!==(r=e.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:m;let o=[],c=[],l=[];const p=new a.A(s);for(;p.remainingSize()>0;){let t=0;t=3===n?p.readUint32():2===n?p.readUint24():1===n?p.readUint16():p.readUint8();const e=s.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+t);p.skip(t);const r=e[0]>>>1&63;15===r?c.push(e):16===r?l.push(e):14===r&&o.push(e)}if(c.length||l.length||o.length){const e=v(o,c,l),r=(0,d.sY)(e.length);(0,h.lW)(r,e.length,e),(0,f.Ow)(t,1,r,e.length)}}function k(t,e=!1){if(!(1&i.f[15](t+36)||e))return;const r=(0,f.iI)(t);if(!(0,u.Bs)(r))return;let n=(0,u.py)(r);if(n.length>2){const e=[],r=[],o=[];if(n.forEach((t=>{const i=t[0]>>>1&63;14===i?e.push(t):15===i?r.push(t):16===i&&o.push(t)})),e.length&&r.length&&o.length){const n=v(e,r,o),a=(0,d.sY)(n.length);(0,h.lW)(a,n.length,n),(0,f.Ow)(t,1,a,n.length),s.M[15](t+36,1|i.f[15](t+36))}}}function _(t,e){if(!e&&t.sideData[1]&&(e=t.sideData[1]),e&&e.length>=6){t.metadata.naluLengthSizeMinusOne=e[0]>>>1&3;const{spss:r}=A(e);if(r.length){const{profile:e,level:i,width:s,height:n}=x(r[0]);t.codecpar.profile=e,t.codecpar.level=i,t.codecpar.width=s,t.codecpar.height=n}}}function x(t){if(!t||t.length<3)return;let e=0;0===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&(e=4);let r=0,i=0,s=0,n=0,o=0,a=1,h=0,f=0,d=0;const p=[],m=[],g=[],A=[],v=(0,u.BN)(t.subarray(e)),w=new c.A(v.length);w.appendBuffer(v),w.readU1(),w.readU1(),w.readU(6),w.readU(5),w.readU(3),w.readU(8);const y=w.readU(3);a=w.readU(2);const b=w.readU(2);if(w.readU(1)){if(r=w.readU(7),h=w.readU(1),i=w.readU(8),f=w.readU(1),d=w.readU(1),w.readU(1)){for(let t=0;t<8;t++)p[t]=w.readU(8);p[8]=w.readU(7);const t=w.readU(8);w.readU(t)}w.skipPadding();for(let t=y-1;t>=0;t--)m[t]=w.readU(1);w.skipPadding();for(let t=y-1;t>=0;t--)m[t]&&(g[t]=w.readU(8));const t=w.readU(8);if(t)for(let e=0;e<t;e++)A[e]=w.readU(32)}w.readU1(),w.readU1()&&w.readU1();const k=s=l.xb(w),_=n=l.xb(w);if(w.readU1()&&(l.xb(w),l.xb(w),l.xb(w),l.xb(w)),w.readU1()){const t=l.xb(w),e=b+5,r=1<<e,i=k/(1<<e),s=_/(1<<e),n=Math.ceil(Math.log2(i)),o=Math.ceil(Math.log2(s));let a=0,c=0,h=0;t>0&&(h=w.readU1(),c=w.readU1());for(let e=0;t>0&&e<=t;e++)c&&0!=e||(e>0&&k>r&&w.readU(n),e>0&&_>r&&w.readU(o),e<t&&k>r&&w.readU(n),e<t&&_>r&&w.readU(o)),h||w.readU(2);if(a=l.xb(w)+1,w.readU(1)&&w.readU(1))for(let e=0;e<=t;e++)w.readU(a)}return o=l.xb(w),{profile:r,level:i,width:s,height:n,chromaFormatIdc:a,bitDepthMinus8:o,generalProfileSpace:0,tierFlag:h,generalConstraintInfo:p,generalSubProfileIdc:A,ptlFrameOnlyConstraintFlag:f,ptlMultilayerEnabledFlag:d,spsMaxSublayersMinus1:y,ptlSublayerLevelPresentFlag:m,sublayerLevelIdc:g}}function I(t){const e=new c.A;return e.appendBuffer(t),1&e.readU(8)?g(e):{}}},16160:(t,e,r)=>{"use strict";r.d(e,{V:()=>s,v:()=>i});const i=256e3,s=BigInt(5e3)},75:(t,e,r)=>{"use strict";r.d(e,{Cj:()=>I,Ib:()=>k,ho:()=>b,jF:()=>M});var i=r(61499),s=r(63939),n=r(9599),o=r(29170),a=r(95335),c=r(72739),h=r(77231),u=r(31425),f=r(44328),d=r(71517),l=r(16160),p=r(9705),m=r(4624),g=r(40417),A=r(75742),v=r(56024),w="src/avformat/demux.ts";const y={fastOpen:!1,maxAnalyzeDuration:1e3};async function b(t,e={}){const r=a.X$({},y,e);return t.ioReader||m.h2("need IOReader",w,65),t.iformat||m.h2("need iformat",w,68),2===t.iformat.type&&(r.maxAnalyzeDuration=Math.max(r.maxAnalyzeDuration,2e3)),t.iformat.init(t),t.options=r,t.iformat.readHeader(t)}async function k(t){const e=t.iformat.getAnalyzeStreamsCount(),r={},p={},m={};let w=0;const y=[];let b=0;const k={},_={};function x(){if(!t.getDecoderResource)return!0;for(let e=0;e<t.streams.length;e++)if(k[t.streams[e].index]&&!_[t.streams[e].index])return!1;return!0}for(;!(t.streams.length>=e&&(0,u.$)(t)&&t.options.fastOpen&&x());){w||(w=(0,d._5)());let e=!1;if(b=await I(t,w),0!==b)break;const c=t.getStreamByIndex(s.f[15](w+32));if(s.f[15](w+28)&&(e=!0,y.push(w),r[c.index]||(c.firstDTS=s.f[17](w+16),c.startTime=s.f[17](w+8),r[c.index]=!0),s.f[17](w+8)<c.startTime&&(c.startTime=s.f[17](w+8)),p[c.index]?p[c.index].push(s.f[17](w+16)):p[c.index]=[s.f[17](w+16)],m[c.index]?m[c.index]+=s.f[15](w+28):m[c.index]=s.f[15](w+28),!_[c.index]&&t.getDecoderResource)){let e=k[c.index];if(!e){const r=await t.getDecoderResource(c.codecpar.codecType,c.codecpar.codecId);r&&(1===c.codecpar.codecType?e=new A.A({resource:r,onReceiveFrame:t=>{c.codecpar.format=s.f[15](t+80),(0,v.xj)(t),_[c.index]=!0},onError:()=>{_[c.index]=!0}}):0===c.codecpar.codecType&&(r.threadModule&&delete r.threadModule,e=new g.A({resource:r,onReceiveFrame:t=>{c.codecpar.format=s.f[15](t+80),c.codecpar.colorSpace=s.f[15](t+220),c.codecpar.colorPrimaries=s.f[15](t+212),c.codecpar.colorTrc=s.f[15](t+216),c.codecpar.chromaLocation=s.f[15](t+224),c.codecpar.sampleAspectRatio=(0,o.A)(t+92,n.P),(0,v.xj)(t),_[c.index]=!0},onError:()=>{_[c.index]=!0}})),await e.open(c.codecpar[i.o9]),k[c.index]=e)}e&&e.decode(w)}if(p[c.index]&&12===p[c.index].length){let t=BigInt(0);for(let e=1;e<p[c.index].length;e++)t+=p[c.index][e]-p[c.index][e-1];let e=Number(t)/(p[c.index].length-1);if(1===c.codecpar.codecType&&c.codecpar.sampleRate>0)c.codecpar.frameSize=Math.round(e/c.timeBase.den*c.timeBase.num*c.codecpar.sampleRate);else if(0===c.codecpar.codecType){const t=c.timeBase.den*c.timeBase.num/e;c.codecpar.framerate.num=Math.round(t),c.codecpar.framerate.den=1}const r=Number(s.f[17](w+16)-c.firstDTS)*c.timeBase.num/c.timeBase.den;r&&(c.codecpar.bitRate=BigInt(Math.floor(8*m[c.index]/r)))}if(s.f[17](w+16)-c.startTime>(0,f.k)(BigInt(Math.floor(t.options.maxAnalyzeDuration)),h.i0,c.timeBase)){a.__(p,((e,r)=>{const i=t.getStreamById(+r);if(e&&e.length>1){let t=BigInt(0);for(let r=1;r<e.length;r++)t+=e[r]-e[r-1];let r=Number(t)/(p[i.index].length-1);if(1===i.codecpar.codecType&&i.codecpar.sampleRate>0)i.codecpar.frameSize=Math.round(r/i.timeBase.den*i.timeBase.num*i.codecpar.sampleRate);else if(0===i.codecpar.codecType){const t=i.timeBase.den*i.timeBase.num/r;i.codecpar.framerate.num=Math.round(t),i.codecpar.framerate.den=1}const n=Number(s.f[17](w+16)-i.firstDTS)*i.timeBase.num/i.timeBase.den;n&&(i.codecpar.bitRate=BigInt(Math.floor(8*m[i.index]/n)))}})),e&&(w=0);break}e&&(w=0)}return w&&(0,d.Qe)(w),y.length&&(t.interval.packetBuffer=y.concat(t.interval.packetBuffer)),a.__(k,(t=>{t&&t.close()})),-1048576===b?0:0!==b?b:(2===t.iformat.type&&1&t.ioReader.flags&&await async function(t){const e=await t.ioReader.fileSize();if(e<=BigInt(0))return;const r=t.interval.packetBuffer;t.interval.packetBuffer=[];let i=t.ioReader.getPos(),n=0;for(;n<4;){const r=e-BigInt(Math.floor(l.v<<n)),o=await t.iformat.seek(t,null,r,2);o>BigInt(0)&&(i=o);const a={},u=(0,d._5)();for(;!(await I(t,u)<0);){let e=s.f[17](u+8);const r=t.getStreamByIndex(s.f[15](u+32));r.startTime!==h.Dh?e-=r.startTime:e-=r.firstDTS,e>BigInt(0)&&((r.duration===h.Dh||!a[s.f[15](u+32)]||r.duration<e&&Math.abs(Number(e-r.duration))<60*r.timeBase.den/r.timeBase.num)&&(r.duration=e),a[u.streamIndex]=e)}(0,d.Qe)(u);let f=!0;if(c.__(t.streams,(t=>{if(t.duration===h.Dh)return f=!1,!1})),f)break;n++}c.__(t.interval.packetBuffer,(t=>{(0,d.Qe)(t)})),t.interval.packetBuffer=r,await t.iformat.seek(t,null,i,2)}(t),0)}function _(t,e){const r=c.El(t.sampleIndexes,(t=>t.pts<s.f[17](e+8)?1:-1)),i={dts:s.f[17](e+16),pts:s.f[17](e+8),pos:s.f[17](e+56),size:s.f[15](e+28),duration:s.f[17](e+48),flags:s.f[15](e+36)};r>-1?(t.sampleIndexesPosMap.set(s.f[17](e+56),r),t.sampleIndexes.splice(r,0,i)):(t.sampleIndexesPosMap.set(s.f[17](e+56),t.sampleIndexes.length),t.sampleIndexes.push(i))}async function x(t,e){const r=t.getStreamById(s.f[15](e+32));let i=0;if(r&&(27===r.codecpar.codecId||173===r.codecpar.codecId||196===r.codecpar.codecId||86018===r.codecpar.codecId))if(!s.f[15](e+28)&&(0,d.fQ)(e,1))for(;;){const r=(0,d._5)();if(i=await t.iformat.readAVPacket(t,r),0!==i){if(t.interval.packetBuffer.length){let r=t.interval.packetBuffer.shift();return(0,d.Up)(e),(0,d.rN)(e,r),(0,d.Qe)(r),x(t,e)}return i}if(s.f[15](r+32)!==s.f[15](e+32))t.interval.packetBuffer.push(r);else{if(s.f[15](r+28))return(0,d.Zx)(e,r),(0,d.Qe)(r),0;(0,d.Up)(e),(0,d.rN)(e,r),(0,d.Qe)(r)}}else if(32&s.f[15](e+36))return I(t,e);if(1&t.ioReader.flags&&!r.sampleIndexesPosMap.has(s.f[17](e+56)))if(0===r.codecpar.codecType)1&s.f[15](e+36)&&_(r,e);else if(1===r.codecpar.codecType){const t=c.El(r.sampleIndexes,(t=>t.pts<s.f[17](e+8)?1:-1));(!r.sampleIndexes.length||t<0&&(0,f.k)(s.f[17](e+8)-r.sampleIndexes[r.sampleIndexes.length-1].pts,(0,o.A)(e+72,n.P),h.i0)>=l.V||t>0&&t<r.sampleIndexes.length-1&&(0,f.k)(s.f[17](e+8)-r.sampleIndexes[t-1].pts,(0,o.A)(e+72,n.P),h.i0)>=l.V||0===t&&(0,f.k)(r.sampleIndexes[0].pts-s.f[17](e+8),(0,o.A)(e+72,n.P),h.i0)>=l.V)&&_(r,e)}return 0}async function I(t,e){let r=0;if((0,d.Up)(e),t.interval.packetBuffer.length){const r=t.interval.packetBuffer.shift();return(0,d.rN)(e,r),(0,d.Qe)(r),x(t,e)}return r=await t.iformat.readAVPacket(t,e),0!==r?((0,d.Up)(e),r):x(t,e)}async function M(t,e,r,i){let s=t.streams[e];if(s||(s=t.getStreamByMediaType(0),s||(s=t.getStreamByMediaType(1))),!s)return m.z3(`not found any stream to seek, streamIndex: ${s.index}`,w,539),BigInt(p.LR);m.Yz(`seek in ${0===s.codecpar.codecType?"video":"audio"} stream, streamIndex: ${s.index}, timestamp: ${r}, flags: ${i}`,w,543),r=(0,f.k)(r,h.i0,s.timeBase);const n=await t.iformat.seek(t,s,r,i);return n>=BigInt(0)?(c.__(t.interval.packetBuffer,(t=>{(0,d.Qe)(t)})),t.interval.packetBuffer.length=0,BigInt(0)):n}},548:(t,e,r)=>{"use strict";r.d(e,{Ay:()=>B,L_:()=>P,eG:()=>M,iV:()=>_});var i=r(69736),s=r.n(i),n=r(61499),o=r(63939),a=r(9599),c=r(29170),h=r(44315),u=r(95335),f=r(62751),d=r(67672),l=r(44328),p=r(77231),m=r(20525),g=r(62100),A=r(58469),v=r(20620),w=r(53e3),y=r(90412),b=r(58919),k=r(89088);function _(t){const e=0|Number(t%BigInt(1e3)&0xffffffffn),r=0|Number(t/BigInt(1e3)%BigInt(60)&0xffffffffn),i=0|Number(t/BigInt(1e3)/BigInt(60)%BigInt(60)&0xffffffffn),s=0|Number(t/BigInt(1e3)/BigInt(3600)&0xffffffffn);return m.GP("%02d:%02d:%02d.%03d",s,i,r,e)}function x(t){return t<BigInt(1e4)?(0,g.A)(0|Number(0xffffffffn&t))+" bps/s":(0|Number(t/BigInt(1e3)&0xffffffffn))+" kbps/s"}function I(t,e,r="unknown"){let i=r;return u.__(t,((t,r)=>{if(e===t)return i=r,!1})),i}function M(t,e){return 1===t?I(f.n1,e):0===t?I(f._R,e):"unknown"}function P(t){return I(f.iW,t)}function C(t,e){switch(t){case 86018:return A.uF[e]||"LC";case 86017:return k.He[e]||"Layer3";case 27:return v.tZ[e]||"High";case 173:return w.dT[e]||"Main";case 225:return y.zk[e]||"Main";case 167:return b.wN[e]||"Profile0"}}function B(t,e){let r="";return t.forEach(((t,i)=>{if(t instanceof h.oD){const e=[];for(let r=0;r<t.streams.length;r++){const i=t.streams[r];e.push({index:i.index,id:i.id,codecpar:i.codecpar[n.o9],nbFrames:i.nbFrames,metadata:i.metadata,duration:i.duration,startTime:i.startTime,disposition:i.disposition,timeBase:i.timeBase[n.o9]})}t={metadata:t.metadata,format:t.format,streams:e}}r+=function(t,e,r){let i=`${r.tag} #${e}, ${I(f.iW,t.format)}, from '${r.from}:'\n`;s()(t.metadata).length&&(i+="  Metadata:\n",u.__(t.metadata,((t,e)=>{d.Ik(t)&&d.YO(t)||(i+=`    ${e}: ${t}\n`)})));let n=BigInt(0),h=BigInt(0),m=-BigInt(1);return t.streams.forEach((t=>{const e=(0,l.k)(t.duration,(0,c.A)(t.timeBase,a.P),p.i0),r=(0,l.k)(t.startTime,(0,c.A)(t.timeBase,a.P),p.i0);e>n&&(n=e),(r<m||m===-BigInt(1))&&(m=r),h+=o.f[17](t.codecpar+32)})),i+=`  Duration: ${_(n)}, start: ${_(m)}, bitrate: ${x(h)}\n`,t.streams.forEach(((t,r)=>{i+=function(t,e,r){const i=I(f.Mb,o.f[15](t.codecpar)),n=[];if(1===o.f[15](t.codecpar)){const e=C(o.f[15](t.codecpar+4),o.f[15](t.codecpar+48)),r=I(f.n1,o.f[15](t.codecpar+4));n.push(`${r}${e?` (${e})`:""}`),n.push(`${o.f[15](t.codecpar+136)} Hz`);let i=`${o.f[15](t.codecpar+116)} channels`;1===o.f[15](t.codecpar+116)?i="mono":2===o.f[15](t.codecpar+116)&&(i="stereo"),n.push(i),n.push(I(f.Sz,o.f[15](t.codecpar+28))),o.f[17](t.codecpar+32)>BigInt(0)&&n.push(`${x(o.f[17](t.codecpar+32))}`)}else if(0===o.f[15](t.codecpar)){const e=C(o.f[15](t.codecpar+4),o.f[15](t.codecpar+48)),r=I(f._R,o.f[15](t.codecpar+4));if(n.push(`${r}${e?` (${e})`:""}`),o.f[15](t.codecpar+28)!==p.N_){const e=I(f.qO,o.f[15](t.codecpar+28)),r=I(f.mX,o.f[15](t.codecpar+84),"tv"),i=I(f._m,o.f[15](t.codecpar+96),"bt709");n.push(`${e}(${r}, ${i})`)}const i={num:o.f[15](t.codecpar+56)*o.f[15](t.codecpar+64),den:o.f[15](t.codecpar+60)*o.f[15](t.codecpar+68)};if((0,l.iU)(i),n.push(`${o.f[15](t.codecpar+56)}x${o.f[15](t.codecpar+60)} [SAR: ${o.f[15](t.codecpar+64)}:${o.f[15](t.codecpar+68)} DAR ${i.num}:${i.den}]`),o.f[17](t.codecpar+32)>BigInt(0)&&n.push(`${x(o.f[17](t.codecpar+32))}`),(0,l.lb)((0,c.A)(t.codecpar+72,a.P))>0&&(n.push(`${(0,l.lb)((0,c.A)(t.codecpar+72,a.P)).toFixed(2)} fps`),n.push(`${(0,l.lb)((0,c.A)(t.codecpar+72,a.P)).toFixed(2)} tbr`)),n.push(`${h=BigInt(Math.floor((0,l.lb)({num:o.f[15](t.timeBase+4),den:o.f[15](t.timeBase)}))),h<BigInt(1e4)?(0,g.A)(0|Number(0xffffffffn&h)):(0|Number(h/BigInt(1e3)&0xffffffffn))+"k"} tbn`),t.disposition){let e="";1&t.disposition&&(e+=`(${I(f.Ki,1)}) `),2&t.disposition&&(e+=`(${I(f.Ki,2)}) `),4&t.disposition&&(e+=`(${I(f.Ki,4)}) `),8&t.disposition&&(e+=`(${I(f.Ki,8)}) `),16&t.disposition&&(e+=`(${I(f.Ki,16)}) `),32&t.disposition&&(e+=`(${I(f.Ki,32)}) `),64&t.disposition&&(e+=`(${I(f.Ki,64)}) `),128&t.disposition&&(e+=`(${I(f.Ki,128)}) `),256&t.disposition&&(e+=`(${I(f.Ki,256)}) `),512&t.disposition&&(e+=`(${I(f.Ki,512)}) `),1024&t.disposition&&(e+=`(${I(f.Ki,1024)}) `),2048&t.disposition&&(e+=`(${I(f.Ki,2048)}) `),65536&t.disposition&&(e+=`(${I(f.Ki,65536)}) `),131072&t.disposition&&(e+=`(${I(f.Ki,131072)}) `),262144&t.disposition&&(e+=`(${I(f.Ki,262144)}) `),524288&t.disposition&&(e+=`(${I(f.Ki,524288)}) `),1048576&t.disposition&&(e+=`(${I(f.Ki,1048576)}) `),e&&n.push(e)}}else o.f[17](t.codecpar+32)>BigInt(0)&&n.push(`${x(o.f[17](t.codecpar+32))}`);var h;let m=`${r}Stream #${e}:${t.index} ${i}: ${n.join(", ")}\n`;return s()(t.metadata).length&&(m+=`${r}  Metadata:\n`,u.__(t.metadata,((t,e)=>{d.Ik(t)&&d.YO(t)||(m+=`${r}    ${e}: ${t}\n`)}))),m}(t,e,"  ")})),i}(t,i,e[i])})),r}},51597:(t,e,r)=>{"use strict";r.d(e,{A:()=>s,E:()=>n});var i=r(134);class s{constructor(){(0,i.A)(this,"type",-1)}destroy(t){}}const n={9:[86018],7:[86017,86019,86018,12,27],11:[86028],0:[86017,86018,86051,69645,86049,65543,65542,12,27,173,225,167,196],4:[139,167],5:[86021,86076,86018,86017,86028,86032,86020,86056,65557,65537,65536,139,167,225,27,173,196,12,94226],6:[86021,86076,139,167,225,94226],1:[86021,86076,86018,86017,86028,86051,86019,167,225,27,173,196,12,94226,94213],8:[86017],2:[86076,86018,86017,86019,,86020,86065,86056,12,225,27,173,196],3:[86021],10:[],12:[94226]}},31425:(t,e,r)=>{"use strict";r.d(e,{$:()=>o});var i=r(77231),s=r(72739),n=r(44328);function o(t){let e=!0;return s.__(t.streams,(t=>{switch(t.codecpar.codecType){case 1:t.codecpar.chLayout.nbChannels!==i.N_&&t.codecpar.sampleRate!==i.N_&&t.codecpar.frameSize!==i.N_&&t.codecpar.bitRate!==BigInt(0)||(e=!1);break;case 0:0!==(0,n.lb)(t.codecpar.framerate)&&t.codecpar.width!==i.N_&&t.codecpar.height!==i.N_&&t.codecpar.bitRate!==BigInt(0)||(e=!1),27!==t.codecpar.codecId&&173!==t.codecpar.codecId&&196!==t.codecpar.codecId&&12!==t.codecpar.codecId||t.codecpar.profile!==i.N_&&t.codecpar.level!==i.N_||(e=!1)}})),e}},92174:(t,e,r)=>{"use strict";r.d(e,{XA:()=>A,bX:()=>w,bx:()=>g,dJ:()=>v,ho:()=>m});var i=r(80662),s=r.n(i),n=r(63939),o=r(50932),a=r(95335),c=r(4624),h=r(51597),u=r(72739),f=r(9705),d=r(548),l="src/avformat/mux.ts";const p={paddingZero:!1};function m(t,e={}){const r=a.X$({},p,e);t.ioWriter||c.h2("need ioWriter",l,52),t.oformat||c.h2("need oformat",l,55),t.options=r,t.processPrivateData={first:new(s())};let i=h.E[t.oformat.type];if(i)for(let e=0;e<t.streams.length;e++){const r=t.streams[e].codecpar.codecId;if(10===t.oformat.type){if(r<65536||r>69683)return c.z3(`format ${(0,d.L_)(t.oformat.type)} not support codecId ${(0,d.eG)(t.streams[e].codecpar.codecType,r)}`,l,71),f.r8}else if(!u.zy(i,r))return c.z3(`format ${(0,d.L_)(t.oformat.type)} not support codecId ${(0,d.eG)(t.streams[e].codecpar.codecType,r)}`,l,76),f.r8}return t.oformat.init(t)}function g(t){return t.oformat.writeHeader(t),0}function A(t,e){const r=t.processPrivateData;return r.first.has(n.f[15](e+32))||(n.f[17](e+16)>BigInt(0)?r.first.set(n.f[15](e+32),n.f[17](e+16)):r.first.set(n.f[15](e+32),BigInt(0))),t.options.paddingZero&&(o.M[17](e+16,n.f[17](e+16)-r.first.get(n.f[15](e+32))),o.M[17](e+8,n.f[17](e+8)-r.first.get(n.f[15](e+32)))),t.oformat.writeAVPacket(t,e)}function v(t){return t.oformat.writeTrailer(t),0}function w(t){t.oformat.flush(t)}},77580:(t,e,r)=>{"use strict";r.d(e,{A:()=>f});var i=r(134),s=r(29967),n=r.n(s),o=r(13724),a=r(82800),c=r(95335),h=r(4624),u="src/avnetwork/ioLoader/FetchIOLoader.ts";class f extends a.A{constructor(t={}){super(t),(0,i.A)(this,"contentLength",void 0),(0,i.A)(this,"receivedLength",void 0),(0,i.A)(this,"info",void 0),(0,i.A)(this,"range",void 0),(0,i.A)(this,"startBytes",void 0),(0,i.A)(this,"endBytes",void 0),(0,i.A)(this,"eofIndex",void 0),(0,i.A)(this,"abortController",void 0),(0,i.A)(this,"reader",void 0),(0,i.A)(this,"buffers",void 0)}async open(t,e){var r;if(this.info=t,this.range=e,this.range.to||(this.range.to=-1),this.range.from=Math.max(this.range.from,0),this.eofIndex<0&&(this.eofIndex=e.to),this.startBytes=0,this.endBytes=-1,this.receivedLength=0,this.buffers=[],this.range&&!this.options.isLive&&(this.startBytes=null!==(r=this.range.from)&&void 0!==r?r:0),this.status=1,!this.options.isLive&&!this.options.disableSegment){const t={method:"HEAD",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};this.info.headers&&c.__(this.info.headers,((e,r)=>{t.headers[r]=e})),this.info.withCredentials&&(t.credentials="include"),this.info.referrerPolicy&&(t.referrerPolicy=this.info.referrerPolicy),AbortController&&(this.abortController=new AbortController,t.signal=this.abortController.signal);try{const e=await fetch(this.info.url,t);if(e.ok&&e.status>=200&&e.status<=299){const t=e.headers.get("X-Content-Length")||e.headers.get("Content-Length");null!=t&&(this.contentLength=n()(t),this.range.to<0&&(this.eofIndex=this.contentLength+this.range.to)),this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex),this.status=2}else this.endBytes=-1}catch(t){this.endBytes=-1}}}async openReader(){const t={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};this.info.headers&&c.__(this.info.headers,((e,r)=>{t.headers[r]=e})),this.options.isLive||this.options.disableSegment||(t.headers.range=`bytes=${this.startBytes}-${this.endBytes>0?this.endBytes:""}`),this.info.withCredentials&&(t.credentials="include"),this.info.referrerPolicy&&(t.referrerPolicy=this.info.referrerPolicy),this.abortController&&this.abortController.abort(),"function"==typeof AbortController&&(this.abortController=new AbortController,t.signal=this.abortController.signal);try{const e=await fetch(this.info.url,t);e.ok&&e.status>=200&&e.status<=299?this.reader=e.body.getReader():(this.status=3,h.h2(`FetchStreamLoader: Http code invalid, ${e.status} ${e.statusText}`,u,189))}catch(t){if(this.retryCount<this.options.retryCount&&(!this.options.isLive||!this.receivedLength))return this.retryCount++,this.status=1,await new o.A(this.options.retryInterval),this.openReader();h.h2(`FetchStreamLoader: exception ${t.message}`,u,202)}}async readInterval(t,e=0){let r=0;for(;this.buffers.length&&r<t.length;){const e=this.buffers.shift();e.length>t.length-r?(t.set(e.subarray(0,t.length-r),r),this.buffers.unshift(e.subarray(t.length-r)),r=t.length):(t.set(e,r),r+=e.length)}if(r>=t.length)return t.length+e;if(4===this.status)return r>0?r+e:e>0?e:-1048576;this.reader||await this.openReader();const{value:i,done:s}=await this.reader.read();return s?null!==this.contentLength&&this.receivedLength+this.range.from<this.endBytes+1?(this.status=3,void h.h2("Fetch stream meet Early-EOF",u,241)):this.options.isLive||this.options.disableSegment||this.receivedLength+this.range.from>=this.eofIndex?(this.status=4,this.startBytes=0,r>0?r+e:e>0?e:-1048576):(await this.reader.cancel(),this.abortController&&this.abortController.abort(),this.reader=null,this.startBytes=this.endBytes+1,this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex),this.readInterval(t.subarray(r),r)):(this.receivedLength+=i.length,i.length>t.length-r?(t.set(i.subarray(0,t.length-r),r),this.buffers.push(i.subarray(t.length-r)),t.length+e):(t.set(i,r),r+=i.length,r+e))}async read(t){return this.readInterval(t)}async seek(t){await this.abort(),this.receivedLength=Number(t)-this.range.from,this.startBytes=Number(t),this.options.disableSegment||(this.endBytes=Math.min(this.startBytes+this.options.preload,this.eofIndex)),this.buffers.length=0,4===this.status&&(this.status=2)}async size(){return this.options.isLive?BigInt(0):BigInt(Math.floor(this.contentLength))}async abort(){this.reader&&(await this.reader.cancel(),this.abortController&&this.abortController.abort(),this.reader=null)}async stop(){await this.abort(),this.status=0}}},79686:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(54001),n=r.n(s),o=r(82800),a=r(67672);class c extends o.A{constructor(...t){super(...t),(0,i.A)(this,"info",void 0),(0,i.A)(this,"range",void 0),(0,i.A)(this,"readPos",void 0),(0,i.A)(this,"endPos",void 0),(0,i.A)(this,"reader",void 0),(0,i.A)(this,"readerResolve",void 0)}async open(t,e){this.info=t,this.range=e,this.readPos=0,this.endPos=this.info.file.size,e.from>0&&(this.readPos=e.from),e.to>0&&(this.endPos=e.to),this.status=2}async readBufferByReader(t){this.reader||(this.reader=new FileReader,this.reader.onloadend=t=>{this.readerResolve&&this.readerResolve(t.target.result)});const e=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;return new(n())((r=>{this.readerResolve=r,this.reader.readAsArrayBuffer(e.call(this.info.file,this.readPos,this.readPos+t))}))}async read(t){if(this.readPos>=this.endPos)return this.status,-1048576;const e=Math.min(t.length,this.endPos-this.readPos);return a.Pc(Blob.prototype.arrayBuffer)?t.set(new Uint8Array(await this.info.file.slice(this.readPos,this.readPos+e).arrayBuffer()),0):t.set(new Uint8Array(await this.readBufferByReader(e)),0),this.readPos+=e,this.readPos>=this.endPos&&(this.status=4),e}async seek(t){return await this.abort(),this.readPos=Number(t),4===this.status&&(this.status=2),0}async size(){return BigInt(Math.floor(this.info.file.size))}async abort(){}async stop(){await this.abort(),this.status=0}}},82800:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(95335);const n={isLive:!0,preload:5242880,retryCount:20,retryInterval:1};class o{constructor(t={}){(0,i.A)(this,"options",void 0),(0,i.A)(this,"status",void 0),(0,i.A)(this,"retryCount",void 0),(0,i.A)(this,"retryTimeout",void 0),this.options=t,this.status=0,this.retryCount=0,this.options=s.X$({},n),s.X$(this.options,t)}}},18667:(t,e,r)=>{"use strict";r.d(e,{A:()=>x});var i=r(54001),s=r.n(i),n=r(63939),o=r(50932),a=r(12264),c=r(29170),h=r(9599),u=r(44527),f=r(9705),d=r(84149),l=r(75742),p=r(4624),m=r(16041),g=r(77104),A=r(84290),v=r(72739),w=r(86932),y=r(36204),b=r(44328),k=r(77231),_="src/avpipeline/AudioDecodePipeline.ts";class x extends u.A{constructor(){super()}createWebcodecDecoder(t){return new g.A({onError:e=>{p.z3(`audio decode error, taskId: ${t.taskId}, error: ${e}`,_,83),t.openReject&&(t.openReject(f.r8),t.openReject=null)},onReceiveFrame(e){const r=(0,y.t)(e,t.avframePool.alloc());o.M[17](r+104,(0,b.k)(n.f[17](r+104),k.KR,t.timeBase)),t.frameCaches.push(r),o.M[17](t.stats+56,n.f[17](t.stats+56)+BigInt(1)),t.lastDecodeTimestamp&&o.M[15](t.stats+240,Math.max((0,w.A)()-t.lastDecodeTimestamp,n.f[15](t.stats+240))),t.lastDecodeTimestamp=(0,w.A)(),e.close()}})}createTask(t){const e=new d.Ay(t.leftPort),r=new d.Ay(t.rightPort),i=[],s=new m.A((0,c.A)(t.avframeList,a.A),t.avframeListMutex),u={...t,frameCaches:i,inputEnd:!1,decoder:null,parameters:0,lastDecodeTimestamp:0,avframePool:s,avpacketPool:new A.A((0,c.A)(t.avpacketList,a.A),t.avpacketListMutex)};return t.resource?u.decoder=new l.A({resource:t.resource,onError:e=>{p.z3(`audio decode error, taskId: ${t.taskId}, error: ${e}`,_,135);const r=this.tasks.get(t.taskId);r.openReject&&(r.openReject(f.r8),r.openReject=null)},onReceiveFrame(t){i.push(t),o.M[17](u.stats+56,n.f[17](u.stats+56)+BigInt(1)),u.lastDecodeTimestamp&&o.M[15](u.stats+240,Math.max((0,w.A)()-u.lastDecodeTimestamp,n.f[15](u.stats+240))),u.lastDecodeTimestamp=(0,w.A)()},avframePool:s}):u.decoder=this.createWebcodecDecoder(u),this.tasks.set(t.taskId,u),r.on(d.S3,(async s=>{switch(s.method){case"pull":if(i.length){const t=i.shift();r.reply(s,t);break}if(!u.inputEnd){for(;;){if(i.length){const t=i.shift();r.reply(s,t);break}const a=await e.request("pull");if(-1048576===a){if(await u.decoder.flush(),u.inputEnd=!0,i.length){const t=i.shift();r.reply(s,t);break}p.pq(`audio decoder ended, taskId: ${u.taskId}`,_,189),r.reply(s,-1048576);break}if(!(a>0)){p.z3(`audio decode pull avpacket error, taskId: ${t.taskId}, ret: ${a}`,_,209),r.reply(s,a);break}{const e=u.decoder.decode(a,(0,b.k)(n.f[17](a+8),(0,c.A)(a+72,h.P),k.KR));if(u.avpacketPool.release(a),e<0){o.M[15](u.stats+48,n.f[15](u.stats+48)+1),p.z3(`audio decode error, taskId: ${t.taskId}, ret: ${e}`,_,202),r.reply(s,e);break}}}break}r.reply(s,-1048576)}})),0}async open(t,e){const r=this.tasks.get(t);if(r)return new(s())((async(t,i)=>{r.openReject=t;try{await r.decoder.open(e),r.parameters=e}catch(e){return p.z3(`open audio decoder failed, error: ${e}`,_,235),void t(f.r8)}t(0)}));p.h2("task not found",_,242)}async resetTask(t){const e=this.tasks.get(t);e&&(e.decoder&&await e.decoder.flush(),v.__(e.frameCaches,(t=>{e.avframePool.release(t)})),e.frameCaches.length=0,e.inputEnd=!1,e.lastDecodeTimestamp=(0,w.A)(),p.pq(`reset audio decoder, taskId: ${e.taskId}`,_,258))}async registerTask(t){return this.tasks.has(t.taskId)?f.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.rightPort.close(),e.leftPort.close(),e.decoder.close(),e.frameCaches.forEach((t=>{e.avframePool.release(t)})),this.tasks.delete(t))}}},68175:(t,e,r)=>{"use strict";r.d(e,{A:()=>b});var i=r(54001),s=r.n(i),n=r(63939),o=r(50932),a=r(12264),c=r(29170),h=r(44527),u=r(21910),f=r(72308),d=r(16041),l=r(84149),p=r(84290),m=r(4624),g=r(67672),A=r(72739),v=r(9705),w=r(13724),y="src/avpipeline/AudioEncodePipeline.ts";class b extends h.A{constructor(){super()}createWebcodecEncoder(t){return new f.A({onError:e=>{m.z3(`audio encode error, taskId: ${t.taskId}, error: ${e}`,y,76),t.openReject&&(t.openReject(e),t.openReject=null)},onReceivePacket(e){t.avpacketCaches.push(e),o.M[17](t.stats+64,n.f[17](t.stats+64)+BigInt(1))},avpacketPool:t.avpacketPool,avframePool:t.avframePool})}createTask(t){const e=new l.Ay(t.leftPort),r=new l.Ay(t.rightPort),i=[],s=new p.A((0,c.A)(t.avpacketList,a.A),t.avpacketListMutex),h={...t,avpacketCaches:i,encoder:null,inputEnd:!1,parameters:0,avframePool:new d.A((0,c.A)(t.avframeList,a.A),t.avframeListMutex),avpacketPool:s};return t.resource?h.encoder=new u.A({resource:t.resource,onError:e=>{m.z3(`audio encode error, taskId: ${t.taskId}, error: ${e}`,y,117);const r=this.tasks.get(t.taskId);r.openReject&&(r.openReject(e),r.openReject=null)},onReceiveAVPacket(t){h.avpacketCaches.push(t),o.M[17](h.stats+64,n.f[17](h.stats+64)+BigInt(1))},avpacketPool:s}):h.encoder=this.createWebcodecEncoder(h),this.tasks.set(t.taskId,h),r.on(l.S3,(async s=>{switch(s.method){case"pull":if(i.length){const t=i.shift();r.reply(s,t);break}if(!h.inputEnd){for(;;){if(i.length){const t=i.shift();r.reply(s,t);break}const a=await e.request("pull");if(g.ai(a)&&!(a>0)){if(-1048576===a){if(await h.encoder.flush(),h.inputEnd=!0,i.length){const t=i.shift();r.reply(s,t);break}m.pq(`audio encoder ended, taskId: ${h.taskId}`,y,187),r.reply(s,-1048576);break}m.z3(`audio encoder pull avpacket error, taskId: ${t.taskId}, ret: ${a}`,y,193),r.reply(s,a);break}{const e=h.encoder.encode(a);if(g.ai(a)?h.avframePool.release(a):a.close(),e<0){o.M[15](h.stats+52,n.f[15](h.stats+52)+1),m.z3(`audio encode error, taskId: ${t.taskId}, ret: ${e}`,y,165),r.reply(s,e);break}for(;h.encoder instanceof f.A&&h.encoder.getQueueLength()>4;)await new w.A(0)}}break}m.pq(`audio encoder ended, taskId: ${h.taskId}`,y,201),r.reply(s,-1048576)}})),0}async open(t,e,r){const i=this.tasks.get(t);if(i)return new(s())((async(t,s)=>{i.openReject=s;try{await i.encoder.open(e,r),i.parameters=e}catch(e){return m.z3(`open audio encoder failed, error: ${e}`,y,221),void t(v.r8)}t(0)}));m.h2("task not found",y,228)}async getExtraData(t){const e=this.tasks.get(t);if(e)return e.encoder.getExtraData();m.h2("task not found",y,236)}async resetTask(t){const e=this.tasks.get(t);e&&(e.encoder&&await e.encoder.flush(),A.__(e.avpacketCaches,(t=>{e.avpacketPool.release(t)})),e.avpacketCaches.length=0,e.inputEnd=!1,m.pq(`reset audio encoder, taskId: ${e.taskId}`,y,251))}async registerTask(t){return this.tasks.has(t.taskId)?v.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.rightPort.close(),e.leftPort.close(),e.encoder.close(),e.avpacketCaches.forEach((t=>{e.avpacketPool.release(t)})),this.tasks.delete(t))}}},72480:(t,e,r)=>{"use strict";r.d(e,{A:()=>C});var i=r(80662),s=r.n(i),n=r(61499),o=r(12264),a=r(29170),c=r(63939),h=r(50932),u=r(9599),f=r(44527),d=r(9705),l=r(84149),p=r(44315),m=r(24175),g=r(75),A=r(37837),v=r(79630),w=r(4624),y=r(84290),b=r(39148),k=r(72739),_=r(44328),x=r(77231),I=r(43607),M="src/avpipeline/DemuxPipeline.ts";const P=-1;class C extends f.A{constructor(){super()}async judgeFormat(t,e=-1){let r=await t.peekString(8);if(/^FLV/.test(r))return 0;if(/^DKIF/.test(r))return 4;if(/^ftyp/.test(r.slice(4,8)))return 1;if(/^OggS/.test(r))return 3;if(/^ID3/.test(r))return 8;if(/^fLaC/.test(r))return 11;if(/^RIFF/.test(r)){const e=(await t.peekString(12)).slice(8);if(/^WAVE/.test(e))return 10}else if(440786851===await t.peekUint32())return 5;return e}createTask(t){let e,r;if(t.mainTaskId){const i=this.tasks.get(t.mainTaskId);e=i.leftIPCPort,r=i.controlIPCPort}else e=new l.Ay(t.leftPort),t.controlPort&&(r=new l.Ay(t.controlPort));const i=t.bufferLength||1048576,n=(0,A.sY)(i);if(!n)return d.gR;const c=new v.A(n,i),h=new m.A(i,!0,c);t.isLive||(h.flags|=1),t.flags&&(h.flags|=t.flags),h.onFlush=async r=>{const i={pointer:r.byteOffset,length:r.length};t.ioloaderOptions&&(i.ioloaderOptions=t.ioloaderOptions);try{return await e.request("read",i)}catch(t){return-1048574}},h.onSeek=async r=>{try{const i={pos:r};return t.ioloaderOptions&&(i.ioloaderOptions=t.ioloaderOptions),await e.request("seek",i),0}catch(t){return-1048574}},h.onSize=async()=>{try{return await e.request("size")}catch(t){return BigInt(-1048574)}};const u=(0,p.Xv)();return u.ioReader=h,u.getDecoderResource=async(t,e)=>{if(r)return r.request("getDecoderResource",{codecId:e,mediaType:t})},this.tasks.set(t.taskId,{...t,leftIPCPort:e,rightIPCPorts:new(s()),controlIPCPort:r,formatContext:u,ioReader:h,buffer:n,cacheAVPackets:new(s()),cacheRequests:new(s()),realFormat:-1,demuxEnded:!1,loop:null,gopCounter:0,lastKeyFramePts:BigInt(0),lastAudioDts:BigInt(0),lastVideoDts:BigInt(0),avpacketPool:new y.A((0,a.A)(t.avpacketList,o.A),t.avpacketListMutex)}),0}async openStream(t,e=2e3){const i=this.tasks.get(t);if(i){let t,s;await i.leftIPCPort.request("open");try{t=await this.judgeFormat(i.ioReader,i.format),i.format=t}catch(t){return d.LR}switch(t){case 0:s=new((await r.e(773).then(r.bind(r,28773))).default);break;case 1:s=new((await r.e(47).then(r.bind(r,92047))).default);break;case 2:s=new((await r.e(331).then(r.bind(r,59331))).default);break;case 4:s=new((await r.e(634).then(r.bind(r,16634))).default);break;case 3:s=new((await r.e(979).then(r.bind(r,69979))).default);break;case 8:s=new((await r.e(839).then(r.bind(r,6839))).default);break;case 5:case 6:s=new((await r.e(577).then(r.bind(r,34577))).default);break;case 9:s=new((await r.e(94).then(r.bind(r,47094))).default);break;case 11:s=new((await r.e(453).then(r.bind(r,18453))).default);break;case 10:s=new((await r.e(791).then(r.bind(r,3791))).default);break;default:return w.z3("format not support",M,372),d.E$}return i.realFormat=t,i.formatContext.iformat=s,g.ho(i.formatContext,{maxAnalyzeDuration:e,fastOpen:i.isLive})}w.h2("task not found",M,387)}async getFormat(t){const e=this.tasks.get(t);if(e)return e.realFormat;w.h2("task not found",M,397)}async analyzeStreams(t){const e=this.tasks.get(t);if(e){await g.Ib(e.formatContext);const t=[];for(let r=0;r<e.formatContext.streams.length;r++){const i=e.formatContext.streams[r];t.push({index:i.index,id:i.id,codecpar:i.codecpar[n.o9],nbFrames:i.nbFrames,metadata:i.metadata,duration:i.duration,startTime:i.startTime,disposition:i.disposition,timeBase:i.timeBase[n.o9]})}return{metadata:e.formatContext.metadata,format:e.realFormat,streams:t}}w.h2("task not found",M,429)}async connectStreamTask(t,e,r){const i=this.tasks.get(t);if(i){const t=new l.Ay(r);i.cacheAVPackets.set(e,[]),t.on(l.S3,(async r=>{switch(r.method){case"pull":{const s=i.cacheAVPackets.get(e);if(s.length){const e=s.shift();1===i.formatContext.streams[c.f[15](e+32)].codecpar.codecType?h.M[15](i.stats+32,c.f[15](i.stats+32)-1):0===i.formatContext.streams[c.f[15](e+32)].codecpar.codecType&&h.M[15](i.stats+120,c.f[15](i.stats+120)-1),t.reply(r,e)}else i.demuxEnded?t.reply(r,-1048576):(i.cacheRequests.set(e,r),i.loop&&i.loop.isStarted()&&i.loop.resetInterval());break}}})),i.rightIPCPorts.set(e,t),w.Yz(`connect stream ${e}, taskId: ${i.taskId}`,M,471)}else w.h2("task not found",M,474)}async startDemux(t,e,r){const i=this.tasks.get(t);i?(r=Math.max(r,2===i.format?20:10),i.loop&&i.loop.destroy(),i.loop=new b.A((async()=>{if(!e){let t=!1;if(i.cacheAVPackets.forEach((e=>{e.length<r&&(t=!0)})),!t)return void i.loop.emptyTask()}const s=i.avpacketPool.alloc();let n=await g.Cj(i.formatContext,s);if(n){i.avpacketPool.release(s),-1048576!==n&&w.z3(`demux error, ret: ${n}, taskId: ${t}`,M,605),i.demuxEnded=!0,w.pq(`demuxer ended, taskId: ${i.taskId}`,M,610);for(let t of i.cacheRequests.keys())i.cacheAVPackets.get(t).length||(i.rightIPCPorts.get(t).reply(i.cacheRequests.get(t),-1048576),i.cacheRequests.delete(t));i.loop.stop()}else{const t=c.f[15](s+32);if(1===i.formatContext.streams[t].codecpar.codecType&&i.cacheAVPackets.has(t)){if(h.M[17](i.stats+24,c.f[17](i.stats+24)+BigInt(1)),h.M[17](i.stats+16,c.f[17](i.stats+16)+BigInt(c.f[15](s+28)>>>0)),c.f[17](i.stats+24)>1&&c.f[17](s+16)>i.lastAudioDts){const e=i.cacheAVPackets.get(t);e&&e.length?h.M[15](i.stats+236,Math.round(c.f[15](s+76)/c.f[15](s+72)/((0|Number(c.f[17](s+16)-c.f[17](e[0]+16)&0xffffffffn))/e.length))):h.M[15](i.stats+236,Math.round(c.f[15](s+76)/c.f[15](s+72)/(0|Number(c.f[17](s+16)-i.lastAudioDts&0xffffffffn))))}i.lastAudioDts=c.f[17](s+16)}else if(0===i.formatContext.streams[t].codecpar.codecType&&i.cacheAVPackets.has(t)){if(h.M[17](i.stats+112,c.f[17](i.stats+112)+BigInt(1)),h.M[17](i.stats+104,c.f[17](i.stats+104)+BigInt(c.f[15](s+28)>>>0)),1&c.f[15](s+36)?(h.M[17](i.stats+176,c.f[17](i.stats+176)+BigInt(1)),c.f[17](i.stats+176)>1&&c.f[17](s+8)>i.lastKeyFramePts&&(h.M[15](i.stats+96,i.gopCounter),i.gopCounter=1,h.M[15](i.stats+92,0|Number(0xffffffffn&(0,_.k)(c.f[17](s+8)-i.lastKeyFramePts,(0,a.A)(s+72,u.P),x.i0)))),i.lastKeyFramePts=c.f[17](s+8)):i.gopCounter++,c.f[17](i.stats+112)>1&&c.f[17](s+16)>i.lastVideoDts){const e=i.cacheAVPackets.get(t);e&&e.length?h.M[15](i.stats+224,Math.round(c.f[15](s+76)/c.f[15](s+72)/((0|Number(c.f[17](s+16)-c.f[17](e[0]+16)&0xffffffffn))/e.length))):h.M[15](i.stats+224,Math.round(c.f[15](s+76)/c.f[15](s+72)/(0|Number(c.f[17](s+16)-i.lastVideoDts&0xffffffffn))))}i.lastVideoDts=c.f[17](s+16)}i.cacheRequests.has(t)?(i.rightIPCPorts.get(t).reply(i.cacheRequests.get(t),s),i.cacheRequests.delete(t)):i.cacheAVPackets.has(t)?(i.cacheAVPackets.get(t).push(s),1===i.formatContext.streams[t].codecpar.codecType?h.M[15](i.stats+32,c.f[15](i.stats+32)+1):0===i.formatContext.streams[t].codecpar.codecType&&h.M[15](i.stats+120,c.f[15](i.stats+120)+1)):i.rightIPCPorts.has(P)?i.cacheRequests.has(P)?(i.rightIPCPorts.get(P).reply(i.cacheRequests.get(P),s),i.cacheRequests.delete(P)):i.cacheAVPackets.get(P).push(s):i.avpacketPool.release(s)}}),0,0,!0,!1),i.loop.start(),w.Yz(`start demux loop, taskId: ${i.taskId}`,M,625)):w.h2("task not found",M,628)}async seek(t,e,r){const i=this.tasks.get(t);if(i){if(i.loop){await i.loop.stopBeforeNextTick();let t=await g.jF(i.formatContext,-1,e,r);if(t>=BigInt(0)){i.cacheAVPackets.forEach((t=>{k.__(t,(t=>{i.avpacketPool.release(t)})),t.length=0})),h.M[15](i.stats+32,0),h.M[15](i.stats+120,0);const r=i.avpacketPool.alloc();for(;t=await g.Cj(i.formatContext,r),!(t<0||i.cacheAVPackets.has(c.f[15](r+32))););if(t>=0){i.demuxEnded=!1;const t=c.f[15](r+32);i.cacheAVPackets.get(t).push(r),1===i.formatContext.streams[c.f[15](r+32)].codecpar.codecType?h.M[15](i.stats+32,c.f[15](i.stats+32)+1):0===i.formatContext.streams[c.f[15](r+32)].codecpar.codecType&&h.M[15](i.stats+120,c.f[15](i.stats+120)+1),i.loop.start();let e=c.f[17](r+8);return i.formatContext.streams[t].startTime!==x.Dh?e-=i.formatContext.streams[t].startTime:e-=i.formatContext.streams[t].firstDTS,(0,_.k)(I.T9(e,BigInt(0)),(0,a.A)(r+72,u.P),x.i0)}return w.R8(`got first packet failed after seek, taskId: ${i.taskId}`,M,681),i.avpacketPool.release(r),i.demuxEnded=!0,e}return t}{w.pq("seek before demux loop start",M,692);let t=await g.jF(i.formatContext,-1,e,r);return t<0?t:e}}}async croppingAVPacketQueue(t,e){const r=this.tasks.get(t);r&&r.cacheAVPackets.forEach(((t,i)=>{const s=c.f[17](t[t.length-1]+16);let n=t.length-2;for(n=t.length-2;n>=0&&!(1&c.f[15](t[n]+36)&&(0,_.k)(s-c.f[17](t[n]+16),(0,a.A)(t[n]+72,u.P),x.i0)>=e);n--);n>0&&(t.splice(0,n).forEach((t=>{r.avpacketPool.release(t)})),1===r.formatContext.streams[i].codecpar.codecType?h.M[15](r.stats+32,t.length):0===r.formatContext.streams[i].codecpar.codecType&&h.M[15](r.stats+120,t.length))}))}async registerTask(t){return this.tasks.has(t.taskId)?d.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.loop&&(await e.loop.stopBeforeNextTick(),e.loop.destroy()),e.leftIPCPort.destroy(),e.rightIPCPorts.forEach((t=>{t.destroy()})),e.rightIPCPorts.clear(),e.formatContext.destroy(),(0,A.Eb)(e.buffer),e.cacheAVPackets.forEach((t=>{t.forEach((t=>{e.avpacketPool.release(t)}))})),this.tasks.delete(t))}}},87243:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i=r(63939),s=r(50932),n=r(44527),o=r(77580),a=r(9705),c=r(84149),h=r(14686),u=r(79686),f=r(4624),d="src/avpipeline/IOPipeline.ts";class l extends n.A{constructor(){super()}async createTask(t){let e;switch(t.type){case 0:e=new o.A(t.options);break;case 1:e=new u.A(t.options);break;case 2:e=new((await r.e(866).then(r.bind(r,15433))).default)(t.options);break;case 3:e=new((await r.e(576).then(r.bind(r,41576))).default)(t.options)}if(!e)return a.UY;const n=new c.Ay(t.rightPort),l={...t,ioLoader:e,ipcPort:n};return n.on(c.S3,(async r=>{switch(r.method){case"open":try{await e.open(t.info,t.range),n.reply(r,{})}catch(e){f.z3(`loader open error, ${e}, taskId: ${t.taskId}`,d,118),n.reply(r,null,e)}break;case"read":{const o=r.params.pointer,c=r.params.length,u=r.params.ioloaderOptions,p=(0,h.JW)(o,c);try{const t=await e.read(p,u);s.M[17](l.stats+192,i.f[17](l.stats+192)+BigInt(t>>>0)),n.reply(r,t)}catch(e){f.z3(`loader read error, ${e}, taskId: ${t.taskId}`,d,139),n.reply(r,a.LR)}break}case"seek":{const i=r.params.pos,s=r.params.ioloaderOptions;try{await e.seek(i,s),n.reply(r)}catch(e){f.z3(`loader seek error, ${e}, taskId: ${t.taskId}`,d,157),n.reply(r,null,e)}break}case"size":n.reply(r,await e.size())}})),this.tasks.set(t.taskId,l),0}async open(t){const e=this.tasks.get(t);if(e)return await e.ioLoader.open(e.info,e.range),0}async getDuration(t){const e=this.tasks.get(t);if(e)return 2===e.type||3===e.type?e.ioLoader.getDuration():0}async hasAudio(t){const e=this.tasks.get(t);if(e)return 3===e.type&&e.ioLoader.hasAudio()}async hasVideo(t){const e=this.tasks.get(t);if(e)return 3===e.type&&e.ioLoader.hasVideo()}async hasSubtitle(t){const e=this.tasks.get(t);if(e)return 3===e.type&&e.ioLoader.hasSubtitle()}async getVideoList(t){const e=this.tasks.get(t);if(e)return 3===e.type||2===e.type?e.ioLoader.getVideoList():{list:[],selectedIndex:0}}async getAudioList(t){const e=this.tasks.get(t);if(e)return 3===e.type?e.ioLoader.getAudioList():{list:[],selectedIndex:0}}async getSubtitleList(t){const e=this.tasks.get(t);if(e)return 3===e.type?e.ioLoader.getSubtitleList():{list:[],selectedIndex:0}}async selectVideo(t,e){const r=this.tasks.get(t);if(r)if(3===r.type)r.ioLoader.selectVideo(e);else if(2===r.type)return r.ioLoader.selectVideo(e)}async selectAudio(t,e){const r=this.tasks.get(t);r&&3===r.type&&r.ioLoader.selectAudio(e)}async selectSubtitle(t,e){const r=this.tasks.get(t);r&&3===r.type&&r.ioLoader.selectSubtitle(e)}async getMinBuffer(t){const e=this.tasks.get(t);if(e)return 3===e.type||2===e.type?e.ioLoader.getMinBuffer():0}async registerTask(t){return this.tasks.has(t.taskId)?a.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(await e.ioLoader.stop(),e.ipcPort.destroy(),this.tasks.delete(t))}}},45597:(t,e,r)=>{"use strict";r.d(e,{A:()=>_});var i=r(61499),s=r(12264),n=r(29170),o=r(63939),a=r(50932),c=r(9599),h=r(44527),u=r(9705),f=r(84149),d=r(44315),l=r(92174),p=r(4624),m=r(84290),g=r(39148),A=r(72739),v=r(44328),w=r(77231),y=r(35336),b=r(71766),k="src/avpipeline/MuxPipeline.ts";class _ extends h.A{constructor(){super()}createTask(t){const e=new f.Ay(t.rightPort),r=(0,d.fG)(),i=new y.A(5242880);return i.onFlush=(t,r)=>{const i=t.slice();return e.notify("write",{data:i,pos:r},[i.buffer]),0},i.onSeek=t=>(e.notify("seek",{pos:t}),0),r.ioWriter=i,this.tasks.set(t.taskId,{...t,rightIPCPort:e,formatContext:r,loop:null,ended:!1,streams:[],avpacketPool:new m.A((0,n.A)(t.avpacketList,s.A),t.avpacketListMutex)}),0}async open(t){const e=this.tasks.get(t);if(e){let t;switch(e.format){case 0:t=new((await r.e(3).then(r.bind(r,4003))).default);break;case 1:t=new((await r.e(765).then(r.bind(r,69765))).default);break;case 2:t=new((await r.e(597).then(r.bind(r,15597))).default);break;case 4:t=new((await r.e(632).then(r.bind(r,5632))).default);break;case 3:t=new((await r.e(109).then(r.bind(r,95109))).default);break;case 8:t=new((await r.e(257).then(r.bind(r,52257))).default);break;case 5:case 6:{const i={isLive:e.isLive,docType:6===e.format?"webm":"matroska"};t=new((await r.e(675).then(r.bind(r,68675))).default)(i)}break;default:return p.z3("format not support",k,192),u.E$}e.formatContext.oformat=t;for(let t=0;t<e.streams.length;t++){const r=await e.streams[t].pullIPC.request("pull");if(-1048576===r)e.streams[t].ended=!0;else{if(r<0)return p.z3(`pull stream ${t} avpacket error, ret: ${r}`,k,206),e.streams[t].ended=!0,u.LR;{a.M[15](r+32,e.streams[t].stream.index),e.streams[t].avpacket=r;const i=(0,v.k)(o.f[17](e.streams[t].avpacket+16),(0,n.A)(e.streams[t].avpacket+72,c.P),w.i0);1===o.f[15](e.streams[t].stream.codecpar)?a.M[17](e.stats+280,i):0===o.f[15](e.streams[t].stream.codecpar)&&a.M[17](e.stats+296,i)}}}return 0}p.h2("task not found",k,225)}async addStream(t,e,r){const s=this.tasks.get(t);if(s){s.streams.push({stream:e,pullIPC:new f.Ay(r),avpacket:0,ended:!1});const t=s.formatContext.createStream();t.id=e.id,t.index=e.index,(0,b.Yi)(t.codecpar[i.o9],e.codecpar),t.timeBase.num=o.f[15](e.timeBase),t.timeBase.den=o.f[15](e.timeBase+4),t.metadata=e.metadata}else p.h2("task not found",k,247)}async updateAVCodecParameters(t,e,r){const s=this.tasks.get(t);if(s){const t=s.formatContext.getStreamByIndex(e);t&&(0,b.Yi)(t.codecpar[i.o9],r)}else p.h2("task not found",k,260)}async start(t){const e=this.tasks.get(t);return e?e.loop?(p.z3("task has started",k,269),u.lh):l.ho(e.formatContext)<0?(p.z3("mux task open error",k,276),u.E$):(l.bx(e.formatContext),e.streams.length?(e.loop=new g.A((async()=>{for(let t=0;t<e.streams.length;t++)if(!e.streams[t].ended&&!e.streams[t].avpacket){const r=await e.streams[t].pullIPC.request("pull");if(-1048576===r)e.streams[t].ended=!0;else{if(r<0)return p.z3(`pull stream ${t} avpacket error, ret: ${r}`,k,296),e.streams[t].ended=!0,e.loop.stop(),e.ended=!0,void e.rightIPCPort.notify("error");a.M[15](r+32,e.streams[t].stream.index),e.streams[t].avpacket=r}}let t=0,r=w.Dh,i=0,s=-1;for(let a=0;a<e.streams.length;a++)if(e.streams[a].avpacket){const h=(0,v.k)(o.f[17](e.streams[a].avpacket+16),(0,n.A)(e.streams[a].avpacket+72,c.P),w.i0);(r===w.Dh||h<r)&&(t=e.streams[a].avpacket,r=h,i=a,s=o.f[15](e.streams[a].stream.codecpar))}if(t){const n=e.formatContext.ioWriter.getPos();l.XA(e.formatContext,t),a.M[17](e.stats+200,o.f[17](e.stats+200)+(e.formatContext.ioWriter.getPos()-n)),e.avpacketPool.release(t),e.streams[i].avpacket=0,1===s?a.M[17](e.stats+288,r):0===s&&a.M[17](e.stats+304,r)}else l.dJ(e.formatContext),l.bX(e.formatContext),e.rightIPCPort.notify("end"),e.loop.stop(),e.ended=!0}),0,0,!1,!1),e.loop.start(),0):(p.z3("task streams not found",k,283),u.lh)):(p.z3("task not found",k,353),u.lh)}async pause(t){const e=this.tasks.get(t);e?e.loop&&await e.loop.stopBeforeNextTick():p.h2("task not found",k,366)}async unpause(t){const e=this.tasks.get(t);e?!e.loop||e.loop.isStarted()||e.ended||e.loop.start():p.h2("task not found",k,378)}async registerTask(t){return this.tasks.has(t.taskId)?u.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.loop&&(await e.loop.stopBeforeNextTick(),e.loop.destroy()),A.__(e.streams,(t=>{t.avpacket&&(e.avpacketPool.release(t.avpacket),t.avpacket=0),t.pullIPC.destroy()})),e.formatContext.destroy(),this.tasks.delete(t))}}},44527:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(80662),n=r.n(s),o=r(4624);class a{constructor(){(0,i.A)(this,"tasks",void 0),this.tasks=new(n())}async clear(){if(this.tasks.size)for(const t of this.tasks.keys())await this.unregisterTask(t)}async setLogLevel(t){o.V$(t)}async getTaskCount(){return this.tasks.size}}},31138:(t,e,r)=>{"use strict";r.d(e,{A:()=>M});var i=r(54001),s=r.n(i),n=r(63939),o=r(50932),a=r(12264),c=r(29170),h=r(9599),u=r(44527),f=r(9705),d=r(84149),l=r(40417),p=r(71039),m=r(4624),g=r(16041),A=r(67672),v=r(72739),w=r(13724),y=r(84290),b=r(39638),k=r(44328),_=r(86932),x=r(95797),I="src/avpipeline/VideoDecodePipeline.ts";class M extends u.A{constructor(){super()}createWebcodecDecoder(t,e=!0){return new p.A({onError:e=>{if(t.hardwareRetryCount>3||!t.firstDecoded)t.targetDecoder===t.hardwareDecoder&&(t.targetDecoder=t.softwareDecoder,t.hardwareDecoder.close(),t.hardwareDecoder=null,t.decoderReady=this.openSoftwareDecoder(t),m.R8(`video decode error width hardware(${t.hardwareRetryCount}), taskId: ${t.taskId}, error: ${e}, try to fallback to software decoder`,I,116));else{t.hardwareRetryCount++;try{m.pq(`retry open hardware decoder(${t.hardwareRetryCount}), taskId: ${t.taskId}`,I,122),t.decoderReady=t.hardwareDecoder.open(t.parameters)}catch(e){m.R8(`retry open hardware decoder failed, fallback to software decoder, taskId: ${t.taskId}`,I,126)}}t.needKeyFrame=!0,t.leftIPCPort.request("requestKeyframe")},onReceiveFrame(e){t.firstDecoded=!0,t.frameCaches.push(e),o.M[17](t.stats+144,n.f[17](t.stats+144)+BigInt(1)),t.lastDecodeTimestamp&&o.M[15](t.stats+248,Math.max((0,_.A)()-t.lastDecodeTimestamp,n.f[15](t.stats+248))),t.lastDecodeTimestamp=(0,_.A)()},enableHardwareAcceleration:e})}createTask(t){const e=new d.Ay(t.leftPort),r=new d.Ay(t.rightPort),i=[],h=new g.A((0,c.A)(t.avframeList,a.A),t.avframeListMutex),u={...t,leftIPCPort:e,rightIPCPort:r,softwareDecoder:null,hardwareDecoder:null,frameCaches:i,inputEnd:!1,targetDecoder:null,needKeyFrame:!0,parameters:0,hardwareRetryCount:0,lastDecodeTimestamp:0,firstDecoded:!1,decoderReady:null,softwareDecoderOpened:!1,avframePool:h,avpacketPool:new y.A((0,c.A)(t.avpacketList,a.A),t.avpacketListMutex)};return u.softwareDecoder=t.resource?new l.A({resource:t.resource,onError:e=>{m.z3(`video decode error, taskId: ${t.taskId}, error: ${e}`,I,184);const r=this.tasks.get(t.taskId);r.openReject&&(r.openReject(f.r8),r.openReject=null)},onReceiveFrame(t){u.firstDecoded=!0,i.push(t),o.M[17](u.stats+144,n.f[17](u.stats+144)+BigInt(1)),u.lastDecodeTimestamp&&o.M[15](u.stats+248,Math.max((0,_.A)()-u.lastDecodeTimestamp,n.f[15](u.stats+248))),u.lastDecodeTimestamp=(0,_.A)()},avframePool:h}):x.A.videoDecoder?this.createWebcodecDecoder(u,!1):null,u.softwareDecoder?(x.A.videoDecoder&&t.enableHardware&&(u.hardwareDecoder=this.createWebcodecDecoder(u)),u.targetDecoder=u.hardwareDecoder||u.softwareDecoder,this.tasks.set(t.taskId,u),r.on(d.S3,(async a=>{switch(a.method){case"pull":if(i.length){const t=i.shift();r.reply(a,t,null,A.ai(t)?null:[t]);break}if(!u.inputEnd){for(;;){if(i.length){const t=i.shift();r.reply(a,t,null,A.ai(t)?null:[t]);break}u.decoderReady&&(await u.decoderReady,u.decoderReady=null);const c=await e.request("pull");if(-1048576===c){if(u.targetDecoder===u.hardwareDecoder){let t=await s().race([new w.A(2),u.targetDecoder.flush()]);A.ai(t)&&m.R8(`video hardware decoder flush failed, ignore it, taskId: ${u.taskId}`,I,251)}else await u.targetDecoder.flush();if(u.inputEnd=!0,u.targetDecoder===u.hardwareDecoder&&await new w.A(0),i.length){const t=i.shift();r.reply(a,t,null,u.targetDecoder===u.hardwareDecoder?[t]:null);break}m.pq(`video decoder ended, taskId: ${u.taskId}`,I,268),r.reply(a,-1048576);break}if(!(c>0)){m.z3(`video decode pull avpacket error, taskId: ${t.taskId}, ret: ${c}`,I,327),r.reply(a,c);break}{if(u.needKeyFrame){if(!(1&n.f[15](c+36))){u.avpacketPool.release(c);continue}u.needKeyFrame=!1}let e=u.targetDecoder.decode(c);if(e<0){if(o.M[15](u.stats+136,n.f[15](u.stats+136)+1),u.targetDecoder===u.hardwareDecoder&&u.softwareDecoder){if(u.targetDecoder=u.softwareDecoder,u.hardwareDecoder.close(),u.hardwareDecoder=null,await this.openSoftwareDecoder(u),m.R8(`video decode error width hardware, taskId: ${u.taskId}, error: ${e}, try to fallback to software decoder`,I,297),!(1&n.f[15](c+36))){u.avpacketPool.release(c),u.needKeyFrame=!0,u.leftIPCPort.request("requestKeyframe");continue}if(e=u.targetDecoder.decode(c),e>=0){u.avpacketPool.release(c);continue}}u.avpacketPool.release(c),m.z3(`video decode error, taskId: ${t.taskId}, ret: ${e}`,I,313),r.reply(a,e);break}for(u.avpacketPool.release(c);u.targetDecoder===u.hardwareDecoder&&u.hardwareDecoder.getQueueLength()>20;)await new w.A(0)}}break}m.pq(`video decoder ended, taskId: ${u.taskId}`,I,334),r.reply(a,-1048576)}})),0):(m.z3("software decoder not support",I,208),f.lh)}async openSoftwareDecoder(t){if(t.softwareDecoder&&!t.softwareDecoderOpened){const e=t.parameters;let r=1;if((0,b.A)()){let t=n.f[15](e+56)*n.f[15](e+60),i=(0,k.lb)((0,c.A)(e+72,h.P));t>=2073600&&t<=2211840?(173!==n.f[15](e+4)&&196!==n.f[15](e+4)&&225!==n.f[15](e+4)||(r=2),i>30?(r=2,173!==n.f[15](e+4)&&196!==n.f[15](e+4)&&225!==n.f[15](e+4)||(r=4)):i>60&&(r=4,173!==n.f[15](e+4)&&196!==n.f[15](e+4)&&225!==n.f[15](e+4)||(r=6))):t>2211840&&t<=8294400?(r=4,173!==n.f[15](e+4)&&196!==n.f[15](e+4)&&225!==n.f[15](e+4)||(r=6)):t>8294400&&(r=6,173!==n.f[15](e+4)&&196!==n.f[15](e+4)&&225!==n.f[15](e+4)||(r=8)),r=Math.min(r,navigator.hardwareConcurrency)}await t.softwareDecoder.open(e,r),t.softwareDecoderOpened=!0}}async open(t,e){const r=this.tasks.get(t);if(r)return new(s())((async(t,i)=>{if(r.openReject=t,r.hardwareDecoder)try{await r.hardwareDecoder.open(e)}catch(t){m.z3(`cannot open hardware decoder, ${t}`,I,413),r.hardwareDecoder.close(),r.hardwareDecoder=null,r.targetDecoder=r.softwareDecoder}if(r.parameters=e,r.targetDecoder===r.softwareDecoder)try{await this.openSoftwareDecoder(r)}catch(e){if(m.z3(`open video software decoder failed, error: ${e}`,I,427),!r.hardwareDecoder)return void t(f.r8)}t(0)}));m.h2("task not found",I,437)}async setPlayRate(t,e){const r=this.tasks.get(t);if(r&&r.softwareDecoder){let t=-16,i=(0,k.lb)((0,c.A)(r.parameters+72,h.P));t=i>=120?e<=1?-16:e<1.5||e<3?8:32:i>=60?e<1.5?-16:e<3?8:e<8?24:32:-16,r.softwareDecoder.setSkipFrameDiscard(t)}else m.h2("task not found",I,481)}async resetTask(t){const e=this.tasks.get(t);e&&(e.targetDecoder===e.softwareDecoder?await e.targetDecoder.flush():e.targetDecoder===e.hardwareDecoder&&(e.hardwareDecoder.close(),e.hardwareDecoder=this.createWebcodecDecoder(e),await e.hardwareDecoder.open(e.parameters),e.targetDecoder=e.hardwareDecoder),v.__(e.frameCaches,(t=>{A.ai(t)?e.avframePool.release(t):t.close()})),e.frameCaches.length=0,e.needKeyFrame=!0,e.inputEnd=!1,e.lastDecodeTimestamp=(0,_.A)(),m.pq(`reset video decoder, taskId: ${e.taskId}`,I,511))}async registerTask(t){return this.tasks.has(t.taskId)?f.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.rightPort.close(),e.leftPort.close(),e.softwareDecoder&&e.softwareDecoder.close(),e.hardwareDecoder&&e.hardwareDecoder.close(),e.frameCaches.forEach((t=>{A.ai(t)?e.avframePool.release(t):t.close()})),this.tasks.delete(t))}async getTasksInfo(){const t=[];return this.tasks.forEach((e=>{t.push({codecId:n.f[15](e.parameters+4),width:n.f[15](e.parameters+56),height:n.f[15](e.parameters+60),framerate:(0,k.lb)((0,c.A)(e.parameters+72,h.P)),hardware:e.targetDecoder===e.hardwareDecoder})})),t}}},41678:(t,e,r)=>{"use strict";r.d(e,{A:()=>I});var i=r(54001),s=r.n(i),n=r(63939),o=r(50932),a=r(12264),c=r(29170),h=r(9599),u=r(44527),f=r(9705),d=r(84149),l=r(4624),p=r(16041),m=r(67672),g=r(72739),A=r(13724),v=r(84290),w=r(39638),y=r(44328),b=r(95797),k=r(80105),_=r(47243),x="src/avpipeline/VideoEncodePipeline.ts";class I extends u.A{constructor(){super()}createWebcodecEncoder(t,e=!0){return new _.A({onError:e=>{t.targetEncoder===t.hardwareEncoder?(t.targetEncoder=t.softwareEncoder,t.hardwareEncoder.close(),t.hardwareEncoder=null,t.encoderReady=this.openSoftwareEncoder(t),l.R8(`video encode error width hardware, taskId: ${t.taskId}, error: ${e}, try to fallback to software encoder`,x,111)):l.z3(`video encode error width hardware, taskId: ${t.taskId}, error: ${e}`,x,114)},onReceivePacket(e){t.avpacketCaches.push(e),o.M[17](t.stats+152,n.f[17](t.stats+152)+BigInt(1))},enableHardwareAcceleration:e,avpacketPool:t.avpacketPool,avframePool:t.avframePool})}createTask(t){const e=new d.Ay(t.leftPort),r=new d.Ay(t.rightPort),i=[],h=new p.A((0,c.A)(t.avframeList,a.A),t.avframeListMutex),u=new v.A((0,c.A)(t.avpacketList,a.A),t.avpacketListMutex),g={...t,leftIPCPort:e,rightIPCPort:r,softwareEncoder:null,hardwareEncoder:null,avpacketCaches:i,inputEnd:!1,targetEncoder:null,parameters:0,timeBase:null,encoderReady:null,softwareEncoderOpened:!1,gopCounter:0,avframePool:h,avpacketPool:u};return g.softwareEncoder=t.resource?new k.A({resource:t.resource,onError:e=>{l.z3(`video encode error, taskId: ${t.taskId}, error: ${e}`,x,162);const r=this.tasks.get(t.taskId);r.openReject&&(r.openReject(e),r.openReject=null)},onReceiveAVPacket(t){g.avpacketCaches.push(t),o.M[17](g.stats+152,n.f[17](g.stats+152)+BigInt(1))},avpacketPool:u}):b.A.videoEncoder?this.createWebcodecEncoder(g,!1):null,g.softwareEncoder?(b.A.videoEncoder&&t.enableHardware&&(g.hardwareEncoder=this.createWebcodecEncoder(g)),g.targetEncoder=g.hardwareEncoder||g.softwareEncoder,this.tasks.set(t.taskId,g),r.on(d.S3,(async a=>{switch(a.method){case"pull":if(i.length){const t=i.shift();r.reply(a,t);break}if(!g.inputEnd){for(;;){if(i.length){const t=i.shift();r.reply(a,t);break}g.encoderReady&&(await g.encoderReady,g.encoderReady=null);const c=await e.request("pull");if(m.ai(c)&&!(c>0)){if(-1048576===c){if(g.targetEncoder===g.hardwareEncoder){let t=await s().race([new A.A(2),g.targetEncoder.flush()]);m.ai(t)&&l.R8(`video hardware encoder flush failed, ignore it, taskId: ${g.taskId}`,x,266)}else await g.targetEncoder.flush();if(g.inputEnd=!0,g.targetEncoder===g.hardwareEncoder&&await new A.A(0),i.length){const t=i.shift();r.reply(a,t);break}l.pq(`video encoder ended, taskId: ${g.taskId}`,x,283),r.reply(a,-1048576);break}l.z3(`video encoder pull avframe error, taskId: ${t.taskId}, ret: ${c}`,x,289),r.reply(a,c);break}{let e=g.targetEncoder.encode(c,0===g.gopCounter);if(e<0&&(o.M[15](g.stats+140,n.f[15](g.stats+140)+1),g.targetEncoder===g.hardwareEncoder&&g.softwareEncoder&&(g.targetEncoder=g.softwareEncoder,g.hardwareEncoder.close(),g.hardwareEncoder=null,await this.openSoftwareEncoder(g),l.R8(`video encode error width hardware, taskId: ${g.taskId}, error: ${e}, try to fallback to software encode`,x,223),e=g.targetEncoder.encode(c,0===g.gopCounter)),e<0)){m.ai(c)?g.avframePool.release(c):c.close(),l.z3(`video encode error, taskId: ${t.taskId}, ret: ${e}`,x,234),r.reply(a,e);break}for(g.gopCounter++,g.gopCounter===g.gop&&(g.gopCounter=0),m.ai(c)?g.avframePool.release(c):c.close();g.targetEncoder instanceof _.A&&g.targetEncoder.getQueueLength()>10;)await new A.A(0)}}break}l.pq(`video encoder ended, taskId: ${g.taskId}`,x,297),r.reply(a,-1048576)}})),0):(l.z3("software encoder not support",x,178),f.lh)}async openSoftwareEncoder(t){if(t.softwareEncoder&&!t.softwareEncoderOpened){const e=t.parameters;let r=1;(0,w.A)()&&(r=Math.max(r,navigator.hardwareConcurrency-2)),await t.softwareEncoder.open(e,t.timeBase,r),t.softwareEncoderOpened=!0}}async open(t,e,r){const i=this.tasks.get(t);if(i)return new(s())((async(t,s)=>{if(i.openReject=s,i.hardwareEncoder)try{await i.hardwareEncoder.open(e,r)}catch(t){l.z3(`cannot open hardware encoder, ${t}`,x,329),i.hardwareEncoder.close(),i.hardwareEncoder=null,i.targetEncoder=i.softwareEncoder}if(i.parameters=e,i.timeBase=r,i.targetEncoder===i.softwareEncoder)try{await this.openSoftwareEncoder(i)}catch(e){if(l.z3(`open video software encoder failed, error: ${e}`,x,344),!i.hardwareEncoder)return void t(f.r8)}t(0)}));l.h2("task not found",x,354)}async resetTask(t){const e=this.tasks.get(t);e&&(e.targetEncoder===e.softwareEncoder?await e.targetEncoder.flush():e.targetEncoder===e.hardwareEncoder&&(e.hardwareEncoder.close(),e.hardwareEncoder=this.createWebcodecEncoder(e),await e.hardwareEncoder.open(e.parameters,e.timeBase),e.targetEncoder=e.hardwareEncoder),g.__(e.avpacketCaches,(t=>{e.avpacketPool.release(t)})),e.avpacketCaches.length=0,e.inputEnd=!1,l.pq(`reset video encode, taskId: ${e.taskId}`,x,376))}async getExtraData(t){const e=this.tasks.get(t);if(e)return e.targetEncoder.getExtraData();l.h2("task not found",x,385)}async getColorSpace(t){const e=this.tasks.get(t);if(e)return e.targetEncoder.getColorSpace();l.h2("task not found",x,393)}async registerTask(t){return this.tasks.has(t.taskId)?f.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);e&&(e.rightPort.close(),e.leftPort.close(),e.softwareEncoder&&e.softwareEncoder.close(),e.hardwareEncoder&&e.hardwareEncoder.close(),g.__(e.avpacketCaches,(t=>{e.avpacketPool.release(t)})),this.tasks.delete(t))}async getTasksInfo(){const t=[];return this.tasks.forEach((e=>{t.push({codecId:n.f[15](e.parameters+4),width:n.f[15](e.parameters+56),height:n.f[15](e.parameters+60),framerate:(0,y.lb)((0,c.A)(e.parameters+72,h.P)),hardware:e.targetEncoder===e.hardwareEncoder})})),t}}},30128:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085);class u{constructor(){(0,n.A)(this,"channels",void 0),(0,n.A)(this,"sampleRate",void 0),(0,n.A)(this,"audioFrameSize",void 0),(0,n.A)(this,"audioPacketBytes",void 0),(0,n.A)(this,"audioPacketCount",void 0),(0,n.A)(this,"audioPacketQueueLength",void 0),(0,n.A)(this,"audioDropPacketCount",void 0),(0,n.A)(this,"audioDecodeErrorPacketCount",void 0),(0,n.A)(this,"audioEncodeErrorFrameCount",void 0),(0,n.A)(this,"audioFrameDecodeCount",void 0),(0,n.A)(this,"audioPacketEncodeCount",void 0),(0,n.A)(this,"audioFrameRenderCount",void 0),(0,n.A)(this,"audioFrameDropCount",void 0),(0,n.A)(this,"width",void 0),(0,n.A)(this,"height",void 0),(0,n.A)(this,"keyFrameInterval",void 0),(0,n.A)(this,"gop",void 0),(0,n.A)(this,"videoPacketBytes",void 0),(0,n.A)(this,"videoPacketCount",void 0),(0,n.A)(this,"videoPacketQueueLength",void 0),(0,n.A)(this,"videoDropPacketCount",void 0),(0,n.A)(this,"videoDecodeErrorPacketCount",void 0),(0,n.A)(this,"videoEncodeErrorFrameCount",void 0),(0,n.A)(this,"videoFrameDecodeCount",void 0),(0,n.A)(this,"videoPacketEncodeCount",void 0),(0,n.A)(this,"videoFrameRenderCount",void 0),(0,n.A)(this,"videoFrameDropCount",void 0),(0,n.A)(this,"keyFrameCount",void 0),(0,n.A)(this,"bufferDropBytes",void 0),(0,n.A)(this,"bufferReceiveBytes",void 0),(0,n.A)(this,"bufferOutputBytes",void 0),(0,n.A)(this,"audioBitrate",void 0),(0,n.A)(this,"videoBitrate",void 0),(0,n.A)(this,"videoDecodeFramerate",void 0),(0,n.A)(this,"videoRenderFramerate",void 0),(0,n.A)(this,"videoEncodeFramerate",void 0),(0,n.A)(this,"audioDecodeFramerate",void 0),(0,n.A)(this,"audioRenderFramerate",void 0),(0,n.A)(this,"audioEncodeFramerate",void 0),(0,n.A)(this,"audioFrameDecodeIntervalMax",void 0),(0,n.A)(this,"audioFrameRenderIntervalMax",void 0),(0,n.A)(this,"videoFrameDecodeIntervalMax",void 0),(0,n.A)(this,"videoFrameRenderIntervalMax",void 0),(0,n.A)(this,"bandwidth",void 0),(0,n.A)(this,"jitter",void 0),(0,n.A)(this,"audioStutter",void 0),(0,n.A)(this,"videoStutter",void 0),(0,n.A)(this,"audiocodec",void 0),(0,n.A)(this,"videocodec",void 0),(0,n.A)(this,"firstAudioMuxDts",void 0),(0,n.A)(this,"lastAudioMuxDts",void 0),(0,n.A)(this,"firstVideoMuxDts",void 0),(0,n.A)(this,"lastVideoMuxDts",void 0)}}i=u.prototype,(s=new(a())).set("channels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("audioFrameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("audioPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("audioPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("audioPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),s.set("audioDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),s.set("audioDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),s.set("audioEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),s.set("audioFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),s.set("audioPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),s.set("audioFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),s.set("audioFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),s.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),s.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),s.set("keyFrameInterval",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),s.set("gop",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),s.set("videoPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),s.set("videoPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),s.set("videoPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),s.set("videoDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),s.set("videoDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),s.set("videoEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),s.set("videoFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),s.set("videoPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),s.set("videoFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),s.set("videoFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:168,8:0}),s.set("keyFrameCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:176,8:0}),s.set("bufferDropBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:184,8:0}),s.set("bufferReceiveBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),s.set("bufferOutputBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),s.set("audioBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),s.set("videoBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:212,8:0}),s.set("videoDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),s.set("videoRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),s.set("videoEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),s.set("audioDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:228,8:0}),s.set("audioRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),s.set("audioEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:236,8:0}),s.set("audioFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),s.set("audioFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:244,8:0}),s.set("videoFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:248,8:0}),s.set("videoFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),s.set("bandwidth",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),s.set("jitter",{0:19,1:0,2:0,3:0,4:0,5:0,6:0,7:264,8:0}),s.set("audioStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),s.set("videoStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:276,8:0}),s.set("firstAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),s.set("lastAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),s.set("firstVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:296,8:0}),s.set("lastVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:304,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,8),(0,h.A)(i,c.g7,312),(0,h.A)(i,c.JY,s)},51170:(t,e,r)=>{"use strict";r.d(e,{default:()=>At});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(54001),h=r.n(c),u=r(61499),f=r(12085),d=r(12264),l=r(73783),p=r(74503),m=r(63939),g=r(9599),A=r(29170),v=r(50932),w=r(94300),y=r(77162),b=r(87243),k=r(72480),_=r(31138),x=r(18667),I=r(88506),M=r(8284),P=r(67672),C=r(95335),B=r(76045),T=r(8507),E=r(26429),U=r(4624),S=r(95797),R=r(86834),L=r(44328),D=r(77231),F=r(14686),$=r(94663),z=r(68175),O=r(41678),N=r(62751),W=r(45597),V=r(30128),j=r(84149),G=r(9705),H=r(1984),q=r(37837),K=r(71766),Y=r(59475),Q=r(96172),J=r(62636),Z=r(56024),X=r(71517),tt=r(58469),et=r(65451),rt=r(20620),it=r(53e3),st=r(90412),nt=r(58919),ot=r(13724),at=r(38656),ct=r(96467),ht=r(86932),ut=r(54058),ft=r(86368),dt=r(10922),lt=r(548),pt="src/avtranscoder/AVTranscoder.ts";class mt{constructor(){(0,n.A)(this,"avpacketList",void 0),(0,n.A)(this,"avframeList",void 0),(0,n.A)(this,"avpacketListMutex",void 0),(0,n.A)(this,"avframeListMutex",void 0)}}i=mt.prototype,(s=new(a())).set("avpacketList",{0:d.A,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("avframeList",{0:d.A,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("avpacketListMutex",{0:l.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("avframeListMutex",{0:l.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),(0,f.A)(i,u.Og,!0),(0,f.A)(i,u.dc,4),(0,f.A)(i,u.g7,32),(0,f.A)(i,u.JY,s);const gt={enableHardware:!0};class At extends Q.A{constructor(t){super(!0),(0,n.A)(this,"level",U.rD),(0,n.A)(this,"DemuxThreadReady",void 0),(0,n.A)(this,"AudioThreadReady",void 0),(0,n.A)(this,"VideoThreadReady",void 0),(0,n.A)(this,"MuxThreadReady",void 0),(0,n.A)(this,"IOThread",void 0),(0,n.A)(this,"DemuxerThread",void 0),(0,n.A)(this,"MuxThread",void 0),(0,n.A)(this,"AudioDecoderThread",void 0),(0,n.A)(this,"AudioFilterThread",void 0),(0,n.A)(this,"AudioEncoderThread",void 0),(0,n.A)(this,"VideoDecoderThread",void 0),(0,n.A)(this,"VideoFilterThread",void 0),(0,n.A)(this,"VideoEncoderThread",void 0),(0,n.A)(this,"GlobalData",void 0),(0,n.A)(this,"tasks",void 0),(0,n.A)(this,"options",void 0),(0,n.A)(this,"reportTimer",void 0),this.options=C.X$({},gt,t),this.GlobalData=(0,p.A)(mt),l.Ts(this.GlobalData[u.o9]+24),l.Ts(this.GlobalData[u.o9]+28),this.tasks=new(a()),this.reportTimer=new ut.A((()=>{this.report()}),0,1e3),U.pq("create transcoder",pt,277)}async getResource(t,e,r){const i=null!=e?`${t}-${e}`:t;if(At.Resource.has(i))return At.Resource.get(i);const s=this.options.getWasm(t,e,r);let n;return s?(P.Yj(s)||P.sv(s)?(n=await(0,B.A)({source:s}),E._7&&0===r&&(n.threadModule=await(0,B.A)({source:R.A.firefox?s:n.buffer},{child:!0})),delete n.buffer):n=s,At.Resource.set(i,n),n):void 0}report(){this.tasks.forEach((t=>{if(t.startTime){const e=t.stats.videoPacketEncodeCount||t.stats.audioPacketEncodeCount,r=(0,ht.A)()-t.startTime;let i=BigInt(0),s=BigInt(0);if(t.stats.lastVideoMuxDts){const e=t.streams.find((t=>0===m.f[15](t.input.codecpar)));i=t.stats.lastVideoMuxDts-t.stats.firstVideoMuxDts,s=e.output?(0,L.k)(e.output.duration,(0,A.A)(e.output.timeBase,g.P),D.i0):(0,L.k)(e.input.duration,(0,A.A)(e.input.timeBase,g.P),D.i0)}if(t.stats.lastAudioMuxDts&&!i){const e=t.streams.find((t=>1===m.f[15](t.input.codecpar)));i=t.stats.lastAudioMuxDts-t.stats.firstAudioMuxDts,s=e.output?(0,L.k)(e.output.duration,(0,A.A)(e.output.timeBase,g.P),D.i0):(0,L.k)(e.input.duration,(0,A.A)(e.input.timeBase,g.P),D.i0)}const n=r?Number(e)/(r/1e3):Number(e),o=Number(t.stats.bufferOutputBytes)/1e3,a=i?8*o/(Number(i)/1e3):0,c=Number(i)/1e3/(r/1e3)||-1;let h=s?Number(i)/Number(s)*100:0;h>100&&(h=100),U.pq(`[${t.taskId}] frame=${e} fps=${n.toFixed(2)} size=${o}kB time=${(0,lt.iV)(i)} bitrate=${a.toFixed(2)}kbps speed=${c.toFixed(2)}x progress=${h.toFixed(2)}%`,pt,354),this.options.onprogress&&this.options.onprogress(t.taskId,h)}}))}async startDemuxPipeline(){return this.DemuxThreadReady?this.DemuxThreadReady:this.DemuxThreadReady=new(h())((async t=>{this.IOThread=await(0,I.pt)(b.A,{name:"IOThread"},87243).run(),this.IOThread.setLogLevel(this.level),this.DemuxerThread=await(0,I.pt)(k.A,{name:"DemuxerThread"},72480).run(),this.DemuxerThread.setLogLevel(this.level),t()}))}async startVideoPipeline(){return this.VideoThreadReady?this.VideoThreadReady:this.VideoThreadReady=new(h())((async t=>{this.VideoDecoderThread=await(0,I.pt)(_.A,{name:"VideoDecoderThread",disableWorker:R.A.safari&&!R.A.checkVersion(R.A.version,"16.1",!0)},31138).run(),this.VideoDecoderThread.setLogLevel(this.level),this.VideoFilterThread=await(0,I.pt)(at.A,{name:"VideoFilterThread",disableWorker:R.A.safari&&!R.A.checkVersion(R.A.version,"16.1",!0)},38656).run(),this.VideoFilterThread.setLogLevel(this.level),this.VideoEncoderThread=await(0,I.pt)(O.A,{name:"VideoEncoderThread",disableWorker:R.A.safari&&!R.A.checkVersion(R.A.version,"16.1",!0)},41678).run(),this.VideoEncoderThread.setLogLevel(this.level),t()}))}async startAudioPipeline(){return this.AudioThreadReady?this.AudioThreadReady:this.AudioThreadReady=new(h())((async t=>{this.AudioDecoderThread=await(0,I.pt)(x.A,{name:"AudioDecoderThread",disableWorker:R.A.safari&&!R.A.checkVersion(R.A.version,"16.1",!0)},18667).run(),this.AudioDecoderThread.setLogLevel(this.level),this.AudioFilterThread=await(0,I.pt)(at.A,{name:"AudioFilterThread",disableWorker:R.A.safari&&!R.A.checkVersion(R.A.version,"16.1",!0)},38656).run(),this.AudioFilterThread.setLogLevel(this.level),this.AudioEncoderThread=await(0,I.pt)(z.A,{name:"AudioEncoderThread",disableWorker:R.A.safari&&!R.A.checkVersion(R.A.version,"16.1",!0)},68175).run(),this.AudioEncoderThread.setLogLevel(this.level),t()}))}async startMuxPipeline(){return this.MuxThreadReady?this.MuxThreadReady:this.MuxThreadReady=new(h())((async t=>{this.MuxThread=await(0,I.pt)(W.A,{name:"MuxThread",disableWorker:!S.A.workerMSE},45597).run(),this.MuxThread.setLogLevel(this.level),t()}))}isHls(t){return t.ext?"m3u8"===t.ext||"m3u"===t.ext:"hls"===t.options.input.protocol}isDash(t){return t.ext?"mpd"===t.ext:"dash"===t.options.input.protocol}async ready(){await this.startDemuxPipeline(),await this.startAudioPipeline(),await this.startVideoPipeline(),await this.startMuxPipeline(),U.pq("AVTranscoder pipelines started",pt,466)}copyAVStreamInterface(t,e){const r=C.X$({},e);return r.codecpar=(0,q.Gy)(168),(0,K.Yi)(r.codecpar,e.codecpar),r.timeBase=(0,q.Gy)(8),v.M[15](r.timeBase+4,m.f[15](e.timeBase+4)),v.M[15](r.timeBase,m.f[15](e.timeBase)),m.f[20](r.codecpar+12)&&((0,q.Eb)(m.f[20](r.codecpar+12)),v.M[20](r.codecpar+12,0),v.M[15](r.codecpar+16,0)),t.options.duration&&(r.duration=(0,L.k)(BigInt(Math.floor(t.options.duration)),D.i0,(0,A.A)(r.timeBase,g.P))),r}async setTaskInput(t){const e=t.taskId,r=t.options,i=t.ioloader2DemuxerChannel=(0,ft.A)(),s=t.stats;let n,o=0;var a;if(P.Yj(r.input.file))n=T.qg(r.input.file).file.split(".").pop(),o=await this.IOThread.registerTask.transfer(i.port1).invoke({type:null!==(a=N.$$[n])&&void 0!==a?a:0,info:{url:r.input.file},range:{from:-1,to:-1},taskId:e,options:{isLive:!1},rightPort:i.port1,stats:s[u.o9]});else if(r.input.file instanceof File)n=r.input.file.name.split(".").pop(),o=await this.IOThread.registerTask.transfer(i.port1).invoke({type:1,info:{file:r.input.file},range:{from:-1,to:-1},taskId:e,options:{isLive:!1},rightPort:i.port1,stats:s[u.o9]});else{const e=t.inputIPCPort=new j.Ay(i.port1);e.on(j.S3,(async r=>{switch(r.method){case"open":e.reply(r,{});break;case"read":{const i=r.params.pointer,s=r.params.length,n=(0,F.JW)(i,s);try{const i=await t.options.input.file.readToBuffer(s,n);t.stats.bufferReceiveBytes+=BigInt(Math.floor(i)),e.reply(r,i)}catch(i){U.z3(`loader read error, ${i}, taskId: ${t.taskId}`,pt,565),e.reply(r,G.LR)}break}case"seek":{const i=r.params.pos;try{await t.options.input.file.seek(i),e.reply(r)}catch(i){U.z3(`loader seek error, ${i}, taskId: ${t.taskId}`,pt,582),e.reply(r,null,i)}break}case"size":e.reply(r,await t.options.input.file.fileSize())}}))}n&&(t.ext=n),o<0&&U.h2(`register io task failed, ret: ${o}, taskId: ${e}`,pt,601)}async setTaskOutput(t){const e=t.muxer2OutputChannel=(0,ft.A)(),r=t.outputIPCPort=new j.Ay(e.port2);let i;if(t.options.output.format)i=N.iW[t.options.output.format];else if(t.options.output.file instanceof FileSystemFileHandle){let e=t.options.output.file.name.split(".").pop();i=N.HR[e]}P.ai(i)||U.h2("invalid output format",pt,620),t.format=i;let s,n=await this.MuxThread.registerTask.transfer(e.port1).invoke({taskId:t.taskId,format:i,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,stats:t.stats[u.o9],rightPort:e.port1});n<0&&U.h2(`register mux task failed, ret: ${n}, taskId: ${t.taskId}`,pt,636),t.options.output.file instanceof FileSystemFileHandle?(s=t.safeFileIO=new Y.A(t.options.output.file),await t.safeFileIO.ready()):s={write:e=>{t.options.output.file.writeBuffer(e)},appendBufferByPosition:(e,r)=>{t.options.output.file.flush(),t.options.output.file.writeBuffer(e),t.options.output.file.flushToPos(BigInt(Math.floor(r)))},seek:e=>{t.options.output.file.seek(BigInt(Math.floor(e)))},close:()=>{t.options.output.file.flush()}},r.on(j.Wo,(async e=>{switch(e.method){case"write":try{if(null!=e.params.pos?s.appendBufferByPosition(e.params.data,Number(e.params.pos)):s.write(e.params.data),t.options.output.file instanceof FileSystemFileHandle&&t.safeFileIO.writeQueueSize>5){for(await this.MuxThread.pause(t.taskId);t.safeFileIO.writeQueueSize>5;)await new ot.A(0);await this.MuxThread.unpause(t.taskId)}}catch(e){U.z3(`ioWriter write error, ${e}, taskId: ${t.taskId}`,pt,690)}break;case"seek":{const r=e.params.pos;try{s.seek(Number(r))}catch(e){U.z3(`ioWriter seek error, ${e}, taskId: ${t.taskId}`,pt,703)}break}case"end":await s.close(),await this.clearTask(t),this.fire(J.X,[t.taskId]),U.pq(`transcode ended, taskId: ${t.taskId}, cost: ${(0,lt.iV)(BigInt(Math.floor((0,ht.A)()-t.startTime)))}`,pt,711);break;case"error":await s.close(),await this.clearTask(t),this.fire(J.L,[t.taskId]),U.pq(`transcode error, taskId: ${t.taskId}`,pt,719)}}))}async analyzeInputStreams(t){const e=t.taskId,r=t.ioloader2DemuxerChannel,i=t.ext,s=t.stats;let n,o=0;if(this.isDash(t)){await this.IOThread.open(e);const o=await this.IOThread.hasAudio(e),a=await this.IOThread.hasVideo(e);o&&a?(n=(0,M.A)(),await this.DemuxerThread.registerTask.transfer(r.port2,t.controller.getDemuxerRenderControlPort()).invoke({taskId:e,leftPort:r.port2,controlPort:t.controller.getDemuxerRenderControlPort(),format:N.HR[i],stats:s[u.o9],isLive:!1,flags:2,ioloaderOptions:{mediaType:"audio"},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24}),await this.DemuxerThread.registerTask({taskId:n,mainTaskId:e,flags:2,format:N.HR[i],stats:s[u.o9],isLive:!1,ioloaderOptions:{mediaType:"video"},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})):await this.DemuxerThread.registerTask.transfer(r.port2,t.controller.getDemuxerRenderControlPort()).invoke({taskId:e,leftPort:r.port2,controlPort:t.controller.getDemuxerRenderControlPort(),format:N.HR[i],stats:s[u.o9],isLive:!1,flags:2,ioloaderOptions:{mediaType:o?"audio":"video"},avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24})}else await this.DemuxerThread.registerTask.transfer(r.port2,t.controller.getDemuxerRenderControlPort()).invoke({taskId:e,leftPort:r.port2,controlPort:t.controller.getDemuxerRenderControlPort(),format:N.HR[i],stats:s[u.o9],isLive:!1,flags:this.isHls(t)?2:0,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24});o=await this.DemuxerThread.openStream(e,1e4),o<0&&U.h2(`open stream failed, ret: ${o}, taskId: ${e}`,pt,809);let a=await this.DemuxerThread.analyzeStreams(e);if(!P.ai(a)&&a.streams.length||U.h2(`analyze stream failed, ret: ${a}`,pt,813),n){o=await this.DemuxerThread.openStream(n,1e4),o<0&&U.h2(`open stream failed, ret: ${o}, taskId: ${e}`,pt,819);const t=await this.DemuxerThread.analyzeStreams(n);!P.ai(t)&&t.streams.length||U.h2(`analyze stream failed, ret: ${t}`,pt,823),a.streams=a.streams.concat(t.streams)}if(n&&(t.subTaskId=n),U.pq("\n"+(0,lt.Ay)([a],[{from:P.Yj(t.options.input.file)?t.options.input.file:t.options.input.file instanceof File?t.options.input.file.name:"ioReader",tag:"Input"}]),pt,832),this.isHls(t)||this.isDash(t)){const t=1e3*await this.IOThread.getDuration(e);if(t>0)for(let e=0;e<a.streams.length;e++)a.streams[e].duration=(0,L.k)(BigInt(Math.floor(t)),D.i0,(0,A.A)(a.streams[e].timeBase,g.P))}return a}async handleAudioStream(t,e){const r=e.options.output.audio;if(null!=r&&r.disable)return 0;if("copy"!==(null==r?void 0:r.codec)||e.options.start||e.options.duration){const i=(0,ft.A)(),s=(0,ft.A)(),n=(0,ft.A)(),o=(0,ft.A)(),a=this.copyAVStreamInterface(e,t),c=(0,M.A)();let h=0;if(r){if(r.codec){const e=N.n1[r.codec];P.ai(e)||U.h2(`invalid codec name(${r.codec})`,pt,893),v.M[15](a.codecpar+4,e),m.f[15](a.codecpar+4)!==m.f[15](t.codecpar+4)&&(v.M[15](a.codecpar+48,D.N_),v.M[15](a.codecpar+52,D.N_))}if(r.bitrate&&v.M[17](a.codecpar+32,BigInt(Math.floor(r.bitrate))),r.channels&&v.M[15](a.codecpar+116,r.channels),r.sampleRate&&v.M[15](a.codecpar+136,r.sampleRate),r.sampleFmt){const t=N.Sz[r.sampleFmt];P.ai(t)||U.h2(`invalid sampleFmt name(${r.sampleFmt})`,pt,914),v.M[15](a.codecpar+28,t)}r.profile&&v.M[15](a.codecpar+48,r.profile)}m.f[15](a.codecpar+48)===D.N_&&(86018===m.f[15](a.codecpar+4)?v.M[15](a.codecpar+48,2):86017===m.f[15](a.codecpar+4)&&v.M[15](a.codecpar+48,34)),await this.DemuxerThread.connectStreamTask.transfer(i.port1).invoke(e.taskId,t.index,i.port1);let f=await this.getResource("decoder",m.f[15](t.codecpar+4),m.f[15](t.codecpar));if(f||(S.A.audioDecoder?(await AudioDecoder.isConfigSupported({codec:(0,$.A)(t.codecpar),sampleRate:m.f[15](t.codecpar+136),numberOfChannels:m.f[15](t.codecpar+116)})).supported||U.h2(`AudioDecoder codecId ${m.f[15](t.codecpar+4)} not support`,pt,945):U.h2(`audio decoder codecId ${m.f[15](t.codecpar+4)} not support`,pt,949)),await this.AudioDecoderThread.registerTask.transfer(i.port2,n.port1).invoke({taskId:c,resource:f,leftPort:i.port2,rightPort:n.port1,stats:e.stats[u.o9],avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,timeBase:{num:m.f[15](t.timeBase),den:m.f[15](t.timeBase+4)}}),h=await this.AudioDecoderThread.open(c,t.codecpar),h<0)return U.z3(`cannot open audio ${(0,lt.eG)(m.f[15](t.codecpar),m.f[15](t.codecpar+4))} decoder`,pt,975),h;let d=await this.getResource("resampler");d||U.h2("resampler not found",pt,981);const l=[],p=[];let w,y;const b=(0,ct.Fn)("resampler",{resource:d,output:{channels:m.f[15](a.codecpar+116),sampleRate:m.f[15](a.codecpar+136),format:m.f[15](a.codecpar+28)}});if(l.push(b),w={id:b.id,port:n.port2},y={id:b.id,port:o.port1},e.options.start||e.options.duration){const r=(0,L.k)(BigInt(Math.floor(e.options.start||0)),D.i0,(0,A.A)(t.timeBase,g.P)),i=(0,ct.Fn)("range",{start:r,end:e.options.duration?(0,L.k)(BigInt(Math.floor(e.options.duration)),D.i0,(0,A.A)(t.timeBase,g.P))+r:-BigInt(1)});l.push(i),w={id:i.id,port:n.port2},p.push({parent:i.id,child:b.id})}await this.AudioFilterThread.registerTask.transfer(n.port2,o.port1).invoke({taskId:c,graph:{vertices:l,edges:p},inputPorts:[w],outputPorts:[y],stats:e.stats[u.o9],avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28});let k=await this.getResource("encoder",m.f[15](a.codecpar+4),m.f[15](a.codecpar));return k||(S.A.audioEncoder?(await AudioEncoder.isConfigSupported({codec:(0,H.A)(a.codecpar),sampleRate:m.f[15](a.codecpar+136),numberOfChannels:m.f[15](a.codecpar+116),bitrate:0|Number(0xffffffffn&m.f[17](a.codecpar+32)),bitrateMode:"constant"})).supported||U.h2(`AudioEncoder ${(0,lt.eG)(m.f[15](a.codecpar),m.f[15](a.codecpar+4))} codecId ${m.f[15](a.codecpar+4)} not support`,pt,1052):U.h2(`${(0,lt.eG)(m.f[15](a.codecpar),m.f[15](a.codecpar+4))} encoder codecId ${m.f[15](a.codecpar+4)} not support`,pt,1056)),await this.AudioEncoderThread.registerTask.transfer(o.port2,s.port1).invoke({taskId:c,resource:k,leftPort:o.port2,rightPort:s.port1,stats:e.stats[u.o9],avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28}),h=await this.AudioEncoderThread.open(c,a.codecpar,{num:m.f[15](a.timeBase),den:m.f[15](a.timeBase+4)}),h<0?(U.z3(`cannot open audio ${(0,lt.eG)(m.f[15](a.codecpar),m.f[15](a.codecpar+4))} encoder`,pt,1078),h):(await this.MuxThread.addStream.transfer(s.port2).invoke(e.taskId,a,s.port2),e.streams.push({taskId:c,input:t,output:a,demuxer2DecoderChannel:i,decoder2FilterChannel:n,filter2EncoderChannel:o,encoder2MuxerChannel:s}),0)}{const r=(0,ft.A)();return await this.DemuxerThread.connectStreamTask.transfer(r.port1).invoke(e.taskId,t.index,r.port1),await this.MuxThread.addStream.transfer(r.port2).invoke(e.taskId,t,r.port2),e.streams.push({input:t,demuxer2MuxerChannel:r}),0}}async handleVideoStream(t,e){const r=e.options.output.video;if(null!=r&&r.disable)return 0;if("copy"!==(null==r?void 0:r.codec)||e.options.start||e.options.duration){var i;const s=(0,ft.A)(),n=(0,ft.A)(),o=(0,ft.A)(),a=(0,ft.A)(),c=this.copyAVStreamInterface(e,t),h=(0,M.A)();let f=0;if(r){if(r.codec){const e=N._R[r.codec];P.ai(e)||U.h2(`invalid codec name(${r.codec})`,pt,1139),v.M[15](c.codecpar+4,e),m.f[15](c.codecpar+4)!==m.f[15](t.codecpar+4)&&(v.M[15](c.codecpar+48,D.N_),v.M[15](c.codecpar+52,D.N_))}if(r.width&&v.M[15](c.codecpar+56,r.width),r.height&&v.M[15](c.codecpar+60,r.height),r.bitrate&&v.M[17](c.codecpar+32,BigInt(Math.floor(r.bitrate))),r.pixfmt){const t=N.qO[r.pixfmt];P.ai(t)||U.h2(`invalid pixfmt name(${r.pixfmt})`,pt,1160),v.M[15](c.codecpar+28,t)}r.framerate&&(v.M[15](c.codecpar+72,r.framerate>>>0),v.M[15](c.codecpar+76,1)),r.aspect&&(v.M[15](c.codecpar+68,r.aspect.den),v.M[15](c.codecpar+64,r.aspect.num)),r.profile&&v.M[15](c.codecpar+48,r.profile),r.level&&v.M[15](c.codecpar+52,r.level),r.delay&&v.M[15](c.codecpar+104,r.delay)}m.f[15](c.codecpar+48)===D.N_&&(27===m.f[15](c.codecpar+4)?v.M[15](c.codecpar+48,100):173===m.f[15](c.codecpar+4)?v.M[15](c.codecpar+48,1):196===m.f[15](c.codecpar+4)||(225===m.f[15](c.codecpar+4)||167===m.f[15](c.codecpar+4))&&v.M[15](c.codecpar+48,0)),m.f[15](c.codecpar+52)===D.N_&&(27===m.f[15](c.codecpar+4)?v.M[15](c.codecpar+52,rt.k9(m.f[15](c.codecpar+56),m.f[15](c.codecpar+60),(0,L.lb)((0,A.A)(c.codecpar+72,g.P)))):173===m.f[15](c.codecpar+4)?v.M[15](c.codecpar+52,it.k9(m.f[15](c.codecpar+48),m.f[15](c.codecpar+56),m.f[15](c.codecpar+60),(0,L.lb)((0,A.A)(c.codecpar+72,g.P)),Number(m.f[17](c.codecpar+32)))):196===m.f[15](c.codecpar+4)||(225===m.f[15](c.codecpar+4)?v.M[15](c.codecpar+52,st.k9(m.f[15](c.codecpar+56),m.f[15](c.codecpar+60),(0,L.lb)((0,A.A)(c.codecpar+72,g.P)))):167===m.f[15](c.codecpar+4)&&v.M[15](c.codecpar+52,nt.k9(m.f[15](c.codecpar+56),m.f[15](c.codecpar+60),(0,L.lb)((0,A.A)(c.codecpar+72,g.P)))))),r&&null!=r.delay||v.M[15](c.codecpar+104,4),27!==m.f[15](c.codecpar+4)&&173!==m.f[15](c.codecpar+4)&&196!==m.f[15](c.codecpar+4)||(2===e.format?v.M[15](c.codecpar+160,2):v.M[15](c.codecpar+160,1)),await this.DemuxerThread.connectStreamTask.transfer(s.port1).invoke(e.subTaskId||e.taskId,t.index,s.port1);let d=await this.getResource("decoder",m.f[15](t.codecpar+4),m.f[15](t.codecpar));if(d||(S.A.videoDecoder?(await VideoDecoder.isConfigSupported({codec:(0,$.A)(t.codecpar)})).supported||U.h2(`VideoDecoder codecId ${m.f[15](t.codecpar+4)} not support`,pt,1251):U.h2(`video decoder codecId ${m.f[15](t.codecpar+4)} not support`,pt,1255)),await this.VideoDecoderThread.registerTask.transfer(s.port2,o.port1).invoke({taskId:h,resource:d,leftPort:s.port2,rightPort:o.port1,stats:e.stats[u.o9],enableHardware:this.options.enableHardware,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28}),f=await this.VideoDecoderThread.open(h,t.codecpar),f<0)return U.z3(`cannot open video ${(0,lt.eG)(m.f[15](t.codecpar),m.f[15](t.codecpar+4))} decoder`,pt,1278),f;let l=await this.getResource("scaler");l||U.h2("scaler not found",pt,1284);const p=[],w=[];let y,b,k;const _=(0,ct.Fn)("scaler",{resource:l,output:{width:m.f[15](c.codecpar+56),height:m.f[15](c.codecpar+60),format:m.f[15](c.codecpar+28)}});if(p.push(_),y={id:_.id,port:o.port2},b={id:_.id,port:a.port1},e.options.start||e.options.duration){const r=(0,L.k)(BigInt(Math.floor(e.options.start||0)),D.i0,(0,A.A)(t.timeBase,g.P)),i=(0,ct.Fn)("range",{start:r,end:e.options.duration?(0,L.k)(BigInt(Math.floor(e.options.duration)),D.i0,(0,A.A)(t.timeBase,g.P))+r:-BigInt(1)});p.push(i),y={id:i.id,port:o.port2},w.push({parent:i.id,child:_.id}),k=i.id}if((0,L.lb)((0,A.A)(t.codecpar+72,g.P))>(0,L.lb)((0,A.A)(c.codecpar+72,g.P))){const e=(0,ct.Fn)("framerate",{framerate:{num:m.f[15](c.codecpar+72),den:m.f[15](c.codecpar+76)},timeBase:{num:m.f[15](t.timeBase),den:m.f[15](t.timeBase+4)}});p.push(e),w.length=0,k?(w.push({parent:k,child:e.id}),w.push({parent:e.id,child:_.id})):(y={id:e.id,port:o.port2},w.push({parent:e.id,child:_.id}))}await this.VideoFilterThread.registerTask.transfer(o.port2,a.port1).invoke({taskId:h,graph:{vertices:p,edges:w},inputPorts:[y],outputPorts:[b],stats:e.stats[u.o9],avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28});let x=await this.getResource("encoder",m.f[15](c.codecpar+4),m.f[15](c.codecpar));return x||(S.A.videoEncoder?(await VideoEncoder.isConfigSupported({codec:(0,$.A)(c.codecpar),width:m.f[15](c.codecpar+56),height:m.f[15](c.codecpar+60)})).supported||U.h2(`VideoEncoder ${(0,lt.eG)(m.f[15](c.codecpar),m.f[15](c.codecpar+4))} codecId ${m.f[15](c.codecpar+4)} not support`,pt,1393):U.h2(`${(0,lt.eG)(m.f[15](c.codecpar),m.f[15](c.codecpar+4))} encoder codecId ${m.f[15](c.codecpar+4)} not support`,pt,1397)),await this.VideoEncoderThread.registerTask.transfer(a.port2,n.port1).invoke({taskId:h,resource:x,leftPort:a.port2,rightPort:n.port1,stats:e.stats[u.o9],enableHardware:this.options.enableHardware,avpacketList:this.GlobalData[u.o9],avpacketListMutex:this.GlobalData[u.o9]+24,avframeList:this.GlobalData[u.o9]+12,avframeListMutex:this.GlobalData[u.o9]+28,gop:(0,L.lb)((0,A.A)(c.codecpar+72,g.P))*(null!==(i=null==r?void 0:r.keyFrameInterval)&&void 0!==i?i:5e3)/1e3|0}),f=await this.VideoEncoderThread.open(h,c.codecpar,{num:m.f[15](c.timeBase),den:m.f[15](c.timeBase+4)}),f<0?(U.z3(`cannot open video ${(0,lt.eG)(m.f[15](c.codecpar),m.f[15](c.codecpar+4))} encoder`,pt,1421),f):(await this.MuxThread.addStream.transfer(n.port2).invoke(e.taskId,c,n.port2),e.streams.push({taskId:h,input:t,output:c,demuxer2DecoderChannel:s,decoder2FilterChannel:o,filter2EncoderChannel:a,encoder2MuxerChannel:n}),0)}{const r=(0,ft.A)();return await this.DemuxerThread.connectStreamTask.transfer(r.port1).invoke(e.subTaskId||e.taskId,t.index,r.port1),await this.MuxThread.addStream.transfer(r.port2).invoke(e.taskId,t,r.port2),e.streams.push({input:t,demuxer2MuxerChannel:r}),0}}async handleCopyStream(t,e){const r=(0,ft.A)();return await this.DemuxerThread.connectStreamTask.transfer(r.port1).invoke(e.subTaskId||e.taskId,t.index,r.port1),await this.MuxThread.addStream.transfer(r.port2).invoke(e.taskId,t,r.port2),e.streams.push({input:t,demuxer2MuxerChannel:r}),0}async clearTask(t){this.MuxThread.unregisterTask(t.taskId);for(let e=0;e<t.streams.length;e++)t.streams[e].taskId&&(1===m.f[15](t.streams[e].input.codecpar)?(await this.AudioEncoderThread.unregisterTask(t.streams[e].taskId),await this.AudioFilterThread.unregisterTask(t.streams[e].taskId),await this.AudioDecoderThread.unregisterTask(t.streams[e].taskId)):0===m.f[15](t.streams[e].input.codecpar)&&(await this.VideoEncoderThread.unregisterTask(t.streams[e].taskId),await this.VideoFilterThread.unregisterTask(t.streams[e].taskId),await this.VideoDecoderThread.unregisterTask(t.streams[e].taskId))),t.streams[e].output&&((0,K.dn)(t.streams[e].output.codecpar),(0,q.Eb)(t.streams[e].output.timeBase));this.DemuxerThread.unregisterTask(t.taskId),t.subTaskId&&this.DemuxerThread.unregisterTask(t.subTaskId),this.IOThread.unregisterTask(t.taskId),t.inputIPCPort&&t.inputIPCPort.destroy(),t.outputIPCPort&&t.outputIPCPort.destroy(),t.safeFileIO&&t.safeFileIO.destroy(),t.stats&&(0,w.A)(t.stats),this.tasks.delete(t.taskId),this.tasks.size||this.reportTimer.stop()}async addTask(t){var e,r;null!==(e=t.output.audio)&&void 0!==e&&e.disable&&null!==(r=t.output.video)&&void 0!==r&&r.disable&&U.h2("audio and video are all disable",pt,1509);const i=(0,M.A)(),s={taskId:i,startTime:0,options:t,ioloader2DemuxerChannel:null,muxer2OutputChannel:null,stats:(0,p.A)(V.A),format:-1,streams:[],formatContext:null,controller:new dt.A(this)};try{let t=0;await this.setTaskInput(s),await this.setTaskOutput(s);const e=s.formatContext=await this.analyzeInputStreams(s);for(let r=0;r<e.streams.length;r++){const i=m.f[15](e.streams[r].codecpar);if(t=1===i?await this.handleAudioStream(e.streams[r],s):0===i?await this.handleVideoStream(e.streams[r],s):await this.handleCopyStream(e.streams[r],s),t<0)throw new Error(`config transcode error, ret: ${t}`)}const r={streams:[],format:s.format,metadata:{}};let n="\nStream mapping:\n";return s.streams.forEach((t=>{t.output?(r.streams.push(t.output),n+=`  Stream #0:${t.input.index} -> #0:${t.output.index} (${(0,lt.eG)(m.f[15](t.input.codecpar),m.f[15](t.input.codecpar+4))} -> ${(0,lt.eG)(m.f[15](t.output.codecpar),m.f[15](t.output.codecpar+4))})\n`):(r.streams.push(t.input),n+=`  Stream #0:${t.input.index} -> #0:${t.output.index} (${(0,lt.eG)(m.f[15](t.input.codecpar),m.f[15](t.input.codecpar+4))} -> copy)\n`)})),U.pq(n,pt,1572),U.pq("\n"+(0,lt.Ay)([r],[{from:s.options.output.file instanceof FileSystemFileHandle?s.options.output.file.name:"IOWriter",tag:"Output"}]),pt,1573),this.tasks.set(i,s),i}catch(t){throw await this.clearTask(s),t}}async startTask(t){const e=this.tasks.get(t);if(e){e.options.start&&await this.DemuxerThread.seek(e.taskId,BigInt(Math.floor(e.options.start)),16);let r=0;if(await this.DemuxerThread.startDemux(t,!1,10),r=await this.MuxThread.open(t),r<0)throw await this.clearTask(e),new Error(`start transcode error, ret ${r}`);const i=e.streams;for(let t=0;t<i.length;t++){if(!i[t].output)continue;let r,s=!1;if(1===m.f[15](i[t].output.codecpar))r=await this.AudioEncoderThread.getExtraData(i[t].taskId);else if(0===m.f[15](i[t].output.codecpar)){r=await this.VideoEncoderThread.getExtraData(i[t].taskId);const e=await this.VideoEncoderThread.getColorSpace(i[t].taskId);e&&(v.M[15](i[t].output.codecpar+96,e.colorSpace),v.M[15](i[t].output.codecpar+88,e.colorPrimaries),v.M[15](i[t].output.codecpar+92,e.colorTrc),s=!0)}if(!r){const e=m.f[15](i[t].output.codecpar+4);86018===e?r=tt.Ij((0,A.A)(i[t].output.codecpar,y.A)):86076===e&&(r=et.Ij((0,A.A)(i[t].output.codecpar,y.A)))}if(r){const e=(0,q.sY)(r.length);(0,F.lW)(e,r.length,r),v.M[20](i[t].output.codecpar+12,e),v.M[15](i[t].output.codecpar+16,r.length),s=!0}s&&await this.MuxThread.updateAVCodecParameters(e.taskId,i[t].output.index,i[t].output.codecpar)}if(r=await this.MuxThread.start(t),r<0)throw await this.clearTask(e),new Error(`start transcode error, ret ${r}`);e.startTime=(0,ht.A)(),this.reportTimer.isStarted()||this.reportTimer.start()}else U.h2(`task ${t} not found`,pt,1658)}async pauseTask(t){this.tasks.get(t)?await this.MuxThread.pause(t):U.h2(`task ${t} not found`,pt,1668)}async unpauseTask(t){this.tasks.get(t)?await this.MuxThread.unpause(t):U.h2(`task ${t} not found`,pt,1678)}async cancelTask(t){const e=this.tasks.get(t);e?(await this.MuxThread.unpause(t),await this.clearTask(e)):U.h2(`task ${t} not found`,pt,1689)}async destroy(){this.MuxThread&&(await this.MuxThread.clear(),(0,I.nE)(this.MuxThread)),this.AudioEncoderThread&&(await this.AudioEncoderThread.clear(),(0,I.nE)(this.AudioEncoderThread)),this.AudioFilterThread&&(await this.AudioFilterThread.clear(),(0,I.nE)(this.AudioFilterThread)),this.AudioDecoderThread&&(await this.AudioDecoderThread.clear(),(0,I.nE)(this.AudioDecoderThread)),this.VideoEncoderThread&&(await this.VideoEncoderThread.clear(),(0,I.nE)(this.VideoEncoderThread)),this.VideoFilterThread&&(await this.VideoFilterThread.clear(),(0,I.nE)(this.VideoFilterThread)),this.VideoDecoderThread&&(await this.VideoDecoderThread.clear(),(0,I.nE)(this.VideoDecoderThread)),this.DemuxerThread&&(await this.DemuxerThread.clear(),(0,I.nE)(this.DemuxerThread)),this.IOThread&&(await this.IOThread.clear(),(0,I.nE)(this.IOThread)),this.VideoEncoderThread=null,this.VideoFilterThread=null,this.VideoDecoderThread=null,this.AudioEncoderThread=null,this.AudioFilterThread=null,this.AudioDecoderThread=null,this.DemuxerThread=null,this.IOThread=null,this.MuxThread=null,this.GlobalData&&(this.GlobalData.avframeList.clear((t=>{(0,Z.to)(t)}),20),this.GlobalData.avpacketList.clear((t=>{(0,X.Up)(t)}),20),l.zr(this.GlobalData[u.o9]+24),l.zr(this.GlobalData[u.o9]+28),(0,w.A)(this.GlobalData),this.GlobalData=null),U.pq("AVTranscoder pipelines stopped",pt,1756)}setLogLevel(t){this.level=t,U.V$(t),this.IOThread&&this.IOThread.setLogLevel(t),this.DemuxerThread&&this.DemuxerThread.setLogLevel(t),this.AudioDecoderThread&&this.AudioDecoderThread.setLogLevel(t),this.AudioFilterThread&&this.AudioFilterThread.setLogLevel(t),this.AudioEncoderThread&&this.AudioEncoderThread.setLogLevel(t),this.VideoDecoderThread&&this.VideoDecoderThread.setLogLevel(t),this.VideoFilterThread&&this.VideoFilterThread.setLogLevel(t),this.VideoEncoderThread&&this.VideoEncoderThread.setLogLevel(t),this.MuxThread&&this.MuxThread.setLogLevel(t),U.pq(`set log level: ${t}`,pt,1792)}async onGetDecoderResource(t,e){return this.getResource("decoder",e,t)}}(0,n.A)(At,"Resource",new(a()))},10922:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(84149),n=r(86368);class o{constructor(t){(0,i.A)(this,"demuxerControlChannel",void 0),(0,i.A)(this,"demuxerControlIPCPort",void 0),(0,i.A)(this,"observer",void 0),this.observer=t,this.demuxerControlChannel=(0,n.A)(),this.demuxerControlIPCPort=new s.Ay(this.demuxerControlChannel.port2),this.demuxerControlIPCPort.on(s.S3,(async t=>{"getDecoderResource"===t.method&&this.demuxerControlIPCPort.reply(t,await this.observer.onGetDecoderResource(t.params.mediaType,t.params.codecId))}))}getDemuxerRenderControlPort(){return this.demuxerControlChannel.port1}destroy(){this.demuxerControlIPCPort&&this.demuxerControlIPCPort.destroy(),this.demuxerControlChannel=null}}},62636:(t,e,r)=>{"use strict";r.d(e,{L:()=>s,X:()=>i});const i="task-ended",s="task-error"},38656:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var i=r(12264),s=r(29170),n=r(16041),o=r(9705),a=r(44527),c=r(96467),h=r(18812);class u extends a.A{constructor(){super()}async createTask(t){const e=new n.A((0,s.A)(t.avframeList,i.A),t.avframeListMutex),r=(0,c.T$)(t.graph,e);if(!(0,c.iT)(r,t.inputPorts,t.outputPorts))return o.lh;const a=[];for(let e=0;e<t.inputPorts.length;e++){const i=new h.t(t.inputPorts[e].port);a.push(i);const s=r.inputs.find((r=>r.id===t.inputPorts[e].id)),{port:n,index:o}=s.filter.getFreeInputNodePort();i.connect(n),s.filter.addInputPeer(this,o)}for(let e=0;e<t.outputPorts.length;e++){const i=new h.t(t.outputPorts[e].port);a.push(i);const s=r.outputs.find((r=>r.id===t.outputPorts[e].id)),{port:n,index:o}=s.filter.getFreeOutputNodePort();n.connect(i),s.filter.addOutputPeer(this,o)}for(let t=0;t<r.vertices.length;t++)await r.vertices[t].filter.ready();return this.tasks.set(t.taskId,{...t,filterGraph:r,filterPorts:a,avframePool:e}),0}async registerTask(t){return this.tasks.has(t.taskId)?o.lh:this.createTask(t)}async unregisterTask(t){const e=this.tasks.get(t);if(e){for(let t=0;t<e.filterGraph.vertices.length;t++)e.filterGraph.vertices[t].filter.disconnect(),await e.filterGraph.vertices[t].filter.destroy();this.tasks.delete(t)}}}},96467:(t,e,r)=>{"use strict";r.d(e,{Fn:()=>l,T$:()=>p,iT:()=>m});var i=r(80662),s=r.n(i),n=r(53402),o=r(54903),a=r(84624),c=r(57473),h=r(4624),u="src/avtranscoder/filter/graph.ts";function f(t,e){const r=t.options;switch(e&&(r.avframePool=e),t.type){case"resampler":return new o.A(r);case"scaler":return new c.A(r);case"range":return new n.A(r);case"framerate":return new a.A(r);default:throw new Error(`invalid GraphNodeType, ${t.type}`)}}let d=0;function l(t,e){return{id:d++,type:t,options:e}}function p(t,e){const r=[],i=[],n=[],o=new(s()),a=new(s()),c=new(s());return t.vertices.forEach((t=>{const i={id:t.id,filter:f(t,e),children:[],parents:[]};o.set(i.id,i),r.push(i)})),t.edges.forEach(((t,e)=>{const r=o.get(t.parent),i=o.get(t.child);r||h.h2(`${e} edge parent(${t.parent}) not found`,u,125),i||h.h2(`${e} edge child(${t.child}) not found`,u,128),r.children.push(i),i.parents.push(r),a.set(r.id,!0),c.set(i.id,!0),r.filter.connect(i.filter)})),t.vertices.forEach((t=>{c.has(t.id)||i.push(o.get(t.id)),a.has(t.id)||n.push(o.get(t.id))})),{vertices:r,edges:t.edges,inputs:i,outputs:n}}function m(t,e,r){const i=new(s()),n=new(s());for(let t=0;t<e.length;t++)i.has(e[t].id)?i.set(e[t].id,i.get(e[t].id)+1):i.set(e[t].id,1);for(let t=0;t<r.length;t++)n.has(r[t].id)?n.set(r[t].id,n.get(r[t].id)+1):n.set(r[t].id,1);for(let e=0;e<t.inputs.length;e++){var o;if(t.inputs[e].filter.getInputCount()>(null!==(o=i.get(t.inputs[e].id))&&void 0!==o?o:0))return h.z3(`input filter(${t.inputs[e].id}) only has ${i.get(t.inputs[e].id)} input channel port`,u,178),!1}for(let e=0;e<t.outputs.length;e++){var a;if(t.outputs[e].filter.getOutputCount()>(null!==(a=n.get(t.outputs[e].id))&&void 0!==a?a:0))return h.z3(`output filter(${t.outputs[e].id}) only has ${n.get(t.outputs[e].id)} output channel port`,u,185),!1}for(let e=0;e<t.vertices.length;e++)if(t.vertices[e].children.length&&t.vertices[e].parents.length){if(t.vertices[e].filter.getOutputCount()!==t.vertices[e].children.length)return h.z3(`filter(${t.vertices[e].id}) only has ${t.vertices[e].children.length} output channel port`,u,193),!1;if(t.vertices[e].filter.getInputCount()!==t.vertices[e].parents.length)return h.z3(`filter(${t.vertices[e].id}) only has ${t.vertices[e].parents.length} input channel port`,u,197),!1}return!0}},77231:(t,e,r)=>{"use strict";r.d(e,{Dh:()=>s,KR:()=>a,N_:()=>n,SF:()=>o,f7:()=>f,go:()=>h,i0:()=>c,zg:()=>u});var i=r(9599);const s=-BigInt(1),n=-1,o=1e6,a=new i.P({den:o,num:1}),c=new i.P({den:1e3,num:1}),h=(new i.P({den:1,num:1}),2147483647),u=65535,f=4294967295},9705:(t,e,r)=>{"use strict";r.d(e,{E$:()=>i,LR:()=>s,LT:()=>c,UY:()=>n,gR:()=>o,lh:()=>a,r8:()=>h});const i=-1,s=-2,n=-3,o=-4,a=-5,c=-7,h=-8},36204:(t,e,r)=>{"use strict";r.d(e,{t:()=>c});var i=r(63939),s=r(50932),n=r(56024),o=r(66788),a=r(14686);function c(t,e=0){0===e&&(e=(0,n.FP)()),s.M[15](e+152,t.sampleRate),s.M[15](e+76,t.numberOfFrames),s.M[15](e+292,t.numberOfChannels),s.M[15](e+80,function(t){switch(t){case"u8":return 0;case"s16":return 1;case"s32":return 2;case"f32":return 3;case"u8-planar":return 5;case"s16-planar":return 6;case"s32-planar":return 7;case"f32-planar":return 8;default:throw new Error("not support")}}(t.format)),s.M[17](e+104,BigInt(Math.floor(t.timestamp))),(0,n.rh)(e);const r=(0,o.K0)(i.f[15](e+80))?i.f[15](e+292):1;for(let s=0;s<r;s++)t.copyTo((0,a.s3)(i.f[20](i.f[20](e+64)+4*s),i.f[15](e+32)),{planeIndex:s});return e}},84716:(t,e,r)=>{"use strict";r.d(e,{T:()=>h});var i=r(63939),s=r(14686),n=r(66788),o=r(44328),a=r(77231);function c(t){switch(i.f[15](t+80)){case 0:return"u8";case 1:return"s16";case 2:return"s32";case 3:return"f32";case 5:return"u8-planar";case 6:return"s16-planar";case 7:return"s32-planar";case 8:return"f32-planar";default:throw new Error("not support")}}function h(t,e){const r=(0,n.K0)(i.f[15](t+80)),h=r?i.f[15](t+292):1;let u;const f=(0,n.Dw)(i.f[15](t+80));if(r){const e=i.f[15](t+76)*f,r=new Uint8Array(h*e);let n=0;for(let o=0;o<h;o++)r.set((0,s.s3)(i.f[20](t+4*o),e),n),n+=e;u=function(t,e){switch(t){case 0:case 5:return e;case 1:case 6:return new Int16Array(e.buffer);case 2:case 7:return new Int32Array(e.buffer);case 3:case 8:return new Float32Array(e.buffer);default:throw new Error("not support")}}(i.f[15](t+80),r)}else u=function(t,e,r){switch(t){case 0:case 5:return(0,s.s3)(e,r);case 1:case 6:return(0,s.cC)(e,r>>>1);case 2:case 7:return(0,s.gd)(e,r>>>2);case 3:case 8:return(0,s.TL)(e,r>>>2);default:throw new Error("not support")}}(i.f[15](t+80),i.f[20](t),f*i.f[15](t+76)*i.f[15](t+292));return new AudioData({data:u,format:c(t),sampleRate:i.f[15](t+152),numberOfFrames:i.f[15](t+76),numberOfChannels:i.f[15](t+292),timestamp:Number(e?(0,o.k)(i.f[17](t+104),e,a.KR):i.f[17](t+104))})}},89188:(t,e,r)=>{"use strict";r.d(e,{pt:()=>u});var i=r(63939),s=r(97317),n=r(44328),o=r(77231),a=r(11473);function c(t){switch(t){case 0:return"I420";case 33:return"I420A";case 4:return"I422";case 5:return"I444";case 28:return"BGRA";case 26:return"RGBA";case 23:return"NV12";default:return null}}function h(t){const e={fullRange:!1,matrix:null,primaries:null,transfer:null};switch(i.f[15](t+220)){case 1:default:e.matrix="bt709";break;case 6:e.matrix="smpte170m";break;case 5:e.matrix="bt470bg";break;case 0:e.matrix="rgb"}switch(i.f[15](t+212)){case 1:default:e.primaries="bt709";break;case 5:e.primaries="bt470bg";break;case 6:e.primaries="smpte170m"}switch(i.f[15](t+216)){case 1:default:e.transfer="bt709";break;case 13:e.transfer="iec61966-2-1";break;case 6:e.transfer="smpte170m"}return 2===i.f[15](t+208)&&(e.fullRange=!0),e}function u(t,e){let r=i.f[15](t+72);const u=s.g[i.f[15](t+80)],f=[];for(let e=0;e<u.nbComponents;e++)f.push({offset:i.f[20](t+4*e),stride:i.f[15](t+32+4*e)});const d={codedWidth:i.f[15](t+68),codedHeight:r,timestamp:Number(e?(0,n.k)(i.f[17](t+104),e,o.KR):i.f[17](t+104)),format:c(i.f[15](t+80)),duration:Number(e?(0,n.k)(i.f[17](t+312),e,o.KR):i.f[17](t+312)),layout:f,colorSpace:h(t),visibleRect:{x:i.f[15](t+276),y:i.f[15](t+268),width:i.f[15](t+68)-(i.f[15](t+276)+i.f[15](t+280)),height:i.f[15](t+72)-(i.f[15](t+268)+i.f[15](t+272))}};return new VideoFrame((0,a.eq)(),d)}},22898:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(63939),s=r(14686);function n(t,e){const r=Number(null!=e?e:i.f[17](t+8)),n=1&i.f[15](t+36);return new EncodedAudioChunk({type:n?"key":"delta",timestamp:r,data:(0,s.s3)(i.f[20](t+24),i.f[15](t+28))})}},28917:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(63939),s=r(14686);function n(t,e){const r=Number(null!=e?e:i.f[17](t+8)),n=1&i.f[15](t+36);return new EncodedVideoChunk({type:n?"key":"delta",timestamp:r,data:(0,s.s3)(i.f[20](t+24),i.f[15](t+28))})}},86368:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(26429),s=r(42577);function n(){return i._7?new MessageChannel:new s.A}},59944:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(63939),s=r(50932),n=r(71517),o=r(37837),a=r(14686),c=r(77231);function h(t,e=0,r){0===e&&(e=(0,n._5)()),s.M[17](e+8,BigInt(Math.floor(t.timestamp))),s.M[17](e+16,BigInt(Math.floor(t.timestamp))),s.M[17](e+48,BigInt(Math.floor(t.duration))),s.M[15](e+76,c.SF),s.M[15](e+72,1),s.M[15](e+36,1|i.f[15](e+36));const h=(0,o.sY)(t.byteLength);var u;if(t.copyTo((0,a.s3)(h,t.byteLength)),(0,n.NX)(e,h,t.byteLength),r&&null!==(u=r.decoderConfig)&&void 0!==u&&u.description){let t;t=r.decoderConfig.description instanceof ArrayBuffer?new Uint8Array(r.decoderConfig.description):new Uint8Array(r.decoderConfig.description.buffer);const i=(0,o.sY)(t.length);(0,a.lW)(i,t.length,t),(0,n.Ow)(e,1,i,t.length)}}},26777:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(63939),s=r(50932),n=r(71517),o=r(37837),a=r(14686),c=r(77231);function h(t,e=0,r){0===e&&(e=(0,n._5)()),s.M[17](e+8,BigInt(Math.floor(t.timestamp))),s.M[15](e+76,c.SF),s.M[15](e+72,1),s.M[17](e+48,BigInt(Math.floor(t.duration)));const h=(0,o.sY)(t.byteLength);if(t.copyTo((0,a.s3)(h,t.byteLength)),(0,n.NX)(e,h,t.byteLength),r){var u;if(null!==(u=r.decoderConfig)&&void 0!==u&&u.description){let t;t=r.decoderConfig.description instanceof ArrayBuffer?new Uint8Array(r.decoderConfig.description):new Uint8Array(r.decoderConfig.description.buffer);const i=(0,o.sY)(t.length);(0,a.lW)(i,t.length,t),(0,n.Ow)(e,1,i,t.length)}if(r.alphaSideData){const t=(0,o.sY)(r.alphaSideData.byteLength);let i;i=r.alphaSideData instanceof ArrayBuffer?new Uint8Array(r.alphaSideData):new Uint8Array(r.alphaSideData.buffer),(0,a.lW)(t,i.length,i),(0,n.Ow)(e,15,t,i.length)}}"key"===t.type&&s.M[15](e+36,1|i.f[15](e+36))}},37180:(t,e,r)=>{"use strict";r.d(e,{OB:()=>c,ab:()=>u,lL:()=>d,mt:()=>h,nG:()=>f});var i=r(63939),s=r(50932),n=r(56024),o=r(97317),a=r(11473);function c(t){switch(t){case"BGRA":return 28;case"BGRX":return 121;case"I420":return 0;case"I420A":return 33;case"I422":return 4;case"I444":return 5;case"NV12":return 23;case"RGBA":return 26;case"RGBX":return 119;default:return-1}}function h(t){switch(t){case"bt709":default:return 1;case"smpte170m":return 6;case"bt470bg":return 5;case"rgb":return 0}}function u(t){switch(t){case"bt709":default:return 1;case"bt470bg":return 5;case"smpte170m":return 6}}function f(t){switch(t){case"bt709":default:return 1;case"iec61966-2-1":return 13;case"smpte170m":return 6}}function d(t,e=0){0===e&&(e=(0,n.FP)()),s.M[15](e+80,c(t.format)),s.M[17](e+104,BigInt(Math.floor(t.timestamp))),s.M[15](e+68,t.codedWidth),s.M[15](e+72,t.codedHeight),s.M[17](e+312,BigInt(Math.floor(t.duration))),s.M[15](e+220,h(t.colorSpace.matrix)),s.M[15](e+212,u(t.colorSpace.primaries)),s.M[15](e+216,f(t.colorSpace.transfer)),s.M[15](e+208,t.colorSpace.fullRange?2:1),t.visibleRect&&(s.M[15](e+276,t.visibleRect.left),s.M[15](e+280,t.visibleRect.right),s.M[15](e+268,t.visibleRect.top),s.M[15](e+272,t.visibleRect.bottom)),(0,n.UD)(e);const r=o.g[i.f[15](e+80)],d=[];for(let t=0;t<r.nbComponents;t++)r.comp[t].plane>=t&&d.push({offset:i.f[20](e+4*t),stride:i.f[15](e+32+4*t)});return t.copyTo((0,a.eq)(),{layout:d}),e}},16041:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(134),s=r(50932),n=r(40046),o=r(73783),a=r(37837),c=r(56024);class h{constructor(t,e){(0,i.A)(this,"list",void 0),(0,i.A)(this,"mutex",void 0),this.list=t,this.mutex=e}alloc(){let t=this.list.find((t=>-1===n.p_(t+320,-1,1,16,2)),20);return t||(t=(0,a.Gy)(328),(0,c._h)(t),s.M[16](t+320,1),o.s2(this.mutex),this.list.push(t,20),o.Tl(this.mutex)),t}release(t){n.Hh(t+320,16,2)<=0||1===n.jb(t+320,1,16,2)&&((0,c.to)(t),n.M_(t+320,-1,16,2))}}},84290:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(134),s=r(50932),n=r(40046),o=r(73783),a=r(37837),c=r(71517);class h{constructor(t,e){(0,i.A)(this,"list",void 0),(0,i.A)(this,"mutex",void 0),this.list=t,this.mutex=e}alloc(){let t=this.list.find((t=>-1===n.p_(t+88,-1,1,16,2)),20);return t||(t=(0,a.Gy)(96),(0,c.Pd)(t),s.M[16](t+88,1),o.s2(this.mutex),this.list.push(t,20),o.Tl(this.mutex)),t}release(t){n.Hh(t+88,16,2)<=0||1===n.jb(t+88,1,16,2)&&((0,c.Up)(t),n.M_(t+88,-1,16,2))}}},97317:(t,e,r)=>{"use strict";r.d(e,{g:()=>i});const i={0:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},12:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},4:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},13:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},5:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},14:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]},23:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:2,offset:0,shift:0,depth:8},{plane:1,step:2,offset:1,shift:0,depth:8}]},59:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},60:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},61:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},62:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},122:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},123:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},124:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},125:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},46:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},45:{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},69:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},70:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},63:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},64:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},126:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},127:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},128:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},129:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},48:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},47:{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},65:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},66:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]},67:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},68:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]},130:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},131:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]},132:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},133:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]},50:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},49:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]},26:{nbComponents:4,log2ChromaW:0,log2ChromaH:0,flags:160,comp:[{plane:0,step:4,offset:0,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:2,shift:0,depth:8},{plane:0,step:4,offset:3,shift:0,depth:8}]},119:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:32,comp:[{plane:0,step:4,offset:0,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:2,shift:0,depth:8}]},28:{nbComponents:4,log2ChromaW:0,log2ChromaH:0,flags:160,comp:[{plane:0,step:4,offset:2,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:0,shift:0,depth:8},{plane:0,step:4,offset:3,shift:0,depth:8}]},121:{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:32,comp:[{plane:0,step:4,offset:2,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:0,shift:0,depth:8}]},33:{nbComponents:4,log2ChromaW:1,log2ChromaH:1,flags:144,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8},{plane:3,step:1,offset:0,shift:0,depth:8}]}}},58055:(t,e,r)=>{"use strict";r.d(e,{J:()=>i});const i={0:{bits:8,planar:!1},1:{bits:16,planar:!1},2:{bits:32,planar:!1},10:{bits:64,planar:!1},3:{bits:32,planar:!1},4:{bits:64,planar:!1},5:{bits:8,planar:!0},6:{bits:16,planar:!0},7:{bits:32,planar:!0},11:{bits:64,planar:!0},8:{bits:32,planar:!0},9:{bits:64,planar:!0}}},62751:(t,e,r)=>{"use strict";r.d(e,{$$:()=>s,HR:()=>i,Ki:()=>l,Mb:()=>d,Sz:()=>c,_R:()=>n,_m:()=>f,iW:()=>h,mX:()=>u,n1:()=>o,qO:()=>a});const i={flv:0,mp4:1,mov:1,ts:2,ivf:4,opus:3,ogg:3,m3u8:2,m3u:2,mpd:1,mp3:8,mkv:5,mka:5,webm:6,aac:9,flac:11,wav:10},s={m3u8:2,m3u:2,mpd:3},n={copy:0,h264:27,avc:27,hevc:173,h265:173,vvc:196,h266:196,av1:225,vp9:167,vp8:139,mpeg4:12},o={copy:0,aac:86018,mp3:86017,opus:86076,flac:86028,speex:86051,vorbis:86021},a={yuv420p:0,yuv422p:4,yuv444p:5,yuv420p10le:62,yuv422p10le:64,yuv444p10le:68,yuv420p10be:61,yuv422p10be:63,yuv444p10be:67},c={u8:0,u8p:5,s16:1,s16p:6,s32:2,s32p:7,s64:10,s64p:11,float:3,floatp:8,double:4,doublep:9},h={flv:0,mp4:1,mov:1,ts:2,mpegts:2,ivf:4,opus:3,ogg:3,m3u8:2,m3u:2,mpd:1,mp3:8,mkv:5,matroska:5,mka:5,webm:6,aac:9,flac:11,wav:10},u={tv:1,pc:2},f={bt709:1,fcc:4,bt470bg:5,smpte170m:6,smpte240m:7,ycgco:8,gbr:0,bt2020ncl:9},d={Audio:1,Video:0,Subtitle:3,Attachment:4,Data:2},l={default:1,dub:2,original:4,comment:8,lyrics:16,karaoke:32,forced:64,"hearing impaired":128,"visual impaired":256,"clean effects":512,"attached pic":1024,"timed thumbnails":2048,captions:65536,descriptions:131072,metadata:262144,dependent:524288,"still image":1048576}},36981:(t,e,r)=>{"use strict";r.d(e,{r:()=>f});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085);class u{constructor(){(0,n.A)(this,"id",void 0),(0,n.A)(this,"name",void 0),(0,n.A)(this,"opaque",void 0)}}i=u.prototype,(s=new(a())).set("id",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("name",{0:4,1:0,2:0,3:1,4:16,5:0,6:0,7:4,8:0}),s.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,4),(0,h.A)(i,c.g7,24),(0,h.A)(i,c.JY,s);class f{constructor(){(0,n.A)(this,"order",void 0),(0,n.A)(this,"nbChannels",void 0),(0,n.A)(this,"u",void 0),(0,n.A)(this,"opaque",void 0)}}!function(t){var e=new(a());e.set("order",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("nbChannels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("u",{0:function(t){var e=new(a());return e.set("mask",{0:10,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("map",{0:u,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,8),(0,h.A)(t,c.g7,8),(0,h.A)(t,c.JY,e),t}({}),1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,8),(0,h.A)(t,c.g7,24),(0,h.A)(t,c.JY,e)}(f.prototype)},50288:(t,e,r)=>{"use strict";r.d(e,{BU:()=>l});var i,s,n,o=r(134),a=r(80662),c=r.n(a),h=r(61499),u=r(12085),f=r(73783);class d{constructor(){(0,o.A)(this,"data",0),(0,o.A)(this,"size",0),(0,o.A)(this,"refcount",0),(0,o.A)(this,"free",0),(0,o.A)(this,"opaque",0),(0,o.A)(this,"flags",0),(0,o.A)(this,"flagsInternal",0)}}s=d.prototype,(n=new(c())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),n.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),n.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),n.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),n.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),n.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),n.set("flagsInternal",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),(0,u.A)(s,h.Og,!0),(0,u.A)(s,h.dc,4),(0,u.A)(s,h.g7,28),(0,u.A)(s,h.JY,n);class l{constructor(){(0,o.A)(this,"buffer",0),(0,o.A)(this,"data",0),(0,o.A)(this,"size",0)}}!function(t){var e=new(c());e.set("buffer",{0:d,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,u.A)(t,h.Og,!0),(0,u.A)(t,h.dc,4),(0,u.A)(t,h.g7,12),(0,u.A)(t,h.JY,e)}(l.prototype);class p{constructor(){(0,o.A)(this,"mutex",void 0),(0,o.A)(this,"pool",0),(0,o.A)(this,"refcount",0),(0,o.A)(this,"size",0),(0,o.A)(this,"opaque",0),(0,o.A)(this,"alloc",0),(0,o.A)(this,"alloc2",0),(0,o.A)(this,"poolFree",0)}}!function(t){var e=new(c());e.set("mutex",{0:f.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("pool",{0:i,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("alloc",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),e.set("alloc2",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),e.set("poolFree",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:28,8:0}),(0,u.A)(t,h.Og,!0),(0,u.A)(t,h.dc,4),(0,u.A)(t,h.g7,32),(0,u.A)(t,h.JY,e)}(p.prototype);class m{constructor(){(0,o.A)(this,"data",0),(0,o.A)(this,"opaque",0),(0,o.A)(this,"free",0),(0,o.A)(this,"pool",0),(0,o.A)(this,"next",0),(0,o.A)(this,"buffer",void 0)}}!function(t){var e=new(c());e.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("pool",{0:p,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),e.set("next",{0:m,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("buffer",{0:d,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),(0,u.A)(t,h.Og,!0),(0,u.A)(t,h.dc,4),(0,u.A)(t,h.g7,48),(0,u.A)(t,h.JY,e)}(m.prototype),i=m},77162:(t,e,r)=>{"use strict";r.d(e,{A:()=>m});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085),u=r(47958),f=r(9599),d=r(36981),l=r(77231),p=r(71766);class m{constructor(){(0,n.A)(this,"codecType",-1),(0,n.A)(this,"codecId",0),(0,n.A)(this,"codecTag",0),(0,n.A)(this,"extradata",0),(0,n.A)(this,"extradataSize",0),(0,n.A)(this,"codedSideData",0),(0,n.A)(this,"nbCodedSideData",0),(0,n.A)(this,"format",l.N_),(0,n.A)(this,"bitRate",BigInt(0)),(0,n.A)(this,"bitsPerCodedSample",0),(0,n.A)(this,"bitsPerRawSample",0),(0,n.A)(this,"profile",l.N_),(0,n.A)(this,"level",l.N_),(0,n.A)(this,"width",0),(0,n.A)(this,"height",0),(0,n.A)(this,"sampleAspectRatio",new f.P({den:1,num:1})),(0,n.A)(this,"framerate",new f.P({den:1,num:0})),(0,n.A)(this,"fieldOrder",0),(0,n.A)(this,"colorRange",0),(0,n.A)(this,"colorPrimaries",2),(0,n.A)(this,"colorTrc",2),(0,n.A)(this,"colorSpace",2),(0,n.A)(this,"chromaLocation",0),(0,n.A)(this,"videoDelay",0),(0,n.A)(this,"chLayout",void 0),(0,n.A)(this,"sampleRate",l.N_),(0,n.A)(this,"blockAlign",0),(0,n.A)(this,"frameSize",0),(0,n.A)(this,"initialPadding",0),(0,n.A)(this,"trailingPadding",0),(0,n.A)(this,"seekPreroll",0),(0,n.A)(this,"bitFormat",0)}destroy(){(0,p.dn)(this[c.o9]),this[c.o9]=0}}i=m.prototype,(s=new(a())).set("codecType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("codecId",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("codecTag",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),s.set("extradata",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),s.set("extradataSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),s.set("codedSideData",{0:u.lg,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),s.set("nbCodedSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),s.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),s.set("bitRate",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),s.set("bitsPerCodedSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),s.set("bitsPerRawSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),s.set("profile",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),s.set("level",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),s.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),s.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:60,8:0}),s.set("sampleAspectRatio",{0:f.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),s.set("framerate",{0:f.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),s.set("fieldOrder",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),s.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),s.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),s.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),s.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),s.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:100,8:0}),s.set("videoDelay",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),s.set("chLayout",{0:d.r,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),s.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),s.set("blockAlign",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),s.set("frameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),s.set("initialPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),s.set("trailingPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),s.set("seekPreroll",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:156,8:0}),s.set("bitFormat",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,8),(0,h.A)(i,c.g7,168),(0,h.A)(i,c.JY,s)},56490:(t,e,r)=>{"use strict";r.d(e,{A:()=>f});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085);class u{constructor(){(0,n.A)(this,"key",0),(0,n.A)(this,"value",0)}}i=u.prototype,(s=new(a())).set("key",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("value",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,4),(0,h.A)(i,c.g7,8),(0,h.A)(i,c.JY,s);class f{constructor(){(0,n.A)(this,"count",0),(0,n.A)(this,"elems",0)}}!function(t){var e=new(a());e.set("count",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("elems",{0:u,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,4),(0,h.A)(t,c.g7,8),(0,h.A)(t,c.JY,e)}(f.prototype)},55833:(t,e,r)=>{"use strict";r.d(e,{pu:()=>m});var i=r(134),s=r(80662),n=r.n(s),o=r(61499),a=r(12085),c=r(56490),h=r(50288),u=r(9599),f=r(94300),d=r(36981),l=r(77231),p=r(56024);const m=8;class g{constructor(){(0,i.A)(this,"type",0),(0,i.A)(this,"data",0),(0,i.A)(this,"size",0),(0,i.A)(this,"metadata",0),(0,i.A)(this,"buf",0)}}var A,v;A=g.prototype,(v=new(n())).set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),v.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),v.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),v.set("metadata",{0:c.A,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),v.set("buf",{0:h.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,a.A)(A,o.Og,!0),(0,a.A)(A,o.dc,4),(0,a.A)(A,o.g7,20),(0,a.A)(A,o.JY,v),function(t){var e=new(n());e.set("displayPrimaries",{0:u.P,1:0,2:0,3:1,4:6,5:0,6:0,7:0,8:0}),e.set("whitePoint",{0:u.P,1:0,2:0,3:1,4:2,5:0,6:0,7:48,8:0}),e.set("minLuminance",{0:u.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("maxLuminance",{0:u.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("hasPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),e.set("hasLuminance",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),(0,a.A)(t,o.Og,!0),(0,a.A)(t,o.dc,4),(0,a.A)(t,o.g7,88),(0,a.A)(t,o.JY,e)}(class{constructor(){(0,i.A)(this,"displayPrimaries",void 0),(0,i.A)(this,"whitePoint",void 0),(0,i.A)(this,"minLuminance",void 0),(0,i.A)(this,"maxLuminance",void 0),(0,i.A)(this,"hasPrimaries",void 0),(0,i.A)(this,"hasLuminance",void 0)}}.prototype),function(t){var e=new(n());e.set("maxCLL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("maxFALL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,a.A)(t,o.Og,!0),(0,a.A)(t,o.dc,4),(0,a.A)(t,o.g7,8),(0,a.A)(t,o.JY,e)}(class{constructor(){(0,i.A)(this,"maxCLL",void 0),(0,i.A)(this,"maxFALL",void 0)}}.prototype);class w{constructor(){(0,i.A)(this,"data",new Array(m).fill(0,0,m)),(0,i.A)(this,"linesize",new Array(m).fill(0,0,m)),(0,i.A)(this,"extendedData",0),(0,i.A)(this,"width",l.N_),(0,i.A)(this,"height",l.N_),(0,i.A)(this,"nbSamples",l.N_),(0,i.A)(this,"format",l.N_),(0,i.A)(this,"keyFrame",0),(0,i.A)(this,"pictType",0),(0,i.A)(this,"sampleAspectRatio",new u.P({den:1,num:0})),(0,i.A)(this,"pts",l.Dh),(0,i.A)(this,"pktDts",l.Dh),(0,i.A)(this,"timeBase",void 0),(0,i.A)(this,"quality",l.N_),(0,i.A)(this,"opaque",0),(0,i.A)(this,"repeatPict",l.N_),(0,i.A)(this,"interlacedFrame",l.N_),(0,i.A)(this,"topFieldFirst",l.N_),(0,i.A)(this,"paletteHasChanged",l.N_),(0,i.A)(this,"sampleRate",l.N_),(0,i.A)(this,"buf",new Array(m).fill(0,0,m)),(0,i.A)(this,"extendedBuf",0),(0,i.A)(this,"nbExtendedBuf",0),(0,i.A)(this,"sideData",0),(0,i.A)(this,"nbSideData",0),(0,i.A)(this,"flags",0),(0,i.A)(this,"colorRange",0),(0,i.A)(this,"colorPrimaries",2),(0,i.A)(this,"colorTrc",2),(0,i.A)(this,"colorSpace",2),(0,i.A)(this,"chromaLocation",0),(0,i.A)(this,"bestEffortTimestamp",l.Dh),(0,i.A)(this,"pktPos",l.Dh),(0,i.A)(this,"metadata",0),(0,i.A)(this,"decodeErrorFlags",0),(0,i.A)(this,"pktSize",l.N_),(0,i.A)(this,"hwFramesCtx",0),(0,i.A)(this,"opaqueRef",0),(0,i.A)(this,"cropTop",0),(0,i.A)(this,"cropBottom",0),(0,i.A)(this,"cropLeft",0),(0,i.A)(this,"cropRight",0),(0,i.A)(this,"privateRef",0),(0,i.A)(this,"chLayout",void 0),(0,i.A)(this,"duration",BigInt(0))}close(){(0,p.to)(this[o.o9]),(0,f.A)(this)}}!function(t){var e=new(n());e.set("data",{0:2,1:1,2:1,3:1,4:8,5:0,6:0,7:0,8:0}),e.set("linesize",{0:15,1:0,2:0,3:1,4:8,5:0,6:0,7:32,8:0}),e.set("extendedData",{0:2,1:1,2:2,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:68,8:0}),e.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("nbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:76,8:0}),e.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),e.set("keyFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),e.set("pictType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),e.set("sampleAspectRatio",{0:u.P,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),e.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),e.set("pktDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),e.set("timeBase",{0:u.P,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),e.set("quality",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:132,8:0}),e.set("repeatPict",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),e.set("interlacedFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),e.set("topFieldFirst",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),e.set("paletteHasChanged",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),e.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),e.set("buf",{0:h.BU,1:1,2:1,3:1,4:8,5:0,6:0,7:156,8:0}),e.set("extendedBuf",{0:h.BU,1:1,2:2,3:0,4:0,5:0,6:0,7:188,8:0}),e.set("nbExtendedBuf",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),e.set("sideData",{0:g,1:1,2:2,3:0,4:0,5:0,6:0,7:196,8:0}),e.set("nbSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),e.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:204,8:0}),e.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),e.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:212,8:0}),e.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),e.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),e.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),e.set("bestEffortTimestamp",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),e.set("pktPos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),e.set("metadata",{0:c.A,1:1,2:1,3:0,4:0,5:0,6:0,7:248,8:0}),e.set("decodeErrorFlags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),e.set("pktSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),e.set("hwFramesCtx",{0:h.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:260,8:0}),e.set("opaqueRef",{0:h.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:264,8:0}),e.set("cropTop",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:268,8:0}),e.set("cropBottom",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),e.set("cropLeft",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:276,8:0}),e.set("cropRight",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),e.set("privateRef",{0:h.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:284,8:0}),e.set("chLayout",{0:d.r,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),e.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:312,8:0}),(0,a.A)(t,o.Og,!0),(0,a.A)(t,o.dc,8),(0,a.A)(t,o.g7,320),(0,a.A)(t,o.JY,e)}(w.prototype),function(t){var e=new(n());e.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:320,8:0}),(0,a.A)(t,o.Og,!0),(0,a.A)(t,o.dc,8),(0,a.A)(t,o.g7,328),(0,a.A)(t,o.JY,e)}(class extends w{constructor(...t){super(...t),(0,i.A)(this,"refCount",void 0)}}.prototype)},47958:(t,e,r)=>{"use strict";r.d(e,{lg:()=>l});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085),u=r(50288),f=r(9599),d=r(77231);class l{constructor(){(0,n.A)(this,"data",0),(0,n.A)(this,"size",d.N_),(0,n.A)(this,"type",-1)}}i=l.prototype,(s=new(a())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,4),(0,h.A)(i,c.g7,12),(0,h.A)(i,c.JY,s);class p{constructor(){(0,n.A)(this,"buf",0),(0,n.A)(this,"pts",d.Dh),(0,n.A)(this,"dts",d.Dh),(0,n.A)(this,"data",0),(0,n.A)(this,"size",0),(0,n.A)(this,"streamIndex",d.N_),(0,n.A)(this,"flags",0),(0,n.A)(this,"sideData",0),(0,n.A)(this,"sideDataElems",0),(0,n.A)(this,"duration",d.Dh),(0,n.A)(this,"pos",d.Dh),(0,n.A)(this,"opaque",0),(0,n.A)(this,"opaqueRef",0),(0,n.A)(this,"timeBase",new f.P({den:d.SF,num:1})),(0,n.A)(this,"bitFormat",0)}}!function(t){var e=new(a());e.set("buf",{0:u.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("dts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),e.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),e.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),e.set("streamIndex",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),e.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:36,8:0}),e.set("sideData",{0:l,1:1,2:1,3:0,4:0,5:0,6:0,7:40,8:0}),e.set("sideDataElems",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),e.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),e.set("pos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),e.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:64,8:0}),e.set("opaqueRef",{0:u.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:68,8:0}),e.set("timeBase",{0:f.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),e.set("bitFormat",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,8),(0,h.A)(t,c.g7,88),(0,h.A)(t,c.JY,e)}(p.prototype),function(t){var e=new(a());e.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,8),(0,h.A)(t,c.g7,96),(0,h.A)(t,c.JY,e)}(class extends p{constructor(...t){super(...t),(0,n.A)(this,"refCount",void 0)}}.prototype)},9599:(t,e,r)=>{"use strict";r.d(e,{P:()=>u});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085);class u{constructor(t){(0,n.A)(this,"num",1),(0,n.A)(this,"den",1),t&&(this.den=t.den,this.num=t.num)}}i=u.prototype,(s=new(a())).set("num",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("den",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,4),(0,h.A)(i,c.g7,8),(0,h.A)(i,c.JY,s)},11573:(t,e,r)=>{"use strict";function i(t,e){let r=0;for(let i=0;i<e;i++)r=2*r+t.readU1();return r}function s(t){let e=0;for(;!i(t,1);)e++;return e>=32?0:i(t,e)+(1<<e)-1}function n(t){let e=0,r=0;for(let s=0;s<8;s++){let n=i(t,8);if(e|=(127&n)<<7*s,r+=1,!(128&n))break}return e}r.d(e,{d:()=>s,f:()=>i,v:()=>n})},37815:(t,e,r)=>{"use strict";r.d(e,{A6:()=>A,D$:()=>d,Q7:()=>m,VG:()=>l,aw:()=>f,us:()=>g});var i=r(14686),s=r(63939),n=r(50932),o=r(37837),a=r(40046),c=r(73783),h=r(52699);const u=1;function f(t,e,r=0,i=0,s=0){const c=(0,o.Gy)(28);if(!c)return 0;const h=function(t,e,r,i=0,s=0,c=0){n.M[20](t,e),n.M[15](t+4,r),n.M[20](t+12,i),n.M[20](t+16,s),a.M_(t+8,1,9,2),n.M[15](t+20,c);const h=(0,o.Gy)(12);return h?(n.M[20](h,t),n.M[20](h+4,e),n.M[15](h+8,r),h):0}(c,t,e,r,i,s);return h||((0,o.Eb)(c),0)}function d(t){return f((0,o.sY)(t),t)}function l(t){const e=(0,o.Gy)(12);return(0,i.Mr)(e,t,12),a.WQ(s.f[20](t)+8,1,9,2),e}function p(t,e){const r=s.f[20](s.f[20](t));if(e?((0,i.Mr)(s.f[20](t),s.f[20](e),12),(0,o.aI)(e)):(0,o.aI)(t),1===a.jb(r+8,1,9,2)){const t=!(2&s.f[15](r+24));s.f[20](r+16)?v(s.f[20](r+16),s.f[20](r)):(0,o.Eb)(s.f[20](r)),t&&(0,o.Eb)(r)}}function m(t){t&&s.f[20](t)&&p(t,0)}function g(t,e){const r=s.f[20](t);if(!e)return m(t),0;if(r&&s.f[20](r+4)===s.f[20](e+4))return n.M[20](r+4,s.f[20](e+4)),n.M[15](r+8,s.f[15](e+8)),0;const i=l(e);return m(t),n.M[20](t,i),0}function A(t,e){if(!s.f[20](t)){const r=f((0,o.cz)(0,e),e);return n.M[20](t,r),n.M[15](s.f[20](r)+24,s.f[15](s.f[20](r)+24)|u),0}const r=s.f[20](t),c=s.f[20](r);if(s.f[15](r+8)===e)return 0;if(!(s.f[15](c+24)&u&&function(t){return 1&s.f[15](s.f[20](t)+20)?0:1===a.Hh(s.f[20](t)+8,9,2)?1:0}(r)&&s.f[20](r+4)===s.f[20](c))){let r=h.z(4);n.M[20](r,0);const o=A(r,e);return o<0?(h.t(4),o):((0,i.Mr)(s.f[20](s.f[20](r)+4),s.f[20](c),Math.min(e,s.f[15](c+4))),p(t,r),h.t(4),0)}const d=(0,o.cz)(s.f[20](c),e);return n.M[20](r+4,d),n.M[20](c,d),n.M[15](r+8,e),n.M[15](c+4,e),0}function v(t,e){const r=t,i=s.f[20](r+12);c.s2(i),n.M[20](r+16,s.f[20](i+4)),n.M[20](i+4,r),c.Tl(i),1===a.jb(i+8,1,9,2)&&function(t){!function(t){for(;s.f[20](t+4);){const e=s.f[20](t+4);n.M[20](t+4,s.f[20](e+16)),s.f[20](e+4)?v(s.f[20](e+4),s.f[20](e)):(0,o.Eb)(s.f[20](e)),(0,o.Eb)(e)}}(t),c.zr(t),(0,o.Eb)(t)}(i)}},73749:(t,e,r)=>{"use strict";r.d(e,{I:()=>o});var i=r(63939),s=r(50932),n=r(37837);function o(t){const e=i.f[20](t);if(e){for(;s.M[15](e,i.f[15](e)-1),i.f[15](e)+1;)(0,n.aI)(i.f[20](e+4)+8*i.f[15](e)),(0,n.aI)(i.f[20](e+4)+8*i.f[15](e)+4);(0,n.aI)(e+4)}(0,n.aI)(t)}},56024:(t,e,r)=>{"use strict";r.d(e,{FP:()=>A,UD:()=>b,_h:()=>y,gg:()=>_,rh:()=>k,to:()=>x,xj:()=>v});var i=r(14686),s=r(63939),n=r(50932),o=r(55833),a=r(37837),c=r(77231),h=r(37815),u=r(73749),f=r(9705),d=r(66788),l=r(97317),p=r(52699),m=r(85103),g=r(38156);function A(){const t=(0,a.Gy)(320);return y(t),t}function v(t){x(t),(0,a.Eb)(t)}function w(t){const e=s.f[20](t);(0,h.Q7)(e+16),(0,u.I)(e+12),(0,a.aI)(t)}function y(t){s.f[20](t+64)!==t&&(0,a.aI)(t+64),(0,i.sO)(t,0,320),n.M[17](t+104,c.Dh),n.M[17](t+112,c.Dh),n.M[17](t+232,c.Dh),n.M[17](t+240,c.Dh),n.M[15](t+256,-1),n.M[15](t+84,1),n.M[15](t+92,0),n.M[15](t+96,1),n.M[15](t+80,-1),n.M[20](t+64,t),n.M[15](t+212,2),n.M[15](t+216,2),n.M[15](t+220,2),n.M[15](t+208,0),n.M[15](t+224,0),n.M[15](t+204,0)}function b(t,e=0){if(!l.g[s.f[15](t+80)])return f.UY;const r=p.z(16),i=p.z(16),o=Math.max(32,e);let a=0;if(!s.f[15](t+32)){e<=0&&(e=32);for(let r=1;r<e;r+=r){if(a=(0,g.O5)(t+32,s.f[15](t+80),(0,m.An)(s.f[15](t+68),r)),a<0)return A(),a;if(!(s.f[15](t+32)&e-1))break}for(let r=0;r<4&&s.f[15](t+32+4*r);r++)n.M[15](t+32+4*r,(0,m.An)(s.f[15](t+32+4*r),e))}for(let e=0;e<4;e++)n.M[15](r+4*e,s.f[15](t+32+4*e));const u=(0,m.An)(s.f[15](t+72),32);if((a=(0,g.S5)(i,s.f[15](t+80),u,r))<0)return A(),a;let d=4*o;for(let t=0;t<4;t++)s.f[15](i+4*t)>c.go-d&&f.UY,d+=s.f[15](i+4*t);if(n.M[20](t+156,(0,h.D$)(d)),!s.f[20](t+156))return x(t),A(),f.gR;if((a=(0,g.Xo)(t,s.f[15](t+80),u,s.f[20](s.f[20](t+156)+4),r))<0)return x(t),A(),a;for(let e=1;e<4;e++)s.f[20](t+4*e)&&n.M[20](t+4*e,s.f[20](t+4*e)+e*o);return n.M[20](t+64,t),A(),0;function A(){p.t(16),p.t(16)}}function k(t,e){const r=(0,d.K0)(s.f[15](t+80)),i=s.f[15](t+292),c=r?i:1;let u=0;if(!s.f[15](t+32)){if(u=(0,d.f8)(s.f[15](t+80),i,s.f[15](t+76),e),u<0)return u;n.M[15](t+32,u)}if(c>o.pu){if(n.M[20](t+64,(0,a.sY)(4*c)),n.M[20](t+188,(0,a.sY)(4*c)),!s.f[20](t+188)||!s.f[20](t+64))return(0,a.aI)(t+64),(0,a.aI)(t+188),f.gR;n.M[15](t+192,c-o.pu)}else n.M[20](t+64,t);for(let e=0;e<Math.min(c,o.pu);e++){if(n.M[20](t+156+4*e,(0,h.D$)(s.f[15](t+32))),!s.f[20](t+156+4*e))return x(t),f.gR;n.M[20](s.f[20](t+64)+4*e,s.f[20](s.f[20](t+156+4*e)+4)),n.M[20](t+4*e,s.f[20](s.f[20](t+156+4*e)+4))}for(let e=0;e<c-o.pu;e++){if(n.M[20](s.f[20](t+188)+4*e,(0,h.D$)(s.f[15](t+32))),!s.f[20](s.f[20](t+188)+4*e))return x(t),f.gR;n.M[20](s.f[20](t+64)+(e+o.pu),s.f[20](s.f[20](s.f[20](t+188)+4*e)+4))}}function _(t,e){n.M[15](t+80,s.f[15](e+80)),n.M[15](t+68,s.f[15](e+68)),n.M[15](t+72,s.f[15](e+72)),(0,i.Mr)(t+288,e+288,24),n.M[15](t+76,s.f[15](e+76));let r=function(t,e){n.M[15](t+84,s.f[15](e+84)),n.M[15](t+88,s.f[15](e+88)),(0,i.Mr)(t+92,e+92,8),n.M[15](t+268,s.f[15](e+268)),n.M[15](t+272,s.f[15](e+272)),n.M[15](t+276,s.f[15](e+276)),n.M[15](t+280,s.f[15](e+280)),n.M[17](t+104,s.f[17](e+104)),n.M[15](t+136,s.f[15](e+136)),n.M[15](t+140,s.f[15](e+140)),n.M[15](t+144,s.f[15](e+144)),n.M[15](t+148,s.f[15](e+148)),n.M[15](t+152,s.f[15](e+152)),n.M[20](t+132,s.f[20](e+132)),n.M[17](t+112,s.f[17](e+112)),n.M[17](t+240,s.f[17](e+240)),n.M[15](t+256,s.f[15](e+256)),n.M[15](t+128,s.f[15](e+128)),n.M[17](t+232,s.f[17](e+232)),n.M[15](t+204,s.f[15](e+204)),n.M[15](t+252,s.f[15](e+252)),n.M[15](t+212,s.f[15](e+212)),n.M[15](t+216,s.f[15](e+216)),n.M[15](t+220,s.f[15](e+220)),n.M[15](t+208,s.f[15](e+208)),n.M[15](t+224,s.f[15](e+224));let r=(0,h.us)(t+264,s.f[20](e+264));return r|=(0,h.us)(t+284,s.f[20](e+284)),r}(t,e);if(r<0)return r;if(!s.f[20](e+156)){for(let r=0;r<8;r++){if(!s.f[20](e+4*r)||!s.f[15](e+32+4*r))continue;let o=s.f[15](e+32+4*r);if(n.M[20](t+4*r,(0,a.sY)(o)),!s.f[20](t+4*r))return x(t),f.gR;(0,i.Mr)(s.f[20](t+4*r),s.f[20](e+4*r),o)}return 0}for(let r=0;r<8;r++)if(s.f[20](e+156+4*r)&&(n.M[20](t+156+4*r,(0,h.VG)(s.f[20](e+156+4*r))),!s.f[20](t+156+4*r)))return x(t),f.gR;if(s.f[20](e+188)){if(n.M[20](t+188,(0,a.Gy)(4*s.f[15](e+192))),!s.f[20](t+188))return x(t),f.gR;n.M[15](t+192,s.f[15](e+192));for(let r=0;r<s.f[15](e+192);r++)if(n.M[20](s.f[20](t+188)+4*r,(0,h.VG)(s.f[20](s.f[20](e+188)+4*r))),!s.f[20](s.f[20](t+188)+4*r))return x(t),f.gR}if(s.f[20](e+64)!==e){let r=s.f[15](e+292);if(!r)return x(t),f.UY;if(n.M[20](t+64,(0,a.Gy)(4*r)),!s.f[20](t+64))return x(t),f.gR;(0,i.Mr)(s.f[20](t+64),s.f[20](e+64),4*r)}else n.M[20](t+64,t);return(0,i.Mr)(t,e,32),(0,i.Mr)(t+32,e+32,32),0}function x(t){!function(t){for(let e=0;e<s.f[15](t+200);e++)w(s.f[20](t+196)+4*e);n.M[15](t+200,0),(0,a.aI)(t+196)}(t);for(let e=0;e<8;e++)(0,h.Q7)(t+156+4*e);for(let e=0;e<s.f[15](t+192);e++)(0,h.Q7)(s.f[20](t+188)+4*e);(0,a.aI)(t+188),(0,u.I)(t+248),(0,h.Q7)(t+260),(0,h.Q7)(t+264),(0,h.Q7)(t+284),y(t)}},71517:(t,e,r)=>{"use strict";r.d(e,{Is:()=>p,NX:()=>x,NZ:()=>A,Ow:()=>l,Pd:()=>v,Qe:()=>g,Up:()=>k,Zx:()=>_,_5:()=>m,fQ:()=>d,iI:()=>u,rN:()=>b,rU:()=>f,zu:()=>w});var i=r(14686),s=r(63939),n=r(50932),o=r(37837),a=r(77231),c=r(37815);const h=64;function u(t,e){return e?(0,i.JW)(s.f[20](t+24),s.f[15](t+28)):(0,i.s3)(s.f[20](t+24),s.f[15](t+28))}function f(t,e){for(let r=0;r<s.f[15](t+44);r++)if(s.f[15](s.f[20](t+40)+12*r+8)===e)return s.f[20](t+40)+12*r;return 0}function d(t,e){for(let r=0;r<s.f[15](t+44);r++)if(s.f[15](s.f[20](t+40)+12*r+8)===e)return!0;return!1}function l(t,e,r,a){for(let i=0;i<s.f[15](t+44);i++)if(s.f[15](s.f[20](t+40)+12*i+8)===e)return(0,o.Eb)(s.f[20](s.f[20](t+40)+12*i)),n.M[20](s.f[20](t+40)+12*i,r),void n.M[15](s.f[20](t+40)+12*i+4,a);const c=12*(s.f[15](t+44)+1),h=(0,o.Gy)(c);if(s.f[15](t+44))for(let e=0;e<s.f[15](t+44);e++)(0,i.Mr)(h+12*e,s.f[20](t+40)+12*e,12);const u=h+12*s.f[15](t+44);n.M[20](u,r),n.M[15](u+8,e),n.M[15](u+4,a),s.f[20](t+40)&&(0,o.Eb)(s.f[20](t+40)),n.M[20](t+40,h),n.M[15](t+44,s.f[15](t+44)+1)}function p(t,e){let r=-1;for(let i=0;i<s.f[15](t+44);i++)if(s.f[15](s.f[20](t+40)+12*i+8)===e){r=i;break}if(r>-1)if(1===s.f[15](t+44))(0,o.Eb)(s.f[20](s.f[20](t+40))),(0,o.Eb)(s.f[20](t+40)),n.M[20](t+40,0),n.M[15](t+44,0);else{const e=12*(s.f[15](t+44)-1),a=(0,o.Gy)(e);for(let e=0;e<s.f[15](t+44);e++)e!==r?(0,i.Mr)(a+12*e,s.f[20](t+40)+12*e,12):(0,o.Eb)(s.f[20](s.f[20](t+40)+12*e));(0,o.Eb)(s.f[20](t+40)),n.M[20](t+40,a),n.M[15](t+44,s.f[15](t+44)-1)}}function m(){const t=(0,o.Gy)(88);return v(t),t}function g(t){k(t),(0,o.Eb)(t)}function A(t,e){const r=s.f[20](t),i=s.f[15](e);if(r){for(let t=0;t<i;t++)(0,o.Eb)(s.f[20](r+12*t));(0,o.aI)(t),n.M[15](e,0)}}function v(t){n.M[20](t+24,0),n.M[15](t+28,0),n.M[20](t+40,0),n.M[15](t+44,0),n.M[15](t+32,a.N_),n.M[17](t+56,a.Dh),n.M[17](t+48,a.Dh),n.M[15](t+36,0),n.M[17](t+16,a.Dh),n.M[17](t+8,a.Dh),n.M[15](t+76,a.SF),n.M[15](t+72,1),n.M[15](t+80,0),n.M[20](t,0)}function w(t,e){return n.M[15](t+32,s.f[15](e+32)),n.M[17](t+56,s.f[17](e+56)),n.M[17](t+48,s.f[17](e+48)),n.M[15](t+36,s.f[15](e+36)),n.M[17](t+16,s.f[17](e+16)),n.M[17](t+8,s.f[17](e+8)),n.M[20](t+64,s.f[20](e+64)),n.M[15](t+76,s.f[15](e+76)),n.M[15](t+72,s.f[15](e+72)),n.M[15](t+80,s.f[15](e+80)),n.M[20](t+68,0),(0,c.us)(t+68,s.f[20](e+68)),function(t,e){if(A(t+40,t+44),s.f[15](e+44)){let r=12;n.M[20](t+40,(0,o.Gy)(r*s.f[15](e+44)));for(let r=0;r<s.f[15](e+44);r++)n.M[15](s.f[20](t+40)+12*r+4,s.f[15](s.f[20](e+40)+12*r+4)),n.M[15](s.f[20](t+40)+12*r+8,s.f[15](s.f[20](e+40)+12*r+8)),n.M[20](s.f[20](t+40)+12*r,(0,o.sY)(s.f[15](s.f[20](e+40)+12*r+4))),(0,i.Mr)(s.f[20](s.f[20](t+40)+12*r),s.f[20](s.f[20](e+40)+12*r),s.f[15](s.f[20](e+40)+12*r+4));n.M[15](t+44,s.f[15](e+44))}}(t,e),0}function y(t,e){return(0,c.A6)(t,e+h),(0,i.sO)(s.f[20](s.f[20](t)+4)+e,0,h),0}function b(t,e){return s.f[20](t)&&(0,c.Q7)(t),n.M[20](t,0),w(t,e),!s.f[20](e)&&s.f[15](e+28)?(y(t,s.f[15](e+28)),s.f[15](e+28)&&(0,i.Mr)(s.f[20](s.f[20](t)+4),s.f[20](e+24),s.f[15](e+28)),n.M[20](t+24,s.f[20](s.f[20](t)+4))):s.f[20](e)&&(n.M[20](t,(0,c.VG)(s.f[20](e))),n.M[20](t+24,s.f[20](e+24))),n.M[15](t+28,s.f[15](e+28)),0}function k(t){A(t+40,t+44),(0,c.Q7)(t+68),s.f[20](t)?(0,c.Q7)(t):s.f[20](t+24)&&(0,o.Eb)(s.f[20](t+24)),v(t)}function _(t,e){s.f[20](t)&&(0,c.Q7)(t),n.M[20](t,0),!s.f[20](e)&&s.f[15](e+28)?(y(t,s.f[15](e+28)),s.f[15](e+28)&&(0,i.Mr)(s.f[20](s.f[20](t)+4),s.f[20](e+24),s.f[15](e+28)),n.M[20](t+24,s.f[20](s.f[20](t)+4))):s.f[20](e)&&(n.M[20](t,(0,c.VG)(s.f[20](e))),n.M[20](t+24,s.f[20](e+24))),n.M[15](t+28,s.f[15](e+28))}function x(t,e,r){s.f[20](t)?(0,c.Q7)(t):s.f[20](t+24)&&(0,o.Eb)(s.f[20](t+24)),n.M[20](t,(0,c.aw)(e,r+h)),n.M[20](t+24,e),n.M[15](t+28,r)}},99991:(t,e,r)=>{"use strict";r.d(e,{b:()=>o});var i=r(63939),s=r(37837),n=r(14686);function o(t){2==i.f[15](t)&&(0,s.aI)(t+8),(0,n.sO)(t,0,24)}},71766:(t,e,r)=>{"use strict";r.d(e,{Yi:()=>u,dn:()=>f});var i=r(14686),s=r(63939),n=r(50932),o=r(37837),a=r(99991),c=r(71517),h=r(77231);function u(t,e){n.M[15](t,s.f[15](e)),n.M[15](t+4,s.f[15](e+4)),n.M[8](t+8,s.f[8](e+8)),n.M[15](t+28,s.f[15](e+28)),n.M[17](t+32,s.f[17](e+32)),n.M[15](t+40,s.f[15](e+40)),n.M[15](t+44,s.f[15](e+44)),n.M[15](t+48,s.f[15](e+48)),n.M[15](t+52,s.f[15](e+52)),n.M[15](t+56,s.f[15](e+56)),n.M[15](t+60,s.f[15](e+60)),n.M[15](t+68,s.f[15](e+68)),n.M[15](t+64,s.f[15](e+64)),n.M[15](t+80,s.f[15](e+80)),n.M[15](t+84,s.f[15](e+84)),n.M[15](t+88,s.f[15](e+88)),n.M[15](t+92,s.f[15](e+92)),n.M[15](t+96,s.f[15](e+96)),n.M[15](t+100,s.f[15](e+100)),n.M[15](t+104,s.f[15](e+104)),(0,i.Mr)(t+112,e+112,24),n.M[15](t+136,s.f[15](e+136)),n.M[15](t+140,s.f[15](e+140)),n.M[15](t+144,s.f[15](e+144)),n.M[15](t+148,s.f[15](e+148)),n.M[15](t+152,s.f[15](e+152)),n.M[15](t+156,s.f[15](e+156)),(0,i.Mr)(t+72,e+72,8),s.f[20](e+12)&&(s.f[20](t+12)&&(0,o.Eb)(s.f[20](t+12)),n.M[20](t+12,(0,o.sY)(s.f[15](e+16))),n.M[15](t+16,s.f[15](e+16)),(0,i.Mr)(s.f[20](t+12),s.f[20](e+12),s.f[15](e+16))),s.f[20](e+20)&&function(t,e,r,a){if(!r)return;const c=(0,o.Gy)(12*a);for(let t=0;t<a;t++)n.M[15](c+12*t+8,s.f[15](r+12*t+8)),n.M[15](c+12*t+4,s.f[15](r+12*t+4)),n.M[20](c+12*t,(0,o.sY)(s.f[15](r+12*t+4))),(0,i.Mr)(c+12*t,r+12*t,s.f[15](r+12*t+4));n.M[15](e,a),n.M[20](t,c)}(t+20,t+24,s.f[20](e+20),s.f[15](e+24))}function f(t){t&&(function(t){s.f[20](t+12)&&(0,o.aI)(t+12),(0,a.b)(t+112),(0,c.NZ)(t+20,t+24),(0,i.sO)(t,0,168),n.M[15](t,-1),n.M[15](t+4,0),n.M[15](t+28,-1),n.M[15](t+112,0),n.M[15](t+80,0),n.M[15](t+84,0),n.M[15](t+88,2),n.M[15](t+92,2),n.M[15](t+96,2),n.M[15](t+100,0),n.M[15](t+64,0),n.M[15](t+68,1),n.M[15](t+72,0),n.M[15](t+72,1),n.M[15](t+48,h.N_),n.M[15](t+52,h.N_)}(t),(0,o.Eb)(t))}},85103:(t,e,r)=>{"use strict";function i(t,e){return t+e-1&~(e-1)}r.d(e,{An:()=>i})},23991:(t,e,r)=>{"use strict";function i(t){let e=0,r=0;for(;r<32&&0===t.readU1();)r++;return e=t.readU(r),e+=(1<<r)-1,e}function s(t){let e=i(t);return e=1&e?(e+1)/2:-e/2,e}r.d(e,{$x:()=>s,xb:()=>i})},37837:(t,e,r)=>{"use strict";r.d(e,{Eb:()=>f,Gy:()=>u,aI:()=>d,cz:()=>l,sY:()=>h});var i=r(11473),s=r(63939),n=r(50932),o=r(14686),a=r(4624),c="src/avutil/util/mem.ts";function h(t){const e=i.s_.malloc(t);return e||a.h2("can not alloc buffer",c,32),e}function u(t){const e=i.s_.malloc(t);return e||a.h2("can not alloc buffer",c,40),(0,o.sO)(e,0,t),e}function f(t){i.s_.free(t)}function d(t){i.s_.free(s.f[20](t)),n.M[20](t,0)}function l(t,e){return i.s_.realloc(t,e)}},60264:(t,e,r)=>{"use strict";function i(t){return t.length>4&&0===t[0]&&0===t[1]&&(1===t[2]||0===t[2]&&1===t[3])}function s(t,e){let r=0;for(let i=e;i<t.length;i++)switch(t[i]){case 0:r++;break;case 1:if(r>=2)return{offset:i-Math.min(r,3),startCode:Math.min(r+1,4)};r=0;break;default:r=0}return{offset:-1,startCode:0}}function n(t){const e=[];let r=s(t,0),i={offset:-1,startCode:0};for(;i=s(t,r.offset+r.startCode),i.offset>-1;)e.push(t.subarray(r.offset+r.startCode,i.offset,!0)),r=i;return e.push(t.subarray(r.offset+r.startCode,void 0,!0)),e}function o(t,e=0,r){r||(r=t.length);const i=new Uint8Array(t.length);let s=0,n=0;for(let o=0;o<t.length;o++){if(o>=e&&o<r)if(0===t[o])s++;else if(3===t[o]&&2===s&&o+1<t.length&&t[o+1]<=3){if(o++,o===t.length)break;s=0===t[o]?1:0}else s=0;i[n++]=t[o]}return i.slice(0,n)}r.d(e,{BN:()=>o,Bs:()=>i,py:()=>n})},38156:(t,e,r)=>{"use strict";r.d(e,{O5:()=>d,S5:()=>l,Xo:()=>p,uC:()=>u});var i=r(63939),s=r(50932),n=r(97317),o=r(9705),a=r(77231),c=r(14686),h=r(52699);function u(t){if(!(t<=0||t>=7))return{x:128*(1&t),y:128*(t>>>1^(t<4?1:0))}}function f(t,e,r,i,s){if(!s)return o.UY;if(t<0)return o.UY;const n=1===i||2===i?s.log2ChromaW:0,c=t+(1<<n)-1>>>n;if(c&&r>a.go/c)return o.UY;let h=r*c;return 4&s.flags&&(h=h+7>>>3),h}function d(t,e,r){const i=n.g[e];if(!i)return o.UY;const{maxPixSteps:a,maxPixStepsComps:h}=function(t){const e=[0,0,0,0],r=[0,0,0,0];for(let i=0;i<4;i++)t.comp[i]&&t.comp[i].step>e[t.comp[i].plane]&&(e[t.comp[i].plane]=t.comp[i].step,r[t.comp[i].plane]=i);return{maxPixSteps:e,maxPixStepsComps:r}}(i);(0,c.sO)(t,0,16);let u=0;for(let e=0;e<4;e++){if((u=f(r,0,a[e],h[e],i))<0)return u;s.M[15](t+4*e,u)}}function l(t,e,r,h){const u=[0,0,0,0],f=n.g[e];if(!f)return o.UY;if((0,c.sO)(t,0,16),i.f[15](h)>a.go/r)return o.UY;if(s.M[15](t,i.f[15](h)*r),2&f.flags)return s.M[15](t+4,1024),0;for(let t=0;t<4;t++)f.comp[t]&&(u[f.comp[t].plane]=1);for(let e=0;e<4&&u[e];e++){let n=1===e||2===e?f.log2ChromaH:0,c=r+(1<<n)-1>>n;if(i.f[15](h+4*e)>a.go/c)return o.UY;s.M[15](t+4*e,c*i.f[15](h+4*e))}return 0}function p(t,e,r,n,u){const f=h.z(16),d=h.z(16);(0,c.sO)(t,0,16);for(let t=0;t<4;t++)s.M[15](f+4*t,i.f[15](u+4*t));let p=l(d,e,r,f);if(p<0)return m(),p;p=0;for(let t=0;t<4;t++){if(i.f[15](d+4*t)>a.go-p)return m(),o.UY;p+=i.f[15](d+4*t)}if(!n)return m(),p;s.M[20](t,n);for(let e=1;e<4&&i.f[15](d+4*e);e++)s.M[20](t+4*e,i.f[20](t+(e-1))+i.f[15](d+(e-1)));return m(),p;function m(){h.t(16),h.t(16)}}},44328:(t,e,r)=>{"use strict";r.d(e,{iU:()=>o,k:()=>s,lb:()=>n});var i=r(31658);function s(t,e,r){return t*BigInt(e.num>>>0)*BigInt(r.den>>>0)/(BigInt(e.den>>>0)*BigInt(r.num>>>0))}function n(t){return t.num/t.den}function o(t){const e=(0,i.A)(t.num,t.den);e<=1||(t.den/=e,t.num/=e)}},66788:(t,e,r)=>{"use strict";r.d(e,{Dw:()=>o,K0:()=>a,f8:()=>c});var i=r(77231),s=r(85103),n=r(58055);function o(t){return t<0||t>=12?0:n.J[t].bits>>3}function a(t){return!(t<0||t>=12)&&n.J[t].planar}function c(t,e,r,n){const c=o(t),h=a(t);return!c||r<=0||e<=0?-1:(n||(n=1,r=(0,s.An)(r,32)),e>i.go/n||e*r>(i.go-n*e)/c?-1:h?(0,s.An)(r*c,n):(0,s.An)(r*c*e,n))}},95007:(t,e,r)=>{"use strict";r.d(e,{A:()=>w});var i=r(134),s=r(95335),n=r(72739),o=r(73783),a=r(7417),c=r(4624),h="src/cheap/allocator/AllocatorJS.ts";const u=2,f=_(16),d=32,l=1+2*d,p=1,m=0,g=2,A=1,v=p+l+2;class w{constructor(t,e=!0){var r,n,o,a;(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"byteOffset",void 0),(0,i.A)(this,"heapOffset",void 0),(0,i.A)(this,"heapLength",void 0),(0,i.A)(this,"int32Array",void 0),(0,i.A)(this,"updates",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"shared",void 0),(0,i.A)(this,"handles",void 0),this.options=s.X$({growSize:1048576,maxHeapSize:2097152e3},t),this.handles=[],this.buffer=t.buffer,this.shared=!1,this.options.memory||this.buffer instanceof ArrayBuffer||this.buffer instanceof SharedArrayBuffer?(this.byteOffset=null!==(r=t.byteOffset)&&void 0!==r?r:0,this.heapOffset=I(this.byteOffset+k(d),null!==(n=t.byteLength)&&void 0!==n?n:this.buffer.byteLength),this.heapLength=M((null!==(o=t.byteLength)&&void 0!==o?o:this.buffer.byteLength)-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,_(this.heapLength)),this.updates=new Int32Array(this.buffer,this.byteOffset,d),"function"==typeof SharedArrayBuffer&&this.buffer instanceof SharedArrayBuffer&&(this.shared=!0)):c.h2("Expected buffer to be an instance of Buffer or ArrayBuffer",h,109),e&&(this.updates.fill(p),function(t){return t[p-1]===l&&t[p+l]===l}(a=this.int32Array)||function(t){const e=p,r=l,i=v,s=t.length-(e+r+2+A);B(t,r,e),t[e+m]=1,t[e+g]=i;for(let r=1;r<d;r++)t[e+g+r]=p;B(t,s,i),t[i+m]=1,t[i+g]=e}(a),function(t){let e=v;for(;e<t.length-A;){const r=C(t,e);r<2||r>=t.length-v?c.h2(`Got invalid sized chunk at ${k(e)} (${k(r)} bytes).`,h,563):U(t,e)?y(t,e,r):b(t,e,r),e+=r+2}}(this.int32Array))}addUpdateHandle(t){n.zy(this.handles,t)||this.handles.push(t)}removeUpdateHandle(t){n.TF(this.handles,t)}malloc_(t){(t=x(t,7))<16&&(t=16);const e=_(t),r=this.findFreeBlock(this.int32Array,e);if(r<=p)return 0;const i=C(this.int32Array,r);return i-(e+2)>=f?function(t,e,r,i,s){const n=e+r+2,o=i-(n-e);E(t,e,i,s),t[e-1]=-r,t[e+r]=-r,t[n-1]=-o,t[n+o]=-o,L(t,n,o,s)}(this.int32Array,r,e,i,this.updates):E(this.int32Array,r,i,this.updates),k(r)+this.heapOffset}malloc(t){this.shared&&((0,o.s2)(a.I,!0),this.checkBuffer());const e=this.malloc_(t);return this.shared&&(0,o.Tl)(a.I),e}calloc_(t,e){let r=t*e;r=r<16?16:x(r,7);const i=this.malloc_(r);if(0===i)return 0;const s=_(i);return this.int32Array.subarray(s,s+r>>2).fill(0),i}calloc(t,e){this.shared&&((0,o.s2)(a.I,!0),this.checkBuffer());const r=this.calloc_(t,e);return this.shared&&(0,o.Tl)(a.I),r}realloc_(t,e){if(0===t)return this.malloc_(e);const r=t;if(0===e)return this.free_(r),0;let i=_(t-=this.heapOffset),s=i,n=0;S(this.int32Array,i)&&(s=this.int32Array[i-1],n=i-s);const o=C(this.int32Array,s)-n;if(o>=_(x(e,7)))return r;{const t=this.malloc_(e);return 0===t?(this.free_(r),0):(this.int32Array.set(this.int32Array.subarray(i,i+o),_(t-this.heapOffset)),this.free_(r),t)}}realloc(t,e){return this.shared&&((0,o.s2)(a.I,!0),this.checkBuffer()),t=this.realloc_(t,e),this.shared&&(0,o.Tl)(a.I),t}alignedAlloc_(t,e){if(t<=8)return this.malloc_(e);const r=this.malloc_(e+t-1+4);if(0===r)return 0;const i=r+t-1+4&~(t-1);return this.int32Array[_(i-this.heapOffset)-A]=_(r-this.heapOffset),i}alignedAlloc(t,e){this.shared&&((0,o.s2)(a.I,!0),this.checkBuffer());const r=this.alignedAlloc_(t,e);return this.shared&&(0,o.Tl)(a.I),r}free_(t){if(0===t)return;let e=_(t-=this.heapOffset);if(S(this.int32Array,e)&&(e=this.int32Array[e-A]),U(this.int32Array,e))return;const r=C(this.int32Array,e),i=R(this.int32Array,e),s=function(t,e){const r=C(t,e);if(e+r+2>=t.length-2)return 0;const i=e+r+2;return t[i-A]<2?0:i}(this.int32Array,e);0!==i?0!==s?function(t,e,r,i,s,n){const o=C(t,e),a=C(t,s),c=s-e+a;E(t,e,o,n),E(t,s,a,n),t[e-A]=-c,t[s+a]=-c,L(t,e,c,n)}(this.int32Array,i,0,0,s,this.updates):D(this.int32Array,i,e,r,this.updates):0!==s?function(t,e,r,i,s){const n=C(t,e);E(t,e,n,s);const o=i+n+2;t[r-A]=-o,t[e+n]=-o,L(t,r,o,s)}(this.int32Array,s,e,r,this.updates):L(this.int32Array,e,r,this.updates)}free(t){this.shared&&((0,o.s2)(a.I,!0),this.checkBuffer()),this.free_(t),this.shared&&(0,o.Tl)(a.I)}sizeof(t){if(0===t)return 0;let e=_(t-=this.heapOffset);return S(this.int32Array,e)&&(e=this.int32Array[e-A]),k(C(this.int32Array,e))}inspect(){return this.checkBuffer(),function(t,e){const r=[],i=P(t,p,e);let s=v,n=0;for(;s<t.length-A;){const i=C(t,s);(i<2||i>=t.length)&&c.h2(`Got invalid sized chunk at ${k(s)} (${k(i)})`,h,619),U(t,s)?r.push(P(t,s,e)):(n+=k(i),r.push({type:"used",block:s,offset:k(s)+e,size:k(i)})),s+=i+2}return{header:i,blocks:r,total:k(t.length),used:n}}(this.int32Array,this.heapOffset)}findFreeBlock(t,e){let r=function(t,e){let r=p;for(let i=t[p+m];i>0;i--){let s=t[r+g+(i-1)];for(;s!==p&&t[s-A]<e;)r=s,s=t[r+g+(i-1)]}return r=t[r+g],r}(t,e);if(r===p){if(this.options.growAllowed&&this.heapLength<this.options.maxHeapSize){const t=this.int32Array.length+1;let r,a,c=0,h=0,u=0;if(this.options.onResize){var i,s,o;const t=this.options.onResize(this.int32Array,this.int32Array.byteLength+x(Math.max(this.options.growSize,k(e)),7));c=null!==(i=t.byteOffset)&&void 0!==i?i:0,u=I(c+k(d),null!==(s=t.byteLength)&&void 0!==s?s:t.buffer.byteLength),h=M((null!==(o=t.byteLength)&&void 0!==o?o:t.buffer.byteLength)-u),r=new Int32Array(t.buffer,u,_(h)),a=new Int32Array(t.buffer,c,d)}else{const t=new ArrayBuffer(this.int32Array.length+_(this.options.growSize));u=I(c+k(d),t.byteLength),h=M(t.byteLength-u),r=new Int32Array(t,u,_(h)),r.set(this.int32Array,0),a=new Int32Array(t,c,d)}this.byteOffset=c,this.heapOffset=u,this.buffer=r.buffer,this.heapLength=h,this.int32Array=r,this.updates=a;const f=r.length-(t-1)-2;B(r,f,t);const l=R(r,t);return 0!==l?D(r,l,t,f,this.updates):L(r,t,f,this.updates),this.handles.length&&n.__(this.handles,(t=>{t(this.buffer)})),this.findFreeBlock(this.int32Array,e)}return r}return r}getBuffer(){return this.buffer}isAlloc(t){this.shared&&((0,o.s2)(a.I,!0),this.checkBuffer());const e=_(t-this.heapOffset);let r=this.int32Array[p+g];for(;r&&r!==p;){if(e>=r&&e<r+this.int32Array[r-A])return this.shared&&(0,o.Tl)(a.I),!1;r=this.int32Array[r+g]}return this.shared&&(0,o.Tl)(a.I),!0}checkBuffer(){this.options.memory&&this.options.memory.buffer!==this.buffer&&(this.buffer=this.options.memory.buffer,this.heapLength=M(this.buffer.byteLength-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,_(this.heapLength)))}}function y(t,e,r){t[e-1]!==t[e+r]&&c.h2(`Block length header does not match footer (${k(t[e-1])} vs ${k(t[e+r])}).`,h,579);const i=t[e+m];(i<1||i>d)&&c.h2(`Block ${k(e)} height must be between 1 and ${d}, got ${i}.`,h,584);for(let r=0;r<i;r++){const i=t[e+g+r];i>=v&&!U(t,i)&&c.h2(`Block ${k(e)} has a pointer to a non-free block (${k(i)}).`,h,590)}return!0}function b(t,e,r){if(t[e-1]===t[e+r])return!0;c.h2(`Block length header does not match footer (${k(t[e-1])} vs ${k(t[e+r])}).`,h,599)}function k(t){return t<<u}function _(t){return t>>>u}function x(t,e){return t+e&~e}function I(t,e){const r=e-t;return t+(x(r,7)===r?0:r-x(r,7)+8)}function M(t){return(p+l)%2||(t-=4),t}function P(t,e,r){const i=t[e+m],s=[];for(let r=0;r<i;r++)s.push(t[e+g+r]);return{type:"free",block:e,offset:k(e)+r,height:i,pointers:s,size:k(t[e-1])}}function C(t,e){const r=t[e-1],i=r>>31;return r+i^i}function B(t,e,r){t[r-1]=e,t[r+e]=e}function T(t,e,r){const i=t[p+m];let s=p;for(let n=i;n>0;n--){let i=s+g+(n-1);for(;t[i]>=v&&t[t[i]-1]<e;)s=t[i],i=s+g+(n-1);r[n-1]=s}}function E(t,e,r,i){T(t,r,i);let s=t[i[0]+g];for(;s!==e&&s!==p&&t[s-1]<=r;){for(let r=t[s+m]-1;r>=0;r--)t[s+g+r]===e&&(i[r]=s);s=t[s+g]}let n=t[p+m];for(let r=0;r<n&&t[i[r]+g+r]===e;r++)t[i[r]+g+r]=t[e+g+r];for(;n>0&&t[p+g+(n-1)]===p;)n--,t[p+m]=n;t[e-1]=-r,t[e+r]=-r}function U(t,e){return!(e<l)&&!(t[e-A]<0)}function S(t,e){return!(e<l)&&!(t[e-A]<0)}function R(t,e){if(e<=v)return 0;const r=t[e-2];return r<2?0:e-(2+r)}function L(t,e,r,i){T(t,r,i);const s=function(t,e,r,i){const s=t[p+m];let n=function(){let t=1;for(;Math.random()<.5&&t<d;)t+=1;return t}();if(r-1<n+1&&(n=r-2),n>s){const r=s+1;return t[p+m]=r,t[p+g+(r-1)]=p,i[r]=p,t[e+m]=r,r}return t[e+m]=n,n}(t,e,r,i);for(let r=1;r<=s;r++){const s=i[r-1]+g+(r-1);t[e+g+(r-1)]=t[s],t[s]=e,i[r-1]=p}return t[e-1]=r,t[e+r]=r,r}function D(t,e,r,i,s){const n=r-e+i;return E(t,e,r-e-2,s),t[e-A]=-n,t[r+i]=-n,L(t,e,n,s),i}},94321:(t,e,r)=>{"use strict";r.d(e,{z:()=>s});var i=r(134);class s{constructor(){(0,i.A)(this,"table",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"nodes",void 0),this.table=new WebAssembly.Table({initial:16,element:"anyfunc"}),this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}]}getPointer(){return this.pointer}alloc(t){let e=this.findFree(t);if(e<0){const r=this.nodes[this.nodes.length-1],i=t-(r.free?r.length:0);this.table.grow(i),r.free?r.length=r.length+i:this.nodes.push({pointer:r.pointer+r.length,length:i,free:!0}),e=this.findFree(t)}const r=this.nodes[e];return r.length>t&&(this.nodes.splice(e+1,0,{pointer:r.pointer+t,length:r.length-t,free:!0}),r.length=t),r.free=!1,r.pointer}free(t){let e=this.findNode(t);const r=this.nodes[e];if(r&&!r.free){const t=this.nodes[e-1],i=this.nodes[e+1];t&&t.free?i&&i.free?(t.length+=r.length+i.length,this.nodes.splice(e,2)):(t.length+=r.length,this.nodes.splice(e,1)):i&&i.free?(r.length+=i.length,this.nodes.splice(e+1,1),r.free=!0):r.free=!0}if(1===this.nodes.length&&this.nodes[0].free){const t=new WebAssembly.Table({initial:16,element:"anyfunc"});this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}];for(let e=1;e<this.pointer;e++)t.set(e,this.table.get(e));this.table=t}}get(t){return this.table.get(t)}set(t,e){if(t<0||t>=this.pointer)throw new RangeError("index out of bound");this.table.set(t,e)}inspect(){return this.nodes}findFree(t){let e=-1;for(let r=0;r<this.nodes.length;r++)if(this.nodes[r].length>=t&&this.nodes[r].free){e=r;break}return e}findNode(t){let e=-1;for(let r=0;r<this.nodes.length;r++)if(this.nodes[r].pointer===t){e=r;break}return e}}},98564:(t,e,r)=>{"use strict";r.d(e,{Ay:()=>d});var i=r(4919),s=r(4624),n=r(63939),o=r(50932),a=r(88096),c=r(73945),h=r.n(c),u="src/cheap/asm/memory.ts";let f;async function d(t){try{let e=(0,i.E_)(h());a.DD(e,"function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer),f=(await WebAssembly.instantiate(e,{env:{memory:t}})).instance,(0,n.$)({4:f.exports.readU8,5:f.exports.readU8,2:f.exports.readU8,3:f.exports.readU8,6:f.exports.readU16,7:f.exports.readU16,8:t=>f.exports.read32(t)>>>0,9:t=>f.exports.read32(t)>>>0,10:t=>BigInt.asUintN(64,f.exports.read64(t)),22:t=>BigInt.asUintN(64,f.exports.read64(t)),11:f.exports.read8,12:f.exports.read8,13:f.exports.read16,14:f.exports.read16,15:f.exports.read32,16:f.exports.read32,17:f.exports.read64,21:f.exports.read64,18:f.exports.readf32,19:f.exports.readf64,20:t=>f.exports.read32(t)>>>0}),(0,o.$)({4:f.exports.write8,5:f.exports.write8,2:f.exports.write8,3:f.exports.write8,6:f.exports.write16,7:f.exports.write16,8:f.exports.write32,9:f.exports.write32,10:f.exports.write64,22:f.exports.write64,11:f.exports.write8,12:f.exports.write8,13:f.exports.write16,14:f.exports.write16,15:f.exports.write32,16:f.exports.write32,17:f.exports.write64,21:f.exports.write64,18:f.exports.writef32,19:f.exports.writef64,20:f.exports.write32})}catch(t){s.R8("memory asm not support, cannot use asm memory function",u,96)}}},26429:(t,e,r)=>{"use strict";r.d(e,{Gx:()=>f,YN:()=>u,ZI:()=>a,_7:()=>o,dP:()=>h,pw:()=>c});var i,s=r(95797),n=r(10576);const o=!!s.A.thread&&!0!==n.TK.CHEAP_DISABLE_THREAD;let a=16,c=1048576;const h=1024,u=null!==(i=n.TK.CHEAP_HEAP_INITIAL)&&void 0!==i?i:265,f=32768},73281:(t,e,r)=>{"use strict";r.d(e,{A:()=>E});var i=r(59135),s=r(63939),n=r(50932);let o,a;const c=(0,i.A)();function h(t,e){a().setUint8(t,e)}function u(t){return a().getUint8(t)}function f(t,e){a().setUint16(t,e,c)}function d(t){return a().getUint16(t,c)}function l(t,e){a().setUint32(t,e,c)}function p(t){return a().getUint32(t,c)}function m(t,e){a().setBigUint64(t,e,c)}function g(t){return a().getBigUint64(t,c)}function A(t,e){a().setInt8(t,e)}function v(t){return a().getInt8(t)}function w(t,e){a().setInt16(t,e,c)}function y(t){return a().getInt16(t,c)}function b(t,e){a().setInt32(t,e,c)}function k(t){return a().getInt32(t,c)}function _(t,e){a().setBigInt64(t,e,c)}function x(t){return a().getBigInt64(t,c)}function I(t,e){a().setFloat32(t,e,c)}function M(t){return a().getFloat32(t,c)}function P(t,e){a().setFloat64(t,e,c)}function C(t){return a().getFloat64(t,c)}function B(t){return a().getUint32(t,c)}function T(t,e){return a().setUint32(t,e,c)}function E(t,e){o=t,a=e,(0,s.$)({4:u,5:u,2:u,3:u,6:d,7:d,8:p,9:p,10:g,11:v,12:v,13:y,14:y,15:k,16:k,17:x,18:M,19:C,20:B,23:t=>!!v(t),24:t=>!!v(t)}),(0,n.$)({4:h,5:h,2:h,3:h,6:f,7:f,8:l,9:l,10:m,11:A,12:A,13:w,14:w,15:b,16:b,17:_,18:I,19:P,20:T,23:(t,e)=>{A(t,e?1:0)},24:(t,e)=>{A(t,e?1:0)}})}},63939:(t,e,r)=>{"use strict";r.d(e,{$:()=>n,f:()=>s});var i=r(95335);const s={4:function(t){throw new Error("unimplemented")},5:function(t){throw new Error("unimplemented")},2:function(t){throw new Error("unimplemented")},3:function(t){throw new Error("unimplemented")},6:function(t){throw new Error("unimplemented")},7:function(t){throw new Error("unimplemented")},8:function(t){throw new Error("unimplemented")},9:function(t){throw new Error("unimplemented")},10:function(t){throw new Error("unimplemented")},11:function(t){throw new Error("unimplemented")},12:function(t){throw new Error("unimplemented")},13:function(t){throw new Error("unimplemented")},14:function(t){throw new Error("unimplemented")},15:function(t){throw new Error("unimplemented")},16:function(t){throw new Error("unimplemented")},17:function(t){throw new Error("unimplemented")},18:function(t){throw new Error("unimplemented")},19:function(t){throw new Error("unimplemented")},20:function(t){throw new Error("unimplemented")},0:function(t){throw new Error("invalid operate")},1:function(t){throw new Error("invalid operate")},22:function(t){throw new Error("invalid operate")},21:function(t){throw new Error("invalid operate")},23:function(t){throw new Error("invalid operate")},24:function(t){throw new Error("invalid operate")}};function n(t){i.X$(s,t)}},50932:(t,e,r)=>{"use strict";r.d(e,{$:()=>n,M:()=>s});var i=r(95335);const s={4:function(t,e){throw new Error("unimplemented")},5:function(t,e){throw new Error("unimplemented")},2:function(t,e){throw new Error("unimplemented")},3:function(t,e){throw new Error("unimplemented")},6:function(t,e){throw new Error("unimplemented")},7:function(t,e){throw new Error("unimplemented")},8:function(t,e){throw new Error("unimplemented")},9:function(t,e){throw new Error("unimplemented")},10:function(t,e){throw new Error("unimplemented")},11:function(t,e){throw new Error("unimplemented")},12:function(t,e){throw new Error("unimplemented")},13:function(t,e){throw new Error("unimplemented")},14:function(t,e){throw new Error("unimplemented")},15:function(t,e){throw new Error("unimplemented")},16:function(t,e){throw new Error("unimplemented")},17:function(t,e){throw new Error("unimplemented")},18:function(t,e){throw new Error("unimplemented")},19:function(t,e){throw new Error("unimplemented")},20:function(t,e){throw new Error("unimplemented")},0:function(t,e){throw new Error("invalid operate")},1:function(t,e){throw new Error("invalid operate")},22:function(t,e){throw new Error("invalid operate")},21:function(t,e){throw new Error("invalid operate")},23:function(t,e){throw new Error("invalid operate")},24:function(t,e){throw new Error("invalid operate")}};function n(t){i.X$(s,t)}},25323:(t,e,r)=>{"use strict";r.d(e,{X:()=>E,l:()=>T});var i=r(66681),s=r.n(i),n=r(11919),o=r.n(n),a=r(75019),c=r.n(a),h=r(99921),u=r(63939),f=r(50932),d=r(61499),l=r(6704),p=r(67672),m=r(95335),g=r(62100),A=r(72739);function v(t,e,r,i){s()(t,e,{get:r,set:i,configurable:!0,enumerable:!0})}function w(t){return function(){return u.f[20](t())}}function y(t,e,r,i){return function(){return t[`__$__${e}`]||(t[`__$__${e}`]=T(r(),i))}}function b(t,e){return function(){return u.f[e](t())}}function k(t,e,r,i){const s=8*l.i[e]-i-r,n=Math.pow(2,r)-1;return function(){return u.f[e](t())>>>s&n}}function _(t){return function(e){f.M[8](t(),e)}}function x(t,e,r,i){const s=`__$__${e}`;return function(e){const n=t[s]||(t[s]=T(r(),i));m.__(e,((t,e)=>{n[e]=t})),t[s]=n}}function I(t,e){return function(r){f.M[e](t(),r)}}function M(t,e,r,i){let s=0,n=8*l.i[e];for(let t=0;t<r;t++)s|=1<<n-1-(t+i);const o=Math.pow(2,r)-1,a=n-i-r;return function(r){const i=t(),n=u.f[e](i);f.M[e](i,n&~s|(r&o)<<a)}}function P(t,e,r){return function(){const i=e[`__$__${r}`];return i[d.o9]=t(),i}}function C(t,e,r,i,s){const n=`__$__${e}`;return function(e){let o=t[n]||function(t,e,r){const i={};let s=(0,h.A)(r);for(let n=0;n<e;n++){const e=(0,g.A)(n);v(i,e,y(i,e,(()=>t()+s*n),r),x(i,e,(()=>t()+s*n),r))}return i}(r,i,s);o[d.o9]=r(),A.__(e,((t,e)=>{o[e]=t})),t[n]=o}}function B(t,e,r,i,s){const n=`__$__${e}`;return function(e){let o=t[n]||function(t,e,r){const i={};let s=(0,h.A)(r);for(let n=0;n<e;n++)v(i,(0,g.A)(n),b((()=>t()+s*n),r),I((()=>t()+s*n),r));return i}(r,i,s);o[d.o9]=r(),A.__(e,((t,e)=>{o[e]=t})),t[n]=o}}function T(t,e){let r=p.Pc(e)?e.prototype:e;const i={};for(i[d.o9]=t,o()(i,r);;){let t=r[d.JY];if(t&&t.forEach(((t,e)=>{t[3]?t[1]?v(i,e,P((()=>i[d.o9]+t[7]),i,e),B(i,e,(()=>i[d.o9]+t[7]),t[4],20)):p.Pc(t[0])||p.Ik(t[0])?v(i,e,P((()=>i[d.o9]+t[7]),i,e),C(i,e,(()=>i[d.o9]+t[7]),t[4],t[0])):v(i,e,P((()=>i[d.o9]+t[7]),i,e),B(i,e,(()=>i[d.o9]+t[7]),t[4],t[0])):t[1]?v(i,e,w((()=>i[d.o9]+t[7])),_((()=>i[d.o9]+t[7]))):p.Pc(t[0])||p.Ik(t[0])?v(i,e,y(i,e,(()=>i[d.o9]+t[7]),t[0]),x(i,e,(()=>i[d.o9]+t[7]),t[0])):t[5]?v(i,e,k((()=>i[d.o9]+t[7]),t[0],t[6],t[8]),M((()=>i[d.o9]+t[7]),t[0],t[6],t[8])):v(i,e,b((()=>i[d.o9]+t[7]),t[0]),I((()=>i[d.o9]+t[7]),t[0]))})),r=c()(r),!r)break}return i}function E(t){let e=c()(t);for(;;){let r=e[d.JY];if(r&&r.forEach(((e,r)=>{delete t[r]})),e=c()(e),!e)break}}},12085:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(66681),s=r.n(i);function n(t,e,r){s()(t,e,{value:r,writable:!1,enumerable:!1,configurable:!1})}},11473:(t,e,r)=>{"use strict";r.d(e,{GE:()=>v,KZ:()=>N,QY:()=>$,Wo:()=>z,XI:()=>b,ce:()=>_,eq:()=>F,pv:()=>j,qq:()=>O,s_:()=>k,wE:()=>w});var i=r(39638),s=r(95007),n=r(94321),o=r(10576),a=r(26429),c=r(7417),h=r(33856),u=r(98564),f=r(82854),d=r(73281),l=r(54568),p=r(86834);let m=-1,g=!0,A="",v=null,w=null,y=0,b=null,k=null,_=null,x=null,I=null,M=null,P=null,C=null,B=null,T=null,E=null,U=null,S=null,R=null,L={5:C,3:C,7:B,9:T,22:E,12:x,14:I,16:M,21:P};function D(){return!(!_||_.buffer===C.buffer)}function F(){return D()&&V(_.buffer),C}function $(){return D()&&V(_.buffer),I}function z(){return D()&&V(_.buffer),M}function O(){return D()&&V(_.buffer),U}function N(){return D()&&V(_.buffer),R}function W(t){return D()&&V(_.buffer),L[t]}function V(t){x=new Int8Array(t),I=new Int16Array(t),M=new Int32Array(t),P=new BigInt64Array(t),C=new Uint8Array(t),B=new Uint16Array(t),T=new Uint32Array(t),E=new BigUint64Array(t),U=new Float32Array(t),S=new Float64Array(t),R=new DataView(t),L={5:C,3:C,7:B,9:T,22:E,12:x,14:I,16:M,21:P}}function j(){return Atomics.add(T,c.h>>>2,1)}(0,i.A)()||(0,l.A)()?(o.TK.CHeap={initThread:async function t(e){var r;(0,d.A)((()=>k),N),(0,h.A)(W),_=e.memory;var i;i=new s.A({buffer:_.buffer,memory:_,byteOffset:a.dP,growAllowed:!0,onResize:(t,e)=>(_.grow(e-t.byteLength>>>16),{buffer:_.buffer,byteOffset:a.dP})},!1),k&&k.removeUpdateHandle(V),k=i,o.TK.CHeap&&(o.TK.CHeap.Allocator=k),k.addUpdateHandle(V),V(k.getBuffer()),e.stackPointer&&(y=e.stackSize,w=e.stackPointer,v=new WebAssembly.Global({value:"i32",mutable:!0},w+y),b=new n.z),m="number"==typeof e.id?e.id:Atomics.add(T,c.h>>>2,1),A=null!==(r=e.name)&&void 0!==r?r:"anonymous",o.TK.CHeap={initThread:t,Allocator:k,Table:b,ThreadId:m,ThreadName:A,Memory:_,StackSize:y,StackTop:w,StackPointer:v,isMainThread:!1},g=!1,e.disableAsm||("function"==typeof BigInt&&BigInt!==Number&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||p.A.newEdge)&&await(0,u.Ay)(_),a._7&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||p.A.newEdge)&&await(0,f.Ay)(_))},isMainThread:!1},g=!1):function(){var t,e,r,i,l,x,I,P;if((0,d.A)((()=>k),N),(0,h.A)(W),_=null!==(t=o.TK.CHeap)&&void 0!==t&&t.Memory?o.TK.CHeap.Memory:new WebAssembly.Memory({initial:a.YN,maximum:a.Gx,shared:a._7}),k=null!==(e=o.TK.CHeap)&&void 0!==e&&e.Allocator?o.TK.CHeap.Allocator:new s.A({buffer:_.buffer,memory:_,byteOffset:a.dP,growAllowed:!0,onResize:(t,e)=>(_.grow(e-t.byteLength>>>16),{buffer:_.buffer,byteOffset:a.dP})}),k.addUpdateHandle(V),V(k.getBuffer()),y=null!==(r=o.TK.CHeap)&&void 0!==r&&r.StackSize?o.TK.CHeap.StackSize:a.pw,w=null!==(i=o.TK.CHeap)&&void 0!==i&&i.StackTop?o.TK.CHeap.StackTop:k.malloc(y),v=null!==(l=o.TK.CHeap)&&void 0!==l&&l.StackPointer?o.TK.CHeap.StackPointer:new WebAssembly.Global({value:"i32",mutable:!0},w+y),b=null!==(x=o.TK.CHeap)&&void 0!==x&&x.Table?o.TK.CHeap.Table:new n.z,m=null!==(I=o.TK.CHeap)&&void 0!==I&&I.ThreadId?o.TK.CHeap.ThreadId:0,A=null!==(P=o.TK.CHeap)&&void 0!==P&&P.ThreadName?o.TK.CHeap.ThreadName:"main",!o.TK.CHeap)if(a._7)Atomics.store(T,c.h>>>2,m+1),Atomics.store(M,c.I>>>2,0);else{T[c.h>>>2]=m+1;let t=c.I>>>2;M[t]=0}"function"==typeof BigInt&&BigInt!==Number&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||p.A.newEdge)&&(0,u.Ay)(_),a._7&&(p.A.chrome&&p.A.checkVersion(p.A.majorVersion,"85",!0)||p.A.firefox&&p.A.checkVersion(p.A.majorVersion,"78",!0)||p.A.safari&&p.A.checkVersion(p.A.majorVersion,"15",!0)||p.A.newEdge)&&(0,f.Ay)(_),o.TK.CHeap||(o.TK.CHeap={Allocator:k,Table:b,ThreadId:m,ThreadName:A,Memory:_,StackSize:y,StackTop:w,StackPointer:v,isMainThread:!0,threadCounter:c.h,heapMutex:c.I}),g=!0}()},80098:(t,e,r)=>{"use strict";r.d(e,{I_:()=>v,SQ:()=>w});var i=r(75019),s=r.n(i),n=r(11919),o=r.n(n),a=r(99921),c=r(63939),h=r(50932),u=r(61499),f=r(6704),d=r(67672),l=r(95335),p=r(72739),m=r(2148);const g=s()({});function A(t,e){for(;;){let r=t[u.JY];if(r){const t=r.get(e);if(t)return t}if(!(t=s()(t))||t===g)return null}}function v(t,e){const r=d.Pc(e)?e.prototype:e,i={};i[u.o9]=t,o()(i,r);const{proxy:s,revoke:n}=Proxy.revocable(i,{get(t,e,i){if(d.Yj(e)){const i=A(r,e.replace(/^\$+/,""));if(i){const r=t[u.o9]+i[7];if(i[3]){const i=t[e];return i[u.o9]=r,i}if(i[1])return c.f[20](r);if(d.Pc(i[0])||d.Ik(i[0]))return t[e]||(t[e]=v(r,i[0]));{let t=c.f[i[0]](r);return i[5]&&(t=t>>>8*f.i[i[0]]-i[8]-i[6]&Math.pow(2,i[6])-1),t}}return t[e]}return t[e]},set(t,e,i,s){if(d.Yj(e)){const s=A(r,e.replace(/^\$+/,""));if(s){const r=t[u.o9]+s[7];if(s[3]){const n=t[e]||function(t,e,r,i){const s={};s[u.o9]=t;let n=(0,a.A)(i?20:r);return new Proxy(s,{get(t,e,s){if(e===u.o9)return t[u.o9];const o=(0,m.A)(e);return i?c.f[20](t[u.o9]+o*n):d.Pc(r)?t[e]:c.f[r](t[u.o9]+o*n)},set(t,e,s,o){if(e===u.o9)return t[u.o9]=s,!0;const a=(0,m.A)(e);if(i)h.M[20](t[u.o9]+a*n,s),t[e]=s;else if(d.Pc(r)){const i=t[e]||(t[e]=v(t[u.o9]+a*n,r));l.__(s,((t,e)=>{i[e]=t})),t[e]=i}else h.M[r](t[u.o9]+a*n,s),t[e]=s;return!0}})}(r,s[4],s[0],s[1]);p.__(i,((t,e)=>{n[e]=t})),t[e]=n}else if(s[1])h.M[20](r,i),t[e]=i;else if(d.Pc(s[0])||d.Ik(s[0])){const n=t[e]||(t[e]=v(r,s[0]));l.__(i,((t,e)=>{n[e]=t})),t[e]=n}else{if(s[5]){let t=0,e=8*f.i[s[0]];for(let r=0;r<s[6];r++)t|=1<<e-1-(r+s[8]);const n=c.f[s[0]](r);h.M[s[0]](r,n&~t|(i&Math.pow(2,s[6])-1)<<e-s[8]-s[6])}else h.M[s[0]](r,i);t[e]=i}}else t[e]=i}else t[e]=i;return!0}});return i[u.kE]=n,s}function w(t){const e=t[u.kE];e&&e()}},52699:(t,e,r)=>{"use strict";r.d(e,{t:()=>n,z:()=>s});var i=r(11473);function s(t){return i.GE.value-=t,i.GE.value}function n(t){i.GE.value+=t}},7417:(t,e,r)=>{"use strict";r.d(e,{I:()=>h,h:()=>c});var i,s,n=r(10576);let o=1;function a(t,e=1){let r=o;for(;r%e;)r+=1;return o=r+t,r}const c=null!==(i=n.TK.CHeap)&&void 0!==i&&i.threadCounter?n.TK.CHeap.threadCounter:a(4,4),h=null!==(s=n.TK.CHeap)&&void 0!==s&&s.heapMutex?n.TK.CHeap.heapMutex:a(4,4)},79630:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(134),s=r(63939),n=r(50932),o=r(11473),a=r(61403);class c{constructor(t,e){(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"len",void 0),this.pointer=t,this.len=e}get byteLength(){return this.len}get buffer(){return(0,o.eq)().buffer}get byteOffset(){return this.pointer}getFloat32(t,e){return(0,o.KZ)().getFloat32(this.pointer+t,e)}getFloat64(t,e){return(0,o.KZ)().getFloat64(this.pointer+t,e)}getInt8(t){return(0,o.KZ)().getInt8(this.pointer+t)}getInt16(t,e){return(0,o.KZ)().getInt16(this.pointer+t,e)}getInt32(t,e){return(0,o.KZ)().getInt32(this.pointer+t,e)}getUint8(t){return(0,o.KZ)().getUint8(this.pointer+t)}getUint16(t,e){return(0,o.KZ)().getUint16(this.pointer+t,e)}getUint32(t,e){return(0,o.KZ)().getUint32(this.pointer+t,e)}setFloat32(t,e,r){(0,o.KZ)().setFloat32(this.pointer+t,e,r)}setFloat64(t,e,r){(0,o.KZ)().setFloat64(this.pointer+t,e,r)}setInt8(t,e){(0,o.KZ)().setInt8(this.pointer+t,e)}setInt16(t,e,r){(0,o.KZ)().setInt16(this.pointer+t,e,r)}setInt32(t,e,r){(0,o.KZ)().setInt32(this.pointer+t,e,r)}setUint8(t,e){(0,o.KZ)().setUint8(this.pointer+t,e)}setUint16(t,e,r){(0,o.KZ)().setUint16(this.pointer+t,e,r)}setUint32(t,e,r){(0,o.KZ)().setUint32(this.pointer+t,e,r)}getBigInt64(t,e){return(0,o.KZ)().getBigInt64(this.pointer+t,e)}getBigUint64(t,e){return(0,o.KZ)().getBigUint64(this.pointer+t,e)}setBigInt64(t,e,r){(0,o.KZ)().setBigInt64(this.pointer+t,e,r)}setBigUint64(t,e,r){(0,o.KZ)().setBigUint64(this.pointer+t,e,r)}}class h extends a.A{constructor(t,e){return super(),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"len",void 0),this.pointer=t,this.len=e,this.proxy}getIndexValue(t){return s.f[2](this.pointer+t)}setIndexValue(t,e){n.M[2](this.pointer+t,e)}set(t,e=0){(0,o.eq)().set(t,this.pointer+e)}subarray(t=0,e,r){return r?new h(this.pointer+t,(e||this.len)-t):(0,o.eq)().subarray(this.pointer+t,this.pointer+(null!=e?e:this.len))}slice(t=0,e){return(0,o.eq)().slice(this.pointer+t,this.pointer+(null!=e?e:this.len))}get length(){return this.len}get byteLength(){return this.len}get buffer(){return(0,o.eq)().buffer}get byteOffset(){return this.pointer}get view(){return new c(this.pointer,this.len)}}},12264:(t,e,r)=>{"use strict";r.d(e,{A:()=>v});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085),u=r(11473),f=r(63939),d=r(50932),l=r(99921),p=r(14686),m=r(67672),g=r(29170);class A{constructor(){(0,n.A)(this,"prev",void 0),(0,n.A)(this,"next",void 0),(0,n.A)(this,"data",void 0)}}i=A.prototype,(s=new(a())).set("prev",{0:A,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("next",{0:A,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),s.set("data",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,4),(0,h.A)(i,c.g7,12),(0,h.A)(i,c.JY,s);class v{constructor(){(0,n.A)(this,"length",0),(0,n.A)(this,"head",0),(0,n.A)(this,"tail",0)}createNode(t,e,r=!1){const i=u.s_.malloc(12);if(d.M[20](i+4,0),d.M[20](i,0),m.ai(e))if(20===e)d.M[20](i+8,t);else{const r=u.s_.malloc((0,l.A)(e));d.M[e](r,t),d.M[20](i+8,r)}else if(r)d.M[20](i+8,t);else{const r=u.s_.malloc((0,l.A)(e));(0,p.Mr)(r,t[c.o9],(0,l.A)(e)),d.M[20](i+8,r)}return i}getItem(t,e){let r;return r=m.ai(e)?20===e?t:f.f[e](t):(0,g.A)(t,e),r}push(t,e,r=!1){const i=this.createNode(t,e,r);this.tail?(d.M[20](this.tail+4,i),d.M[20](i,this.tail),this.tail=i):(this.head=i,this.tail=i),this.length++}pop(t){const e=this.tail;let r=this.getItem(f.f[20](e+8),t);return this.length>1?(d.M[20](f.f[20](e)+4,0),this.tail=f.f[20](e)):(this.head=0,this.tail=0),this.length--,u.s_.free(f.f[20](e+8)),u.s_.free(e),r}shift(t){const e=this.head;let r=this.getItem(f.f[20](e+8),t);return this.length>1?(d.M[20](f.f[20](e+4),0),this.head=f.f[20](e+4)):(this.head=0,this.tail=0),this.length--,u.s_.free(f.f[20](e+8)),u.s_.free(e),r}unshift(t,e,r=!1){const i=this.createNode(t,e,r);this.head?(d.M[20](this.head,i),d.M[20](i+4,this.head),this.head=i):(this.head=i,this.tail=i),this.length++}forEach(t,e){if(!this.length)return;let r=this.head,i=0;for(;0!==r&&!1!==t(this.getItem(f.f[20](r+8),e),i);)r=f.f[20](r+4),i++}find(t,e){if(!this.length)return 0;let r=this.head,i=0;for(;0!==r;){const s=this.getItem(f.f[20](r+8),e);if(!0===t(s,i))return s;r=f.f[20](r+4),i++}return 0}indexOf(t,e){if(!this.length)return 0;let r=this.head,i=0;for(;0!==r;){if(i===t)return this.getItem(f.f[20](r+8),e);r=f.f[20](r+4),i++}return 0}clear(t,e){if(this.length){let r=this.head;for(;0!==r;){t&&t(this.getItem(f.f[20](r+8),e)),u.s_.free(f.f[20](r+8));const i=f.f[20](r+4);u.s_.free(r),r=i}}this.head=0,this.tail=0,this.length=0}}!function(t){var e=new(a());e.set("length",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("head",{0:A,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("tail",{0:A,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,4),(0,h.A)(t,c.g7,12),(0,h.A)(t,c.JY,e)}(v.prototype)},74503:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(99921),s=r(11473),n=r(14686),o=r(95335),a=r(34677),c=r(29170);function h(t,e){const r=(0,i.A)(t),h=s.s_.malloc(r);if(!h)throw new TypeError("cannot alloc memory for struct");(0,n.sO)(h,0,r);const u=(0,c.A)(h,t),f=new t;return e&&o.X$(f,e),o.__(f,((t,e)=>{(0,a.A)(t)&&(u[e]=t)})),u}},14686:(t,e,r)=>{"use strict";r.d(e,{JW:()=>h,Mr:()=>o,TL:()=>l,cC:()=>f,gd:()=>d,lW:()=>a,s3:()=>u,sO:()=>c});var i=r(11473),s=r(79630),n=r(26429);function o(t,e,r){(0,i.eq)().set((0,i.eq)().subarray(e,e+r),t)}function a(t,e,r){(0,i.eq)().set(r.subarray(0,e),t)}function c(t,e,r){(0,i.eq)().subarray(t,t+r).fill(e)}function h(t,e){return n._7?u(t,e):new s.A(t,e)}function u(t,e){return(0,i.eq)().subarray(t,t+e)}function f(t,e){return(0,i.QY)().subarray(t>>>1,(t>>>1)+e)}function d(t,e){return(0,i.Wo)().subarray(t>>>2,(t>>>2)+e)}function l(t,e){return(0,i.qq)().subarray(t>>>2,(t>>>2)+e)}},99921:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(61499),s=r(67672),n=r(6704);function o(t){return s.ai(t)?n.i[t]||0:s.Pc(t)&&t.prototype[i.Og]?t.prototype[i.g7]:0}},29170:(t,e,r)=>{"use strict";r.d(e,{A:()=>h});var i=r(61499),s=r(80098),n=r(25323),o=r(95797),a=r(67672),c=r(10534);function h(t,e){return arguments[2]&&a.Yj(arguments[2])&&(e=e.prototype,c.__(arguments[2],(t=>{const r=e[i.JY];e=r.get(t)[0]}))),o.A.proxy?(0,s.I_)(t,e):(0,n.l)(t,e)}},94300:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(11473),s=r(61499),n=r(80098),o=r(25323),a=r(95797);function c(t){const e=t[s.o9];e&&(i.s_.free(e),t[s.o9]=0,a.A.proxy?(0,n.SQ)(t):(0,o.X)(t))}},61499:(t,e,r)=>{"use strict";r.d(e,{JY:()=>h,Og:()=>n,dc:()=>a,g7:()=>o,kE:()=>u,o9:()=>c});var i=r(75062),s=r.n(i);const n=s()("Struct"),o=s()("StructLength"),a=s()("StructMaxBaseTypeByteLength"),c=s()("StructAddress"),h=(s()("StructKeysQueue"),s()("StructKeysMeta")),u=(s()("StructKeysInstance"),s()("StructProxyRevoke"))},82854:(t,e,r)=>{"use strict";r.d(e,{Ay:()=>d,KJ:()=>u,Ko:()=>f});var i=r(4919),s=r(4624),n=r(88096),o=r(49583),a=r.n(o),c=r(40046),h="src/cheap/thread/asm/atomics.ts";let u;function f(){return!!u}async function d(t){try{if(!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return;{const e=(0,i.E_)(a());n.DD(e,!0),u=(await WebAssembly.instantiate(e,{env:{memory:t}})).instance}(0,c.$Z)({add:function(t,e,r){switch(r){case 5:case 3:return 255&u.exports.add8(t,e);case 12:return u.exports.add8(t,e);case 14:return u.exports.add16(t,e);case 7:return 65535&u.exports.add16(t,e);case 16:return u.exports.add32(t,e);case 9:return 4294967295&u.exports.add32(t,e);case 21:return u.exports.add64(t,e);case 22:return BigInt.asUintN(64,u.exports.add64(t,e))}},sub:function(t,e,r){switch(r){case 5:case 3:return 255&u.exports.sub8(t,e);case 12:return u.exports.sub8(t,e);case 14:return u.exports.sub16(t,e);case 7:return 65535&u.exports.sub16(t,e);case 16:return u.exports.sub32(t,e);case 9:return 4294967295&u.exports.sub32(t,e);case 21:return u.exports.sub64(t,e);case 22:return BigInt.asUintN(64,u.exports.sub64(t,e))}},and:function(t,e,r){switch(r){case 5:case 3:return 255&u.exports.and8(t,e);case 12:return u.exports.and8(t,e);case 14:return u.exports.and16(t,e);case 7:return 65535&u.exports.and16(t,e);case 16:return u.exports.and32(t,e);case 9:return 4294967295&u.exports.and32(t,e);case 21:return u.exports.and64(t,e);case 22:return BigInt.asUintN(64,u.exports.and64(t,e))}},or:function(t,e,r){switch(r){case 5:case 3:return 255&u.exports.or8(t,e);case 12:return u.exports.or8(t,e);case 14:return u.exports.or16(t,e);case 7:return 65535&u.exports.or16(t,e);case 16:case 9:return u.exports.or32(t,e);case 21:return u.exports.or64(t,e);case 22:return BigInt.asUintN(64,u.exports.or64(t,e))}},xor:function(t,e,r){switch(r){case 5:case 3:return 255&u.exports.xor8(t,e);case 12:return u.exports.xor8(t,e);case 14:return u.exports.xor16(t,e);case 7:return 65535&u.exports.xor16(t,e);case 16:case 9:return u.exports.xor32(t,e);case 21:return u.exports.xor64(t,e);case 22:return BigInt.asUintN(64,u.exports.xor64(t,e))}},store:function(t,e,r){switch(r){case 5:case 12:case 3:return u.exports.store8(t,e);case 14:case 7:return u.exports.store16(t,e);case 16:case 9:return u.exports.store32(t,e);case 21:case 22:return u.exports.store64(t,e)}},load:function(t,e){switch(e){case 5:case 3:return 255&u.exports.load8(t);case 12:return u.exports.load8(t);case 14:case 7:return u.exports.load16(t);case 16:return u.exports.load32(t);case 9:return 4294967295&u.exports.load32(t);case 21:return u.exports.load64(t);case 22:return BigInt.asUintN(64,u.exports.load64(t))}},compareExchange:function(t,e,r,i){switch(i){case 5:case 3:return 255&u.exports.compare_exchange8(t,e,r);case 12:return u.exports.compare_exchange8(t,e,r);case 14:return u.exports.compare_exchange16(t,e,r);case 7:return 65535&u.exports.compare_exchange16(t,e,r);case 16:return u.exports.compare_exchange32(t,e,r);case 9:return 4294967295&u.exports.compare_exchange32(t,e,r);case 21:return u.exports.compare_exchange64(t,e,r);case 22:return BigInt.asUintN(64,u.exports.compare_exchange64(t,e,r))}},exchange:function(t,e,r){switch(r){case 5:case 3:return 255&u.exports.exchange8(t,e);case 12:return u.exports.exchange8(t,e);case 14:return u.exports.exchange16(t,e);case 7:return 65535&u.exports.exchange16(t,e);case 16:return u.exports.exchange32(t,e);case 9:return 4294967295&u.exports.exchange32(t,e);case 21:return u.exports.exchange64(t,e);case 22:return BigInt.asUintN(64,u.exports.exchange64(t,e))}},notify:function(t,e){return u.exports.notify(t,e)},wait:function(t,e){return u.exports.wait(t,e)},waitTimeout:function(t,e,r){return u.exports.waitTimeout(t,e,BigInt(r>>>0))}})}catch(t){s.R8("atomics asm not support, cannot use asm atomics function",h,284)}}},40046:(t,e,r)=>{"use strict";let i,s,n,o,a,c,h,u,f,d,l,p,m,g;function A(t){t.add&&(i=t.add),t.sub&&(s=t.sub),t.and&&(n=t.and),t.or&&(o=t.or),t.xor&&(a=t.xor),t.store&&(c=t.store),t.load&&(h=t.load),t.compareExchange&&(u=t.compareExchange),t.exchange&&(f=t.exchange),t.notify&&(d=t.notify),t.wait&&(l=t.wait),t.waitTimeout&&(p=t.waitTimeout),t.waitAsync&&(m=t.waitAsync),t.waitTimeoutAsync&&(g=t.waitTimeoutAsync)}r.d(e,{$Z:()=>A,Hh:()=>h,I8:()=>a,M_:()=>c,Uo:()=>n,WQ:()=>i,cv:()=>f,j4:()=>p,jb:()=>s,me:()=>d,or:()=>o,p_:()=>u,uk:()=>l})},33856:(t,e,r)=>{"use strict";r.d(e,{A:()=>C});var i=r(54001),s=r.n(i),n=r(86932),o=r(7972),a=r(40046),c=r(26429),h=r(39638),u=r(86834);let f;const d=c._7||(0,h.A)()||!u.A.chrome||u.A.checkVersion(u.A.majorVersion,"94",!0);function l(t,e,r,i){if(d)return Atomics.add(f(r),t>>>i,e);{const s=f(r),n=t>>>i,o=s[n];return s[n]+=e,o}}function p(t,e,r,i){if(d)return Atomics.sub(f(r),t>>>i,e);{const s=f(r),n=t>>>i,o=s[n];return s[n]-=e,o}}function m(t,e,r,i){if(d)return Atomics.and(f(r),t>>>i,e);{const s=f(r),n=t>>>i,o=s[n];return s[n]&=e,o}}function g(t,e,r,i){if(d)return Atomics.or(f(r),t>>>i,e);{const s=f(r),n=t>>>i,o=s[n];return s[n]|=e,o}}function A(t,e,r,i){if(d)return Atomics.xor(f(r),t>>>i,e);{const s=f(r),n=t>>>i,o=s[n];return s[n]^=e,o}}function v(t,e,r,i){if(d)return Atomics.store(f(r),t>>>i,e);{const s=f(r),n=t>>>i,o=s[n];return s[n]=e,o}}function w(t,e,r){return d?Atomics.load(f(e),t>>>r):f(e)[t>>>r]}function y(t,e,r,i,s){if(d)return Atomics.compareExchange(f(i),t>>>s,e,r);{const n=f(i),o=t>>>s,a=n[o];return a===e&&(n[o]=r),a}}function b(t,e,r,i){if(d)return Atomics.exchange(f(r),t>>>i,e);{const s=f(r),n=t>>>i,o=s[n];return s[n]=e,o}}function k(t,e){return d?Atomics.notify(f(16),t>>>2,e):void 0}const _={ok:0,"not-equal":1,"timed-out":2};function x(t,e){return _[Atomics.wait(f(16),t>>>2,e)]}function I(t,e,r){return _[Atomics.wait(f(16),t>>>2,e,r)]}async function M(t,e){if(Atomics.waitAsync){const r=Atomics.waitAsync(f(16),t>>>2,e);return r.async?_[await r.value]:_[r.value]}if(w(t)!==e)return 1;for(;w(t)===e;)await new(s())((t=>{(0,o.A)((()=>{t()}))}));return 0}async function P(t,e,r){if(Atomics.waitAsync){const i=Atomics.waitAsync(f(16),t>>>2,e,r);return i.async?_[await i.value]:_[i.value]}if(w(t)!==e)return 1;{const i=(0,n.A)();for(;w(t)===e&&(0,n.A)()-i<r;)await new(s())((t=>{(0,o.A)((()=>{t()}))}));return w(t)!==e?0:2}}function C(t){f=t,(0,a.$Z)({add:l,sub:p,and:m,or:g,xor:A,store:v,load:w,compareExchange:y,exchange:b,notify:k,wait:x,waitTimeout:I,waitAsync:M,waitTimeoutAsync:P})}},42518:(t,e,r)=>{"use strict";r.d(e,{Ts:()=>d,XR:()=>A,mq:()=>m,uk:()=>g,vP:()=>p,zr:()=>l});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085),u=r(73783),f=r(40046);function d(t,e){return f.M_(t,0,16,2),0}function l(t){return f.M_(t,0,16,2),0}function p(t){return f.WQ(t,1,16,2),f.me(t,1),0}function m(t){return f.WQ(t,1,16,2),f.me(t,1073741824),0}function g(t,e){let r=f.Hh(t,16,2);return u.Tl(e),f.uk(t,r),u.s2(e),0}function A(t,e,r){let i=f.Hh(t,16,2);u.Tl(e);let s=f.j4(t,i,r);return u.s2(e),2===s?110:0}i=class{constructor(){(0,n.A)(this,"atomic",void 0)}}.prototype,(s=new(a())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,4),(0,h.A)(i,c.g7,4),(0,h.A)(i,c.JY,s)},81574:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(84149),s=r(10576),n=r(67672);let o=s.TK;function a(t){let e,r;o.onmessage=a=>{const c=a.data,h=c.type,u=c.data;switch(h){case"init":if(s.TK.CHeap&&s.TK.CHeap.initThread)return void s.TK.CHeap.initThread(u).then((()=>{o.postMessage({type:"ready"})}));o.postMessage({type:"ready"});break;case"run":o.postMessage({type:"running"}),r=t(u.params),f=u.port,e=new i.Ay(f),e.on(i.S3,(async t=>{const i=t.method,s=t.params;if(n.Pc(r[i]))try{const n=[],o=await r[i](...s.params,n);e.reply(t,o,null,n)}catch(r){e.reply(t,-2097152,{message:r.message})}}));break;case"stop":e&&e.destroy(),o.postMessage({type:"stopped"})}var f}}},26848:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var i=r(10576);let s=i.TK;function n(t){let e;s.onmessage=r=>{const n=r.data,o=n.type,a=n.data;switch(o){case"init":if(i.TK.CHeap&&i.TK.CHeap.initThread)return void i.TK.CHeap.initThread(a).then((()=>{s.postMessage({type:"ready"})}));s.postMessage({type:"ready"});break;case"run":e=t(a.params);break;case"stop":e&&e.then?e.then((t=>{s.postMessage({type:"stopped",data:t})})):s.postMessage({type:"stopped",data:e})}}}},67524:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(84149),s=r(10576),n=r(67672);let o=s.TK;function a(t){let e;o.onmessage=r=>{const a=r.data,c=a.type,h=a.data;switch(c){case"init":if(s.TK.CHeap&&s.TK.CHeap.initThread)return void s.TK.CHeap.initThread(h).then((()=>{o.postMessage({type:"ready"})}));o.postMessage({type:"ready"});break;case"run":o.postMessage({type:"running"}),u=h.port,e=new i.Ay(u),e.on(i.S3,(async r=>{const i=r.method,s=r.params;if(n.Pc(t[i]))try{const n=[],o=await t[i](...s.params,n);e.reply(r,o,null,n)}catch(t){e.reply(r,-2097152,{message:t.message})}}));break;case"stop":e&&e.destroy(),o.postMessage({type:"stopped"})}var u}}},73783:(t,e,r)=>{"use strict";r.d(e,{Tl:()=>m,Ts:()=>l,eu:()=>d,s2:()=>p,zr:()=>g});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085),u=r(40046),f=r(39638);class d{constructor(){(0,n.A)(this,"atomic",void 0)}}function l(t){return u.M_(t,0,16,2),0}function p(t,e=!1){let r;if(0!==(r=u.p_(t,0,1,16,2)))do{2!=r&&0===u.p_(t,1,2,16,2)||!e&&(0,f.A)()&&u.uk(t,2)}while(0!==(r=u.p_(t,0,2,16,2)));return 0}function m(t){return 1!==u.jb(t,1,16,2)&&(u.M_(t,0,16,2),u.me(t,1)),0}function g(t){return u.M_(t,0,16,2),0}i=d.prototype,(s=new(a())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,4),(0,h.A)(i,c.g7,4),(0,h.A)(i,c.JY,s)},79490:(t,e,r)=>{"use strict";r.d(e,{Ts:()=>p,XR:()=>w,Zr:()=>v,bE:()=>g,uk:()=>A,zr:()=>m});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085),u=r(73783),f=r(63939),d=r(50932),l=r(40046);function p(t,e){return l.M_(t,0|e,16,2),u.Ts(t+4),0}function m(t){return u.zr(t+4),0}function g(t){return l.WQ(t,1,16,2),l.me(t,1),0}function A(t){for(;l.uk(t,0),l.jb(t,1,16,2)<=0;)l.WQ(t,1,16,2);return 0}function v(t){return u.s2(t+4),f.f[16](t)>0?(d.M[16](t,f.f[16](t)-1),u.Tl(t+4),0):(u.Tl(t+4),11)}function w(t,e){return 2!==l.j4(t,0,e)&&l.jb(t,1,16,2)<=0?(l.WQ(t,1,16,2),110):0}i=class{constructor(){(0,n.A)(this,"atomic",void 0),(0,n.A)(this,"mutex",void 0)}}.prototype,(s=new(a())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("mutex",{0:u.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,4),(0,h.A)(i,c.g7,8),(0,h.A)(i,c.JY,s)},88506:(t,e,r)=>{"use strict";r.d(e,{nE:()=>_,pt:()=>k});var i=r(75062),s=r.n(i),n=r(80662),o=r.n(n),a=r(54001),c=r.n(a),h=r(11473),u=r(84149),f=r(61837),d=r(26429),l=r(67672),p=r(10576),m=r(62100);let g=p.TK.Worker,A=p.TK.MessageChannel;r(81574),r(26848),r(67524);const v=(0,f.A)(81574,{varName:"init"}),w=((0,f.A)(26848,{varName:"init"}),(0,f.A)(67524,{varName:"init"}),s()("revoke")),y=new(o());function b(t,e){return`${t}_${e}`}function k(t,e={},r){let i,s=[];function n(...e){const i=new t(...e);return new(c())((e=>{const s={$worker:null,$ipc:null,$channel:null,$moduleId:(0,m.A)(r),$stackPointer:0,$instance:i,$type:"class"},{proxy:n,revoke:o}=Proxy.revocable(s,{get(e,r,n){if(e[r])return s[r];if(r in t.prototype&&"function"==typeof t.prototype[r]){const t=function(...t){return i[r](...t)};t.transfer=function(...t){return{invoke:function(...t){return i[r](...t)}}},e[r]=t}return e[r]}});s[w]=o,e(n)}))}return i=(...i)=>{let n;if(r instanceof g)n=r;else{let e;const i=b(r,"class");if(y.has(i))e=y.get(i).url,y.get(i).refCount++;else{const s=`\n            ${(0,f.A)(r,{varName:`__module_${t.name}__`,exportName:`__${t.name}__`,pointName:t.name,exportIsClass:!0})}\n            function run(params) {\n              params.unshift(null)\n              return new (Function.prototype.bind.apply(__module_${t.name}__.__${t.name}__, params))()\n            }\n            ${v}\n            init.default(run);\n          `;{const t=new Blob([s],{type:"text/javascript"});e=URL.createObjectURL(t)}y.set(i,{url:e,refCount:1})}n=new g(e)}const o=new A;return new(c())(((a,c)=>{var f;const l=h.s_.alignedAlloc(d.ZI,e.stackSize?e.stackSize+d.ZI&~d.ZI:d.pw),p=e=>{const c=e.data,h=c.type;switch(c.data,h){case"ready":n.postMessage({type:"run",data:{port:o.port2,params:i}},[o.port2,...s]);break;case"running":!function(){const e=new u.Ay(o.port1),i={$worker:n,$ipc:e,$channel:o,$moduleId:(0,m.A)(r),$stackPointer:l,$type:"class"},{proxy:s,revoke:c}=Proxy.revocable(i,{get(r,s,n){if(r[s])return i[s];if(s in t.prototype&&"function"==typeof t.prototype[s]){const t=async function(...t){return e.request(s,{params:t})};t.transfer=function(...t){return{invoke:async function(...r){return e.request(s,{params:r},t)}}},r[s]=t}return r[s]}});i[w]=c,a(s)}()}};n.onmessage=p,n.onmessage=p,n.postMessage({type:"init",data:{memory:h.ce,name:e.name||t.name,stackPointer:l,stackSize:null!==(f=e.stackSize)&&void 0!==f?f:d.pw}})}))},{run:d._7&&!e.disableWorker?i:n,transfer:function(...t){return s=t,{run:d._7&&!e.disableWorker?i:n}}}}function _(t){if(t.$worker&&(t.$worker.terminate(),t.$worker=null),t.$moduleId){if(l.Yj(t.$moduleId)){const e=b(t.$moduleId,t.$type);y.has(e)&&(y.get(e).refCount--,0===y.get(e).refCount&&(URL.revokeObjectURL(y.get(e).url),y.delete(e)))}t.$moduleId=null}if(t.$ipc&&(t.$ipc.destroy(),t.$ipc=null),t.$stackPointer&&(h.s_.free(t.$stackPointer),t.$stackPointer=0),t.$channel=null,t.$instance=null,t[w]){const e=t[w];t[w]=null,e()}}},6704:(t,e,r)=>{"use strict";r.d(e,{_:()=>s,i:()=>i});const i={2:1,3:1,4:1,5:1,6:2,7:2,8:4,9:4,10:8,11:1,12:1,13:2,14:2,15:4,16:4,17:8,18:4,19:8,20:4,0:4,1:4,22:8,21:8,23:1,24:1},s={2:0,3:0,4:0,5:0,6:1,7:1,8:2,9:2,10:4,11:0,12:0,13:1,14:1,15:2,16:2,17:4,18:2,19:4,20:2,1:2,0:2,22:4,21:4,23:0,24:0}},16030:(t,e,r)=>{"use strict";r.d(e,{A:()=>L});var i=r(134),s=r(80662),n=r.n(s),o=r(54001),a=r.n(o),c=r(61499),h=r(12085),u=r(11473),f=r(50932),d=r(63939),l=r(95335),p=r(72739),m=r(4624),g=r(67672),A=r(14686),v=r(14621),w=r(1708),y=r(20357),b=r(77775),k=r(61837),_=r(26429),x=r(40046),I=r(82854),M=r(24565),P=r(80905),C=r(39638),B="src/cheap/webassembly/WebAssemblyRunner.ts";r(81999);const T=(0,k.A)(81999,{varName:"init"});function E(){}let U=!1;var S,R;S=class{constructor(){(0,i.A)(this,"flags",void 0)}}.prototype,(R=new(n())).set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,h.A)(S,c.Og,!0),(0,h.A)(S,c.dc,4),(0,h.A)(S,c.g7,4),(0,h.A)(S,c.JY,R);class L{static getTable(){return u.XI}constructor(t,e={}){var r;if((0,i.A)(this,"resource",void 0),(0,i.A)(this,"instance",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"builtinMalloc",void 0),(0,i.A)(this,"memoryBase",void 0),(0,i.A)(this,"tableBase",void 0),(0,i.A)(this,"childImports",void 0),(0,i.A)(this,"childUrl",void 0),(0,i.A)(this,"childBlob",void 0),(0,i.A)(this,"childThreads",void 0),(0,i.A)(this,"imports",void 0),(0,i.A)(this,"childReadyPromises",void 0),this.resource=t,this.builtinMalloc=[],this.childThreads=new(n()),this.childReadyPromises=[],g.Yj(e.childImports)?this.childImports=e.childImports:g.Ik(e.childImports)&&e.childImports instanceof Blob&&(this.childImports=URL.createObjectURL(e.childImports)),this.memoryBase=t.dataSize?u.s_.malloc(t.dataSize):0,e.thread&&e.tableBase&&u.XI.getPointer()!==e.tableBase&&u.XI.alloc(e.tableBase-u.XI.getPointer()),this.tableBase=t.tableSize?u.XI.alloc(t.tableSize):0,this.options=e,this.imports={env:{memory:u.ce,__stack_pointer:u.GE,__indirect_function_table:u.XI.table,clock_time_get:v.WU,clock_res_get:v.Lq,random_get:v.Pp,abort:v.h2,proc_exit:function(t){m.z3(`wasm module exit, code: ${t}`,B,135)},__syscall_renameat:function(){},__syscall_unlinkat:function(){},environ_get:E,environ_sizes_get:E,fd_close:E,fd_fdstat_get:v.LS,fd_read:E,fd_seek:E,fd_write:v.nK,emscripten_builtin_malloc:t=>{const e=u.s_.malloc(t);return this.builtinMalloc.push(e),e},emscripten_builtin_free:t=>{u.s_.free(t)},emscripten_builtin_memalign:(t,e,r)=>{const i=u.s_.alignedAlloc(e,r);return 0!==i?(f.M[20](t,i),this.builtinMalloc.push(i),0):-1},emscripten_memcpy_big:function(t,e,r){(0,A.Mr)(t,e,r)},__libc_malloc:function(t){return u.s_.malloc(t)},__libc_free:t=>{u.s_.free(t)},malloc:function(t){return u.s_.malloc(t)},calloc:function(t,e){return u.s_.calloc(t,e)},realloc:function(t,e){return u.s_.realloc(t,e)},aligned_alloc:(t,e)=>u.s_.alignedAlloc(t,e),free:function(t){u.s_.free(t)},posix_memalign:function(t,e,r){const i=u.s_.alignedAlloc(e,r);return 0!==i?(f.M[20](t,i),0):-1}},"GOT.func":{malloc:new WebAssembly.Global({mutable:!0,value:"i32"},2),free:new WebAssembly.Global({mutable:!0,value:"i32"},1),calloc:new WebAssembly.Global({mutable:!0,value:"i32"},3),realloc:new WebAssembly.Global({mutable:!0,value:"i32"},4),aligned_alloc:new WebAssembly.Global({mutable:!0,value:"i32"},5)}},l.X$(this.imports.env,{wasm_pthread_create:(t,e,r,i)=>{if(!this.childUrl){const t=`\n              ${(0,k.A)(16030,{varName:"__WebAssemblyRunner__",exportName:"__WebAssemblyRunner__",pointName:L.name,exportIsClass:!0})}\n              ${T}\n              var preRun;\n              ${this.childImports?`\n              preRun = import('${this.childImports}')\n              `:""}\n              init.default(preRun);\n            `;this.childBlob=new Blob([t],{type:"text/javascript"}),this.childUrl=URL.createObjectURL(this.childBlob)}const s=new Worker(this.childUrl);f.M[15](t,(0,u.pv)()),f.M[16](t+12,1),f.M[15](t+8,0),f.M[20](t+4,0);const n=u.s_.alignedAlloc(_.ZI,_.pw),o=u.s_.malloc(4);let c;return(0,A.sO)(o,0,4),this.childThreads.set(d.f[15](t),{thread:t,worker:s,stackPointer:n,threadDescriptor:o}),this.childReadyPromises.push(new(a())((t=>{c=t}))),s.onmessage=t=>{const e=t.data,r=e.type;e.data,"run"===r&&c()},s.postMessage({type:"run",data:{cheap:{memory:u.ce,stackPointer:n,stackSize:_.pw,id:d.f[15](t)},runner:{resource:{tableSize:this.resource.tableSize,module:this.resource.threadModule.module,initFuncs:this.resource.threadModule.initFuncs},options:{memoryBase:this.options.memoryBase||this.memoryBase,tableBase:this.tableBase,thread:t,threadDescriptor:o,childImports:this.childImports},func:r,args:i,imports:this.childImports,thread:t}}}),0},wasm_pthread_join2:(t,e)=>{if(1&d.f[15](t+8))return this.childThreads.delete(d.f[15](t)),0;x.uk(t+12,1),0!==e&&f.M[20](e,d.f[20](t+4));const r=this.childThreads.get(d.f[15](t));return u.s_.free(r.stackPointer),u.s_.free(r.threadDescriptor),r.worker.terminate(),this.childThreads.delete(d.f[15](t)),0},wasm_pthread_detach2:t=>{const e=this.childThreads.get(d.f[15](t));f.M[15](e.threadDescriptor,1|d.f[15](e.threadDescriptor)),f.M[15](t+8,1|d.f[15](t+8))}}),l.X$(this.imports.env,w),l.X$(this.imports.env,y),l.X$(this.imports.env,b),this.memoryBase?l.X$(this.imports.env,{__memory_base:this.memoryBase}):e.memoryBase&&l.X$(this.imports.env,{__memory_base:e.memoryBase}),this.tableBase&&l.X$(this.imports.env,{__table_base:this.tableBase}),null!==(r=e.imports)&&void 0!==r&&r.env&&(l.X$(this.imports.env,e.imports.env),e.envKey&&e.importMap)){const t={};l.__(this.imports.env,((r,i)=>{e.importMap[i]&&(t[e.importMap[i]]=r)})),this.imports[e.envKey]=t}this.imports.wasi_snapshot_preview1=this.imports.env}overrideAtomic(){w.override({atomic_add_i8:I.KJ.exports.add8,atomic_sub_i8:I.KJ.exports.sub8,atomic_and_i8:I.KJ.exports.and8,atomic_or_i8:I.KJ.exports.or8,atomic_xor_i8:I.KJ.exports.xor8,atomic_store_i8:I.KJ.exports.store8,atomic_load_i8:I.KJ.exports.load8,atomic_compare_exchange_i8:I.KJ.exports.compare_exchange8,atomic_exchange_i8:I.KJ.exports.exchange8,atomic_add_i16:I.KJ.exports.add16,atomic_sub_i16:I.KJ.exports.sub16,atomic_and_i16:I.KJ.exports.and16,atomic_or_i16:I.KJ.exports.or16,atomic_xor_i16:I.KJ.exports.xor16,atomic_store_i16:I.KJ.exports.store16,atomic_load_i16:I.KJ.exports.load16,atomic_compare_exchange_i16:I.KJ.exports.compare_exchange16,atomic_exchange_i16:I.KJ.exports.exchange16,atomic_add_i32:I.KJ.exports.add32,atomic_sub_i32:I.KJ.exports.sub32,atomic_and_i32:I.KJ.exports.and32,atomic_or_i32:I.KJ.exports.or32,atomic_xor_i32:I.KJ.exports.xor32,atomic_store_i32:I.KJ.exports.store32,atomic_load_i32:I.KJ.exports.load32,atomic_compare_exchange_i32:I.KJ.exports.compare_exchange32,atomic_exchange_i32:I.KJ.exports.exchange32,atomic_add_i64:I.KJ.exports.add64,atomic_sub_i64:I.KJ.exports.sub64,atomic_and_i64:I.KJ.exports.and64,atomic_or_i64:I.KJ.exports.or64,atomic_xor_i64:I.KJ.exports.xor64,atomic_store_i64:I.KJ.exports.store64,atomic_load_i64:I.KJ.exports.load64,atomic_compare_exchange_i64:I.KJ.exports.compare_exchange64,atomic_exchange_i64:I.KJ.exports.exchange64,atomics_notify:I.KJ.exports.notify,atomics_wait:I.KJ.exports.wait}),l.X$(this.imports.env,w)}async run(t){g.Ik(t)&&l.X$(this.options.imports,t),(0,C.A)()&&!M.LK&&M.Ko()&&this.resource.threadModule&&(await M.Ts(u.ce,y.override),l.X$(this.imports.env,y)),!U&&I.Ko()&&(U=!0,this.overrideAtomic()),P.Ko()&&!P.LK&&await P.Ts(u.ce),this.instance=await WebAssembly.instantiate(this.resource.module,this.imports),this.initRunTime()}async runAsChild(t){g.Ik(t)&&l.X$(this.options.imports,t),!M.LK&&M.Ko()&&(await M.Ts(u.ce,y.override),l.X$(this.imports.env,y)),!U&&I.Ko()&&(U=!0,this.overrideAtomic()),this.instance=new WebAssembly.Instance(this.resource.module,this.imports),this.initRunTime()}async childrenThreadReady(){if(!this.childReadyPromises.length)return;const t=this.childReadyPromises;this.childReadyPromises=[],await a().all(t)}initRunTime(){this.builtinMalloc=[],g.YO(this.resource.initFuncs)&&p.__(this.resource.initFuncs,(t=>{let e;if(this.asm[t]&&(e=this.asm[t]),e)return e()}))}call(t,...e){if(!this.asm)return-1;let r;if(this.asm[t]?r=this.asm[t]:this.options.exportMap&&this.options.exportMap[t]&&this.asm[this.options.exportMap[t]]&&(r=this.asm[this.options.exportMap[t]]),r)return r.apply(null,e);m.z3(`the wasm module has not function ${t} to call`,B,514)}get asm(){return this.instance&&this.instance.exports}getInstance(){return this.instance}destroy(){var t;null!==(t=this.builtinMalloc)&&void 0!==t&&t.length&&(p.__(this.builtinMalloc,(t=>{u.s_.free(t)})),this.builtinMalloc.length=0),this.memoryBase&&(u.s_.free(this.memoryBase),this.memoryBase=null),this.tableBase&&(u.XI.free(this.tableBase),this.tableBase=null),this.childImports&&(URL.revokeObjectURL(this.childImports),this.childImports=null),this.childUrl&&(URL.revokeObjectURL(this.childUrl),this.childUrl=null),this.childBlob=null,this.childReadyPromises.length=0,this.childThreads.size&&this.childThreads.forEach(((t,e)=>{1&d.f[15](t.threadDescriptor)||(m.R8("has child thread running, maybe resource leakage",B,559),t.worker.terminate(),f.M[16](t.thread+12,0),t.stackPointer&&u.s_.free(t.stackPointer),u.s_.free(t.threadDescriptor),this.childThreads.delete(e))})),this.builtinMalloc=null,this.instance=null,this.options.thread&&(this.options.threadDescriptor&&1&d.f[15](this.options.threadDescriptor)?(u.wE&&u.s_.free(u.wE),u.s_.free(this.options.threadDescriptor),self.close()):(f.M[16](this.options.thread+12,0),x.me(this.options.thread+12,1)))}}},76045:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(54001),s=r.n(i),n=r(67672),o=r(24175),a=r(34531),c=r(88096),h=r(92647),u=r(95335),f=r(26429);async function d(t,e={}){let r,i,d,l;if(e=u.X$({enableThread:f._7,initFuncs:e.child?[]:["__wasm_apply_data_relocs","__wasm_call_ctors","_initialize"]},e),n.ai(t.dataSize)&&n.ai(t.tableSize))if(i=t.dataSize,d=t.dataSize,n.Yj(t.source)){const e={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(n.Pc(WebAssembly.compileStreaming))r=await WebAssembly.compileStreaming(fetch(t.source,e));else{const i=await fetch(t.source,e);l=await i.arrayBuffer(),r=await WebAssembly.compile(l)}}else r=await WebAssembly.compile(t.source),l=n.sv(t.source)?t.source:t.source.buffer;else{const u={ioReader:new o.A(1048576),ioWriter:new a.A(1048576),bufferEnded:!1,compileStopped:!1,error:"",abortController:null,pullResolve:null,bufferResolve:null,buffers:[],data:{},options:e},f=new Response(new ReadableStream({async start(e){if(n.Yj(t.source)){var r;AbortController&&(u.abortController=new AbortController);const i={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade",signal:null===(r=u.abortController)||void 0===r?void 0:r.signal},s=await fetch(t.source,i);let n;s.ok&&s.status>=200&&s.status<=299?n=s.body.getReader():e.error(`Http code invalid, ${s.status} ${s.statusText}`);const o=[];u.ioReader.onFlush=async t=>{let e=0;for(;o.length&&e<t.length;){const r=o.shift();r.length>t.length-e?(t.set(r.subarray(0,t.length-e),e),o.unshift(r.subarray(t.length-e)),e=t.length):(t.set(r,e),e+=r.length)}if(e>=t.length)return t.length;const{value:r,done:i}=await n.read();return i?e>0?e:-1048576:(u.buffers.push(r),r.length>t.length-e?(t.set(r.subarray(0,t.length-e),e),o.push(r.subarray(t.length-e)),t.length):(t.set(r,e),e+=r.length,e))}}else{let e=0,r=t.source.byteLength;const i=n.sv(t.source)?new Uint8Array(t.source):t.source;u.ioReader.onFlush=async t=>{if(e>=r)return-1048576;const s=Math.min(t.length,r-e);return t.set(i.subarray(e,e+s),0),e+=s,s}}u.ioWriter.onFlush=async t=>u.pullResolve?(u.pullResolve(t.slice()),u.pullResolve=null,0):((await new(s())(((t,e)=>{u.bufferResolve=t}))).enqueue(t.slice()),0),async function(t){try{for(await t.ioWriter.writeUint32(await t.ioReader.readUint32()),await t.ioWriter.writeUint32(await t.ioReader.readUint32());;){if(t.compileStopped){t.abortController&&t.abortController.abort();break}const e=await t.ioReader.readUint8();if(t.options.child&&11===e){await t.ioWriter.writeUint8(e),await(0,c.$z)(t.ioWriter,7),await(0,c.$z)(t.ioWriter,1),await(0,c.$z)(t.ioWriter,0),await t.ioWriter.writeUint8(65),await t.ioWriter.writeUint8(0),await t.ioWriter.writeUint8(11),await(0,c.$z)(t.ioWriter,1),await t.ioWriter.writeUint8(0);const r=await(0,c.GG)(t.ioReader);await t.ioReader.skip(r);continue}await t.ioWriter.writeUint8(e);const r=await(0,c.GG)(t.ioReader);await(0,c.$z)(t.ioWriter,r);const i=t.ioReader.getPos();if(11===e){const e=await(0,c.GG)(t.ioReader);if(await(0,c.$z)(t.ioWriter,e),e){for(await(0,c.$z)(t.ioWriter,await(0,c.GG)(t.ioReader));;){const e=await t.ioReader.readUint8();if(await t.ioWriter.writeUint8(e),11===e)break}t.data.dataSize=await(0,c.GG)(t.ioReader),await(0,c.$z)(t.ioWriter,t.data.dataSize)}}else if(2===e){let e=await(0,c.GG)(t.ioReader);await(0,c.$z)(t.ioWriter,e);let r=0;for(;e--;){const e=await(0,c.GG)(t.ioReader);await(0,c.$z)(t.ioWriter,e),await t.ioWriter.writeBuffer(await t.ioReader.readBuffer(e));const i=await(0,c.GG)(t.ioReader);await(0,c.$z)(t.ioWriter,i),await t.ioWriter.writeBuffer(await t.ioReader.readBuffer(i));const s=await t.ioReader.readUint8();switch(await t.ioWriter.writeUint8(s),s){case 0:await(0,c.$z)(t.ioWriter,await(0,c.GG)(t.ioReader));break;case 3:await(0,c.p7)(t.ioWriter,await(0,c.Ee)(t.ioReader)),await(0,c.$z)(t.ioWriter,await(0,c.GG)(t.ioReader));break;case 2:{let e=await(0,c.GG)(t.ioReader);t.options.enableThread?e|=2:e&=-3,await(0,c.$z)(t.ioWriter,e),await(0,c.$z)(t.ioWriter,await(0,c.GG)(t.ioReader)),1&e&&await(0,c.$z)(t.ioWriter,await(0,c.GG)(t.ioReader)),r++;break}case 1:{await(0,c.p7)(t.ioWriter,await(0,c.Ee)(t.ioReader));const e=await(0,c.GG)(t.ioReader);await(0,c.$z)(t.ioWriter,e);const i=await(0,c.GG)(t.ioReader);await(0,c.$z)(t.ioWriter,i),t.data.tableSize=i,1&e&&await(0,c.$z)(t.ioWriter,await(0,c.GG)(t.ioReader)),r++;break}}if(2===r)break}}r-Number(t.ioReader.getPos()-i)&&await t.ioReader.pipe(t.ioWriter,r-Number(t.ioReader.getPos()-i))}}catch(e){-1048576===t.ioReader.error?t.bufferEnded=!0:t.error=e,t.ioReader.remainingLength()&&await t.ioWriter.writeBuffer(await t.ioReader.readBuffer(t.ioReader.remainingLength())),await t.ioWriter.flush()}}(u)},async pull(t){if(u.error)t.close();else{if(u.bufferResolve)return u.bufferResolve(t),void(u.bufferResolve=null);t.enqueue(await new(s())(((t,e)=>{u.pullResolve=t}))),u.bufferEnded?t.close():u.error&&t.error(u.error)}},cancel(t){u.compileStopped=!0}}),{headers:{"Content-Type":"application/wasm"}});r=n.Pc(WebAssembly.compileStreaming)?await WebAssembly.compileStreaming(f):await WebAssembly.compile(await f.arrayBuffer()),l=n.Yj(t.source)?(0,h.A)(Uint8Array,u.buffers).buffer:n.sv(t.source)?t.source:t.source.buffer,i=u.data.tableSize,d=u.data.dataSize}return e.child?{module:r,initFuncs:e.initFuncs||[]}:{module:r,tableSize:i,dataSize:d,initFuncs:e.initFuncs||[],buffer:l}}},81999:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var i=r(10576);i.TK.imports={env:{}};let s=i.TK;function n(t){s.onmessage=e=>{const r=e.data,n=r.type,o=r.data;let a;"run"===n&&(s.postMessage({type:"run"}),i.TK.CHeap&&i.TK.CHeap.initThread&&i.TK.CHeap.initThread(o.cheap).then((()=>{function e(){i.TK.__SELF_THREAD__=o.runner.thread,o.runner.options.imports=i.TK.imports,a=new __WebAssemblyRunner__.__WebAssemblyRunner__(o.runner.resource,o.runner.options),a.runAsChild().then((()=>{__WebAssemblyRunner__.__WebAssemblyRunner__.getTable().get(o.runner.func)(o.runner.args),a.destroy()}))}t?t.then((()=>{e()})):e()})))}}},80905:(t,e,r)=>{"use strict";r.d(e,{Ko:()=>d,LK:()=>u,Ts:()=>l});var i=r(11473),s=r(4919),n=r(4624),o=r(97134),a=r.n(o),c=r(88096),h="src/cheap/webassembly/runtime/asm/libc.ts";let u,f=!0;function d(){return f}async function l(t){try{if(!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return void(f=!1);{const e=(0,s.E_)(a());c.DD(e,!0),u=(await WebAssembly.instantiate(e,{env:{memory:t,malloc:function(t){return i.s_.malloc(t)},calloc:function(t,e){return i.s_.calloc(t,e)},realloc:function(t,e){return i.s_.realloc(t,e)},aligned_alloc:(t,e)=>i.s_.alignedAlloc(t,e),free:function(t){i.s_.free(t)}}})).instance,i.XI.set(2,u.exports.malloc),i.XI.set(1,u.exports.free),i.XI.set(3,u.exports.calloc),i.XI.set(4,u.exports.realloc),i.XI.set(5,u.exports.alignedAlloc)}}catch(t){f=!1,n.R8("thread asm not support, cannot use asm thread function",h,64)}}},24565:(t,e,r)=>{"use strict";r.d(e,{Ko:()=>f,LK:()=>h,Ts:()=>d});var i=r(4919),s=r(4624),n=r(5454),o=r.n(n),a=r(88096),c="src/cheap/webassembly/runtime/asm/thread.ts";let h,u=!0;function f(){return u}async function d(t,e){try{if(!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return void(u=!1);{const e=(0,i.E_)(o());a.DD(e,!0),h=(await WebAssembly.instantiate(e,{env:{memory:t}})).instance}e({wasm_pthread_mutex_lock:h.exports.lock,wasm_pthread_mutex_unlock:h.exports.unlock,wasm_pthread_cond_wait:h.exports.wait,wasm_pthread_cond_timedwait:h.exports.timedwait,wasm_pthread_cond_signal:h.exports.signal,wasm_pthread_cond_broadcast:h.exports.broadcast})}catch(t){u=!1,s.R8("thread asm not support, cannot use asm thread function",c,65)}}},1708:(t,e,r)=>{"use strict";r.r(e),r.d(e,{atomic_add_i16:()=>p,atomic_add_i32:()=>_,atomic_add_i64:()=>U,atomic_add_i8:()=>n,atomic_and_i16:()=>g,atomic_and_i32:()=>I,atomic_and_i64:()=>R,atomic_and_i8:()=>a,atomic_compare_exchange_i16:()=>b,atomic_compare_exchange_i32:()=>T,atomic_compare_exchange_i64:()=>z,atomic_compare_exchange_i8:()=>d,atomic_exchange_i16:()=>k,atomic_exchange_i32:()=>E,atomic_exchange_i64:()=>O,atomic_exchange_i8:()=>l,atomic_load_i16:()=>y,atomic_load_i32:()=>B,atomic_load_i64:()=>$,atomic_load_i8:()=>f,atomic_or_i16:()=>A,atomic_or_i32:()=>M,atomic_or_i64:()=>L,atomic_or_i8:()=>c,atomic_store_i16:()=>w,atomic_store_i32:()=>C,atomic_store_i64:()=>F,atomic_store_i8:()=>u,atomic_sub_i16:()=>m,atomic_sub_i32:()=>x,atomic_sub_i64:()=>S,atomic_sub_i8:()=>o,atomic_xor_i16:()=>v,atomic_xor_i32:()=>P,atomic_xor_i64:()=>D,atomic_xor_i8:()=>h,atomics_notify:()=>N,atomics_wait:()=>W,atomics_wait_timeout:()=>V,override:()=>j});var i=r(40046),s=r(6704);let n=function(t,e){return i.WQ(t,e,12,s._[12])},o=function(t,e){return i.jb(t,e,12,s._[12])},a=function(t,e){return i.Uo(t,e,12,s._[12])},c=function(t,e){return i.or(t,e,12,s._[12])},h=function(t,e){return i.I8(t,e,12,s._[12])},u=function(t,e){return i.M_(t,e,12,s._[12])},f=function(t){return i.Hh(t,12,s._[12])},d=function(t,e,r){return i.p_(t,e,r,12,s._[12])},l=function(t,e){return i.cv(t,e,12,s._[12])},p=function(t,e){return i.WQ(t,e,14,s._[14])},m=function(t,e){return i.jb(t,e,14,s._[14])},g=function(t,e){return i.Uo(t,e,14,s._[14])},A=function(t,e){return i.or(t,e,14,s._[14])},v=function(t,e){return i.I8(t,e,14,s._[14])},w=function(t,e){return i.M_(t,e,14,s._[14])},y=function(t){return i.Hh(t,14,s._[14])},b=function(t,e,r){return i.p_(t,e,r,14,s._[14])},k=function(t,e){return i.cv(t,e,14,s._[14])},_=function(t,e){return i.WQ(t,e,16,s._[16])},x=function(t,e){return i.jb(t,e,16,s._[16])},I=function(t,e){return i.Uo(t,e,16,s._[16])},M=function(t,e){return i.or(t,e,16,s._[16])},P=function(t,e){return i.I8(t,e,16,s._[16])},C=function(t,e){return i.M_(t,e,16,s._[16])},B=function(t){return i.Hh(t,16,s._[16])},T=function(t,e,r){return i.p_(t,e,r,16,s._[16])},E=function(t,e){return i.cv(t,e,16,s._[16])},U=function(t,e){return i.WQ(t,e,21,s._[21])},S=function(t,e){return i.jb(t,e,21,s._[21])},R=function(t,e){return i.Uo(t,e,21,s._[21])},L=function(t,e){return i.or(t,e,21,s._[21])},D=function(t,e){return i.I8(t,e,21,s._[21])},F=function(t,e){return i.M_(t,e,21,s._[21])},$=function(t){return i.Hh(t,21,s._[21])},z=function(t,e,r){return i.p_(t,e,r,21,s._[21])},O=function(t,e){return i.cv(t,e,21,s._[21])},N=function(t,e){return i.me(t,e)},W=function(t,e){return i.uk(t,e)},V=function(t,e,r){return i.j4(t,e,0|Number(0xffffffffn&r))};function j(t){t.atomic_add_i8&&(n=t.atomic_add_i8),t.atomic_sub_i8&&(o=t.atomic_sub_i8),t.atomic_and_i8&&(a=t.atomic_and_i8),t.atomic_or_i8&&(c=t.atomic_or_i8),t.atomic_xor_i8&&(h=t.atomic_xor_i8),t.atomic_store_i8&&(u=t.atomic_store_i8),t.atomic_load_i8&&(f=t.atomic_load_i8),t.atomic_compare_exchange_i8&&(d=t.atomic_compare_exchange_i8),t.atomic_exchange_i8&&(l=t.atomic_exchange_i8),t.atomic_add_i16&&(p=t.atomic_add_i16),t.atomic_sub_i16&&(m=t.atomic_sub_i16),t.atomic_and_i16&&(g=t.atomic_and_i16),t.atomic_or_i16&&(A=t.atomic_or_i16),t.atomic_xor_i16&&(v=t.atomic_xor_i16),t.atomic_store_i16&&(w=t.atomic_store_i16),t.atomic_load_i16&&(y=t.atomic_load_i16),t.atomic_compare_exchange_i16&&(b=t.atomic_compare_exchange_i16),t.atomic_exchange_i16&&(k=t.atomic_exchange_i16),t.atomic_add_i32&&(_=t.atomic_add_i32),t.atomic_sub_i32&&(x=t.atomic_sub_i32),t.atomic_and_i32&&(I=t.atomic_and_i32),t.atomic_or_i32&&(M=t.atomic_or_i32),t.atomic_xor_i32&&(P=t.atomic_xor_i32),t.atomic_store_i32&&(C=t.atomic_store_i32),t.atomic_load_i32&&(B=t.atomic_load_i32),t.atomic_compare_exchange_i32&&(T=t.atomic_compare_exchange_i32),t.atomic_exchange_i32&&(E=t.atomic_exchange_i32),t.atomic_add_i64&&(U=t.atomic_add_i64),t.atomic_sub_i64&&(S=t.atomic_sub_i64),t.atomic_and_i64&&(R=t.atomic_and_i64),t.atomic_or_i64&&(L=t.atomic_or_i64),t.atomic_xor_i64&&(D=t.atomic_xor_i64),t.atomic_store_i64&&(F=t.atomic_store_i64),t.atomic_load_i64&&($=t.atomic_load_i64),t.atomic_compare_exchange_i64&&(z=t.atomic_compare_exchange_i64),t.atomic_exchange_i64&&(O=t.atomic_exchange_i64),t.atomics_notify&&(N=t.atomics_notify),t.atomics_wait&&(W=t.atomics_wait),t.atomics_wait_timeout&&(V=t.atomics_wait_timeout)}},14621:(t,e,r)=>{"use strict";r.d(e,{LS:()=>f,Lq:()=>m,Pp:()=>g,WU:()=>p,h2:()=>l,nK:()=>d});var i=r(50932),s=r(63939),n=r(14686),o=r(50011);const a=[null,[],[]],c=0,h=28;function u(t,e){const r=a[t];0===e||10===e?(console.log.bind(console)(o.D(r)),r.length=0):r.push(e)}function f(t,e){let r=0;return 0==t?r=2:1!=t&&2!=t||(r=64),i.M[11](e,2),i.M[13](e+2,1),i.M[15](e+8,0|r),i.M[15](e+12,0),i.M[17](e+16,BigInt(0)),c}function d(t,e,r,n){let o=0;for(let i=0;i<r;i++){let r=s.f[8](e),i=s.f[8](e+4);e+=8;for(let e=0;e<i;e++)u(t,s.f[4](r+e));o+=i}return i.M[8](n,(0|o)>>>0),c}function l(t){throw t=`abort(${t+=""}). Build with -s ASSERTIONS=1 for more info.`,new WebAssembly.RuntimeError(t)}function p(t,e,r){if(0!==t)return h;const s=(new Date).getTime();return i.M[10](r,BigInt(s)*BigInt(1e6)),c}function m(t,e){return 0!==t?h:(i.M[10](e,BigInt(1e6)),c)}function g(t,e){const r=(0,n.s3)(t,e);return crypto.getRandomValues(r),c}},20357:(t,e,r)=>{"use strict";r.r(e),r.d(e,{Pthread:()=>w,PthreadOnce:()=>v,override:()=>L,wasm_cpu_core_count:()=>R,wasm_pthread_cond_broadcast:()=>B,wasm_pthread_cond_destroy:()=>I,wasm_pthread_cond_init:()=>x,wasm_pthread_cond_signal:()=>C,wasm_pthread_cond_timedwait:()=>P,wasm_pthread_cond_wait:()=>M,wasm_pthread_equal2:()=>U,wasm_pthread_exit:()=>E,wasm_pthread_mutex_destroy:()=>b,wasm_pthread_mutex_init:()=>y,wasm_pthread_mutex_lock:()=>k,wasm_pthread_mutex_unlock:()=>_,wasm_pthread_once:()=>T,wasm_pthread_support:()=>S});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085),u=r(63939),f=r(50932),d=r(73783),l=r(42518),p=r(26429),m=r(11473),g=r(40046),A=r(10576);class v{constructor(){(0,n.A)(this,"atomic",void 0)}}i=v.prototype,(s=new(a())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,4),(0,h.A)(i,c.g7,4),(0,h.A)(i,c.JY,s);class w{constructor(){(0,n.A)(this,"id",void 0),(0,n.A)(this,"retval",void 0),(0,n.A)(this,"flags",void 0),(0,n.A)(this,"status",void 0)}}let y,b,k,_,x,I,M,P,C,B,T;function E(t){const e=A.TK.__SELF_THREAD__;f.M[20](e+4,t)}function U(t,e){return u.f[15](t)===u.f[15](e)?1:0}function S(){return p._7?1:0}function R(){return navigator.hardwareConcurrency}function L(t){t.wasm_pthread_mutex_lock&&(k=t.wasm_pthread_mutex_lock),t.wasm_pthread_mutex_unlock&&(_=t.wasm_pthread_mutex_unlock),t.wasm_pthread_cond_wait&&(M=t.wasm_pthread_cond_wait),t.wasm_pthread_cond_timedwait&&(P=t.wasm_pthread_cond_timedwait),t.wasm_pthread_cond_signal&&(C=t.wasm_pthread_cond_signal),t.wasm_pthread_cond_broadcast&&(B=t.wasm_pthread_cond_broadcast)}!function(t){var e=new(a());e.set("id",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),e.set("retval",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),e.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),e.set("status",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),(0,h.A)(t,c.Og,!0),(0,h.A)(t,c.dc,4),(0,h.A)(t,c.g7,16),(0,h.A)(t,c.JY,e)}(w.prototype),y=function(t,e){return d.Ts(t)},b=function(t){return d.zr(t)},k=function(t){return d.s2(t)},_=function(t){return d.Tl(t)},x=function(t,e){return l.Ts(t,e)},I=function(t){return l.zr(t)},M=function(t,e){return l.uk(t,e)},P=function(t,e,r){let i=1e3*Number(u.f[17](r))+u.f[15](r+8)/1e6;return l.XR(t,e,i)},C=function(t){return l.vP(t)},B=function(t){return l.mq(t)},T=function(t,e){return 0===g.WQ(t,1,16,2)&&m.XI.get(e)(),0}},77775:(t,e,r)=>{"use strict";r.r(e),r.d(e,{Timespec:()=>d,wasm_sem_destroy:()=>p,wasm_sem_init:()=>l,wasm_sem_post:()=>v,wasm_sem_timedwait:()=>A,wasm_sem_trywait:()=>g,wasm_sem_wait:()=>m});var i,s,n=r(134),o=r(80662),a=r.n(o),c=r(61499),h=r(12085),u=r(63939),f=r(79490);class d{constructor(){(0,n.A)(this,"tvSec",void 0),(0,n.A)(this,"tvNSec",void 0)}}function l(t,e,r){return f.Ts(t,r)}function p(t){return f.zr(t)}function m(t){return f.uk(t)}function g(t){return f.Zr(t)}function A(t,e){let r=1e3*Number(u.f[17](e))+u.f[15](e+8)/1e6;return f.XR(t,r)}function v(t){return f.bE(t)}i=d.prototype,(s=new(a())).set("tvSec",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),s.set("tvNSec",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,h.A)(i,c.Og,!0),(0,h.A)(i,c.dc,8),(0,h.A)(i,c.g7,16),(0,h.A)(i,c.JY,s)},6331:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(10576);class n{constructor(t,e){(0,i.A)(this,"type",void 0),(0,i.A)(this,"phase",void 0),(0,i.A)(this,"ns",void 0),(0,i.A)(this,"target",void 0),(0,i.A)(this,"originalEvent",void 0),(0,i.A)(this,"isPrevented",void 0),(0,i.A)(this,"isStopped",void 0),(0,i.A)(this,"listener",void 0),this.type=t,this.phase=n.PHASE_CURRENT,e&&(this.originalEvent=e)}preventDefault(){const t=this;if(!t.isPrevented){const{originalEvent:e}=t;e&&e.preventDefault(),t.isPrevented=s.rT}return t}stopPropagation(){const t=this;if(!t.isStopped){const{originalEvent:e}=t;e&&e.stopPropagation(),t.isStopped=s.rT}return t}prevent(){return this.preventDefault()}stop(){return this.stopPropagation()}}(0,i.A)(n,"PHASE_CURRENT",0),(0,i.A)(n,"PHASE_UPWARD",1),(0,i.A)(n,"PHASE_DOWNWARD",s.Cy)},96172:(t,e,r)=>{"use strict";r.d(e,{A:()=>f});var i=r(134),s=r(67672),n=r(72739),o=r(6331),a=r(95335),c=r(20525),h=r(56401),u=r(10576);class f{constructor(t){(0,i.A)(this,"ns",void 0),(0,i.A)(this,"listeners",void 0),(0,i.A)(this,"nativeListeners",void 0),this.ns=t||u.W8,this.listeners={}}fire(t,e,r){let i=this,c=s.Yj(t)?i.parse(t):t,f=i.listeners[c.type],d=u.rT;if(f){f=a.C(f);const t=e&&e[0]instanceof o.A?e[0]:u.ZH;n.__(f,(function(s){if(!p(c.ns,s,u.rT)||!n.zy(f,s)||r&&!r(c,e,s))return;t&&(t.listener=s.fn);let o=(0,h.A)(s.fn,s.ctx,e);return t&&(t.listener=u.ZH),s.num=s.num?s.num+1:1,s.num===s.max&&i.off(c,s.fn),t&&(o===u.W8?t.prevent().stop():t.isStopped&&(o=u.W8)),o===u.W8?d=u.W8:void 0}))}return d}on(t,e){const r=this,i=r.listeners,o=s.Pc(e)?{fn:e}:e;if(s.Ik(o)&&s.Pc(o.fn)){const e=s.Yj(t)?r.parse(t):t;o.ns=e.ns,n.VC(i[e.type]||(i[e.type]=[]),o)}return this}one(t,e){return s.Pc(e)?e={fn:e,max:1}:e.max=1,this.on(t,e)}off(t,e){const r=this,i=r.listeners;if(t){const o=s.Yj(t)?r.parse(t):t,c=o.type,h=o.ns,f=l(e),d=function(t,e){n.__(t,(function(e,r){f(e)&&t.splice(r,1)}),u.rT),t.length||delete i[e]},m=function(t,e){n.__(t,(function(e,r){p(h,e)&&t.splice(r,1)}),u.rT),t.length||delete i[e]};c?i[c]&&d(i[c],c):h&&a.__(i,m)}else r.listeners={}}has(t,e){let r=this.listeners,i=s.Yj(t)?this.parse(t):t,o=i.type,c=i.ns,h=u.rT,f=l(e);var d;return o?r[o]&&(d=r[o],n.__(d,(function(t){if(f(t))return h=u.W8}))):c&&a.__(r,(function(t){return n.__(t,(function(t){if(p(c,t))return h=u.W8})),h})),!h}parse(t){const e={type:t,ns:u.u1};if(this.ns){const r=c.qh(t,u.ZG);r>=0&&(e.type=c.di(t,0,r),e.ns=c.di(t,r+1))}return e}}function d(){return u.rT}function l(t){return s.Pc(t)?function(e){return t===e.fn}:d}function p(t,e,r){const{ns:i}=e;return i&&t?i===t:r?u.rT:u.W8}},84504:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(2148);function s(t,e,r=!1){const s=e.split("."),n=t.split(".");for(let t=0;t<n.length;t++){if(r&&t==n.length-1&&(0,i.A)(n[t])>=(0,i.A)(s[t]))return n.length>=s.length;if((0,i.A)(n[t])>(0,i.A)(s[t]))return!0;if((0,i.A)(n[t])<(0,i.A)(s[t]))return!1;if(t===s.length-1&&t===n.length-1)return r;if(t===s.length-1)return!0;if(t===n.length-1)return!1}return!0}},92647:(t,e,r)=>{"use strict";function i(t,e){if(!e.length)return null;if(1===e.length)return e[0];let r,i=0;for(r of e)i+=r.length;let s=new t(i),n=0;for(r of e)s.set(r,n),n+=r.length;return s}r.d(e,{A:()=>i})},78995:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(56401),s=r(72739),n=r(10576);function o(t,e,r){let o;return function(){let a=this;if(!o){const c=s.$r(arguments);r&&(0,i.A)(t,a,c),o=setTimeout((function(){o=n.ZH,r||(0,i.A)(t,a,c)}),e)}}}},56401:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(67672),s=r(10576);function n(t,e,r){if(i.Pc(t))return i.YO(r)?t.apply(e,r):e!==s.ZH?t.call(e,r):r!==s.ZH?t(r):t()}},8284:(t,e,r)=>{"use strict";function i(){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(16)}))}r.d(e,{A:()=>i})},86932:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(45249),s=r.n(i);function n(){return s()()}},54568:(t,e,r)=>{"use strict";function i(){return"function"==typeof registerProcessor&&"number"==typeof sampleRate&&"number"==typeof currentFrame&&"number"==typeof currentTime}r.d(e,{A:()=>i})},34677:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(10576);function s(t){return t!==i.ZH}},59135:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(34677);let s;function n(){if((0,i.A)(s))return s;const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),s=256===new Int16Array(t)[0],s}},20491:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(67672),s=r(62100),n=r(20525);function o(t){return i.Pc(t)&&n.zy((0,s.A)(t),"[native code]")}},39638:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(34677),s=r(54568);function n(){return!("object"==typeof window&&(0,i.A)(window.document)||(0,s.A)())}},7972:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(64236),s=r.n(i),n=r(20491),o=r(10576);let a;typeof s()===o.s0&&(0,n.A)(s())&&(a=s()),a=typeof MessageChannel===o.s0&&(0,n.A)(MessageChannel)?function(t){const e=new MessageChannel;e.port1.onmessage=t,e.port2.postMessage(1)}:"function"==typeof setTimeout?setTimeout:function(t){setTimeout(t)};const c=a},61837:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i=r(69736),s=r.n(i),n=r(73146),o=r.n(n);const a='\nfunction webpackBootstrapFunc (modules) {\n  var installedModules = {};\n  function __webpack_require__(moduleId) {\n    if(installedModules[moduleId])\n    return installedModules[moduleId].exports;\n    var module = installedModules[moduleId] = {\n      i: moduleId,\n      l: false,\n      exports: {}\n    };\n    if (!modules[moduleId]) {\n      console.log(\'can not found module:\', moduleId)\n    }\n    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n    module.l = true;\n    return module.exports;\n  }\n  __webpack_require__.m = modules;\n  __webpack_require__.c = installedModules;\n  __webpack_require__.i = function(value) { return value; };\n  __webpack_require__.d = function(exports, definition, getter) {\n    if (typeof definition === \'string\') {\n      if(!__webpack_require__.o(exports, definition)) {\n        Object.defineProperty(exports, definition, {\n          enumerable: true,\n          get: getter\n        });\n      }\n    }\n    else {\n      for(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n          Object.defineProperty(exports, key, {\n            enumerable: true,\n            get: definition[key]\n          });\n        }\n      }\n    }\n  };\n  __webpack_require__.r = function(exports) {\n    if(typeof Symbol !== \'undefined\' && Symbol.toStringTag) {\n    \tObject.defineProperty(exports, Symbol.toStringTag, { value: \'Module\' });\n    }\n    Object.defineProperty(exports, \'__esModule\', { value: true });\n  };\n  __webpack_require__.f = {};\n  __webpack_require__.e = function(chunkId) {\n    return Promise.all(Object.keys(__webpack_require__.f).reduce(function (promises, key) {\n      __webpack_require__.f[key](chunkId, promises);\n        return promises;\n    \t}, []));\n\t};\n  __webpack_require__.u = function(chunkId) {\n    return chunkId + "LIB_NAME";\n  };\n  __webpack_require__.n = function(module) {\n    var getter = module && module.__esModule ?\n      function getDefault() { return module[\'default\']; } :\n      function getModuleExports() { return module; };\n    __webpack_require__.d(getter, \'a\', getter);\n    return getter;\n  };\n  (function() {\n    var installedChunks = {\n      "main": 0\n    };\n    __webpack_require__.f.j = function(chunkId, promises) {\n      var installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n      if (installedChunkData !== 0) {\n        if(installedChunkData) {\n          promises.push(installedChunkData[2]);\n        } else {\n          if (true) {\n            var promise = new Promise(function(resolve, reject){installedChunkData = installedChunks[chunkId] = [resolve, reject]});\n            promises.push(installedChunkData[2] = promise);\n            var url = __webpack_require__.p + __webpack_require__.u(chunkId);\n            var error = new Error();\n            var loadingEnded = function(event) {\n              if(__webpack_require__.o(installedChunks, chunkId)) {\n                installedChunkData = installedChunks[chunkId];\n                if(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n                if(installedChunkData) {\n                  var errorType = event && (event.type === \'load\' ? \'missing\' : event.type);\n                  var realSrc = url;\n                  error.message = "Loading chunk " + chunkId + " failed.\\n(" + errorType + ": " + realSrc + ")";\n                  error.name = "ChunkLoadError";\n                  error.type = errorType;\n                  error.request = realSrc;\n                  installedChunkData[1](error);\n                }\n              }\n            };\n            __webpack_require__.l(url, loadingEnded);\n          }\n        }\n      }\n    };\n    var webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n    var [chunkIds, moreModules, runtime] = data;\n    var moduleId, chunkId, i = 0;\n    if (chunkIds.some(function(id){return installedChunks[id] !== 0})) {\n      for(moduleId in moreModules) {\n        if(__webpack_require__.o(moreModules, moduleId)) {\n          __webpack_require__.m[moduleId] = moreModules[moduleId];\n        }\n      }\n      if(runtime) runtime(__webpack_require__);\n    }\n    if (parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n      for (;i < chunkIds.length; i++) {\n        chunkId = chunkIds[i];\n        if (__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n          installedChunks[chunkId][0]();\n        }\n        installedChunks[chunkId] = 0;\n      }\n    }\n    var self = typeof globalThis !== undefined ? globalThis : self\n    var exportName = \'LIBRARY_EXPORT_NAME\'\n    var chunkLoadingGlobal = self["webpackChunk" + exportName] = self["webpackChunk" + exportName] || [];\n    chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\n    chunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));\n  })();\n  (function() {\n    var inProgress = {};\n    __webpack_require__.l = function(url, done) {\n      if (inProgress[url]) { inProgress[url].push(done); return; }\n        inProgress[url] = [done];\n        var onComplete = function(event) {\n          clearTimeout(timeout);\n          var doneFns = inProgress[url];\n          delete inProgress[url];\n          doneFns && doneFns.forEach(function(fn){fn(event)});\n        }\n        var timeout = setTimeout(onComplete.bind(null, undefined, { type: "timeout" }), 120000);\n      import(url).then(function() {\n        onComplete({\n          type: "load"\n        })\n      }, function (error) {\n        onComplete({\n          type: "missing"\n        })\n      });\n    };\n  })();\n  __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n  __webpack_require__.p = "ROOT_URL";\n  __webpack_require__.oe = function(err) { console.error(err); throw err; };\n  var f = __webpack_require__(__webpack_require__.s = ENTRY_MODULE);\n  return f;\n}\n',c="[\\.|\\-|\\+|\\w|/|@|!]+",h="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+c+").*?\\)";function u(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function f(t,e,i,n){const o={};o[i]=[];let a=e.toString();const f=a.match(/^(function)?\s?\w*\(\w+,\s*(\w+),\s*(\w+)\)/);if(!f)return o;const d=f[3];n.__webpack_exports_process__||(n.__webpack_require__=d,n.__webpack_exports__=f[2],n.__webpack_exports_process__=!0);let l,p=new RegExp("(\\\\n|\\W)"+u(d)+h,"g");for(;l=p.exec(a);)"dll-reference"!==l[3]&&o[i].push(l[3]);for(p=new RegExp("\\("+u(d)+'\\("(dll-reference\\s('+c+'))"\\)\\)'+h,"g");l=p.exec(a);)t[l[2]]||(o[i].push(l[1]),t[l[2]]=r(l[1]).m),o[l[2]]=o[l[2]]||[],o[l[2]].push(l[4]);const m=s()(o);for(let t=0;t<m.length;t++)for(let e=0;e<o[m[t]].length;e++)g=+o[m[t]][e],isNaN(g)||(o[m[t]][e]=+o[m[t]][e]);var g;return o}function d(t){return s()(t).reduce((function(e,r){return e||t[r].length>0}),!1)}function l(t,e){const i={main:r.m},n=function(t,e){const r={main:[e]},i={main:[],__webpack_exports__:"__webpack_exports__",__webpack_require__:"__webpack_require__",__webpack_exports_process__:!1},n={main:{}};for(;d(r);){const e=s()(r);for(let o=0;o<e.length;o++){let a=e[o],c=r[a].pop();if(n[a]=n[a]||{},n[a][c]||!t[a][c])continue;n[a][c]=!0,i[a]=i[a]||[],i[a].push(c);let h=f(t,t[a][c],a,i),u=s()(h);for(let t=0;t<u.length;t++)r[u[t]]=r[u[t]]||[],r[u[t]]=r[u[t]].concat(h[u[t]])}}return i}(i,t);let c=o()(t);return"var "+e.varName+"=("+a.replace("ENTRY_MODULE",c).replace("ROOT_URL",r.p||"").replace("LIBRARY_EXPORT_NAME","AVTranscoder").replace("LIB_NAME",r.u&&r.u("")||"")+")({"+n.main.map((function(t){const r=o()(t);let s=r+": "+i.main[t].toString();if(r===c&&e.exportName&&e.pointName){const t=`;${n.__webpack_require__}.d(\n          ${n.__webpack_exports__},\n          "${e.exportName}",\n          function() {\n            if (${e.exportIsClass}) {\n              for (var key in ${n.__webpack_exports__}) {\n                if (key === '${e.exportName}') {\n                  continue;\n                }\n                var v = ${n.__webpack_exports__}[key];\n                if (typeof v === 'function' && v.name === '${e.pointName}') {\n                  return v;\n                }\n              }\n            }\n            return ${e.pointName};\n          }\n        );`;s=s.slice(0,s.length-1)+t+"}"}return s})).join(",")+"});"}},2148:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(67672),s=r(10576);function n(t,e){return i.sH(t)?+t:e!==s.ZH?e:0}},62100:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(10576);function s(t,e){return t!=i.Cq&&t.toString?t.toString():e!==i.ZH?e:i.u1}},65196:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(54001),n=r.n(s),o=r(67672),a=r(72739);class c{constructor(){(0,i.A)(this,"queue",void 0),this.queue=[]}async execute(t){try{const e=await t.task();t.resolve(e)}catch(e){t.reject(e)}}async next(){if(this.queue.length){const t=this.queue[0];t.error?t.reject(t.error):await this.execute(t),this.queue.shift(),this.queue.length&&this.next()}}async push(t){if(!o.Pc(t))throw new TypeError("task must be a function");return new(n())(((e,r)=>{const i={task:t,resolve:e,reject:r};this.queue.push(i),1===this.queue.length&&this.next()}))}clear(t){a.__(this.queue,(e=>{e.error=t||new Error("command queue clear")}))}get length(){return this.queue.length}}},61403:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(67672);class n{constructor(){(0,i.A)(this,"proxy",void 0),this.proxy=new Proxy(this,{get:(t,e,r)=>s.sH(e)?t.getIndexValue(+e):t[e],set:(t,e,r,i)=>(s.sH(e)?t.setIndexValue(+e,r):t[e]=r,!0)})}}},37246:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(4624);class n{constructor(t=1048576){(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"bitsLeft",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"endPointer",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.size=t,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}peekU1(){let t=0;(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();let e=this.pointer,r=this.bitsLeft;return 0===r&&(e++,r=8),t=this.buffer[e]>>r-1&1,t}readU1(){let t=0;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,t=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8),t}readU(t){let e=0;for(let r=0;r<t;r++)e|=this.readU1()<<t-r-1;return e}remainingLength(){return this.endPointer-this.pointer}getPos(){return this.pointer}skip(t){const e=(t-t%8)/8;this.pointer+=e;const r=t%8;this.bitsLeft<=r?(this.pointer++,this.bitsLeft=8-(r-this.bitsLeft)):this.bitsLeft-=r}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&this.pointer++,!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);const t=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(t<0)throw this.error=t,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+t,this.pointer=0}else{const t=this.onFlush(this.buffer);if(this.endPointer=t,this.pointer=0,this.bitsLeft=8,t<0)throw this.error=t,Error("IOReader error, flush failed")}}getBuffer(){return this.buffer}appendBuffer(t){if(this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else{const e=Math.min(this.size-this.endPointer,t.length);this.buffer.set(t.subarray(0,e),this.endPointer),this.endPointer+=e,s.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",190)}}clear(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0}skipPadding(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++)}}},83314:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(134);class s{constructor(t=1048576){(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"bitPointer",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),this.pointer=0,this.bitPointer=0,this.size=t,this.error=0,this.buffer=new Uint8Array(this.size)}writeU1(t){(this.remainingLength()<1||1===this.remainingLength()&&this.bitPointer>=8)&&this.flush(),1&t?this.buffer[this.pointer]|=1<<7-this.bitPointer:this.buffer[this.pointer]&=~(1<<7-this.bitPointer),this.bitPointer++,8===this.bitPointer&&(this.pointer++,this.bitPointer=0)}writeU(t,e){for(let r=0;r<t;r++)this.writeU1(e>>t-r-1&1)}remainingLength(){return this.size-this.pointer}flush(){if(!this.onFlush)throw this.error=-1048574,Error("BSWriter error, flush failed because of no flush callback");if(this.pointer)if(this.bitPointer&&this.pointer>1){const t=this.onFlush(this.buffer.subarray(0,this.pointer-1));if(0!==t)throw this.error=t,Error("BSWriter error, flush failed");this.buffer[0]=this.buffer[this.pointer]}else if(0===this.bitPointer){const t=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("BSWriter error, flush failed")}this.pointer=0}padding(){for(;0!==this.bitPointer;)this.writeU1(0)}clear(){this.pointer=0,this.bitPointer=0,this.error=0}getBuffer(){return this.buffer}getPointer(){return this.pointer}}},31865:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(92647),n=r(50011);class o{constructor(t,e=!0){(0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"byteStart",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}readUint8(){return this.data.getUint8(this.pos+++this.byteStart)}readUint16(){const t=this.data.getUint16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,t}readUint24(){return this.readUint16()<<8|this.readUint8()}readUint32(){const t=this.data.getUint32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,t}readUint64(){const t=BigInt(this.readUint32()),e=BigInt(this.readUint32());return this.littleEndian?e<<BigInt(32)|t:t<<BigInt(32)|e}readInt8(){return this.data.getInt8(this.pos+++this.byteStart)}readInt16(){const t=this.data.getInt16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,t}readInt32(){const t=this.data.getInt32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,t}readInt64(){const t=BigInt(this.readInt32()),e=BigInt(this.readInt32());return this.littleEndian?e<<BigInt(32)|t:t<<BigInt(32)|e}readFloat(){const t=this.data.getFloat32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,t}readDouble(){const t=this.data.getFloat64(this.pos+this.byteStart,this.littleEndian);return this.pos+=8,t}readHex(t=1){let e="";for(let r=0;r<t;r++){const t=this.readUint8().toString(16);e+=1===t.length?"0"+t:t}return e}readString(t=1){let e="";if(t){let r=this.pos;for(let e=0;e<t&&0===this.buffer[this.pos+e];e++)r++;e=n.D(this.buffer.subarray(r,r+t))}return this.pos+=t,e}readLine(){let t="";for(let e=this.pos;e<this.size;e++)if(10===this.buffer[e]||13===this.buffer[e]){t+=this.readString(e-this.pos);break}for(let t=this.pos;t<this.size&&(10===this.buffer[t]||13===this.buffer[t]);t++)this.readUint8();return t}getPos(){return BigInt(this.pos)}seek(t){t>this.size&&(t=this.size),this.pos=Math.max(0,t)}skip(t){this.seek(this.pos+t)}back(t){this.seek(this.pos-t)}remainingSize(){return this.size-this.pos}readBuffer(t){t=Math.min(t,this.remainingSize());const e=this.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e}appendBuffer(t){this.buffer=(0,s.A)(Uint8Array,[this.buffer.slice(),t.slice()]),this.data=new DataView(this.buffer.buffer),this.size+=t.byteLength,this.byteStart=0}resetBuffer(t,e=!0){this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}}},729:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(4624),n=r(50011);class o{constructor(t,e=!0){(0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"byteStart",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}writeUint8(t){this.data.setUint8(this.pos+++this.byteStart,t)}writeUint16(t){this.data.setUint16(this.pos+this.byteStart,t,this.littleEndian),this.pos+=2}writeUint24(t){const e=3840&t,r=240&t,i=15&t;this.littleEndian?(this.writeUint8(i),this.writeUint8(r),this.writeUint8(e)):(this.writeUint8(e),this.writeUint8(r),this.writeUint8(i))}writeUint32(t){this.data.setUint32(this.pos+this.byteStart,t,this.littleEndian),this.pos+=4}writeUint64(t){const e=t&BigInt(4294967295),r=(t&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeUint32(Number(e)),this.writeUint32(Number(r))):(this.writeUint32(Number(r)),this.writeUint32(Number(e)))}writeInt8(t){this.data.setInt8(this.pos+++this.byteStart,t)}writeInt16(t){this.data.setInt16(this.pos+this.byteStart,t,this.littleEndian),this.pos+=2}writeInt32(t){this.data.setInt32(this.pos+this.byteStart,t,this.littleEndian),this.pos+=4}writeInt64(t){const e=t&BigInt(4294967295),r=(t&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeInt32(Number(e)),this.writeInt32(Number(r))):(this.writeInt32(Number(r)),this.writeInt32(Number(e)))}writeFloat(t){this.data.setFloat32(this.pos+this.byteStart,t,this.littleEndian),this.pos+=4}writeDouble(t){this.data.setFloat64(this.pos+this.byteStart,t,this.littleEndian),this.pos+=8}getPos(){return this.pos}seek(t){t>this.size&&(t=this.size),this.pos=Math.max(0,t)}skip(t){this.seek(this.pos+t)}back(t){this.seek(this.pos-t)}remainingSize(){return this.size-this.pos}writeBuffer(t){let e=t.length;this.remainingSize()<e&&(e=this.remainingSize(),s.R8(`the remaining buffer size is smaller then the wrote buffer, hope set ${t.length}, but set ${e}`,"src/common/io/BufferWriter.ts",211)),this.buffer.set(t,this.pos),this.pos+=t.length}writeString(t){const e=n.l(t);return this.writeBuffer(e),e.length}getWroteBuffer(){return this.buffer.subarray(0,this.pos)}resetBuffer(t,e=!0){this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!e}}},31830:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(54001),n=r.n(s);class o{constructor(t,e=!1){(0,i.A)(this,"handler",void 0),(0,i.A)(this,"file",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"writer",void 0),(0,i.A)(this,"append",void 0),(0,i.A)(this,"reader",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"blobSlice",void 0),(0,i.A)(this,"readied",void 0),(0,i.A)(this,"readHold",void 0),this.handler=t,this.append=e,this.readied=!1}async ready(){this.readied||(this.file=await this.handler.getFile(),this.writer=await this.handler.createWritable(),this.pos=this.append?this.file.size:0,this.size=this.pos,this.reader=new FileReader,this.blobSlice=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,this.reader.onloadend=t=>{this.readHold&&(this.readHold.resolve(t.target.result),this.readHold=null)},this.readied=!0)}async write_(t){await this.writer.write(t),this.pos+=t.byteLength,this.pos>this.size&&(this.size+=t.byteLength)}async write(t){await this.write_(t)}async seek_(t){await this.writer.seek(t),this.pos=t}async seek(t){await this.seek_(t)}async seekToEnd(){await this.seek_(this.size)}async resize_(t){t!==this.file.size&&(t<this.file.size&&(this.pos=this.file.size),await this.writer.truncate(t),this.size=t)}async resize(t){await this.resize_(t)}async read_(t,e){return new(n())(((r,i)=>{this.readHold={resolve:r,reject:i},this.reader.readAsArrayBuffer(this.blobSlice.call(this.file,t,e))}))}async read(t,e){return await this.read_(t,e)}async appendBufferByPosition(t,e){await this.writer.close(),this.file=await this.handler.getFile(),this.writer=await this.handler.createWritable({keepExistingData:!0});const r=this.file.size,i=t.byteLength;if(e>=this.file.size)await this.resize_(e+i),await this.seek_(e),await this.write_(t);else{let i=e;for(await this.seek_(e),await this.write_(t);i<r;){const t=await this.read_(i,Math.min(i+5242880,r));await this.write_(t),i+=t.byteLength}}}async close_(){this.readied&&(await this.writer.close(),this.file=await this.handler.getFile(),this.readied=!1)}async close(){await this.close_()}getFile(){return this.file}getHandle(){return this.handler}getPos(){return this.pos}getSize(){return this.size}async destroy(){await this.close_(),this.handler=null,this.file=null}}},24175:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(4624),n=r(50011),o=r(13724),a="src/common/io/IOReader.ts";class c{constructor(t=1048576,e=!0,r){if((0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"endPointer",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),(0,i.A)(this,"fileSize_",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),(0,i.A)(this,"onSeek",void 0),(0,i.A)(this,"onSize",void 0),(0,i.A)(this,"flags",void 0),this.pos=BigInt(0),this.pointer=0,this.error=0,this.endPointer=0,this.littleEndian=!e,this.flags=0,r&&r.view)this.size=r.length,this.buffer=r,this.data=r.view;else if(r&&!r.byteOffset)this.size=r.length,this.buffer=r,this.data=new DataView(this.buffer.buffer);else{if(r)throw new Error("not support subarray of ArrayBuffer");this.size=Math.max(t,102400),this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}async readUint8(){this.remainingLength()<1&&await this.flush(1);const t=this.data.getUint8(this.pointer);return this.pointer++,this.pos++,t}async peekUint8(){return this.remainingLength()<1&&await this.flush(1),this.data.getUint8(this.pointer)}async readUint16(){this.remainingLength()<2&&await this.flush(2);const t=this.data.getUint16(this.pointer,this.littleEndian);return this.pointer+=2,this.pos+=BigInt(2),t}async peekUint16(){return this.remainingLength()<2&&await this.flush(2),this.data.getUint16(this.pointer,this.littleEndian)}async readUint24(){return this.remainingLength()<3&&await this.flush(3),await this.readUint16()<<8|await this.readUint8()}async peekUint24(){this.remainingLength()<3&&await this.flush(3);const t=this.pointer,e=this.pos,r=await this.readUint16()<<8|await this.readUint8();return this.pointer=t,this.pos=e,r}async readUint32(){this.remainingLength()<4&&await this.flush(4);const t=this.data.getUint32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),t}async peekUint32(){return this.remainingLength()<4&&await this.flush(4),this.data.getUint32(this.pointer,this.littleEndian)}async readUint64(){this.remainingLength()<8&&await this.flush(8);const t=this.data.getBigUint64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),t}async peekUint64(){return this.remainingLength()<8&&await this.flush(8),this.data.getBigUint64(this.pointer,this.littleEndian)}async readInt8(){this.remainingLength()<1&&await this.flush(1);const t=this.data.getInt8(this.pointer);return this.pointer++,this.pos++,t}async peekInt8(){return this.remainingLength()<1&&await this.flush(1),this.data.getInt8(this.pointer)}async readInt16(){this.remainingLength()<2&&await this.flush(2);const t=this.data.getInt16(this.pointer,this.littleEndian);return this.pointer+=2,this.pos+=BigInt(2),t}async peekInt16(){return this.remainingLength()<2&&await this.flush(2),this.data.getInt16(this.pointer,this.littleEndian)}async readInt32(){this.remainingLength()<4&&await this.flush(4);const t=this.data.getInt32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),t}async peekInt32(){return this.remainingLength()<4&&await this.flush(4),this.data.getInt32(this.pointer,this.littleEndian)}async readInt64(){this.remainingLength()<8&&await this.flush(8);const t=this.data.getBigInt64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),t}async peekInt64(){return this.remainingLength()<8&&await this.flush(8),this.data.getBigInt64(this.pointer,this.littleEndian)}async readFloat(){this.remainingLength()<4&&await this.flush(4);const t=this.data.getFloat32(this.pointer,this.littleEndian);return this.pointer+=4,this.pos+=BigInt(4),t}async peekFloat(){return this.remainingLength()<4&&await this.flush(4),this.data.getFloat32(this.pointer,this.littleEndian)}async readDouble(){this.remainingLength()<8&&await this.flush(8);const t=this.data.getFloat64(this.pointer,this.littleEndian);return this.pointer+=8,this.pos+=BigInt(8),t}async peekDouble(){return this.remainingLength()<8&&await this.flush(8),this.data.getFloat64(this.pointer,this.littleEndian)}async readHex(t=1){let e="";for(let r=0;r<t;r++){const t=(await this.readUint8()).toString(16);e+=1===t.length?"0"+t:t}return e}async peekHex(t=1){t>this.size&&(this.error=-1048574,s.h2("peekHex, length too large",a,334)),this.remainingLength()<t&&await this.flush(t);const e=this.pointer,r=this.pos;let i="";for(let e=0;e<t;e++){const t=(await this.readUint8()).toString(16);i+=1===t.length?"0"+t:t}return this.pointer=e,this.pos=r,i}async readBuffer(t,e){if(e||(e=new Uint8Array(t)),this.remainingLength()<t){let r=0;if(this.remainingLength()>0){const i=this.remainingLength();e.set(this.buffer.subarray(this.pointer,this.pointer+i),r),r+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i}for(;t>0;){await this.flush();const i=Math.min(this.endPointer-this.pointer,t);e.set(this.buffer.subarray(this.pointer,this.pointer+i),r),r+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i}}else e.set(this.buffer.subarray(this.pointer,this.pointer+t),0),this.pointer+=t,this.pos+=BigInt(t);return e}async readToBuffer(t,e){if(this.remainingLength()<t){let r=0;if(this.remainingLength()>0){const i=this.remainingLength();e.set(this.buffer.subarray(this.pointer,this.pointer+i),r),r+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i}for(;t>0;){try{await this.flush()}catch(t){if(-1048576===this.error&&r)return r;throw t}const i=Math.min(this.endPointer-this.pointer,t);e.set(this.buffer.subarray(this.pointer,this.pointer+i),r),r+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i}return r}return e.set(this.buffer.subarray(this.pointer,this.pointer+t),0),this.pointer+=t,this.pos+=BigInt(t),t}async peekBuffer(t,e){return t>this.size&&(this.error=-1048574,s.h2("peekBuffer, length too large",a,455)),this.remainingLength()<t&&await this.flush(t),e||(e=new Uint8Array(t)),e.set(this.buffer.subarray(this.pointer,this.pointer+t),0),e}async readString(t=1){const e=await this.readBuffer(t);return n.D(e)}async peekString(t=1){const e=await this.peekBuffer(t);return n.D(e)}async readLine(){let t="";for(;;){let e=!1;for(let r=this.pointer;r<this.endPointer;r++)if(10===this.buffer[r]||13===this.buffer[r]){r!==this.pointer&&(t+=await this.readString(r-this.pointer)),e=!0;break}if(e)break;t+=await this.readString(this.remainingLength()),await this.flush()}for(;;){const t=await this.peekUint8();if(10!==t&&13!==t)break;await this.readUint8()}return t}async peekLine(){this.remainingLength()<this.size&&await this.flush();let t="",e=!1;for(let r=this.pointer;r<this.endPointer;r++)if(10===this.buffer[r]||13===this.buffer[r]){t+=await this.peekString(r-this.pointer),e=!0;break}return e||(this.error=-1048574,s.h2("peekLine, out of buffer",a,543)),t}getPointer(){return this.pointer}getPos(){return this.pos}async skip(t){const e=t;for(;this.remainingLength()<t;)t-=this.remainingLength(),this.pointer=this.endPointer,await this.flush();this.remainingLength()>=t&&(this.pointer+=t),this.pos+=BigInt(e)}remainingLength(){return this.endPointer-this.pointer}async flush_(t){for(;;){const e=await this.onFlush(t);if(-1048575!==e)return e;await new o.A(0)}}async flush(t=0){if(this.onFlush||(this.error=-1048574,s.h2("IOReader error, flush failed because of no flush callback",a,611)),!(this.size-this.remainingLength()<=0))if(t=Math.min(t,this.size),this.pointer<this.endPointer?(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer):this.endPointer=0,this.pointer=0,t)for(;this.remainingLength()<t;){const t=await this.flush_(this.buffer.subarray(this.endPointer));if(t<0)throw this.error=t,new Error(`IOReader error, flush ${-1048576===t?"ended":"failed"}, ret: ${t}`);this.endPointer+=t}else{const t=await this.flush_(this.buffer.subarray(this.endPointer));if(t<0)throw this.error=t,new Error(`IOReader error, flush ${-1048576===t?"ended":"failed"}, ret: ${t}`);this.endPointer+=t}}async seek(t,e=!1,r=!0){if(!e){const e=Number(t-this.pos);if(e<0&&Math.abs(e)<this.pointer)return this.pointer+=e,void(this.pos=t);if(e>0&&this.pointer+e<this.endPointer)return this.pointer+=e,void(this.pos=t);if(0===e)return}this.onSeek||(this.error=-1048574,s.h2("IOReader error, seek failed because of no seek callback",a,672)),this.pointer=this.endPointer=0,this.pos=t;const i=await this.onSeek(t);0!==i&&(this.error=i,s.h2("IOReader error, seek failed",a,681)),r&&await this.flush()}getBuffer(){return this.buffer}appendBuffer(t){if(this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=t.length)this.buffer.set(t,this.endPointer),this.endPointer+=t.length;else{const e=Math.min(this.size-this.endPointer,t.length);this.buffer.set(t.subarray(0,e),this.endPointer),this.endPointer+=e,s.R8("IOReader, call appendBuffer but the buffer's size is lagger then the remaining size",a,711)}}reset(){this.pointer=this.endPointer=0,this.pos=BigInt(0),this.error=0}setEndian(t){this.littleEndian=!t}async fileSize(){return this.fileSize_||(this.onSize||(this.error=-1048574,s.h2("IOReader error, fileSize failed because of no onSize callback",a,732)),this.fileSize_=await this.onSize()),this.fileSize_}getBufferSize(){return this.size}async pipe(t,e){if(e)if(this.remainingLength()<e){if(this.remainingLength()>0){const r=this.remainingLength();await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+r)),this.pointer+=r,this.pos+=BigInt(r),e-=r}for(;e>0;){await this.flush();const r=Math.min(this.remainingLength(),e);await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+r)),this.pointer+=r,this.pos+=BigInt(r),e-=r}}else await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+e)),this.pointer+=e,this.pos+=BigInt(e);else{if(this.remainingLength()>0){const e=this.remainingLength();await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+e)),this.pointer+=e,this.pos+=BigInt(e)}for(;await this.flush_(this.buffer.subarray(0))>0;){const e=this.remainingLength();await t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+e)),this.pointer+=e,this.pos+=BigInt(e)}}}}},34531:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(50011);class n{constructor(t=1048576,e=!0,r){if((0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),(0,i.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!e,this.error=0,r&&r.view)this.size=r.length,this.buffer=r,this.data=r.view;else if(r&&!r.byteOffset)this.size=r.length,this.buffer=r,this.data=new DataView(this.buffer.buffer);else{if(r)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}async writeUint8(t){this.remainingLength()<1&&await this.flush(),this.data.setUint8(this.pointer,t),this.pointer++,this.pos++}async writeUint16(t){this.remainingLength()<2&&await this.flush(),this.data.setUint16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}async writeUint24(t){this.remainingLength()<3&&await this.flush();const e=(16711680&t)>>16,r=(65280&t)>>8,i=255&t;this.littleEndian?(await this.writeUint8(i),await this.writeUint8(r),await this.writeUint8(e)):(await this.writeUint8(e),await this.writeUint8(r),await this.writeUint8(i))}async writeUint32(t){this.remainingLength()<4&&await this.flush(),this.data.setUint32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeUint64(t){this.remainingLength()<8&&await this.flush(),this.data.setBigUint64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}async writeInt8(t){this.remainingLength()<1&&await this.flush(),this.data.setInt8(this.pointer,t),this.pointer++,this.pos++}async writeInt16(t){this.remainingLength()<2&&await this.flush(),this.data.setInt16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}async writeInt32(t){this.remainingLength()<4&&await this.flush(),this.data.setInt32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeInt64(t){this.remainingLength()<8&&await this.flush(),this.data.setBigInt64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}async writeFloat(t){this.remainingLength()<4&&await this.flush(),this.data.setFloat32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}async writeDouble(t){this.remainingLength()<8&&await this.flush(),this.data.setFloat64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}async writeBuffer(t){if(!t.length)return;let e=t.length;if(this.remainingLength()<e){let r=0;for(;e>0;){await this.flush();const i=Math.min(this.size,e);this.buffer.set(t.subarray(r,r+i),this.pointer),this.pointer+=i,this.pos+=BigInt(i),r+=i,e-=i}}else this.buffer.set(t,this.pointer),this.pointer+=e,this.pos+=BigInt(e)}async writeString(t){const e=s.l(t);return await this.writeBuffer(e),e.length}encodeString(t){return s.l(t)}async flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=await this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}async flushToPos(t){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const e=await this.onFlush(this.buffer.subarray(0,this.pointer),t);if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}async seek(t){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");await this.flush();const e=await this.onSeek(t);if(0!==e)throw this.error=e,Error("IOWriter error, seek failed");this.pos=t}seekInline(t){const e=this.pointer;this.pointer=Math.max(0,Math.min(this.size,t)),this.pos+=BigInt(this.pointer-e)}skip(t){const e=this.pointer;this.pointer=Math.min(this.size,this.pointer+t),this.pos+=BigInt(this.pointer-e)}back(t){const e=this.pointer;this.pointer=Math.max(0,this.pointer-t),this.pos+=BigInt(this.pointer-e)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(t){this.littleEndian=!t}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}},35336:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134),s=r(50011);class n{constructor(t=1048576,e=!0,r){if((0,i.A)(this,"data",void 0),(0,i.A)(this,"buffer",void 0),(0,i.A)(this,"pointer",void 0),(0,i.A)(this,"pos",void 0),(0,i.A)(this,"size",void 0),(0,i.A)(this,"littleEndian",void 0),(0,i.A)(this,"error",void 0),(0,i.A)(this,"onFlush",void 0),(0,i.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!e,this.error=0,r&&r.view)this.size=r.length,this.buffer=r,this.data=r.view;else if(r&&!r.byteOffset)this.size=r.length,this.buffer=r,this.data=new DataView(this.buffer.buffer);else{if(r)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}writeUint8(t){this.remainingLength()<1&&this.flush(),this.data.setUint8(this.pointer,t),this.pointer++,this.pos++}writeUint16(t){this.remainingLength()<2&&this.flush(),this.data.setUint16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeUint24(t){this.remainingLength()<3&&this.flush();const e=(16711680&t)>>16,r=(65280&t)>>8,i=255&t;this.littleEndian?(this.writeUint8(i),this.writeUint8(r),this.writeUint8(e)):(this.writeUint8(e),this.writeUint8(r),this.writeUint8(i))}writeUint32(t){this.remainingLength()<4&&this.flush(),this.data.setUint32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeUint64(t){this.remainingLength()<8&&this.flush(),this.data.setBigUint64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeInt8(t){this.remainingLength()<1&&this.flush(),this.data.setInt8(this.pointer,t),this.pointer++,this.pos++}writeInt16(t){this.remainingLength()<2&&this.flush(),this.data.setInt16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}writeInt32(t){this.remainingLength()<4&&this.flush(),this.data.setInt32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeInt64(t){this.remainingLength()<8&&this.flush(),this.data.setBigInt64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}writeFloat(t){this.remainingLength()<4&&this.flush(),this.data.setFloat32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}writeDouble(t){this.remainingLength()<8&&this.flush(),this.data.setFloat64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}getPointer(){return this.pointer}getPos(){return this.pos}remainingLength(){return this.size-this.pointer}writeBuffer(t){if(!t.length)return;let e=t.length;if(this.remainingLength()<e){let r=0;for(;e>0;){this.flush();const i=Math.min(this.size,e);this.buffer.set(t.subarray(r,r+i),this.pointer),this.pointer+=i,this.pos+=BigInt(i),r+=i,e-=i}}else this.buffer.set(t,this.pointer),this.pointer+=e,this.pos+=BigInt(e)}writeString(t){const e=s.l(t);return this.writeBuffer(e),e.length}encodeString(t){return s.l(t)}flush(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const t=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}flushToPos(t){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){const e=this.onFlush(this.buffer.subarray(0,this.pointer),t);if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}seek(t){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");this.flush();const e=this.onSeek(t);if(0!==e)throw this.error=e,Error("IOWriter error, seek failed");this.pos=t}seekInline(t){const e=this.pointer;this.pointer=Math.max(0,Math.min(this.size,t)),this.pos+=BigInt(this.pointer-e)}skip(t){const e=this.pointer;this.pointer=Math.min(this.size,this.pointer+t),this.pos+=BigInt(this.pointer-e)}back(t){const e=this.pointer;this.pointer=Math.max(0,this.pointer-t),this.pos+=BigInt(this.pointer-e)}getBuffer(){return this.buffer.subarray(0,this.pointer)}setEndian(t){this.littleEndian=!t}reset(){this.pointer=0,this.pos=BigInt(0),this.error=0}getBufferSize(){return this.size}}},59475:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(31830),n=r(65196);class o extends s.A{constructor(t,e=!1){super(t,e),(0,i.A)(this,"commandQueue",void 0),this.commandQueue=new n.A}async write(t){return this.commandQueue.push((async()=>super.write(t)))}async seek(t){return this.commandQueue.push((async()=>super.seek(t)))}async seekToEnd(){return this.commandQueue.push((async()=>super.seekToEnd()))}async resize(t){return this.commandQueue.push((async()=>super.resize(t)))}async read(t,e){return this.commandQueue.push((async()=>super.read(t,e)))}async appendBufferByPosition(t,e){return this.commandQueue.push((async()=>super.appendBufferByPosition(t,e)))}async close(){return this.commandQueue.push((async()=>super.close()))}async destroy(){await super.destroy(),this.commandQueue.clear(),this.commandQueue=null}get writeQueueSize(){return this.commandQueue.length}}},31658:(t,e,r)=>{"use strict";function i(t,e){for(;0!==e;)[t,e]=[e,t%e];return t}r.d(e,{A:()=>i})},42577:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(134);class s extends EventTarget{constructor(...t){super(...t),(0,i.A)(this,"peer",void 0),(0,i.A)(this,"onmessage",void 0),(0,i.A)(this,"onmessageerror",void 0)}postMessage(t,e){var r;null!==(r=this.peer)&&void 0!==r&&r.onmessage&&this.peer.onmessage({data:t})}close(){this.peer=null}start(){}}class n{constructor(){(0,i.A)(this,"port1",void 0),(0,i.A)(this,"port2",void 0),this.port1=new s,this.port2=new s,this.port1.peer=this.port2,this.port2.peer=this.port1}}},84149:(t,e,r)=>{"use strict";r.d(e,{Ay:()=>d,S3:()=>f,Wo:()=>u});var i=r(134),s=r(80662),n=r.n(s),o=r(54001),a=r.n(o),c=r(96172),h=r(34677);const u="notify",f="request";class d extends c.A{constructor(t){super(!0),(0,i.A)(this,"port",void 0),(0,i.A)(this,"requestMap",void 0),(0,i.A)(this,"seq",void 0),(0,i.A)(this,"closed",void 0),this.port=t,this.port.onmessage=this.handle.bind(this),this.seq=0,this.requestMap=new(n()),this.port.start(),this.closed=!1}handle(t){const e=t.data,r=e.type,i=e.data;if("notify"===r)this.fire(u,i);else if("reply"===r){const t=this.requestMap.get(i.seq);t&&((0,h.A)(i.result)?t.resolve(i.result):i.error?t.reject(i.error):t.resolve(void 0),this.requestMap.delete(i.seq))}else"request"===r&&this.fire(f,i)}notify(t,e={},r=[]){this.port.postMessage({type:"notify",data:{method:t,params:e}},r)}async request(t,e={},r=[]){return new(a())(((i,s)=>{const n=this.seq++;this.requestMap.set(n,{resolve:i,reject:s}),this.port.postMessage({type:"request",data:{seq:n,method:t,params:e}},r)}))}reply(t,e,r,i=[]){const s={seq:t.seq};(0,h.A)(e)?s.result=e:r&&(s.error=r),null!=i&&i.length?this.port.postMessage({type:"reply",data:s},i):this.port.postMessage({type:"reply",data:s})}getPort(){return this.port}destroy(){this.requestMap.size&&(this.requestMap.forEach((t=>{t.reject("ipc port close")})),this.requestMap.clear()),this.port&&(this.port.close(),this.port=null),this.closed=!0}}},6253:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(134),s=r(39638),n=r(86932),o=r(47222),a=r(78995);let c,h=0;function u(){return c?(h++,c):(c=new o.A,h=1,c)}function f(){0!==h&&(h--,0===h&&(c.destroy(),c=null))}class d{constructor(t,e=!0){(0,i.A)(this,"messageChannel",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"started",void 0),(0,i.A)(this,"timer",void 0),(0,i.A)(this,"workerTimer",void 0),(0,i.A)(this,"workerSetTimeout",void 0),(0,i.A)(this,"onClock",void 0),(0,i.A)(this,"nextTick",void 0),(0,i.A)(this,"a",void 0),(0,i.A)(this,"b",void 0),(0,i.A)(this,"beta",void 0),(0,i.A)(this,"alpha",void 0),(0,i.A)(this,"count",void 0),(0,i.A)(this,"equivalent",void 0),(0,i.A)(this,"timestamp",void 0),(0,i.A)(this,"onVisibilityChange",void 0),(0,i.A)(this,"timeoutNext",void 0),(0,i.A)(this,"running",void 0),(0,i.A)(this,"highPerformance",void 0),this.started=!1,this.interval=t,this.highPerformance=e,this.a=.2,this.b=4,this.equivalent=50,this.timestamp=0,this.nextTick=()=>{if(this.started&&!this.running)if(this.running=!0,this.interval>=4||!this.highPerformance)this.timeoutTick();else if(this.interval<=0)this.messageChannel.port1.postMessage(null);else{const t=(0,n.A)();t-this.timestamp>this.equivalent&&(this.count=0,this.timestamp=t),this.count<this.beta?this.messageChannel.port1.postMessage(null):this.timeoutTick()}},this.compute(),this.messageChannel=new MessageChannel,this.handleEvent(),this.timeoutNext=t=>{t?this.workerTimer=null:this.timer=null,this.running=!1,this.count++,this.onClock?this.onClock(this.nextTick):this.nextTick()},(0,s.A)()||"hidden"!==document.visibilityState||(this.workerSetTimeout=u()),this.running=!1}compute(t=!0){this.interval>0&&(this.beta=Math.ceil(this.equivalent*(1-this.b/this.interval)/(this.a-this.b)),this.alpha=Math.floor(this.equivalent/this.interval-this.beta),t&&(this.count=0))}timeoutTick(){this.workerSetTimeout&&"hidden"===document.visibilityState&&this.interval<1e3?this.workerTimer=this.workerSetTimeout.setTimeout(this.timeoutNext,this.interval):this.timer=setTimeout(this.timeoutNext,this.interval)}start(){this.started||(this.started=!0,this.timestamp=(0,n.A)(),this.nextTick())}stop(){this.started=!1,this.timer&&(clearTimeout(this.timer),this.timer=null),this.workerTimer&&this.workerSetTimeout&&this.workerSetTimeout.clearTimeout(this.workerTimer),this.running=!1}isStarted(){return this.started}setInterval(t){this.interval=Math.max(t,0),this.compute()}getInterval(){return this.interval}isZeroTimeout(){return this.interval<4}destroy(){this.stop(),this.workerSetTimeout&&(f(),this.workerSetTimeout=null),this.onVisibilityChange&&(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.onVisibilityChange=null)}handleEvent(){this.messageChannel.port2.onmessage=()=>{this.started&&(this.running=!1,this.count++,this.onClock?this.onClock(this.nextTick):this.nextTick())},(0,s.A)()||(this.onVisibilityChange=(0,a.A)((t=>{"hidden"===document.visibilityState?(this.workerSetTimeout=u(),this.timer&&(clearTimeout(this.timer),this.timer=null,this.running=!1),this.nextTick()):(this.workerTimer&&(this.workerSetTimeout.clearTimeout(this.workerTimer),this.workerTimer=null,this.running=!1),this.timer&&(clearTimeout(this.timer),this.timer=null,this.running=!1),f(),this.workerSetTimeout=null,this.nextTick())}),20),document.addEventListener("visibilitychange",this.onVisibilityChange))}}},39148:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});var i=r(134),s=r(54001),n=r.n(s),o=r(6253),a=r(86932);class c{constructor(t,e=0,r=0,s=!0,n=!0){(0,i.A)(this,"task",void 0),(0,i.A)(this,"count",void 0),(0,i.A)(this,"emptyCount",void 0),(0,i.A)(this,"started",void 0),(0,i.A)(this,"clock",void 0),(0,i.A)(this,"timestamp",void 0),(0,i.A)(this,"timeout",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"startTimer",void 0),(0,i.A)(this,"autoInterval",void 0),(0,i.A)(this,"sync",void 0),(0,i.A)(this,"tickAfter",void 0),(0,i.A)(this,"processing",void 0),this.task=t,this.timeout=e,this.interval=r,this.autoInterval=s,this.sync=n,this.count=0,this.emptyCount=0,this.timestamp=0,this.started=!1,this.processing=!1,this.clock=new o.A(this.interval),this.clock.onClock=t=>{if(this.started)if(this.count++,this.sync)this.tickAfter&&(this.tickAfter(),this.tickAfter=null),!1===this.task()?this.stop():this.next(t);else{if(this.processing)return;this.processing=!0,this.task().then((e=>{this.processing=!1,this.tickAfter&&(this.tickAfter(),this.tickAfter=null),!1===e?this.stop():this.next(t)}))}}}next(t){if(!this.started)return;const e=(0,a.A)();if(this.autoInterval&&e-this.timestamp>50){const t=this.emptyCount/this.count;0===this.emptyCount?this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)):t<.1?this.clock.setInterval(this.clock.getInterval()-1):t>.2?this.clock.setInterval(Math.min(this.clock.getInterval()+1,20)):t>.5&&this.clock.setInterval(this.clock.getInterval()<<1),this.count=0,this.emptyCount=0,this.timestamp=e}t()}start(){this.started=!0,this.timeout?this.startTimer=setTimeout((()=>{this.count=0,this.emptyCount=0,this.timestamp=(0,a.A)(),this.clock.start(),this.startTimer=null}),this.timeout):(this.count=0,this.emptyCount=0,this.timestamp=(0,a.A)(),this.clock.start())}stop(){this.started=!1,this.processing=!1,this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.stop()}async stopBeforeNextTick(){if(this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.isStarted())return this.sync?(this.started=!1,this.processing=!1,void this.clock.stop()):new(n())((t=>{this.tickAfter=()=>{this.started=!1,this.processing=!1,this.clock.stop(),t()}}))}isStarted(){return this.started}emptyTask(){this.emptyCount++}isZeroTimeout(){var t;return null===(t=this.clock)||void 0===t?void 0:t.isZeroTimeout()}restart(){this.clock&&(this.stop(),this.clock.setInterval(this.interval),this.start())}resetInterval(){this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)),this.emptyCount=0,this.count=0,this.timestamp=(0,a.A)()}destroy(){this.stop(),this.task=null,this.timeout=null,this.interval=null}}},13724:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(45249),n=r.n(s);class o{constructor(t){(0,i.A)(this,"timeout",void 0),(0,i.A)(this,"timer",void 0),(0,i.A)(this,"resolve",void 0),(0,i.A)(this,"reject",void 0),(0,i.A)(this,"startTime",void 0),this.timeout=t}then(t,e){this.resolve=t,this.reject=e,this.startTime=n()(),this.timer=setTimeout((()=>{this.resolve(n()()-this.startTime),this.timer=null}),1e3*this.timeout)}stop(t=!0){this.timer&&(clearTimeout(this.timer),this.timer=null,this.resolve&&t?this.resolve(n()()-this.startTime):this.reject&&!t&&this.reject(n()()-this.startTime))}reset(t){t&&(this.timeout=t),this.timer&&(clearTimeout(this.timer),this.timer=setTimeout((()=>{this.resolve(n()()-this.startTime),this.timer=null}),1e3*this.timeout))}}},54058:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(134);class s{constructor(t,e,r){(0,i.A)(this,"task",void 0),(0,i.A)(this,"timeout",void 0),(0,i.A)(this,"interval",void 0),(0,i.A)(this,"timer",void 0),this.task=t,this.timeout=e,this.interval=r}start(){const t=this;t.stop();let e=t.timeout;const r=t.interval,i=function(){!1!==t.task()&&t.timer?t.timer=setTimeout(i,t.interval):t.stop()};null==e&&(e=r),t.timer=setTimeout(i,e)}stop(){this.timer&&(clearTimeout(this.timer),this.timer=null)}updateInterval(t){this.interval=t}isStarted(){return!!this.timer}destroy(){this.stop(),this.task=this.timeout=this.interval=null}}},47222:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var i=r(134),s=r(80662),n=r.n(s),o=r(61837);r(7903);class a{constructor(){(0,i.A)(this,"worker",void 0),(0,i.A)(this,"workerUrl",void 0),(0,i.A)(this,"taskMap",void 0),(0,i.A)(this,"id",void 0),this.id=0,this.taskMap=new(n());const t=`\n      ${(0,o.A)(7903,{varName:"workerSetTimeoutTask"})}\n      workerSetTimeoutTask.default(self)\n    `,e=new Blob([t],{type:"text/javascript"});this.workerUrl=URL.createObjectURL(e),this.worker=new Worker(this.workerUrl),this.worker.addEventListener("message",(t=>{const e=t.data,r=e.type,i=e.id;if("pong"===r){const t=this.taskMap.get(i);t&&t(!0)}}))}setTimeout(t,e=0){const r=this.id++;return this.taskMap.set(r,t),this.worker.postMessage({type:"ping",data:{timeout:e,id:r}}),r}clearTimeout(t){this.taskMap.delete(t)}destroy(){this.worker&&(this.worker.terminate(),this.worker=null),this.workerUrl&&(URL.revokeObjectURL(this.workerUrl),this.workerUrl=null),this.taskMap&&(this.taskMap.clear(),this.taskMap=null)}}},7903:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(134),s=r(4624),n="src/common/timer/workerSetTimeoutTask.ts";class o{constructor(t){(0,i.A)(this,"worker",void 0),this.worker=t,this.handleEvents()}handleEvents(){this.worker.addEventListener("message",(t=>{var e;let r=t.data.data;setTimeout((()=>{this.worker.postMessage({type:"pong",id:r.id})}),Math.max(null!==(e=r.timeout)&&void 0!==e?e:0,4))}))}}function a(t){try{new o(t)}catch(t){s.z3("new WorkerSetTimeout failed",n,32)}}},72739:(t,e,r)=>{"use strict";r.d(e,{$r:()=>f,El:()=>d,TF:()=>h,VC:()=>c,__:()=>o,zy:()=>u});var i=r(67672),s=r(10576),n=r(56401);function o(t,e,r){if(!t)return;const{length:i}=t;if(i)if(r)for(let r=i-1;r>=0&&e(t[r],r)!==s.W8;r--);else for(let r=0;r<i&&e(t[r],r)!==s.W8;r++);}function a(t,e){t[t.length]=e}function c(t,e){!function(t,e,r){i.YO(e)?o(e,(function(e){r(t,e)})):r(t,e)}(t,e,a)}function h(t,e,r){let i=0;return o(t,(function(n,o){(r===s.W8?n==e:n===e)&&(t.splice(o,1),i++)}),s.rT),i}function u(t,e,r){return function(t,e,r){let i=s.Cy;return o(t,(function(t,n){if(r===s.W8?t==e:t===e)return i=n,s.W8})),i}(t,e,r)>=0}function f(t){return i.YO(t)?t:(0,n.A)(s.Ml.slice,t)}function d(t,e){let r=0,i=t.length-1,s=-1;for(;r<=i;){let n=(r+i)/2>>>0;const o=e(t[n]);if(0===o){s=n;break}1===o?r=n+1:(i=n-1,s=n)}return s}},90932:(t,e,r)=>{"use strict";r.d(e,{l:()=>s});const i="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";function s(t,e=!0){const r=t.length;let s=0,n=0,o="";for(let e=0;e<r;e++)for(n=n<<8|t[e],s+=8;s>=5;)o+=i[n>>>s-5&31],s-=5;if(s>0&&(o+=i[n<<5-s&31]),e)for(;o.length%8!=0;)o+="=";return o}},4919:(t,e,r)=>{"use strict";r.d(e,{E_:()=>n});var i=r(72739);const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function n(t){const e="function"==typeof atob?atob(t):function(t){function e(t){const e=s.indexOf(t);return-1===e?0:e}let r="";for(let i=0;i<t.length;){const s=e(t[i++]),n=e(t[i++]),o=e(t[i++]),a=e(t[i++]),c=s<<2|n>>4,h=(15&n)<<4|o>>2,u=(3&o)<<6|a;r+=String.fromCharCode(c),64!==o&&(r+=String.fromCharCode(h)),64!==a&&(r+=String.fromCharCode(u))}return r}(t),r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}const o={};i.__(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],((t,e)=>{o[t]=e}))},43607:(t,e,r)=>{"use strict";function i(t){return t>0?t:-t}function s(t,e){return t>e?t:e}function n(t,e){return t>e?e:t}r.d(e,{T9:()=>s,jk:()=>n,tn:()=>i})},86834:(t,e,r)=>{"use strict";r.d(e,{A:()=>l});var i=r(29967),s=r.n(i),n=r(72739),o=r(67672),a=r(84504);function c(t){return o.Yj(t)&&t.split(".").shift()||""}const h=[["alipay",/alipay/],["wechat",/micromessenger/],["dingtalk",/dingtalk[ \/]([\d_.]+)/],["baiduApp",/baiduboxapp/],["baidu",/baidubrowser/],["baidu",/bdbrowser/],["uc",/ucbrowser/],["uc",/ucweb/],["qq",/qqbrowser/],["qqApp",/qq/],["ie",/iemobile[ \/]([\d_.]+)/],["ie",/msie[ \/]([\d_.]+)/],["ie",/trident[ \/]([\d_.]+)/,4],["edge",/edge[ \/]([\d_.]+)/],["newEdge",/edg[ \/]([\d_.]+)/],["chrome",/chrome[ \/]([\d_.]+)/],["firefox",/firefox[ \/]([\d_.]+)/],["opera",/opera(?:.*version)?[ \/]([\d_.]+)/],["safari",/version[ \/]([\d_.]+) safari/],["safari",/version[ \/]([\d_.]+) \S* safari/],["safari",/safari/]],u={},f={},d=function(t){let e,r;return(0,n.__)(h,(i=>{let n=i[1].exec(t);if(n)return e=i[0],r=n[1],r&&(r=r.replace(/_/g,"."),i[2]&&(r=s()(r,10)+i[2]+".0")),!1})),{name:e||"",version:r||"",majorVersion:(u[e]||c)(r),checkVersion:f[e]||a.A}}(("object"==typeof navigator&&navigator.userAgent||"").toLowerCase());d.name&&(d[d.name]=!0);const l=d},10576:(t,e,r)=>{"use strict";r.d(e,{Cq:()=>a,Cy:()=>h,M_:()=>p,Ml:()=>A,TK:()=>m,W8:()=>o,ZG:()=>d,ZH:()=>c,aV:()=>u,jf:()=>l,rT:()=>n,s0:()=>f,u1:()=>v,x7:()=>g});var i=r(7403),s=r.n(i);const n=!0,o=!1,a=null,c=void 0,h=-1,u="undefined",f="function",d=".",l=typeof window!==u?window:c,p=(typeof document!==u&&document,typeof globalThis!==u?globalThis:typeof r.g!==u?r.g:l),m=typeof self!==u?self:p,g=function(){},A=(s()({}),s()([])),v=""},67672:(t,e,r)=>{"use strict";r.d(e,{Ik:()=>u,Pc:()=>c,YO:()=>h,Yj:()=>f,ai:()=>d,o:()=>l,sH:()=>m,sv:()=>g,zM:()=>p});var i=r(68632),s=r.n(i),n=r(88032),o=r.n(n),a=r(10576);function c(t){return typeof t===a.s0}function h(t){return s()(t)}function u(t){return t!==a.Cq&&"object"==typeof t}function f(t){return"string"==typeof t}function d(t){return"number"==typeof t&&!isNaN(t)}function l(t){return"bigint"==typeof t}function p(t){return"boolean"==typeof t}function m(t){return d(t)||f(t)&&!isNaN(o()(t))&&isFinite(+t)}function g(t){return t instanceof ArrayBuffer}},10534:(t,e,r)=>{"use strict";r.d(e,{__:()=>n});var i=r(10576);const s={};function n(t,e){const r=s.hasOwnProperty(t)?s[t]:s[t]=t.split(i.ZG);for(let t=0,s=r.length-1;t<=s&&e(r[t],t===s)!==i.W8;t++);}},4624:(t,e,r)=>{"use strict";r.d(e,{R8:()=>y,V$:()=>g,Yz:()=>v,h2:()=>k,pq:()=>w,rD:()=>a,z3:()=>b});var i=r(10576),s=r(62100);const n=0,o=1,a=2,c=3,h=4,u=5,f=typeof console!==i.aV?console:i.Cq,d=/common/.test((0,s.A)(i.x7))?a:c,l=(i.jf&&/edge|msie|trident/i.test(i.jf.navigator.userAgent),i.u1),p=f?l?function(t,e,r){f.log(l+t,r,e)}:function(t,e){f.log(t,e)}:i.x7;function m(){if(i.M_){const t=i.TK.COMMON_LOG_LEVEL;if(t>=n&&t<=u)return t}return d}function g(t){i.TK.COMMON_LOG_LEVEL=t}function A(t){return`background-color:${t};border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;`}function v(t,e,r){m()<=o&&p(`[${arguments[1]}][line ${arguments[2]}] [debug]`,t,A("#999"))}function w(t,e,r){m()<=a&&p(`[${arguments[1]}][line ${arguments[2]}] [info]`,t,A("#2db7f5"))}function y(t,e,r){m()<=c&&p(`[${arguments[1]}][line ${arguments[2]}] [warn]`,t,A("#f90"))}function b(t,e,r){m()<=h&&p(`[${arguments[1]}][line ${arguments[2]}] [error]`,t,A("#ed4014"))}function k(t,e,r){if(m()<=u)throw b(t,e,r),new Error(`[${arguments[1]}][line ${arguments[2]}] [fatal]: ${t}`)}},95335:(t,e,r)=>{"use strict";r.d(e,{C:()=>h,X$:()=>c,__:()=>o,zy:()=>u}),r(69736);var i=r(67672),s=r(72739),n=r(10576);function o(t,e){for(let r in t)if(e(t[r],r)===n.W8)break}function a(t,e){return i.Ik(t)?i.Ik(e)?(o(e,(function(e,r){t[r]=e})),t):t:e}function c(t,e,r){return a(a(t,e),r)}function h(t,e){let r=t;return i.YO(t)?e?(r=[],s.__(t,(function(t,i){r[i]=h(t,e)}))):r=t.slice():i.Ik(t)&&(r={},o(t,(function(t,i){r[i]=e?h(t,e):t}))),r}function u(t,e){return t[e]!==n.ZH}},20525:(t,e,r)=>{"use strict";r.d(e,{GP:()=>f,di:()=>c,qh:()=>h,zy:()=>u});var i=r(29967),s=r.n(i),n=r(67672),o=r(10576),a=r(62100);function c(t,e,r){return n.ai(r)?e===r?o.u1:t.slice(e,r):t.slice(e)}function h(t,e,r){return t.indexOf(e,r!==o.ZH?r:0)}function u(t,e){return h(t,e)>=0}function f(t,...e){let r=0;const i=e.length;return t.replace(/(%[sdvx%])|(%0(\d)+[dx])/g,(t=>{if(r>=i)return t;const n=e[r++];if(/%0(\d)+[dx]/g.test(t)){const e=s()(t.substring(1));let r="d"===t[t.length-1]?(0,a.A)(Number(n)):Number(n).toString(16);return e>r.length&&(r=new Array(e-r.length).fill("0").join("")+r),r}switch(t){case"%%":return"%";case"%s":return String(n);case"%d":return(0,a.A)(Number(n));case"%v":return"";case"%x":return Number(n).toString(16)}return t}))}},95797:(t,e,r)=>{"use strict";r.d(e,{A:()=>s});var i=r(86834);const s=function(){let t="function"==typeof Blob,e="object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate,r="function"==typeof fetch,s="object"==typeof document&&document.createElement("canvas"),n=s&&!!s.getContext("webgl"),o="function"==typeof OffscreenCanvas,a="function"==typeof Worker,c="function"==typeof ArrayBuffer,h="object"==typeof Atomics,u="function"==typeof AudioContext||"function"==typeof webkitAudioContext,f="function"==typeof AudioWorklet,d="function"==typeof VideoDecoder,l="function"==typeof VideoEncoder,p="function"==typeof AudioDecoder,m="function"==typeof AudioEncoder,g="function"==typeof SharedArrayBuffer,A="function"==typeof MediaSource||"function"==typeof ManagedMediaSource,v="function"==typeof Proxy,w=a&&g&&h&&v;i.A.safari&&!i.A.checkVersion(i.A.majorVersion,"11",!0)&&(e=!1),i.A.chrome&&!i.A.checkVersion(i.A.majorVersion,"94",!0)&&(d=!1,p=!1),i.A.safari&&!i.A.checkVersion(i.A.majorVersion,"17",!0)&&(d=!1);let y="object"==typeof navigator&&"object"==typeof navigator.gpu,b="function"==typeof MediaSourceHandle,k=e&&"function"==typeof WebAssembly.Global;return{browser:i.A,blob:t,wasm:e,fetch:r,webgl:n,worker:a,mse:A,arrayBuffer:c,audioContext:u,audioWorklet:f,videoDecoder:d,videoEncoder:l,audioDecoder:p,audioEncoder:m,atomics:h,shareArrayBuffer:g,thread:w,webgpu:y,offscreenCanvas:o,workerMSE:b,webAssemblyGlobal:k,proxy:v,simd:(i.A.chrome||i.A.newEdge)&&i.A.checkVersion(i.A.majorVersion,"91",!0)||i.A.firefox&&i.A.checkVersion(i.A.majorVersion,"89",!0)||i.A.safari&&i.A.checkVersion(i.A.version,"16.4",!0),wasmBaseSupported:r&&e&&n&&u&&c&&k}}()},50011:(t,e,r)=>{"use strict";r.d(e,{D:()=>o,l:()=>n});const i="function"==typeof TextEncoder?new TextEncoder:null,s="function"==typeof TextDecoder?new TextDecoder:null;function n(t){if(i)return i.encode(t);const e=[];for(let r=0;r<t.length;++r){let i=t.charCodeAt(r);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&t.charCodeAt(++r)),i<=127?e.push(i):i<=2047?(e.push(192|i>>6),e.push(128|63&i)):i<=65535?(e.push(224|i>>12),e.push(128|i>>6&63),e.push(128|63&i)):(e.push(240|i>>18),e.push(128|i>>12&63),e.push(128|i>>6&63),e.push(128|63&i))}return new Uint8Array(e)}function o(t){if(t instanceof Uint8Array&&s&&!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer))return s.decode(t);let e="";for(let r=0;r<t.length;){let i=t[r++>>>0];if(!(128&i)){e+=String.fromCharCode(i);continue}let s=63&t[r++>>>0];if(192==(224&i)){e+=String.fromCharCode((31&i)<<6|s);continue}let n=63&t[r++>>>0];if(i=224==(240&i)?(15&i)<<12|s<<6|n:(7&i)<<18|s<<12|n<<6|63&t[r++>>>0],i<65536)e+=String.fromCharCode(i);else{let t=i-65536;e+=String.fromCharCode(55296|t>>10,56320|1023&t)}}return e}},8507:(t,e,r)=>{"use strict";function i(t){const e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],r={},i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);let s=14;for(;s--;){var n;r[e[s]]=null!==(n=i[s])&&void 0!==n?n:""}return{protocol:r.protocol,file:r.file,host:r.host,port:r.port,user:r.user,password:r.password,origin:`${r.protocol}://${r.authority}`,pathname:r.path,search:`?${r.query}`,hash:r.anchor?`#${r.anchor}`:""}}r.d(e,{ll:()=>f,qg:()=>i}),r(73146);const s=/(?:\/|^)\.(?=\/)/g,n=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o=/^(?=([^\/?#]*))\1([^]*)$/,a=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/;function c(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}function h(t){const e=a.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null}function u(t){for(t=t.split("").reverse().join("").replace(s,"");t.length!==(t=t.replace(n,"")).length;);return t.split("").reverse().join("")}function f(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;let e=h(t);if(!e)throw new Error("Error trying to parse base URL.");return e.path=u(e.path),c(e)}let i=h(e);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=u(i.path),c(i)):e;let s=h(t);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){let t=o.exec(s.path);s.netLoc=t[1],s.path=t[2]}s.netLoc&&!s.path&&(s.path="/");const n={scheme:s.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(n.netLoc=s.netLoc,"/"!==i.path[0]))if(i.path){let t=s.path,e=t.substring(0,t.lastIndexOf("/")+1)+i.path;n.path=u(e)}else n.path=s.path,i.params||(n.params=s.params,i.query||(n.query=s.query));return null===n.path&&(n.path=r.alwaysNormalize?u(i.path):i.path),c(n)}},88096:(t,e,r)=>{"use strict";r.d(e,{$z:()=>h,DD:()=>u,Ee:()=>a,GG:()=>n,p7:()=>c});var i=r(31865);function s(t){let e=0,r=0;for(;;){const i=t.readUint8();if(e|=(127&i)<<r,r+=7,!(128&i))break}return e}async function n(t){let e=0,r=0;for(;;){const i=await t.readUint8();if(e|=(127&i)<<r,r+=7,!(128&i))break}return e}function o(t){let e,r=0,i=0;for(;e=t.readUint8(),r|=(127&e)<<i,i+=7,128&e;);return 64&e&&(r|=-1<<i),r}async function a(t){let e,r=0,i=0;for(;e=await t.readUint8(),r|=(127&e)<<i,i+=7,128&e;);return 64&e&&(r|=-1<<i),r}async function c(t,e){let r=!0;for(;r;){let i=127&e;0==(e>>=7)&&!(64&i)||-1===e&&64&i?r=!1:i|=128,await t.writeUint8(i)}}async function h(t,e){do{let r=127&e;0!=(e>>=7)&&(r|=128),await t.writeUint8(r)}while(0!==e)}function u(t,e){const r=new i.A(t,!0);for(r.skip(8);r.remainingSize();){const i=r.readUint8(),n=s(r);if(2===i){let i=s(r);for(;i--;){const i=s(r);r.skip(i);const n=s(r);switch(r.skip(n),r.readUint8()){case 0:s(r);break;case 3:o(r),s(r);break;case 2:{const i=Number(r.getPos());return void(t[i]=e?2|t[i]:-3&t[i])}case 1:{o(r);const t=s(r);s(r),1&t&&s(r);break}}}return}r.skip(n)}}},49804:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var i=r(134),s=r(16030),n=r(4624);class o{constructor(t){(0,i.A)(this,"scaler",void 0),(0,i.A)(this,"options",void 0),(0,i.A)(this,"inputParameters",void 0),(0,i.A)(this,"outputParameters",void 0),this.options=t,this.scaler=new s.A(this.options.resource)}async open(t,e,r=2){this.inputParameters=t,this.outputParameters=e,await this.scaler.run(),this.scaler.call("scale_set_input_parameters",t.width,t.height,t.format),this.scaler.call("scale_set_output_parameters",e.width,e.height,e.format);let i=this.scaler.call("scale_init",r);i<0&&n.h2(`open scaler failed, ret: ${i}`,"src/videoscale/VideoScaler.ts",92)}scale(t,e){return this.scaler.call("scale_process",t,e)}close(){this.scaler.call("scale_destroy"),this.scaler.destroy(),this.scaler=null}getInputScaleParameters(){return this.inputParameters}getOutputScaleParameters(){return this.outputParameters}}},37149:(t,e,r)=>{r(18355),t.exports=r(46438).Array.isArray},87172:(t,e,r)=>{r(23204),t.exports=r(46438).Date.now},85079:(t,e,r)=>{var i=r(46438),s=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},92861:(t,e,r)=>{r(78978),r(97863),r(7914),r(96050),r(28337),r(74674),r(62223),t.exports=r(46438).Map},92696:(t,e,r)=>{r(74712);var i=r(46438).Object;t.exports=function(t,e,r){return i.defineProperty(t,e,r)}},22948:(t,e,r)=>{r(51780),t.exports=r(46438).Object.freeze},62160:(t,e,r)=>{r(18128),t.exports=r(46438).Object.getPrototypeOf},47567:(t,e,r)=>{r(96847),t.exports=r(46438).Object.keys},21724:(t,e,r)=>{r(4284),t.exports=r(46438).Object.setPrototypeOf},27279:(t,e,r)=>{r(95828),t.exports=r(46438).parseFloat},25216:(t,e,r)=>{r(65331),t.exports=r(46438).parseInt},34750:(t,e,r)=>{r(78978),r(97863),r(7914),r(91229),r(2639),r(46121),t.exports=r(46438).Promise},31707:(t,e,r)=>{r(66801),t.exports=r(46438).setImmediate},16560:(t,e,r)=>{r(19626),r(78978),r(42860),r(60716),t.exports=r(46438).Symbol},54220:(t,e,r)=>{r(97863),r(7914),t.exports=r(84336).f("iterator")},39967:(t,e,r)=>{t.exports=r(84336).f("toPrimitive")},25219:t=>{t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},12560:t=>{t.exports=function(){}},2832:t=>{t.exports=function(t,e,r,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(r+": incorrect invocation!");return t}},80812:(t,e,r)=>{var i=r(24401);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},77076:(t,e,r)=>{var i=r(95838);t.exports=function(t,e){var r=[];return i(t,!1,r.push,r,e),r}},84448:(t,e,r)=>{var i=r(65133),s=r(70181),n=r(72917);t.exports=function(t){return function(e,r,o){var a,c=i(e),h=s(c.length),u=n(o,h);if(t&&r!=r){for(;h>u;)if((a=c[u++])!=a)return!0}else for(;h>u;u++)if((t||u in c)&&c[u]===r)return t||u||0;return!t&&-1}}},48219:(t,e,r)=>{var i=r(58852),s=r(7001),n=r(66310),o=r(70181),a=r(99244);t.exports=function(t,e){var r=1==t,c=2==t,h=3==t,u=4==t,f=6==t,d=5==t||f,l=e||a;return function(e,a,p){for(var m,g,A=n(e),v=s(A),w=i(a,p,3),y=o(v.length),b=0,k=r?l(e,y):c?l(e,0):void 0;y>b;b++)if((d||b in v)&&(g=w(m=v[b],b,A),t))if(r)k[b]=g;else if(g)switch(t){case 3:return!0;case 5:return m;case 6:return b;case 2:k.push(m)}else if(u)return!1;return f?-1:h||u?u:k}}},49742:(t,e,r)=>{var i=r(24401),s=r(15461),n=r(30254)("species");t.exports=function(t){var e;return s(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!s(e.prototype)||(e=void 0),i(e)&&null===(e=e[n])&&(e=void 0)),void 0===e?Array:e}},99244:(t,e,r)=>{var i=r(49742);t.exports=function(t,e){return new(i(t))(e)}},44968:(t,e,r)=>{var i=r(93417),s=r(30254)("toStringTag"),n="Arguments"==i(function(){return arguments}());t.exports=function(t){var e,r,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),s))?r:n?i(e):"Object"==(o=i(e))&&"function"==typeof e.callee?"Arguments":o}},93417:t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},95933:(t,e,r)=>{"use strict";var i=r(78423).f,s=r(22087),n=r(30953),o=r(58852),a=r(2832),c=r(95838),h=r(88839),u=r(20322),f=r(45274),d=r(58219),l=r(75172).fastKey,p=r(6096),m=d?"_s":"size",g=function(t,e){var r,i=l(e);if("F"!==i)return t._i[i];for(r=t._f;r;r=r.n)if(r.k==e)return r};t.exports={getConstructor:function(t,e,r,h){var u=t((function(t,i){a(t,u,e,"_i"),t._t=e,t._i=s(null),t._f=void 0,t._l=void 0,t[m]=0,null!=i&&c(i,r,t[h],t)}));return n(u.prototype,{clear:function(){for(var t=p(this,e),r=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete r[i.i];t._f=t._l=void 0,t[m]=0},delete:function(t){var r=p(this,e),i=g(r,t);if(i){var s=i.n,n=i.p;delete r._i[i.i],i.r=!0,n&&(n.n=s),s&&(s.p=n),r._f==i&&(r._f=s),r._l==i&&(r._l=n),r[m]--}return!!i},forEach:function(t){p(this,e);for(var r,i=o(t,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(i(r.v,r.k,this);r&&r.r;)r=r.p},has:function(t){return!!g(p(this,e),t)}}),d&&i(u.prototype,"size",{get:function(){return p(this,e)[m]}}),u},def:function(t,e,r){var i,s,n=g(t,e);return n?n.v=r:(t._l=n={i:s=l(e,!0),k:e,v:r,p:i=t._l,n:void 0,r:!1},t._f||(t._f=n),i&&(i.n=n),t[m]++,"F"!==s&&(t._i[s]=n)),t},getEntry:g,setStrong:function(t,e,r){h(t,e,(function(t,r){this._t=p(t,e),this._k=r,this._l=void 0}),(function(){for(var t=this,e=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?u(0,"keys"==e?r.k:"values"==e?r.v:[r.k,r.v]):(t._t=void 0,u(1))}),r?"entries":"values",!r,!0),f(e)}}},5874:(t,e,r)=>{var i=r(44968),s=r(77076);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return s(this)}}},99373:(t,e,r)=>{"use strict";var i=r(66670),s=r(88535),n=r(75172),o=r(81984),a=r(2677),c=r(30953),h=r(95838),u=r(2832),f=r(24401),d=r(1356),l=r(78423).f,p=r(48219)(0),m=r(58219);t.exports=function(t,e,r,g,A,v){var w=i[t],y=w,b=A?"set":"add",k=y&&y.prototype,_={};return m&&"function"==typeof y&&(v||k.forEach&&!o((function(){(new y).entries().next()})))?(y=e((function(e,r){u(e,y,t,"_c"),e._c=new w,null!=r&&h(r,A,e[b],e)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(t){var e="add"==t||"set"==t;!(t in k)||v&&"clear"==t||a(y.prototype,t,(function(r,i){if(u(this,y,t),!e&&v&&!f(r))return"get"==t&&void 0;var s=this._c[t](0===r?0:r,i);return e?this:s}))})),v||l(y.prototype,"size",{get:function(){return this._c.size}})):(y=g.getConstructor(e,t,A,b),c(y.prototype,r),n.NEED=!0),d(y,t),_[t]=y,s(s.G+s.W+s.F,_),v||g.setStrong(y,t,A),y}},46438:t=>{var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},58852:(t,e,r)=>{var i=r(25219);t.exports=function(t,e,r){if(i(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,i){return t.call(e,r,i)};case 3:return function(r,i,s){return t.call(e,r,i,s)}}return function(){return t.apply(e,arguments)}}},87608:t=>{t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},58219:(t,e,r)=>{t.exports=!r(81984)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},3802:(t,e,r)=>{var i=r(24401),s=r(66670).document,n=i(s)&&i(s.createElement);t.exports=function(t){return n?s.createElement(t):{}}},77956:t=>{t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},36473:(t,e,r)=>{var i=r(54311),s=r(59820),n=r(36569);t.exports=function(t){var e=i(t),r=s.f;if(r)for(var o,a=r(t),c=n.f,h=0;a.length>h;)c.call(t,o=a[h++])&&e.push(o);return e}},88535:(t,e,r)=>{var i=r(66670),s=r(46438),n=r(58852),o=r(2677),a=r(75509),c="prototype",h=function(t,e,r){var u,f,d,l=t&h.F,p=t&h.G,m=t&h.S,g=t&h.P,A=t&h.B,v=t&h.W,w=p?s:s[e]||(s[e]={}),y=w[c],b=p?i:m?i[e]:(i[e]||{})[c];for(u in p&&(r=e),r)(f=!l&&b&&void 0!==b[u])&&a(w,u)||(d=f?b[u]:r[u],w[u]=p&&"function"!=typeof b[u]?r[u]:A&&f?n(d,i):v&&b[u]==d?function(t){var e=function(e,r,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,i)}return t.apply(this,arguments)};return e[c]=t[c],e}(d):g&&"function"==typeof d?n(Function.call,d):d,g&&((w.virtual||(w.virtual={}))[u]=d,t&h.R&&y&&!y[u]&&o(y,u,d)))};h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,h.U=64,h.R=128,t.exports=h},81984:t=>{t.exports=function(t){try{return!!t()}catch(t){return!0}}},95838:(t,e,r)=>{var i=r(58852),s=r(27904),n=r(12828),o=r(80812),a=r(70181),c=r(55298),h={},u={},f=t.exports=function(t,e,r,f,d){var l,p,m,g,A=d?function(){return t}:c(t),v=i(r,f,e?2:1),w=0;if("function"!=typeof A)throw TypeError(t+" is not iterable!");if(n(A)){for(l=a(t.length);l>w;w++)if((g=e?v(o(p=t[w])[0],p[1]):v(t[w]))===h||g===u)return g}else for(m=A.call(t);!(p=m.next()).done;)if((g=s(m,v,p.value,e))===h||g===u)return g};f.BREAK=h,f.RETURN=u},66670:t=>{var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},75509:t=>{var e={}.hasOwnProperty;t.exports=function(t,r){return e.call(t,r)}},2677:(t,e,r)=>{var i=r(78423),s=r(86260);t.exports=r(58219)?function(t,e,r){return i.f(t,e,s(1,r))}:function(t,e,r){return t[e]=r,t}},76260:(t,e,r)=>{var i=r(66670).document;t.exports=i&&i.documentElement},32484:(t,e,r)=>{t.exports=!r(58219)&&!r(81984)((function(){return 7!=Object.defineProperty(r(3802)("div"),"a",{get:function(){return 7}}).a}))},20709:t=>{t.exports=function(t,e,r){var i=void 0===r;switch(e.length){case 0:return i?t():t.call(r);case 1:return i?t(e[0]):t.call(r,e[0]);case 2:return i?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},7001:(t,e,r)=>{var i=r(93417);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},12828:(t,e,r)=>{var i=r(20210),s=r(30254)("iterator"),n=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||n[s]===t)}},15461:(t,e,r)=>{var i=r(93417);t.exports=Array.isArray||function(t){return"Array"==i(t)}},24401:t=>{t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},27904:(t,e,r)=>{var i=r(80812);t.exports=function(t,e,r,s){try{return s?e(i(r)[0],r[1]):e(r)}catch(e){var n=t.return;throw void 0!==n&&i(n.call(t)),e}}},48248:(t,e,r)=>{"use strict";var i=r(22087),s=r(86260),n=r(1356),o={};r(2677)(o,r(30254)("iterator"),(function(){return this})),t.exports=function(t,e,r){t.prototype=i(o,{next:s(1,r)}),n(t,e+" Iterator")}},88839:(t,e,r)=>{"use strict";var i=r(74742),s=r(88535),n=r(61331),o=r(2677),a=r(20210),c=r(48248),h=r(1356),u=r(66123),f=r(30254)("iterator"),d=!([].keys&&"next"in[].keys()),l="keys",p="values",m=function(){return this};t.exports=function(t,e,r,g,A,v,w){c(r,e,g);var y,b,k,_=function(t){if(!d&&t in P)return P[t];switch(t){case l:case p:return function(){return new r(this,t)}}return function(){return new r(this,t)}},x=e+" Iterator",I=A==p,M=!1,P=t.prototype,C=P[f]||P["@@iterator"]||A&&P[A],B=C||_(A),T=A?I?_("entries"):B:void 0,E="Array"==e&&P.entries||C;if(E&&(k=u(E.call(new t)))!==Object.prototype&&k.next&&(h(k,x,!0),i||"function"==typeof k[f]||o(k,f,m)),I&&C&&C.name!==p&&(M=!0,B=function(){return C.call(this)}),i&&!w||!d&&!M&&P[f]||o(P,f,B),a[e]=B,a[x]=m,A)if(y={values:I?B:_(p),keys:v?B:_(l),entries:T},w)for(b in y)b in P||n(P,b,y[b]);else s(s.P+s.F*(d||M),e,y);return y}},27899:(t,e,r)=>{var i=r(30254)("iterator"),s=!1;try{var n=[7][i]();n.return=function(){s=!0},Array.from(n,(function(){throw 2}))}catch(t){}t.exports=function(t,e){if(!e&&!s)return!1;var r=!1;try{var n=[7],o=n[i]();o.next=function(){return{done:r=!0}},n[i]=function(){return o},t(n)}catch(t){}return r}},20322:t=>{t.exports=function(t,e){return{value:e,done:!!t}}},20210:t=>{t.exports={}},74742:t=>{t.exports=!0},75172:(t,e,r)=>{var i=r(19191)("meta"),s=r(24401),n=r(75509),o=r(78423).f,a=0,c=Object.isExtensible||function(){return!0},h=!r(81984)((function(){return c(Object.preventExtensions({}))})),u=function(t){o(t,i,{value:{i:"O"+ ++a,w:{}}})},f=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!s(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!n(t,i)){if(!c(t))return"F";if(!e)return"E";u(t)}return t[i].i},getWeak:function(t,e){if(!n(t,i)){if(!c(t))return!0;if(!e)return!1;u(t)}return t[i].w},onFreeze:function(t){return h&&f.NEED&&c(t)&&!n(t,i)&&u(t),t}}},53792:(t,e,r)=>{var i=r(66670),s=r(8036).set,n=i.MutationObserver||i.WebKitMutationObserver,o=i.process,a=i.Promise,c="process"==r(93417)(o);t.exports=function(){var t,e,r,h=function(){var i,s;for(c&&(i=o.domain)&&i.exit();t;){s=t.fn,t=t.next;try{s()}catch(i){throw t?r():e=void 0,i}}e=void 0,i&&i.enter()};if(c)r=function(){o.nextTick(h)};else if(!n||i.navigator&&i.navigator.standalone)if(a&&a.resolve){var u=a.resolve(void 0);r=function(){u.then(h)}}else r=function(){s.call(i,h)};else{var f=!0,d=document.createTextNode("");new n(h).observe(d,{characterData:!0}),r=function(){d.data=f=!f}}return function(i){var s={fn:i,next:void 0};e&&(e.next=s),t||(t=s,r()),e=s}}},11642:(t,e,r)=>{"use strict";var i=r(25219);function s(t){var e,r;this.promise=new t((function(t,i){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=i})),this.resolve=i(e),this.reject=i(r)}t.exports.f=function(t){return new s(t)}},22087:(t,e,r)=>{var i=r(80812),s=r(90082),n=r(77956),o=r(4566)("IE_PROTO"),a=function(){},c="prototype",h=function(){var t,e=r(3802)("iframe"),i=n.length;for(e.style.display="none",r(76260).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),h=t.F;i--;)delete h[c][n[i]];return h()};t.exports=Object.create||function(t,e){var r;return null!==t?(a[c]=i(t),r=new a,a[c]=null,r[o]=t):r=h(),void 0===e?r:s(r,e)}},78423:(t,e,r)=>{var i=r(80812),s=r(32484),n=r(10752),o=Object.defineProperty;e.f=r(58219)?Object.defineProperty:function(t,e,r){if(i(t),e=n(e,!0),i(r),s)try{return o(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},90082:(t,e,r)=>{var i=r(78423),s=r(80812),n=r(54311);t.exports=r(58219)?Object.defineProperties:function(t,e){s(t);for(var r,o=n(e),a=o.length,c=0;a>c;)i.f(t,r=o[c++],e[r]);return t}},81033:(t,e,r)=>{var i=r(36569),s=r(86260),n=r(65133),o=r(10752),a=r(75509),c=r(32484),h=Object.getOwnPropertyDescriptor;e.f=r(58219)?h:function(t,e){if(t=n(t),e=o(e,!0),c)try{return h(t,e)}catch(t){}if(a(t,e))return s(!i.f.call(t,e),t[e])}},36309:(t,e,r)=>{var i=r(65133),s=r(1743).f,n={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return o&&"[object Window]"==n.call(t)?function(t){try{return s(t)}catch(t){return o.slice()}}(t):s(i(t))}},1743:(t,e,r)=>{var i=r(85081),s=r(77956).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,s)}},59820:(t,e)=>{e.f=Object.getOwnPropertySymbols},66123:(t,e,r)=>{var i=r(75509),s=r(66310),n=r(4566)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=s(t),i(t,n)?t[n]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},85081:(t,e,r)=>{var i=r(75509),s=r(65133),n=r(84448)(!1),o=r(4566)("IE_PROTO");t.exports=function(t,e){var r,a=s(t),c=0,h=[];for(r in a)r!=o&&i(a,r)&&h.push(r);for(;e.length>c;)i(a,r=e[c++])&&(~n(h,r)||h.push(r));return h}},54311:(t,e,r)=>{var i=r(85081),s=r(77956);t.exports=Object.keys||function(t){return i(t,s)}},36569:(t,e)=>{e.f={}.propertyIsEnumerable},47331:(t,e,r)=>{var i=r(88535),s=r(46438),n=r(81984);t.exports=function(t,e){var r=(s.Object||{})[t]||Object[t],o={};o[t]=e(r),i(i.S+i.F*n((function(){r(1)})),"Object",o)}},49709:(t,e,r)=>{var i=r(66670).parseFloat,s=r(24269).trim;t.exports=1/i(r(80459)+"-0")!=-1/0?function(t){var e=s(String(t),3),r=i(e);return 0===r&&"-"==e.charAt(0)?-0:r}:i},15722:(t,e,r)=>{var i=r(66670).parseInt,s=r(24269).trim,n=r(80459),o=/^[-+]?0[xX]/;t.exports=8!==i(n+"08")||22!==i(n+"0x16")?function(t,e){var r=s(String(t),3);return i(r,e>>>0||(o.test(r)?16:10))}:i},41704:t=>{t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},61037:(t,e,r)=>{var i=r(80812),s=r(24401),n=r(11642);t.exports=function(t,e){if(i(t),s(e)&&e.constructor===t)return e;var r=n.f(t);return(0,r.resolve)(e),r.promise}},86260:t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},30953:(t,e,r)=>{var i=r(2677);t.exports=function(t,e,r){for(var s in e)r&&t[s]?t[s]=e[s]:i(t,s,e[s]);return t}},61331:(t,e,r)=>{t.exports=r(2677)},643:(t,e,r)=>{"use strict";var i=r(88535),s=r(25219),n=r(58852),o=r(95838);t.exports=function(t){i(i.S,t,{from:function(t){var e,r,i,a,c=arguments[1];return s(this),(e=void 0!==c)&&s(c),null==t?new this:(r=[],e?(i=0,a=n(c,arguments[2],2),o(t,!1,(function(t){r.push(a(t,i++))}))):o(t,!1,r.push,r),new this(r))}})}},44398:(t,e,r)=>{"use strict";var i=r(88535);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},32074:(t,e,r)=>{var i=r(24401),s=r(80812),n=function(t,e){if(s(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=r(58852)(Function.call,r(81033).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,r){return n(t,r),e?t.__proto__=r:i(t,r),t}}({},!1):void 0),check:n}},45274:(t,e,r)=>{"use strict";var i=r(66670),s=r(46438),n=r(78423),o=r(58219),a=r(30254)("species");t.exports=function(t){var e="function"==typeof s[t]?s[t]:i[t];o&&e&&!e[a]&&n.f(e,a,{configurable:!0,get:function(){return this}})}},1356:(t,e,r)=>{var i=r(78423).f,s=r(75509),n=r(30254)("toStringTag");t.exports=function(t,e,r){t&&!s(t=r?t:t.prototype,n)&&i(t,n,{configurable:!0,value:e})}},4566:(t,e,r)=>{var i=r(96308)("keys"),s=r(19191);t.exports=function(t){return i[t]||(i[t]=s(t))}},96308:(t,e,r)=>{var i=r(46438),s=r(66670),n="__core-js_shared__",o=s[n]||(s[n]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:r(74742)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},85614:(t,e,r)=>{var i=r(80812),s=r(25219),n=r(30254)("species");t.exports=function(t,e){var r,o=i(t).constructor;return void 0===o||null==(r=i(o)[n])?e:s(r)}},43172:(t,e,r)=>{var i=r(49383),s=r(87608);t.exports=function(t){return function(e,r){var n,o,a=String(s(e)),c=i(r),h=a.length;return c<0||c>=h?t?"":void 0:(n=a.charCodeAt(c))<55296||n>56319||c+1===h||(o=a.charCodeAt(c+1))<56320||o>57343?t?a.charAt(c):n:t?a.slice(c,c+2):o-56320+(n-55296<<10)+65536}}},24269:(t,e,r)=>{var i=r(88535),s=r(87608),n=r(81984),o=r(80459),a="["+o+"]",c=RegExp("^"+a+a+"*"),h=RegExp(a+a+"*$"),u=function(t,e,r){var s={},a=n((function(){return!!o[t]()||""!=""[t]()})),c=s[t]=a?e(f):o[t];r&&(s[r]=c),i(i.P+i.F*a,"String",s)},f=u.trim=function(t,e){return t=String(s(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(h,"")),t};t.exports=u},80459:t=>{t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},8036:(t,e,r)=>{var i,s,n,o=r(58852),a=r(20709),c=r(76260),h=r(3802),u=r(66670),f=u.process,d=u.setImmediate,l=u.clearImmediate,p=u.MessageChannel,m=u.Dispatch,g=0,A={},v="onreadystatechange",w=function(){var t=+this;if(A.hasOwnProperty(t)){var e=A[t];delete A[t],e()}},y=function(t){w.call(t.data)};d&&l||(d=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return A[++g]=function(){a("function"==typeof t?t:Function(t),e)},i(g),g},l=function(t){delete A[t]},"process"==r(93417)(f)?i=function(t){f.nextTick(o(w,t,1))}:m&&m.now?i=function(t){m.now(o(w,t,1))}:p?(n=(s=new p).port2,s.port1.onmessage=y,i=o(n.postMessage,n,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(t){u.postMessage(t+"","*")},u.addEventListener("message",y,!1)):i=v in h("script")?function(t){c.appendChild(h("script"))[v]=function(){c.removeChild(this),w.call(t)}}:function(t){setTimeout(o(w,t,1),0)}),t.exports={set:d,clear:l}},72917:(t,e,r)=>{var i=r(49383),s=Math.max,n=Math.min;t.exports=function(t,e){return(t=i(t))<0?s(t+e,0):n(t,e)}},49383:t=>{var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},65133:(t,e,r)=>{var i=r(7001),s=r(87608);t.exports=function(t){return i(s(t))}},70181:(t,e,r)=>{var i=r(49383),s=Math.min;t.exports=function(t){return t>0?s(i(t),9007199254740991):0}},66310:(t,e,r)=>{var i=r(87608);t.exports=function(t){return Object(i(t))}},10752:(t,e,r)=>{var i=r(24401);t.exports=function(t,e){if(!i(t))return t;var r,s;if(e&&"function"==typeof(r=t.toString)&&!i(s=r.call(t)))return s;if("function"==typeof(r=t.valueOf)&&!i(s=r.call(t)))return s;if(!e&&"function"==typeof(r=t.toString)&&!i(s=r.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},19191:t=>{var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},80218:(t,e,r)=>{var i=r(66670).navigator;t.exports=i&&i.userAgent||""},6096:(t,e,r)=>{var i=r(24401);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},67816:(t,e,r)=>{var i=r(66670),s=r(46438),n=r(74742),o=r(84336),a=r(78423).f;t.exports=function(t){var e=s.Symbol||(s.Symbol=n?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:o.f(t)})}},84336:(t,e,r)=>{e.f=r(30254)},30254:(t,e,r)=>{var i=r(96308)("wks"),s=r(19191),n=r(66670).Symbol,o="function"==typeof n;(t.exports=function(t){return i[t]||(i[t]=o&&n[t]||(o?n:s)("Symbol."+t))}).store=i},55298:(t,e,r)=>{var i=r(44968),s=r(30254)("iterator"),n=r(20210);t.exports=r(46438).getIteratorMethod=function(t){if(null!=t)return t[s]||t["@@iterator"]||n[i(t)]}},18355:(t,e,r)=>{var i=r(88535);i(i.S,"Array",{isArray:r(15461)})},52293:(t,e,r)=>{"use strict";var i=r(12560),s=r(20322),n=r(20210),o=r(65133);t.exports=r(88839)(Array,"Array",(function(t,e){this._t=o(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,s(1)):s(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])}),"values"),n.Arguments=n.Array,i("keys"),i("values"),i("entries")},23204:(t,e,r)=>{var i=r(88535);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},96050:(t,e,r)=>{"use strict";var i=r(95933),s=r(6096),n="Map";t.exports=r(99373)(n,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=i.getEntry(s(this,n),t);return e&&e.v},set:function(t,e){return i.def(s(this,n),0===t?0:t,e)}},i,!0)},74712:(t,e,r)=>{var i=r(88535);i(i.S+i.F*!r(58219),"Object",{defineProperty:r(78423).f})},51780:(t,e,r)=>{var i=r(24401),s=r(75172).onFreeze;r(47331)("freeze",(function(t){return function(e){return t&&i(e)?t(s(e)):e}}))},18128:(t,e,r)=>{var i=r(66310),s=r(66123);r(47331)("getPrototypeOf",(function(){return function(t){return s(i(t))}}))},96847:(t,e,r)=>{var i=r(66310),s=r(54311);r(47331)("keys",(function(){return function(t){return s(i(t))}}))},4284:(t,e,r)=>{var i=r(88535);i(i.S,"Object",{setPrototypeOf:r(32074).set})},78978:()=>{},95828:(t,e,r)=>{var i=r(88535),s=r(49709);i(i.G+i.F*(parseFloat!=s),{parseFloat:s})},65331:(t,e,r)=>{var i=r(88535),s=r(15722);i(i.G+i.F*(parseInt!=s),{parseInt:s})},91229:(t,e,r)=>{"use strict";var i,s,n,o,a=r(74742),c=r(66670),h=r(58852),u=r(44968),f=r(88535),d=r(24401),l=r(25219),p=r(2832),m=r(95838),g=r(85614),A=r(8036).set,v=r(53792)(),w=r(11642),y=r(41704),b=r(80218),k=r(61037),_="Promise",x=c.TypeError,I=c.process,M=I&&I.versions,P=M&&M.v8||"",C=c[_],B="process"==u(I),T=function(){},E=s=w.f,U=!!function(){try{var t=C.resolve(1),e=(t.constructor={})[r(30254)("species")]=function(t){t(T,T)};return(B||"function"==typeof PromiseRejectionEvent)&&t.then(T)instanceof e&&0!==P.indexOf("6.6")&&-1===b.indexOf("Chrome/66")}catch(t){}}(),S=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},R=function(t,e){if(!t._n){t._n=!0;var r=t._c;v((function(){for(var i=t._v,s=1==t._s,n=0,o=function(e){var r,n,o,a=s?e.ok:e.fail,c=e.resolve,h=e.reject,u=e.domain;try{a?(s||(2==t._h&&F(t),t._h=1),!0===a?r=i:(u&&u.enter(),r=a(i),u&&(u.exit(),o=!0)),r===e.promise?h(x("Promise-chain cycle")):(n=S(r))?n.call(r,c,h):c(r)):h(i)}catch(t){u&&!o&&u.exit(),h(t)}};r.length>n;)o(r[n++]);t._c=[],t._n=!1,e&&!t._h&&L(t)}))}},L=function(t){A.call(c,(function(){var e,r,i,s=t._v,n=D(t);if(n&&(e=y((function(){B?I.emit("unhandledRejection",s,t):(r=c.onunhandledrejection)?r({promise:t,reason:s}):(i=c.console)&&i.error&&i.error("Unhandled promise rejection",s)})),t._h=B||D(t)?2:1),t._a=void 0,n&&e.e)throw e.v}))},D=function(t){return 1!==t._h&&0===(t._a||t._c).length},F=function(t){A.call(c,(function(){var e;B?I.emit("rejectionHandled",t):(e=c.onrejectionhandled)&&e({promise:t,reason:t._v})}))},$=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),R(e,!0))},z=function(t){var e,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw x("Promise can't be resolved itself");(e=S(t))?v((function(){var i={_w:r,_d:!1};try{e.call(t,h(z,i,1),h($,i,1))}catch(t){$.call(i,t)}})):(r._v=t,r._s=1,R(r,!1))}catch(t){$.call({_w:r,_d:!1},t)}}};U||(C=function(t){p(this,C,_,"_h"),l(t),i.call(this);try{t(h(z,this,1),h($,this,1))}catch(t){$.call(this,t)}},(i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(30953)(C.prototype,{then:function(t,e){var r=E(g(this,C));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=B?I.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&R(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),n=function(){var t=new i;this.promise=t,this.resolve=h(z,t,1),this.reject=h($,t,1)},w.f=E=function(t){return t===C||t===o?new n(t):s(t)}),f(f.G+f.W+f.F*!U,{Promise:C}),r(1356)(C,_),r(45274)(_),o=r(46438)[_],f(f.S+f.F*!U,_,{reject:function(t){var e=E(this);return(0,e.reject)(t),e.promise}}),f(f.S+f.F*(a||!U),_,{resolve:function(t){return k(a&&this===o?C:this,t)}}),f(f.S+f.F*!(U&&r(27899)((function(t){C.all(t).catch(T)}))),_,{all:function(t){var e=this,r=E(e),i=r.resolve,s=r.reject,n=y((function(){var r=[],n=0,o=1;m(t,!1,(function(t){var a=n++,c=!1;r.push(void 0),o++,e.resolve(t).then((function(t){c||(c=!0,r[a]=t,--o||i(r))}),s)})),--o||i(r)}));return n.e&&s(n.v),r.promise},race:function(t){var e=this,r=E(e),i=r.reject,s=y((function(){m(t,!1,(function(t){e.resolve(t).then(r.resolve,i)}))}));return s.e&&i(s.v),r.promise}})},97863:(t,e,r)=>{"use strict";var i=r(43172)(!0);r(88839)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=i(e,r),this._i+=t.length,{value:t,done:!1})}))},19626:(t,e,r)=>{"use strict";var i=r(66670),s=r(75509),n=r(58219),o=r(88535),a=r(61331),c=r(75172).KEY,h=r(81984),u=r(96308),f=r(1356),d=r(19191),l=r(30254),p=r(84336),m=r(67816),g=r(36473),A=r(15461),v=r(80812),w=r(24401),y=r(66310),b=r(65133),k=r(10752),_=r(86260),x=r(22087),I=r(36309),M=r(81033),P=r(59820),C=r(78423),B=r(54311),T=M.f,E=C.f,U=I.f,S=i.Symbol,R=i.JSON,L=R&&R.stringify,D="prototype",F=l("_hidden"),$=l("toPrimitive"),z={}.propertyIsEnumerable,O=u("symbol-registry"),N=u("symbols"),W=u("op-symbols"),V=Object[D],j="function"==typeof S&&!!P.f,G=i.QObject,H=!G||!G[D]||!G[D].findChild,q=n&&h((function(){return 7!=x(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a}))?function(t,e,r){var i=T(V,e);i&&delete V[e],E(t,e,r),i&&t!==V&&E(V,e,i)}:E,K=function(t){var e=N[t]=x(S[D]);return e._k=t,e},Y=j&&"symbol"==typeof S.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof S},Q=function(t,e,r){return t===V&&Q(W,e,r),v(t),e=k(e,!0),v(r),s(N,e)?(r.enumerable?(s(t,F)&&t[F][e]&&(t[F][e]=!1),r=x(r,{enumerable:_(0,!1)})):(s(t,F)||E(t,F,_(1,{})),t[F][e]=!0),q(t,e,r)):E(t,e,r)},J=function(t,e){v(t);for(var r,i=g(e=b(e)),s=0,n=i.length;n>s;)Q(t,r=i[s++],e[r]);return t},Z=function(t){var e=z.call(this,t=k(t,!0));return!(this===V&&s(N,t)&&!s(W,t))&&(!(e||!s(this,t)||!s(N,t)||s(this,F)&&this[F][t])||e)},X=function(t,e){if(t=b(t),e=k(e,!0),t!==V||!s(N,e)||s(W,e)){var r=T(t,e);return!r||!s(N,e)||s(t,F)&&t[F][e]||(r.enumerable=!0),r}},tt=function(t){for(var e,r=U(b(t)),i=[],n=0;r.length>n;)s(N,e=r[n++])||e==F||e==c||i.push(e);return i},et=function(t){for(var e,r=t===V,i=U(r?W:b(t)),n=[],o=0;i.length>o;)!s(N,e=i[o++])||r&&!s(V,e)||n.push(N[e]);return n};j||(a((S=function(){if(this instanceof S)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(r){this===V&&e.call(W,r),s(this,F)&&s(this[F],t)&&(this[F][t]=!1),q(this,t,_(1,r))};return n&&H&&q(V,t,{configurable:!0,set:e}),K(t)})[D],"toString",(function(){return this._k})),M.f=X,C.f=Q,r(1743).f=I.f=tt,r(36569).f=Z,P.f=et,n&&!r(74742)&&a(V,"propertyIsEnumerable",Z,!0),p.f=function(t){return K(l(t))}),o(o.G+o.W+o.F*!j,{Symbol:S});for(var rt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),it=0;rt.length>it;)l(rt[it++]);for(var st=B(l.store),nt=0;st.length>nt;)m(st[nt++]);o(o.S+o.F*!j,"Symbol",{for:function(t){return s(O,t+="")?O[t]:O[t]=S(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in O)if(O[e]===t)return e},useSetter:function(){H=!0},useSimple:function(){H=!1}}),o(o.S+o.F*!j,"Object",{create:function(t,e){return void 0===e?x(t):J(x(t),e)},defineProperty:Q,defineProperties:J,getOwnPropertyDescriptor:X,getOwnPropertyNames:tt,getOwnPropertySymbols:et});var ot=h((function(){P.f(1)}));o(o.S+o.F*ot,"Object",{getOwnPropertySymbols:function(t){return P.f(y(t))}}),R&&o(o.S+o.F*(!j||h((function(){var t=S();return"[null]"!=L([t])||"{}"!=L({a:t})||"{}"!=L(Object(t))}))),"JSON",{stringify:function(t){for(var e,r,i=[t],s=1;arguments.length>s;)i.push(arguments[s++]);if(r=e=i[1],(w(e)||void 0!==t)&&!Y(t))return A(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Y(e))return e}),i[1]=e,L.apply(R,i)}}),S[D][$]||r(2677)(S[D],$,S[D].valueOf),f(S,"Symbol"),f(Math,"Math",!0),f(i.JSON,"JSON",!0)},62223:(t,e,r)=>{r(643)("Map")},74674:(t,e,r)=>{r(44398)("Map")},28337:(t,e,r)=>{var i=r(88535);i(i.P+i.R,"Map",{toJSON:r(5874)("Map")})},2639:(t,e,r)=>{"use strict";var i=r(88535),s=r(46438),n=r(66670),o=r(85614),a=r(61037);i(i.P+i.R,"Promise",{finally:function(t){var e=o(this,s.Promise||n.Promise),r="function"==typeof t;return this.then(r?function(r){return a(e,t()).then((function(){return r}))}:t,r?function(r){return a(e,t()).then((function(){throw r}))}:t)}})},46121:(t,e,r)=>{"use strict";var i=r(88535),s=r(11642),n=r(41704);i(i.S,"Promise",{try:function(t){var e=s.f(this),r=n(t);return(r.e?e.reject:e.resolve)(r.v),e.promise}})},42860:(t,e,r)=>{r(67816)("asyncIterator")},60716:(t,e,r)=>{r(67816)("observable")},7914:(t,e,r)=>{r(52293);for(var i=r(66670),s=r(2677),n=r(20210),o=r(30254)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<a.length;c++){var h=a[c],u=i[h],f=u&&u.prototype;f&&!f[o]&&s(f,o,h),n[h]=n.Array}},66801:(t,e,r)=>{var i=r(88535),s=r(8036);i(i.G+i.B,{setImmediate:s.set,clearImmediate:s.clear})},73945:t=>{t.exports="AGFzbQEAAAABKQhgAn9/AGACf34AYAJ/fQBgAn98AGABfwF/YAF/AX5gAX8BfWABfwF8AhIBA2VudgZtZW1vcnkCAwGAgAIDDw4AAAABAgMEBAQEBAUGBweIAQ4Gd3JpdGU4AAAHd3JpdGUxNgABB3dyaXRlMzIAAgd3cml0ZTY0AAMId3JpdGVmMzIABAh3cml0ZWY2NAAFBXJlYWQ4AAYGcmVhZFU4AAcGcmVhZDE2AAgHcmVhZFUxNgAJBnJlYWQzMgAKBnJlYWQ2NAALB3JlYWRmMzIADAdyZWFkZjY0AA0KfQ4JACAAIAE6AAALCQAgACABOwEACwkAIAAgATYCAAsJACAAIAE3AwALCQAgACABOAIACwkAIAAgATkDAAsHACAALAAACwcAIAAtAAALBwAgAC4BAAsHACAALwEACwcAIAAoAgALBwAgACkDAAsHACAAKgIACwcAIAArAwAL"},49583:t=>{t.exports="AGFzbQEAAAABLAdgAX8Bf2ABfwF+YAJ/fwF/YAJ/fgF+YAN/f38Bf2ADf35+AX5gA39/fgF/AhIBA2VudgZtZW1vcnkCAwGAgAIDKCcAAAABAgICAwICAgMCAgIDAgICAwICAgMCAgIDAgICAwQEBAUCAgYHhgMnBWxvYWQ4AAAGbG9hZDE2AAEGbG9hZDMyAAIGbG9hZDY0AAMGc3RvcmU4AAQHc3RvcmUxNgAFB3N0b3JlMzIABgdzdG9yZTY0AAcEYWRkOAAIBWFkZDE2AAkFYWRkMzIACgVhZGQ2NAALBHN1YjgADAVzdWIxNgANBXN1YjMyAA4Fc3ViNjQADwRhbmQ4ABAFYW5kMTYAEQVhbmQzMgASBWFuZDY0ABMDb3I4ABQEb3IxNgAVBG9yMzIAFgRvcjY0ABcEeG9yOAAYBXhvcjE2ABkFeG9yMzIAGgV4b3I2NAAbCWV4Y2hhbmdlOAAcCmV4Y2hhbmdlMTYAHQpleGNoYW5nZTMyAB4KZXhjaGFuZ2U2NAAfEWNvbXBhcmVfZXhjaGFuZ2U4ACASY29tcGFyZV9leGNoYW5nZTE2ACESY29tcGFyZV9leGNoYW5nZTMyACISY29tcGFyZV9leGNoYW5nZTY0ACMGbm90aWZ5ACQEd2FpdAAlC3dhaXRUaW1lb3V0ACYKugMnCAAgAP4SAAALCAAgAP4TAQALCAAgAP4QAgALCAAgAP4RAwALDAAgACAB/hkAACABCwwAIAAgAf4aAQAgAQsMACAAIAH+FwIAIAELDAAgACAB/hgDACABCwoAIAAgAf4gAAALCgAgACAB/iEBAAsKACAAIAH+HgIACwoAIAAgAf4fAwALCgAgACAB/icAAAsKACAAIAH+KAEACwoAIAAgAf4lAgALCgAgACAB/iYDAAsKACAAIAH+LgAACwoAIAAgAf4vAQALCgAgACAB/iwCAAsKACAAIAH+LQMACwoAIAAgAf41AAALCgAgACAB/jYBAAsKACAAIAH+MwIACwoAIAAgAf40AwALCgAgACAB/jwAAAsKACAAIAH+PQEACwoAIAAgAf46AgALCgAgACAB/jsDAAsKACAAIAH+QwAACwoAIAAgAf5EAQALCgAgACAB/kECAAsKACAAIAH+QgMACwwAIAAgASAC/koAAAsMACAAIAEgAv5LAQALDAAgACABIAL+SAIACwwAIAAgASAC/kkDAAsKACAAIAH+AAIACwwAIAAgAUJ//gECAAsMACAAIAEgAv4BAgAL"},97134:t=>{t.exports="AGFzbQEAAAABEANgAX8Bf2ABfwBgAn9/AX8CWQYDZW52Bm1lbW9yeQIDAYCAAgNlbnYGbWFsbG9jAAADZW52BGZyZWUAAQNlbnYGY2FsbG9jAAIDZW52B3JlYWxsb2MAAgNlbnYNYWxpZ25lZF9hbGxvYwACAwYFAAECAgIHMwUGbWFsbG9jAAUEZnJlZQAGBmNhbGxvYwAHB3JlYWxsb2MACAxhbGlnbmVkQWxsb2MACQoqBQYAIAAQAAsGACAAEAELCAAgACABEAILCAAgACABEAMLCAAgACABEAML"},5454:t=>{t.exports="AGFzbQEAAAABEwNgAX8Bf2ACf38Bf2ADf39/AX8CEgEDZW52Bm1lbW9yeQIDAYCAAgMHBgAAAQIAAAc5BgRsb2NrAAAGdW5sb2NrAAEEd2FpdAACCXRpbWVkd2FpdAADBnNpZ25hbAAECWJyb2FkY2FzdAAFCvYBBlYBAX8gAEEAQQH+SAIAIQEgAUEARwRAA0AgAUECRgR/QQEFIABBAUEC/kgCAEEARwsEQCAAQQJCf/4BAgAaCyAAQQBBAv5IAgAhASABQQBHDQALC0EACyMAIABBAf4lAgBBAUcEQCAAQQD+FwIAIABBAf4AAgAaC0EACx0AIAAgAP4QAgAgARABGkJ//gECABogARAAGkEACykAIAAgAP4QAgAgARABGiACKQMA/gECACABEAAaQQJGBH9B8AAFQQALCxYAIABBAf4eAgAaIABBAf4AAgAaQQALGgAgAEEB/h4CABogAEGAgICABP4AAgAaQQAL"},68632:(t,e,r)=>{t.exports=r(37149)},45249:(t,e,r)=>{t.exports=r(87172)},73146:(t,e,r)=>{t.exports=r(85079)},80662:(t,e,r)=>{t.exports=r(92861)},66681:(t,e,r)=>{t.exports=r(92696)},7403:(t,e,r)=>{t.exports=r(22948)},75019:(t,e,r)=>{t.exports=r(62160)},69736:(t,e,r)=>{t.exports=r(47567)},11919:(t,e,r)=>{t.exports=r(21724)},88032:(t,e,r)=>{t.exports=r(27279)},29967:(t,e,r)=>{t.exports=r(25216)},54001:(t,e,r)=>{t.exports=r(34750)},64236:(t,e,r)=>{t.exports=r(31707)},75062:(t,e,r)=>{t.exports=r(16560)},134:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(92696),s=r(87361);function n(t,e,r){return(e=(0,s.A)(e))in t?i(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},91908:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(23509),s=r(39967);function n(t,e){if("object"!=(0,i.A)(t)||!t)return t;var r=t[s];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=(0,i.A)(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}},87361:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(23509),s=r(91908);function n(t){var e=(0,s.A)(t,"string");return"symbol"==(0,i.A)(e)?e:String(e)}},23509:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});var i=r(16560),s=r(54220);function n(t){return n="function"==typeof i&&"symbol"==typeof s?function(t){return typeof t}:function(t){return t&&"function"==typeof i&&t.constructor===i&&t!==i.prototype?"symbol":typeof t},n(t)}}},i={};function s(t){var e=i[t];if(void 0!==e)return e.exports;var n=i[t]={exports:{}};return r[t](n,n.exports,s),n.exports}s.m=r,s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce(((e,r)=>(s.f[r](t,e),e)),[])),s.u=t=>t+".avtranscoder.js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="AVTranscoder:",s.l=(r,i,n,o)=>{if(t[r])t[r].push(i);else{var a,c;if(void 0!==n)for(var h=document.getElementsByTagName("script"),u=0;u<h.length;u++){var f=h[u];if(f.getAttribute("src")==r||f.getAttribute("data-webpack")==e+n){a=f;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",e+n),a.src=r),t[r]=[i];var d=(e,i)=>{a.onerror=a.onload=null,clearTimeout(l);var s=t[r];if(delete t[r],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((t=>t(i))),e)return e(i)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),(()=>{var t={792:0};s.f.j=(e,r)=>{var i=s.o(t,e)?t[e]:void 0;if(0!==i)if(i)r.push(i[2]);else{var n=new Promise(((r,s)=>i=t[e]=[r,s]));r.push(i[2]=n);var o=s.p+s.u(e),a=new Error;s.l(o,(r=>{if(s.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var n=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",a.name="ChunkLoadError",a.type=n,a.request=o,i[1](a)}}),"chunk-"+e,e)}};var e=(e,r)=>{var i,n,[o,a,c]=r,h=0;if(o.some((e=>0!==t[e]))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);c&&c(s)}for(e&&e(r);h<o.length;h++)n=o[h],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0},r=self.webpackChunkAVTranscoder=self.webpackChunkAVTranscoder||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var n=s(51170);return n.default})()));