/*! For license information please see avplayer.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AVPlayer=t():e.AVPlayer=t()}(self,(()=>(()=>{var e,t,r={92246:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(16030),f=r(4624),h=function(){function e(t){(0,i.A)(this,e),(0,s.A)(this,"resampler",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"inputParameters",void 0),(0,s.A)(this,"outputParameters",void 0),this.options=t,this.resampler=new c.A(this.options.resource)}var t;return(0,a.A)(e,[{key:"open",value:(t=(0,n.A)(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.inputParameters=t,this.outputParameters=r,e.next=4,this.resampler.run();case 4:this.resampler.call("resample_set_input_parameters",t.sampleRate,t.channels,t.format,t.layout||0),this.resampler.call("resample_set_output_parameters",r.sampleRate,r.channels,r.format,r.layout||0),(n=this.resampler.call("resample_init"))<0&&f.h2("open resampler failed, ret: ".concat(n),"src/audioresample/Resampler.ts",84);case 8:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"resample",value:function(e,t,r){return this.resampler.call("resample_process",e,t,r)}},{key:"getOutputSampleCount",value:function(e){return this.resampler.call("resample_nb_sample",e)}},{key:"close",value:function(){this.resampler.call("resample_destroy"),this.resampler.destroy(),this.resampler=null}},{key:"getInputPCMParameters",value:function(){return this.inputParameters}},{key:"getOutputPCMParameters",value:function(){return this.outputParameters}}]),e}()},70089:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(16030),f=function(){function e(t){(0,i.A)(this,e),(0,s.A)(this,"processor",void 0),(0,s.A)(this,"options",void 0),this.options=t,this.processor=new c.A(this.options.resource)}var t;return(0,a.A)(e,[{key:"open",value:(t=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.processor.run();case 2:this.processor.call("stretchpitch_init"),this.processor.call("stretchpitch_set_channels",t.channels),this.processor.call("stretchpitch_set_samplerate",t.sampleRate);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"setRate",value:function(e){this.processor.call("stretchpitch_set_rate",e)}},{key:"setRateChange",value:function(e){this.processor.call("stretchpitch_set_rate_change",e)}},{key:"setTempo",value:function(e){this.processor.call("stretchpitch_set_tempo",e)}},{key:"setTempoChange",value:function(e){this.processor.call("stretchpitch_set_tempo_change",e)}},{key:"setPitch",value:function(e){this.processor.call("stretchpitch_set_pitch",e)}},{key:"setPitchOctaves",value:function(e){this.processor.call("stretchpitch_set_pitch_octaves",e)}},{key:"setPitchSemiTones",value:function(e){this.processor.call("stretchpitch_set_pitch_semi_tones",e)}},{key:"sendSamples",value:function(e,t){this.processor.call("stretchpitch_send_samples",e,t)}},{key:"receiveSamples",value:function(e,t){return this.processor.call("stretchpitch_receive_samples",e,t)}},{key:"flush",value:function(){this.processor.call("stretchpitch_flush")}},{key:"clear",value:function(){this.processor.call("stretchpitch_clear")}},{key:"getUnprocessedSamplesCount",value:function(){return this.processor.call("stretchpitch_get_unprocessed_samples_num")}},{key:"getInputOutputSamplesRatio",value:function(){return this.processor.call("stretchpitch_get_input_output_sample_ratio")}},{key:"getLatency",value:function(){return this.processor.call("get_latency")}},{key:"close",value:function(){this.processor.call("stretchpitch_destroy"),this.processor.destroy(),this.processor=null}}]),e}()},51128:(e,t,r)=>{"use strict";r.d(t,{d:()=>a});var n,i=r(134),a=(n={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,86017,"mp3"),86018,"mp4a.40"),86021,"vorbis"),86028,"flac"),86076,"opus"),65542,"ulaw"),65543,"alaw"),225,"av01"),27,"avc1"),173,"hev1"),(0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,196,"vvc1"),139,"vp8"),167,"vp09"),12,"mp4v"))},1984:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(63939),i=r(51128);function a(e){var t=n.f[15](e+4),r=n.f[15](e+48),a=i.d[t];return 86018===t&&(a="".concat(a,".").concat(r)),a||"unknown"}},21233:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});var n=r(86834);function i(e){return e?!n.A.chrome||n.A.checkVersion(n.A.majorVersion,"94",!0)?"prefer-hardware":"allow":!n.A.chrome||n.A.checkVersion(n.A.majorVersion,"94",!0)?"prefer-software":"deny"}},94663:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(63939),i=r(51128),a=r(90412),s=r(14392),o=r(58919),u=r(55611),c=r(20525),f=r(77231),h=r(14686),d=r(90932);function l(e,t){var r=n.f[15](e+4),l=n.f[15](e+48),p=n.f[15](e+52);!t&&0!==n.f[20](e+12)&&n.f[15](e+16)&&(t=(0,h.s3)(n.f[20](e+12),n.f[15](e+16)));var v=i.d[r],m="";if(27===r)110===l&&(l=100),m=c.GP("%s.%02x00%02x",v,255&l,255&p);else if(173===r){var g,A=0,y=0,x=0,k=0;(null===(g=t)||void 0===g?void 0:g.length)>13&&(A=t[1]>>>6&3,x=t[1]>>>5&1,y=t[2]|t[3]<<8|t[4]<<16|t[5]<<24,k=240&t[6]),m=c.GP("%s.%s%d.%x.%s%d.%x",v,{0:"",1:"A",2:"B",3:"C"}[A],l,y,0===x?"L":"H",p,k)}else if(196===r){var b,w=0;if((null===(b=t)||void 0===b?void 0:b.length)>13&&(w=1&t[5]),m=c.GP("%s.%d.%s%d",v,l,0===w?"L":"H",p),t){var _=u.Ui(t);if(_.generalConstraintInfo.length){for(var T=_.generalConstraintInfo.length-1;T>0&&0===_.generalConstraintInfo[T];)T--;var I=_.generalConstraintInfo.slice(0,T+1);I.length&&(m+=".C".concat(d.l(new Uint8Array(I),!1)))}_.generalSubProfileIdc.length&&(m+=".S".concat(_.generalSubProfileIdc.map((function(e){return e.toString(16)})).join("+"))),m+=".O".concat(_.olsIdx,"+").concat(_.numSublayers)}}else if(225===r)if(t){var S=a.Ui(t);m=c.GP("%s.%d.%02d%s.%02d.%d.%d%d%d",v,S.profile,S.level,S.tier?"H":"M",S.bitDepth,S.monochrome,S.chromaSubsamplingX,S.chromaSubsamplingY,S.chromaSamplePosition)}else m=c.GP("%s.%d.%02dM.08",v,l,p);else if(139===r)if(t){var P=s.U(t);m=c.GP("%s.%02d.%02d.%02d",v,P.profile,P.level,P.bitDepth)}else m=l!==f.N_&&p!==f.N_?c.GP("%s.%02d.%02d.08",v,l,p):v;else if(167===r)if(t){var B=o.Ui(t);m=c.GP("%s.%02d.%02d.%02d.%02d.%02d.%02d.%02d.%02d",v,B.profile,B.level,B.bitDepth,B.chromaSubsampling,B.colorPrimaries,B.colorTrc,B.colorSpace,B.fullRangeFlag)}else m=l!==f.N_&&p!==f.N_?c.GP("%s.%02d.%02d.08.00",v,l,p):c.GP("%s.%02d.%02d.08.00",v,0,40);else m=v||"unknown";return m}},53616:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(63939),f=r(9705),h=r(26235),d=r(59996),l=r(62624),p=r(9787),v=r(43950),m=function(){function e(t){(0,i.A)(this,e),(0,s.A)(this,"options",void 0),(0,s.A)(this,"frame",void 0),(0,s.A)(this,"decoder",void 0),this.options=t}var t,r;return(0,a.A)(e,[{key:"getAVFrame",value:function(){return this.frame?this.frame:this.frame={pts:BigInt(0),duration:BigInt(0),rects:[],timeBase:{den:1,num:1}}}},{key:"outputAVFrame",value:function(){this.frame&&(this.options.onReceiveSubtitle&&this.options.onReceiveSubtitle(this.frame),this.frame=null)}},{key:"receiveAVFrame",value:function(){return this.decoder.receiveAVFrame(this.getAVFrame())}},{key:"open",value:(r=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=c.f[15](t+4),e.next=94226===e.t0?3:94232===e.t0?5:94210===e.t0||94225===e.t0?7:94213===e.t0?9:94212===e.t0||94230===e.t0?11:13;break;case 3:return this.decoder=new h.A,e.abrupt("break",14);case 5:return this.decoder=new l.A,e.abrupt("break",14);case 7:return this.decoder=new v.A,e.abrupt("break",14);case 9:return this.decoder=new p.A,e.abrupt("break",14);case 11:return this.decoder=new d.A,e.abrupt("break",14);case 13:return e.abrupt("return",f.r8);case 14:return e.abrupt("return",0);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"decode",value:function(e){var t=this.decoder.sendAVPacket(e);if(t)return t;for(;;){if(1!==(t=this.receiveAVFrame())){if(t<0)return t;break}this.outputAVFrame()}return 0}},{key:"flush",value:(t=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.decoder.flush();case 1:if(!(this.receiveAVFrame()<1)){e.next=5;break}return e.abrupt("return");case 5:this.outputAVFrame(),e.next=1;break;case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){this.frame&&(this.frame=null)}}]),e}()},59996:(e,t,r)=>{"use strict";r.d(t,{A:()=>y});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(43070),f=r(31060),h=r(134),d=r(63939),l=r(81023),p=r(71517),v=r(81238),m=r(50011);function g(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,A()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function A(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(A=function(){return!!e})()}var y=function(e){function t(){var e;return(0,a.A)(this,t),e=g(this,t),(0,h.A)((0,c.A)(e),"queue",void 0),e.queue=[],e}return(0,f.A)(t,e),(0,s.A)(t,[{key:"sendAVPacket",value:function(e){return this.queue.push({data:(0,p.iI)(e).slice(),pts:d.f[17](e+8),duration:d.f[17](e+48),timeBase:{den:d.f[15](e+76),num:d.f[15](e+72)}}),0}},{key:"receiveAVFrame",value:function(e){if(this.queue.length){var t=this.queue.shift();e.pts=t.pts,e.duration=t.duration,e.timeBase.den=t.timeBase.den,e.timeBase.num=t.timeBase.num;var r=m.decode(t.data);return/^\w+?\s*:/.test(r)||(r="Dialogue: "+r),e.rects.push({type:v.G.SUBTITLE_ASS,text:r,flags:0}),1}return 0}},{key:"flush",value:function(){return 0}}]),t}(l.A)},81023:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(81570),i=r(78716),a=(0,n.A)((function e(){(0,i.A)(this,e)}))},43950:(e,t,r)=>{"use strict";r.d(t,{A:()=>y});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(43070),f=r(31060),h=r(134),d=r(63939),l=r(81023),p=r(71517),v=r(81238),m=r(50011);function g(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,A()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function A(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(A=function(){return!!e})()}var y=function(e){function t(){var e;return(0,a.A)(this,t),e=g(this,t),(0,h.A)((0,c.A)(e),"queue",void 0),e.queue=[],e}return(0,f.A)(t,e),(0,s.A)(t,[{key:"sendAVPacket",value:function(e){return this.queue.push({data:(0,p.iI)(e).slice(),pts:d.f[17](e+8),duration:d.f[17](e+48),timeBase:{den:d.f[15](e+76),num:d.f[15](e+72)}}),0}},{key:"receiveAVFrame",value:function(e){if(this.queue.length){var t=this.queue.shift();return e.pts=t.pts,e.duration=t.duration,e.timeBase.den=t.timeBase.den,e.timeBase.num=t.timeBase.num,e.rects.push({type:v.G.SUBTITLE_TEXT,text:m.decode(t.data),flags:0}),1}return 0}},{key:"flush",value:function(){return 0}}]),t}(l.A)},9787:(e,t,r)=>{"use strict";r.d(t,{A:()=>x});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(43070),f=r(31060),h=r(134),d=r(63939),l=r(81023),p=r(71517),v=r(81238),m=r(50011),g=r(4624);function A(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,y()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function y(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(y=function(){return!!e})()}var x=function(e){function t(){var e;return(0,a.A)(this,t),e=A(this,t),(0,h.A)((0,c.A)(e),"queue",void 0),e.queue=[],e}return(0,f.A)(t,e),(0,s.A)(t,[{key:"sendAVPacket",value:function(e){var t=(0,p.iI)(e).slice();if(t.length<2)return 0;var r=t[0]<<8|t[1];if(r+2>t.length)return g.R8("invalid timed text data, need ".concat(r+2," but got ").concat(t.length,", ignore it"),"src/avcodec/subtitle/decoder/TimedTextDecoder.ts",59),0;var n=m.decode(t.subarray(2,2+r));return this.queue.push({text:n,pts:d.f[17](e+8),duration:d.f[17](e+48),timeBase:{den:d.f[15](e+76),num:d.f[15](e+72)}}),0}},{key:"receiveAVFrame",value:function(e){if(this.queue.length){var t=this.queue.shift();return e.pts=t.pts,e.duration=t.duration,e.timeBase.den=t.timeBase.den,e.timeBase.num=t.timeBase.num,e.rects.push({type:v.G.SUBTITLE_TEXT,text:t.text,flags:0}),1}return 0}},{key:"flush",value:function(){return 0}}]),t}(l.A)},62624:(e,t,r)=>{"use strict";r.d(t,{A:()=>k});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(43070),f=r(31060),h=r(134),d=r(63939),l=r(81023),p=r(50011),v=r(71517),m=r(77231),g=r(81238),A=r(38115);function y(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,x()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function x(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}var k=function(e){function t(){var e;return(0,a.A)(this,t),e=y(this,t),(0,h.A)((0,c.A)(e),"queue",void 0),e.queue=[],e}return(0,f.A)(t,e),(0,s.A)(t,[{key:"sendAVPacket",value:function(e){var t=p.decode((0,v.iI)(e));return t?(/<tt/.test(t.trim())?this.queue=this.queue.concat(A.q(t).queue):this.queue.push({pts:d.f[17](e+8),duration:d.f[17](e+48),context:t,region:"Default"}),0):0}},{key:"receiveAVFrame",value:function(e){if(this.queue.length){var t=this.queue.shift();return e.pts=t.pts,e.duration=t.duration,e.timeBase.den=m.qs,e.timeBase.num=1,e.rects.push({type:g.G.SUBTITLE_WEBVTT,text:t.context,flags:0}),1}return 0}},{key:"flush",value:function(){return 0}}]),t}(l.A)},26235:(e,t,r)=>{"use strict";r.d(t,{A:()=>k});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(43070),f=r(31060),h=r(134),d=r(63939),l=r(81023),p=r(50011),v=r(71517),m=r(54825),g=r(81238),A=r(77231);function y(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,x()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function x(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}var k=function(e){function t(){var e;return(0,a.A)(this,t),e=y(this,t),(0,h.A)((0,c.A)(e),"queue",void 0),e.queue=[],e}return(0,f.A)(t,e),(0,s.A)(t,[{key:"findTimelineTag",value:function(e){var t=e.indexOf("<");if(t>=0){var r=e.indexOf(">",t);if(r>t&&/^(\d{2,}:)?\d{2}:\d{2}\.\d{1,3}$/.test(e.substring(t+1,r)))return{start:t,end:r}}return{start:-1,end:-1}}},{key:"sendAVPacket",value:function(e){for(var t=p.decode((0,v.iI)(e)),r=d.f[17](e+8),n=r+d.f[17](e+48),i=[];;){var a=this.findTimelineTag(t),s=a.start,o=a.end;if(s<0)break;var u=(0,m.j)(t.substring(s+1,o));i.push(t.substring(0,s)),this.queue.push({context:i.join(""),pts:r,duration:u-r,timeBase:{den:d.f[15](e+76),num:d.f[15](e+72)}}),r=u,t=t.substring(o+1)}return i.push(t),this.queue.push({context:i.join(""),pts:r,duration:n-r,timeBase:{den:d.f[15](e+76),num:d.f[15](e+72)}}),0}},{key:"receiveAVFrame",value:function(e){if(this.queue.length){var t=this.queue.shift();return e.pts=t.pts,e.duration=t.duration,e.timeBase.den=A.qs,e.timeBase.num=1,e.rects.push({type:g.G.SUBTITLE_WEBVTT,text:t.context,flags:0}),1}return 0}},{key:"flush",value:function(){return 0}}]),t}(l.A)},75742:(e,t,r)=>{"use strict";r.d(t,{A:()=>A});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(11473),f=r(16030),h=r(56024),d=r(4624),l=r(95797),p=r(95335),v=r(73749),m=r(67672),g=r(37837),A=function(){function e(t){(0,i.A)(this,e),(0,s.A)(this,"options",void 0),(0,s.A)(this,"decoder",void 0),(0,s.A)(this,"frame",void 0),(0,s.A)(this,"decoderOptions",0),this.options=t,this.decoder=new f.A(t.resource)}var t,r;return(0,a.A)(e,[{key:"getAVFrame",value:function(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,h.FP)()}},{key:"outputAVFrame",value:function(){this.frame&&(this.options.onReceiveFrame?this.options.onReceiveFrame(this.frame):this.options.avframePool?this.options.avframePool.release(this.frame):(0,h.xj)(this.frame),this.frame=0)}},{key:"receiveAVFrame",value:function(){return this.decoder.call("decoder_receive",this.getAVFrame())}},{key:"open",value:(r=(0,n.A)(u().mark((function e(t){var r,n,i=this,a=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},e.next=3,this.decoder.run();case 3:if(p.keys(r).length&&(this.decoderOptions&&(v.AO(this.decoderOptions),c.s_.free(this.decoderOptions),this.decoderOptions=0),this.decoderOptions=(0,g.Gy)(8),p.each(r,(function(e,t){(m.Yj(e)||m.Yj(t))&&v.a5(i.decoderOptions,t,e)}))),n=0,!l.A.jspi){e.next=11;break}return e.next=8,this.decoder.callAsync("decoder_open",t,0,1,this.decoderOptions);case 8:n=e.sent,e.next=14;break;case 11:return n=this.decoder.call("decoder_open",t,0,1,this.decoderOptions),e.next=14,this.decoder.childrenThreadReady();case 14:n<0&&d.h2("open audio decoder failed, ret: ".concat(n),"src/avcodec/wasmcodec/AudioDecoder.ts",113);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"decode",value:function(e){var t=this.decoder.call("decoder_decode",e);if(t)return t;for(;;){if(1!==(t=this.receiveAVFrame())){if(t<0)return t;break}this.outputAVFrame()}return 0}},{key:"flush",value:(t=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.decoder.call("decoder_flush");case 1:if(!(this.receiveAVFrame()<1)){e.next=5;break}return e.abrupt("return");case 5:this.outputAVFrame(),e.next=1;break;case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){this.decoder.call("decoder_close"),this.decoder.destroy(),this.decoder=null,this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,h.xj)(this.frame),this.frame=0),this.decoderOptions&&(v.AO(this.decoderOptions),c.s_.free(this.decoderOptions),this.decoderOptions=0)}}]),e}()},40417:(e,t,r)=>{"use strict";r.d(t,{A:()=>A});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(11473),f=r(16030),h=r(56024),d=r(4624),l=r(95797),p=r(95335),v=r(73749),m=r(67672),g=r(37837),A=function(){function e(t){(0,i.A)(this,e),(0,s.A)(this,"options",void 0),(0,s.A)(this,"decoder",void 0),(0,s.A)(this,"frame",void 0),(0,s.A)(this,"parameters",void 0),(0,s.A)(this,"decoderOptions",0),this.options=t,this.decoder=new f.A(this.options.resource)}var t,r;return(0,a.A)(e,[{key:"getAVFrame",value:function(){return this.frame?this.frame:this.frame=this.options.avframePool?this.options.avframePool.alloc():(0,h.FP)()}},{key:"outputAVFrame",value:function(){this.frame&&(this.options.onReceiveFrame?this.options.onReceiveFrame(this.frame):this.options.avframePool?this.options.avframePool.release(this.frame):(0,h.xj)(this.frame),this.frame=0)}},{key:"receiveAVFrame",value:function(){return this.decoder.call("decoder_receive",this.getAVFrame())}},{key:"open",value:(r=(0,n.A)(u().mark((function e(t){var r,n,i,a=this,s=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:1,n=s.length>2&&void 0!==s[2]?s[2]:{},e.next=4,this.decoder.run(null,r);case 4:if(i=0,p.keys(n).length&&(this.decoderOptions&&(v.AO(this.decoderOptions),c.s_.free(this.decoderOptions),this.decoderOptions=0),this.decoderOptions=(0,g.Gy)(8),p.each(n,(function(e,t){(m.Yj(e)||m.Yj(t))&&v.a5(a.decoderOptions,t,e)}))),!l.A.jspi){e.next=12;break}return e.next=9,this.decoder.callAsync("decoder_open",t,0,r,this.decoderOptions);case 9:i=e.sent,e.next=15;break;case 12:return i=this.decoder.call("decoder_open",t,0,r,this.decoderOptions),e.next=15,this.decoder.childrenThreadReady();case 15:return i<0&&d.h2("open video decoder failed, ret: ".concat(i),"src/avcodec/wasmcodec/VideoDecoder.ts",151),this.parameters=t,e.next=19,this.decoder.childrenThreadReady();case 19:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"decode",value:function(e){var t=this.decoder.call("decoder_decode",e);if(t)return t;for(;;){if(1!==(t=this.receiveAVFrame())){if(t<0)return t;break}this.outputAVFrame()}return 0}},{key:"flush",value:(t=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.decoder.call("decoder_flush");case 1:if(!(this.receiveAVFrame()<1)){e.next=5;break}return e.abrupt("return");case 5:this.outputAVFrame(),e.next=1;break;case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"close",value:function(){this.decoder.call("decoder_close"),this.decoder.destroy(),this.decoder=null,this.frame&&(this.options.avframePool?this.options.avframePool.release(this.frame):(0,h.xj)(this.frame),this.frame=0),this.parameters=0,this.decoderOptions&&(v.AO(this.decoderOptions),c.s_.free(this.decoderOptions),this.decoderOptions=0)}},{key:"setSkipFrameDiscard",value:function(e){this.decoder.call("decoder_discard",e)}}]),e}()},77104:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(63939),f=r(1984),h=r(14686),d=r(71517),l=r(22898),p=r(4624),v=function(){function e(t){(0,i.A)(this,e),(0,s.A)(this,"options",void 0),(0,s.A)(this,"decoder",void 0),(0,s.A)(this,"parameters",void 0),(0,s.A)(this,"extradata",void 0),(0,s.A)(this,"currentError",void 0),this.options=t}var t,r,o;return(0,a.A)(e,[{key:"output",value:function(e){this.options.onReceiveFrame?this.options.onReceiveFrame(e):e.close()}},{key:"error",value:function(e){this.currentError=e,this.options.onError(e)}},{key:"open",value:(o=(0,n.A)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentError=null,this.parameters=t,this.extradata=null,0!==c.f[20](t+12)&&(this.extradata=(0,h.s3)(c.f[20](t+12),c.f[15](t+16)).slice()),(r={codec:(0,f.A)(this.parameters),sampleRate:c.f[15](t+136),numberOfChannels:c.f[15](t+116),description:this.extradata}).description||delete r.description,e.next=8,AudioDecoder.isConfigSupported(r);case 8:if(e.sent.supported){e.next=11;break}throw new Error("not support");case 11:if(this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new AudioDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(r),!this.currentError){e.next=17;break}throw this.currentError;case 17:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"changeExtraData",value:function(e){if(e.length===this.extradata.length){for(var t=!0,r=0;r<e.length;r++)if(e[r]!==this.extradata[r]){t=!1;break}if(t)return}if(this.extradata=e.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,f.A)(this.parameters),sampleRate:c.f[15](this.parameters+136),numberOfChannels:c.f[15](this.parameters+116),description:this.extradata}),this.currentError)throw this.currentError}},{key:"decode",value:function(e,t){var r=(0,d.rU)(e,1);0!==r&&this.changeExtraData((0,h.s3)(c.f[20](r),c.f[15](r+4)));var n=(0,l.A)(e,t);try{this.decoder.decode(n)}catch(e){return p.z3("decode error, ".concat(e),"src/avcodec/webcodec/AudioDecoder.ts",155),-1}return 0}},{key:"flush",value:(r=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.decoder.flush();case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"close",value:function(){"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=null}},{key:"getQueueLength",value:function(){return this.decoder.decodeQueueSize}}],[{key:"isSupported",value:(t=(0,n.A)(u().mark((function e(t){var r,n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,0!==c.f[20](t+12)&&(r=(0,h.s3)(c.f[20](t+12),c.f[15](t+16)).slice()),(n={codec:(0,f.A)(t),sampleRate:c.f[15](t+136),numberOfChannels:c.f[15](t+116),description:r}).description||delete n.description,e.next=6,AudioDecoder.isConfigSupported(n);case 6:return i=e.sent,e.abrupt("return",i.supported);case 8:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}()},71039:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(63939),f=r(86834),h=r(94663),d=r(14686),l=r(71517),p=r(21233),v=r(28917),m=r(4624),g=function(){function e(t){(0,i.A)(this,e),(0,s.A)(this,"decoder",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"parameters",void 0),(0,s.A)(this,"extradata",void 0),(0,s.A)(this,"currentError",void 0),(0,s.A)(this,"inputQueue",void 0),(0,s.A)(this,"outputQueue",void 0),(0,s.A)(this,"sort",void 0),(0,s.A)(this,"keyframeRequire",void 0),this.options=t,this.inputQueue=[],this.outputQueue=[],this.sort=f.A.safari}var t,r,o,g;return(0,a.A)(e,[{key:"output",value:(g=(0,n.A)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.sort){e.next=13;break}r=0;case 2:if(!(r<this.outputQueue.length)){e.next=9;break}if(!(this.outputQueue[r].timestamp>t.timestamp)){e.next=6;break}return this.outputQueue.splice(r,0,t),e.abrupt("break",9);case 6:r++,e.next=2;break;case 9:for(r===this.outputQueue.length&&this.outputQueue.push(t);this.outputQueue.length>2&&this.outputQueue[0].timestamp===this.inputQueue[0];)n=this.outputQueue.shift(),this.options.onReceiveFrame?this.options.onReceiveFrame(n):n.close(),this.inputQueue.shift();e.next=14;break;case 13:this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close();case 14:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"error",value:function(e){this.currentError=e,this.options.onError(e)}},{key:"changeExtraData",value:function(e){var t;if(e.length===this.extradata.length){for(var r=!0,n=0;n<e.length;n++)if(e[n]!==this.extradata[n]){r=!1;break}if(r)return}this.extradata=e.slice(),this.decoder.reset(),this.decoder.configure({codec:(0,h.A)(this.parameters,e),description:this.extradata,hardwareAcceleration:(0,p.C)(null===(t=this.options.enableHardwareAcceleration)||void 0===t||t)}),this.keyframeRequire=!0}},{key:"open",value:(o=(0,n.A)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentError=null,this.extradata=null,0!==c.f[20](t+12)&&(this.extradata=(0,d.s3)(c.f[20](t+12),c.f[15](t+16)).slice()),this.parameters=t,(n={codec:(0,h.A)(t),codedWidth:c.f[15](t+56),codedHeight:c.f[15](t+60),description:2!==c.f[15](t+160)?this.extradata:void 0,hardwareAcceleration:(0,p.C)(null===(r=this.options.enableHardwareAcceleration)||void 0===r||r)}).description||delete n.description,e.next=8,VideoDecoder.isConfigSupported(n);case 8:if(e.sent.supported){e.next=11;break}throw new Error("not support");case 11:if(this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=new VideoDecoder({output:this.output.bind(this),error:this.error.bind(this)}),this.decoder.reset(),this.decoder.configure(n),!this.currentError){e.next=17;break}throw this.currentError;case 17:this.keyframeRequire=!0,this.inputQueue.length=0,this.outputQueue.length=0;case 20:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"decode",value:function(e){var t=(0,l.rU)(e,1);0!==t&&this.changeExtraData((0,d.s3)(c.f[20](t),c.f[15](t+4)));var r=1&c.f[15](e+36);if(this.keyframeRequire&&!r)return 0;var n=Number(c.f[17](e+8)),i=(0,v.A)(e);if(this.sort){for(var a=0;a<this.inputQueue.length;a++)if(this.inputQueue[a]>n){this.inputQueue.splice(a,0,n);break}a===this.inputQueue.length&&this.inputQueue.push(n)}try{this.decoder.decode(i)}catch(e){return m.z3("decode error, ".concat(e),"src/avcodec/webcodec/VideoDecoder.ts",223),-1}return r&&(this.keyframeRequire=!1),0}},{key:"flush",value:(r=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.decoder.flush();case 2:if(this.sort)for(;this.outputQueue.length;)t=this.outputQueue.shift(),this.options.onReceiveFrame?this.options.onReceiveFrame(t):t.close();this.keyframeRequire=!0;case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"close",value:function(){var e;this.decoder&&"closed"!==this.decoder.state&&this.decoder.close(),this.decoder=null,this.currentError=null,null!==(e=this.outputQueue)&&void 0!==e&&e.length&&this.outputQueue.forEach((function(e){e.close()})),this.inputQueue=null,this.outputQueue=null}},{key:"getQueueLength",value:function(){return this.decoder.decodeQueueSize}},{key:"setSkipFrameDiscard",value:function(e){}}],[{key:"isSupported",value:(t=(0,n.A)(u().mark((function e(t,r){var n,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,0!==c.f[20](t+12)&&(n=(0,d.s3)(c.f[20](t+12),c.f[15](t+16)).slice()),(i={codec:(0,h.A)(t),codedWidth:c.f[15](t+56),codedHeight:c.f[15](t+60),description:2!==c.f[15](t+160)?n:void 0,hardwareAcceleration:(0,p.C)(null==r||r)}).description||delete i.description,e.next=6,VideoDecoder.isConfigSupported(i);case 6:return a=e.sent,e.abrupt("return",a.supported);case 8:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})}]),e}()},44315:(e,t,r)=>{"use strict";r.d(t,{Xv:()=>m,fG:()=>g,oD:()=>v});var n=r(81570),i=r(78716),a=r(134),s=r(63939),o=r(50932),u=r(15017),c=r(71517),f=r(7417),h=r(73783),d=f.z1(4,4),l=f.z1(4,4),p=(0,n.A)((function e(){(0,i.A)(this,e),(0,a.A)(this,"packetBuffer",void 0),this.packetBuffer=[]})),v=function(){function e(){(0,i.A)(this,e),(0,a.A)(this,"metadataHeaderPadding",-1),(0,a.A)(this,"metadata",void 0),(0,a.A)(this,"streams",void 0),(0,a.A)(this,"options",void 0),(0,a.A)(this,"chapters",void 0),(0,a.A)(this,"privateData",void 0),(0,a.A)(this,"processPrivateData",void 0),(0,a.A)(this,"iformat",void 0),(0,a.A)(this,"oformat",void 0),(0,a.A)(this,"ioReader",void 0),(0,a.A)(this,"ioWriter",void 0),(0,a.A)(this,"errorFlag",void 0),(0,a.A)(this,"interval",void 0),(0,a.A)(this,"streamIndex",void 0),(0,a.A)(this,"getDecoderResource",null),this.streams=[],this.errorFlag=0,this.streamIndex=0,this.interval=new p,this.options={},this.privateData={},this.metadata={},this.chapters=[]}return(0,n.A)(e,[{key:"format",get:function(){return this.iformat?this.iformat.type:this.oformat?this.oformat.type:-1}},{key:"getStreamById",value:function(e){return this.streams.find((function(t){return t.id===e}))}},{key:"getStreamByIndex",value:function(e){return this.streams.find((function(t){return t.index===e}))}},{key:"getStreamByMediaType",value:function(e){return this.streams.find((function(t){var r;return(null===(r=t.codecpar)||void 0===r?void 0:r.codecType)===e}))}},{key:"createStream",value:function(){var e=new u.A;return e.index=this.streamIndex++,(0,h.s2)(l),e.id=s.f[15](d),o.M[15](d,e.id+1),(0,h.Tl)(l),this.removeStreamByIndex(e.index),this.streams.push(e),e}},{key:"addStream",value:function(e){this.removeStreamByIndex(e.index),this.streams.push(e)}},{key:"removeStream",value:function(e){this.removeStreamByIndex(e.index)}},{key:"removeStreamById",value:function(e){var t=this.streams.findIndex((function(t){return t.id===e}));if(t>-1){var r=this.streams.splice(t,1);r[0]&&r[0].destroy()}}},{key:"removeStreamByIndex",value:function(e){var t=this.streams.findIndex((function(t){return t.index===e}));if(t>-1){var r=this.streams.splice(t,1);r[0]&&r[0].destroy()}}},{key:"destroy",value:function(){this.oformat&&this.oformat.destroy(this),this.iformat&&this.iformat.destroy(this),this.interval.packetBuffer.length&&this.interval.packetBuffer.forEach((function(e){(0,c.Qe)(e)})),this.streams.forEach((function(e){e.destroy()})),this.streams=[],this.interval=null,this.ioReader=this.ioWriter=null,this.oformat=this.iformat=null}}]),e}();function m(){return new v}function g(){return new v}},15017:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(78716),i=r(81570),a=r(134),s=r(80662),o=r.n(s),u=r(74503),c=r(94300),f=r(77162),h=r(77231),d=r(9599),l=function(){function e(){(0,n.A)(this,e),(0,a.A)(this,"index",h.N_),(0,a.A)(this,"id",h.N_),(0,a.A)(this,"privData",null),(0,a.A)(this,"codecpar",(0,u.A)(f.A,new f.A)),(0,a.A)(this,"sideData",{}),(0,a.A)(this,"nbFrames",BigInt(0)),(0,a.A)(this,"metadata",{}),(0,a.A)(this,"duration",h.Dh),(0,a.A)(this,"startTime",h.Dh),(0,a.A)(this,"firstDTS",BigInt(0)),(0,a.A)(this,"disposition",0),(0,a.A)(this,"timeBase",(0,u.A)(d.P)),(0,a.A)(this,"sampleIndexes",[]),(0,a.A)(this,"sampleIndexesPosMap",new(o()))}return(0,i.A)(e,[{key:"destroy",value:function(){this.codecpar&&(this.codecpar.destroy(),(0,c.A)(this.codecpar),this.codecpar=null),this.timeBase&&((0,c.A)(this.timeBase),this.timeBase=null),this.sampleIndexes.length=0,this.sampleIndexesPosMap.clear()}}]),e}()},64436:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(78716),i=r(81570),a=r(134),s=r(63939),o=r(37837),u=r(71766),c=function(){function e(){(0,n.A)(this,e),(0,a.A)(this,"inCodecpar",void 0),(0,a.A)(this,"inTimeBase",void 0),(0,a.A)(this,"outCodecpar",void 0)}return(0,i.A)(e,[{key:"init",value:function(e,t){return this.inCodecpar=(0,o.Gy)(168),(0,u.Yi)(this.inCodecpar,e),this.inTimeBase={den:s.f[15](t+4),num:s.f[15](t)},0}},{key:"destroy",value:function(){this.inCodecpar&&((0,u.dn)(this.inCodecpar),this.inCodecpar=0)}}]),e}()},26173:(e,t,r)=>{"use strict";r.d(t,{A:()=>S});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134),l=r(63939),p=r(50932),v=r(64436),m=r(71517),g=r(20620),A=r(53e3),y=r(55611),x=r(14686),k=r(9705),b=r(60264),w=r(37837),_=r(4624);function T(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,I()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function I(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(I=function(){return!!e})()}var S=function(e){function t(){var e;(0,a.A)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=T(this,t,[].concat(n)),(0,d.A)((0,u.A)(e),"cache",void 0),(0,d.A)((0,u.A)(e),"cached",void 0),e}return(0,h.A)(t,e),(0,s.A)(t,[{key:"init",value:function(e,r){return(0,c.A)((0,f.A)(t.prototype),"init",this).call(this,e,r),this.cache=(0,m._5)(),this.cached=!1,0}},{key:"destroy",value:function(){(0,c.A)((0,f.A)(t.prototype),"destroy",this).call(this),(0,m.Qe)(this.cache),this.cache=0}},{key:"sendAVPacket",value:function(e){var t,r=(0,x.JW)(l.f[20](e+24),l.f[15](e+28));if(1!==l.f[15](e+80)&&(0,b.Bs)(r)){if((0,m.zu)(this.cache,e),27===l.f[15](this.inCodecpar+4)?t=g.oT(r):173===l.f[15](this.inCodecpar+4)?t=A.oT(r):196===l.f[15](this.inCodecpar+4)?t=y.oT(r):_.h2("not support for codecId: ".concat(l.f[15](this.inCodecpar+4)),"src/avformat/bsf/h2645/Annexb2AvccFilter.ts",91),p.M[15](this.cache+80,1),(0,m.NX)(this.cache,t.bufferPointer,t.length),t.key&&p.M[15](this.cache+36,1|l.f[15](this.cache+36)),t.extradata){var n=(0,w.sY)(t.extradata.length);(0,x.lW)(n,t.extradata.length,t.extradata),(0,m.Ow)(this.cache,1,n,t.extradata.length)}}else(0,m.rN)(this.cache,e);return this.cached=!0,0}},{key:"receiveAVPacket",value:function(e){return this.cached?((0,m.Up)(e),(0,m.rN)(e,this.cache),this.cached=!1,0):k.LR}}]),t}(v.A)},58469:(e,t,r)=>{"use strict";r.d(t,{En:()=>u,Ij:()=>f,XC:()=>c,hY:()=>o,uF:()=>a});var n=r(134),i=r(77231),a=(0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)({},1,"Main"),2,"LC"),3,"LC"),4,"LC"),5,"HE"),6,"HE"),s={96e3:0,88200:1,64e3:2,48e3:3,44100:4,32e3:5,24e3:6,22050:7,16e3:8,12e3:9,11025:10,8e3:11,7350:12},o=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,i.N_,i.N_,i.N_],u=[i.N_,1,2,3,4,5,6,7];function c(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t){var r=function(e){var t,r,n=i.N_,a=i.N_,s=i.N_;return e.length>=2&&(n=e[0]>>3&31,a=null!==(t=o[(7&e[0])<<1|e[1]>>7])&&void 0!==t?t:48e3,s=null!==(r=u[e[1]>>3&15])&&void 0!==r?r:2),{profile:n,sampleRate:a,channels:s}}(t),n=r.profile,a=r.sampleRate,s=r.channels;e.codecpar.profile=n,e.codecpar.sampleRate=a,e.codecpar.chLayout.nbChannels=s}}function f(e){var t=s[e.sampleRate],r=e.chLayout.nbChannels,n=new Uint8Array(2);return n[0]=(31&e.profile)<<3|(14&t)>>1,n[1]=(1&t)<<7|(15&r)<<3,n}},87771:(e,t,r)=>{"use strict";r.d(t,{R:()=>p,j:()=>a});var n=r(14686),i=r(37246),a=[3,4,3,7,259,263,1539,1543],s=[[64,69,96],[64,70,96],[80,87,120],[80,88,120],[96,104,144],[96,105,144],[112,121,168],[112,122,168],[128,139,192],[128,140,192],[160,174,240],[160,175,240],[192,208,288],[192,209,288],[224,243,336],[224,244,336],[256,278,384],[256,279,384],[320,348,480],[320,349,480],[384,417,576],[384,418,576],[448,487,672],[448,488,672],[512,557,768],[512,558,768],[640,696,960],[640,697,960],[768,835,1152],[768,836,1152],[896,975,1344],[896,976,1344],[1024,1114,1536],[1024,1115,1536],[1152,1253,1728],[1152,1254,1728],[1280,1393,1920],[1280,1394,1920]],o=[4,5,6,5],u=[4,6,7,6],c=[48e3,44100,32e3,0],f=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],h=[2,1,2,3,3,4,4,5],d=[1,2,3,6],l=7;function p(e,t){var r=new i.A(t);r.appendBuffer((0,n.s3)(e,t));var p={syncWord:0,crc1:0,srCode:0,bitstreamId:0,bitstreamMode:0,channelMode:0,lfeOn:0,frameType:0,substreamId:0,centerMixLevel:0,surroundMixLevel:0,channelMap:0,numBlocks:0,dolbySurroundMode:0,srShift:0,sampleRate:0,bitRate:0,channels:0,frameSize:0,channelLayout:BigInt(0),ac3BitrateCode:0};if(p.syncWord=r.readU(16),2935!==p.syncWord)return-1;if(p.bitstreamId=31&r.readU(29),p.bitstreamId>16)return-2;if(p.numBlocks=6,p.ac3BitrateCode=-1,p.centerMixLevel=5,p.surroundMixLevel=6,p.dolbySurroundMode=0,p.bitstreamId<=10){if(p.crc1=r.readU(16),p.srCode=r.readU(2),3===p.srCode)return-3;var v=r.readU(6);if(v>37)return-4;p.ac3BitrateCode=v>>1,r.readU(5),p.bitstreamMode=r.readU(3),p.channelMode=r.readU(3),2==p.channelMode?p.dolbySurroundMode=r.readU(2):(1&p.channelMode&&1!=p.channelMode&&(p.centerMixLevel=o[r.readU(2)]),4&p.channelMode&&(p.surroundMixLevel=u[r.readU(2)])),p.lfeOn=r.readU(1),p.srShift=Math.max(p.bitstreamId,8)-8,p.sampleRate=c[p.srCode]>>p.srShift,p.bitRate=1e3*f[p.ac3BitrateCode]>>p.srShift,p.channels=h[p.channelMode]+p.lfeOn,p.frameSize=2*s[v][p.srCode],p.frameType=2,p.substreamId=0}else{if(p.crc1=0,p.frameType=r.readU(2),3==p.frameType)return-5;if(p.substreamId=r.readU(3),p.frameSize=r.readU(11)+1<<1,p.frameSize<l)return-6;if(p.srCode=r.readU(2),3==p.srCode){var m=r.readU(2);if(3==m)return-7;p.sampleRate=c[m]/2,p.srShift=1}else p.numBlocks=d[r.readU(2)],p.sampleRate=c[p.srCode],p.srShift=0;p.channelMode=r.readU(3),p.lfeOn=r.readU(1),p.bitRate=8*p.frameSize*p.sampleRate/(256*p.numBlocks),p.channels=h[p.channelMode]+p.lfeOn}return p.channelLayout=BigInt.asUintN(64,a[p.channelMode]),p.lfeOn&&(p.channelLayout|=BigInt(8)),p}},90412:(e,t,r)=>{"use strict";r.d(t,{Ui:()=>o,XC:()=>s,zk:()=>a}),r(42096),r(75062),r(16091),r(68632);var n=r(134),i=r(37246),a=(0,n.A)((0,n.A)((0,n.A)({},0,"Main"),1,"High"),2,"Professional");function s(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=4){var r=o(t);e.codecpar.profile=r.profile,e.codecpar.level=r.level}}function o(e){var t=new i.A(e.length);t.appendBuffer(e),t.readU1(),t.readU(7);var r=t.readU(3),n=t.readU(5),a=t.readU1(),s=t.readU1()?10:8;return t.readU1()&&(s=12),{profile:r,level:n,tier:a,bitDepth:s,monochrome:t.readU1(),chromaSubsamplingX:t.readU1(),chromaSubsamplingY:t.readU1(),chromaSamplePosition:t.readU(2)}}},20620:(e,t,r)=>{"use strict";r.d(t,{Jk:()=>_,KD:()=>S,MB:()=>x,S1:()=>b,XC:()=>I,ci:()=>T,oT:()=>w,tZ:()=>y,wf:()=>P}),r(42096),r(75062),r(16091),r(68632);var n=r(134),i=r(63939),a=r(50932),s=r(72739),o=r(729),u=r(31865),c=r(37246),f=r(4624),h=r(14686),d=r(71517),l=r(60264),p=r(37837),v=r(23991),m=r(39381),g="src/avformat/codecs/h264.ts",A=3,y=(0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)({},66,"Constrained Baseline"),77,"Main"),100,"High"),110,"High10"),122,"High422"),244,"High444");function x(e){var t=new u.A(e);t.skip(5);for(var r=[],n=[],i=[],a=31&t.readUint8(),s=0;s<a;s++){var o=t.readUint16();r.push(t.readBuffer(o))}for(var c=t.readUint8(),f=0;f<c;f++){var h=t.readUint16();n.push(t.readBuffer(h))}if(t.remainingSize()>4){t.skip(3);var d=t.readUint8();if(d>0)for(var l=0;l<d;l++){var p=t.readUint16();i.push(t.readBuffer(p))}}return{spss:r,ppss:n,spsExts:i}}function k(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];e.length>32&&(f.R8("h264 metadata's sps max length is 32, but get ".concat(e.length),g,210),e=e.slice(0,32)),e.length>256&&(f.R8("h264 metadata's pps max length is 256, but get ".concat(e.length),g,214),e=e.slice(0,256));var n=7;n=e.reduce((function(e,t){return e+2+t.length}),n),n=t.reduce((function(e,t){return e+2+t.length}),n);var i=e[0],a=P(i);66!==a.profile&&77!==a.profile&&88!==a.profile&&(n+=4,r.length&&(n=r.reduce((function(e,t){return e+2+t.length}),n)));var u=new Uint8Array(n),c=new o.A(u);return c.writeUint8(1),c.writeUint8(i[1]),c.writeUint8(i[2]),c.writeUint8(i[3]),c.writeUint8(252|A),c.writeUint8(224|31&e.length),s.__(e,(function(e){c.writeUint16(e.length),c.writeBuffer(e)})),c.writeUint8(t.length),s.__(t,(function(e){c.writeUint16(e.length),c.writeBuffer(e)})),66!==a.profile&&77!==a.profile&&88!==a.profile&&(c.writeUint8(252|a.chromaFormatIdc),c.writeUint8(248|a.bitDepthLumaMinus8),c.writeUint8(248|a.bitDepthChromaMinus8),r.length&&s.__(r,(function(e){c.writeUint16(e.length),c.writeBuffer(e)}))),u}function b(e){var t=(0,l.py)(e);if(t.length>1){var r=[],n=[],i=[];if(t.forEach((function(e){var t=31&e[0];7===t?r.push(e):8===t?n.push(e):13===t&&i.push(e)})),r.length&&n.length)return k(r,n,i)}}function w(e){var t,r=(0,l.py)(e),n=!1;if(r.length>1){var i=[],a=[],u=[];r.forEach((function(e){var t=31&e[0];7===t?i.push(e):8===t?a.push(e):13===t&&u.push(e)})),i.length&&a.length&&(t=k(i,a,u)),r=r.filter((function(e){var t=31&e[0];return 9!==t&&8!==t&&7!==t&&13!==t}))}var c=r.reduce((function(e,t){return e+A+1+t.length}),0),f=(0,p.sY)(c),d=(0,h.s3)(f,c),v=new o.A(d);return s.__(r,(function(e){3===A?v.writeUint32(e.length):2===A?v.writeUint24(e.length):1===A?v.writeUint16(e.length):v.writeUint8(e.length),v.writeBuffer(e.subarray(0)),5==(31&e[0])&&(n=!0)})),{bufferPointer:f,length:c,key:n,extradata:t}}function _(e,t){var r;if(1&i.f[15](e+36)){var n=(0,d.iI)(e);if(!(0,l.Bs)(n)){for(var a=null!==(r=t.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:A,s=[],o=[],c=[],f=[],v=new u.A(n);v.remainingSize()>0;){var m;m=3===a?v.readUint32():2===a?v.readUint24():1===a?v.readUint16():v.readUint8();var g=n.subarray(0|Number(0xffffffffn&v.getPos()),(0|Number(0xffffffffn&v.getPos()))+m);v.skip(m);var y=31&g[0];7===y?s.push(g):8===y?o.push(g):13===y?c.push(g):f.push(g)}if(s.length||o.length){var x=k(s,o,c),b=(0,p.sY)(x.length);(0,h.lW)(b,x.length,x),(0,d.Ow)(e,1,b,x.length)}}}}function T(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(1&i.f[15](e+36)||t){var r=(0,d.iI)(e);if((0,l.Bs)(r)){var n=(0,l.py)(r);if(n.length>1){var s=[],o=[],u=[];if(n.forEach((function(e){var t=31&e[0];7===t?s.push(e):8===t?o.push(e):13===t&&u.push(e)})),s.length&&o.length){var c=k(s,o,u),f=(0,p.sY)(c.length);(0,h.lW)(f,c.length,c),(0,d.Ow)(e,1,f,c.length),a.M[15](e+36,1|i.f[15](e+36))}}}}}function I(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[4];var r=x(t).spss;if(r.length){var n=P(r[0]),i=n.profile,a=n.level,s=n.width,o=n.height;e.codecpar.profile=i,e.codecpar.level=a,e.codecpar.width=s,e.codecpar.height=o}}}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(!(1&i.f[15](e+36)))return!1;if(2===i.f[15](e+80))return(0,l.py)((0,h.s3)(i.f[20](e+24),i.f[15](e+28))).some((function(e){return 5==(31&e[0])}));for(var r=i.f[15](e+28),n=0;n<r-t;){if(5==(31&m.r8(i.f[20](e+24)+(n+t))))return!0;n+=4===t?m.Sg(i.f[20](e+24)+n):3===t?m.ht(i.f[20](e+24)+n):2===t?m.yd(i.f[20](e+24)+n):m.r8(i.f[20](e+24)+n),n+=t}return!1}function P(e){if(e&&!(e.length<3)){var t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);var r=(0,l.BN)(e.subarray(t)),n=new c.A(r.length);n.appendBuffer(r),n.readU1(),n.readU(2),n.readU(5);var i=n.readU(8);n.readU1(),n.readU1(),n.readU1(),n.readU1(),n.readU1(),n.readU1(),n.readU(2);var a=n.readU(8);v.xb(n);var s=1,o=0,u=0;if((100==i||110==i||122==i||244==i||44==i||83==i||86==i||118==i||128==i||138==i||139==i||134==i||135==i)&&(3===(s=v.xb(n))&&n.readU1(),o=v.xb(n),u=v.xb(n),n.readU1(),n.readU1()))for(var f=new Array(8),h=0;h<(3!=s?8:12);h++)f[h]=n.readU1();var d=v.xb(n),p=v.xb(n),m=0,g=0;if(0===p)m=v.xb(n);else if(1===p){g=n.readU1(),v.$x(n),v.$x(n);for(var A=v.xb(n),y=0;y<A;y++)v.$x(n)}v.xb(n),n.readU1();var x=v.xb(n),k=v.xb(n),b=n.readU1(),w=16*(x+1),_=(2-b)*(k+1)*16;b||n.readU1(),n.readU1();var T=n.readU1();if(T){var I=1,S=2-T;1===s?(I=2,S=2*(2-T)):2===T&&(I=2,S=2-T),w-=I*(v.xb(n)+v.xb(n)),_-=S*(v.xb(n)+v.xb(n))}return{profile:i,level:a,width:w,height:_,chromaFormatIdc:s,bitDepthLumaMinus8:o,bitDepthChromaMinus8:u,frameMbsOnlyFlag:b,picOrderCntType:p,log2MaxPicOrderCntLsbMinus4:m,deltaPicOrderAlwaysZeroFlag:g,log2MaxFrameNumMinus4:d}}}},53e3:(e,t,r)=>{"use strict";r.d(t,{HL:()=>A,Jk:()=>b,KD:()=>T,S1:()=>x,XC:()=>_,ZU:()=>S,ci:()=>w,dT:()=>m,oT:()=>k,wf:()=>I}),r(42096),r(75062),r(16091),r(68632);var n=r(134),i=r(63939),a=r(50932),s=r(72739),o=r(729),u=r(31865),c=r(37246),f=r(14686),h=r(60264),d=r(71517),l=r(37837),p=r(23991),v=r(39381),m=(0,n.A)((0,n.A)((0,n.A)((0,n.A)({},1,"Main"),2,"Main10"),3,"MainStillPicture"),4,"Main444"),g=3;function A(e){var t=new u.A(e,!0);t.skip(22);for(var r=[],n=[],i=[],a=t.readUint8(),s=0;s<a;s++){for(var o=63&t.readUint8(),c=t.readUint16(),f=[],h=0;h<c;h++){var d=t.readUint16();f.push(t.readBuffer(d))}32===o?r=f:33===o?n=f:34===o&&(i=f)}return{vpss:r,spss:n,ppss:i}}function y(e,t,r){var n=t[0],i=23;e.length&&(i+=3,i=e.reduce((function(e,t){return e+2+t.length}),i)),t.length&&(i+=3,i=t.reduce((function(e,t){return e+2+t.length}),i)),r.length&&(i+=3,i=r.reduce((function(e,t){return e+2+t.length}),i));var a=new Uint8Array(i),u=new o.A(a,!0),c=I(n);u.writeUint8(1),u.writeUint8(n[1]),u.writeUint8(n[2]),u.writeUint8(n[3]),u.writeUint8(n[4]),u.writeUint8(n[5]),u.writeUint8(n[6]),u.writeUint8(n[7]),u.writeUint8(n[8]),u.writeUint8(n[9]),u.writeUint8(n[10]),u.writeUint8(n[11]),u.writeUint8(c.level),u.writeUint8(1020),u.writeUint8(0),u.writeUint8(16320),u.writeUint8(16320|c.chroma_format_idc),u.writeUint8(8160|c.bit_depth_luma_minus8),u.writeUint8(8160|c.bit_depth_chroma_minus8),u.writeUint16(0),u.writeUint8(8|(1&n[0])<<2|g);var f=0;return e.length&&f++,t.length&&f++,r.length&&f++,u.writeUint8(f),e.length&&(u.writeUint8(160),u.writeUint16(e.length),s.__(e,(function(e){u.writeUint16(e.length),u.writeBuffer(e)}))),t.length&&(u.writeUint8(161),u.writeUint16(t.length),s.__(t,(function(e){u.writeUint16(e.length),u.writeBuffer(e)}))),r.length&&(u.writeUint8(162),u.writeUint16(r.length),s.__(r,(function(e){u.writeUint16(e.length),u.writeBuffer(e)}))),a}function x(e){var t=(0,h.py)(e);if(t.length>=2){var r=[],n=[],i=[];if(t.forEach((function(e){var t=e[0]>>>1&63;32===t?r.push(e):33===t?n.push(e):34===t&&i.push(e)})),n.length&&i.length)return y(r,n,i)}}function k(e){var t,r=!1,n=(0,h.py)(e);if(n.length>=2){var i=[],a=[],u=[];n.forEach((function(e){var t=e[0]>>>1&63;32===t?i.push(e):33===t?a.push(e):34===t&&u.push(e)})),a.length&&u.length&&(t=y(i,a,u),n=n.filter((function(e){var t=e[0]>>>1&63;return 32!==t&&33!==t&&34!==t&&35!==t})))}var c=n.reduce((function(e,t){return e+g+1+t.length}),0),d=(0,l.sY)(c),p=(0,f.s3)(d,c),v=new o.A(p);return s.__(n,(function(e){3===g?v.writeUint32(e.length):2===g?v.writeUint24(e.length):1===g?v.writeUint16(e.length):v.writeUint8(e.length),v.writeBuffer(e.subarray(0));var t=e[0]>>>1&63;19!==t&&20!==t&&21!==t||(r=!0)})),{bufferPointer:d,length:c,extradata:t,key:r}}function b(e,t){var r;if(1&i.f[15](e+36)){var n=(0,d.iI)(e);if(!(0,h.Bs)(n)){for(var a=null!==(r=t.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:g,s=[],o=[],c=[],p=new u.A(n);p.remainingSize()>0;){var v;v=3===a?p.readUint32():2===a?p.readUint24():1===a?p.readUint16():p.readUint8();var m=n.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+v);p.skip(v);var A=m[0]>>>1&63;33===A?o.push(m):34===A?c.push(m):32===A&&s.push(m)}if(o.length||c.length||s.length){var x=y(s,o,c),k=(0,l.sY)(x.length);(0,f.lW)(k,x.length,x),(0,d.Ow)(e,1,k,x.length)}}}}function w(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(1&i.f[15](e+36)||t){var r=(0,d.iI)(e);if((0,h.Bs)(r)){var n=(0,h.py)(r);if(n.length>2){var s=[],o=[],u=[];if(n.forEach((function(e){var t=e[0]>>>1&63;32===t?s.push(e):33===t?o.push(e):34===t&&u.push(e)})),s.length&&o.length&&u.length){var c=y(s,o,u),p=(0,l.sY)(c.length);(0,f.lW)(p,c.length,c),(0,d.Ow)(e,1,p,c.length),a.M[15](e+36,1|i.f[15](e+36))}}}}}function _(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=3&t[21];var r=A(t).spss;if(r.length){var n=I(r[0]),i=n.profile,a=n.level,s=n.width,o=n.height;e.codecpar.profile=i,e.codecpar.level=a,e.codecpar.width=s,e.codecpar.height=o}}}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(!(1&i.f[15](e+36)))return!1;if(2===i.f[15](e+80))return(0,h.py)((0,f.s3)(i.f[20](e+24),i.f[15](e+28))).some((function(e){var t=e[0]>>>1&63;return 20===t||19===t}));for(var r=i.f[15](e+28),n=0;n<r-t;){var a=v.r8(i.f[20](e+24)+(n+t))>>>1&63;if(20===a||19===a)return!0;n+=4===t?v.Sg(i.f[20](e+24)+n):3===t?v.ht(i.f[20](e+24)+n):2===t?v.yd(i.f[20](e+24)+n):v.r8(i.f[20](e+24)+n),n+=t}return!1}function I(e){if(e&&!(e.length<3)){var t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);var r=0,n=0,i=0,a=0,s=0,o=0,u=1,f=0,d=0,l=0,v=0,m=(0,h.BN)(e.subarray(t)),g=new c.A(m.length);g.appendBuffer(m),g.readU1(),g.readU(6),g.readU(6),g.readU(3),g.readU(4);var A=g.readU(3);g.readU1();var y=0;if(A<=6){f=g.readU(2),d=g.readU1(),r=g.readU(5),l=g.readU(32),v=g.readU(48),n=g.readU(8);for(var x=new Array(6),k=new Array(6),b=0;b<A;b++)x[b]=g.readU1(),k[b]=g.readU1();if(A>0)for(var w=A;w<8;w++)g.readU(2);for(var _=0;_<A;_++)x[_]&&(g.readU(2),g.readU(1),g.readU(5),g.readU(32),g.readU(1),g.readU(1),g.readU(1),g.readU(1),g.readU(44)),k[_]&&g.readU(8);p.xb(g),3===(u=p.xb(g))&&(y=g.readU(1)),i=p.xb(g),a=p.xb(g);var T=0,I=0,S=0,P=0;g.readU1()&&(T=p.xb(g),I=p.xb(g),S=p.xb(g),P=p.xb(g)),s=p.xb(g),o=p.xb(g);var B=2,C=2;0===u?B=C=0:2===u?(B=2,C=1):3===u&&(B=C=1),i-=B*(1<<s+1)*(T+I),a-=C*(1<<s+1)*(S+P)}for(var M=p.xb(g)+4,R=g.readU1()?0:A;R<A+1;R++)p.xb(g),p.xb(g),p.xb(g);var U=p.xb(g)+3,E=p.xb(g),D=p.xb(g)+2,L=p.xb(g),F=U+E,O=U-1,N=i+(1<<F)-1>>F,z=a+(1<<F)-1>>F;return{profile:r,level:n,width:i,height:a,chroma_format_idc:u,bit_depth_luma_minus8:s,bit_depth_chroma_minus8:o,general_profile_space:f,general_tier_flag:d,general_profile_compatibility_flags:l,constraint_flags:v,separate_colour_plane_flag:y,log2_min_cb_size:U,log2_diff_max_min_coding_block_size:E,log2_min_tb_size:D,log2_diff_max_min_transform_block_size:L,log2_max_trafo_size:L+D,log2_ctb_size:F,log2_min_pu_size:O,ctb_width:N,ctb_height:z,ctb_size:N*z,min_cb_width:i>>U,min_cb_height:a>>U,min_tb_width:i>>D,min_tb_height:a>>D,min_pu_width:i>>O,min_pu_height:a>>O,log2_max_poc_lsb:M}}}function S(e){if(e&&!(e.length<3)){var t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);var r=(0,h.BN)(e.subarray(t)),n=new c.A(r.length);return n.appendBuffer(r),{pps_pic_parameter_set_id:p.xb(n),pps_seq_parameter_set_id:p.xb(n),dependent_slice_segment_flag:n.readU1(),output_flag_present_flag:n.readU1(),num_extra_slice_header_bits:n.readU(3)}}}},89088:(e,t,r)=>{"use strict";r.d(t,{Au:()=>y,He:()=>x,XC:()=>k,Y2:()=>m,hG:()=>g,oz:()=>A});var n=r(134),i=r(77231),a=[44100,48e3,32e3,0],s=[22050,24e3,16e3,0],o=[11025,12e3,8e3,0],u=[0,1152,1152,384],c=[0,576,1152,384],f=[0,576,1152,384],h=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],d=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],l=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],p=[0,32,48,56,64,80,96,112,128,144,160,176,192,224,256,-1],v=[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1];function m(e,t){switch(e){case 0:return o[t];case 2:return s[t];case 3:return a[t]}return i.N_}function g(e,t){switch(e){case 0:return f[t];case 2:return c[t];case 3:return u[t]}return i.N_}function A(e,t,r){switch(t){case 1:switch(e){case 0:case 2:return v[r];case 3:return l[r]}break;case 2:switch(e){case 0:case 2:return v[r];case 3:return d[r]}case 3:switch(e){case 0:case 2:return p[r];case 3:return h[r]}}return i.N_}function y(e){switch(e){case 1:return 34;case 2:return 33;case 3:return 32}return i.N_}var x=(0,n.A)((0,n.A)((0,n.A)({},32,"Layer1"),33,"Layer2"),34,"Layer3");function k(e,t){if(t&&t.length>=4){var r=t[1]>>>3&3,n=(6&t[1])>>1,i=(12&t[2])>>>2,a=3&~(t[3]>>>6)?2:1,s=y(n),o=m(r,i);e.codecpar.profile=s,e.codecpar.sampleRate=o,e.codecpar.chLayout.nbChannels=a}}},14392:(e,t,r)=>{"use strict";r.d(t,{U:()=>a,X:()=>i});var n=r(37246);function i(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){var r=a(t);e.codecpar.profile=r.profile,e.codecpar.level=r.level}}function a(e){var t=new n.A(e.length);return t.appendBuffer(e.subarray(4)),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}},58919:(e,t,r)=>{"use strict";r.d(t,{Ui:()=>o,XC:()=>s,wN:()=>a}),r(42096),r(75062),r(16091),r(68632);var n=r(134),i=r(37246),a=(0,n.A)((0,n.A)((0,n.A)((0,n.A)({},0,"Profile0"),1,"Profile1"),2,"Profile2"),3,"Profile3");function s(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){var r=o(t);e.codecpar.profile=r.profile,e.codecpar.level=r.level}}function o(e){var t=new i.A(e.length);return t.appendBuffer(e),{profile:t.readU(8),level:t.readU(8),bitDepth:t.readU(4),chromaSubsampling:t.readU(3),fullRangeFlag:t.readU1(),colorPrimaries:t.readU(8),colorTrc:t.readU(8),colorSpace:t.readU(8)}}},55611:(e,t,r)=>{"use strict";r.d(t,{Jk:()=>y,QA:()=>k,Ui:()=>_,XC:()=>b,ci:()=>x,oT:()=>A,wf:()=>w});var n=r(63939),i=r(50932),a=r(72739),s=r(729),o=r(31865),u=r(37246),c=r(14686),f=r(60264),h=r(71517),d=r(37837),l=r(23991),p=r(83314),v=3;function m(e){var t=e.readU(9),r=e.readU(3),n=e.readU(2),i=e.readU(2),a=e.readU(3);e.readU(5),e.readU(2);var s=e.readU(6),o=e.readU(7),u=e.readU(1),c=e.readU(8),f=e.readU(1),h=e.readU(1),d=[],l=[];if(s){for(var p=0;p<s-1;p++)d[p]=e.readU(8);d[s-1]=e.readU(6)}else e.readU(6);if(r>1){for(var v=0,m=r-2;m>=0;--m)v|=e.readU(1)<<m;for(var g=r;g<=8&&r>1;++g)e.readU(1);for(var A=r-2;A>=0;--A)v&1<<A&&(l[A]=e.readU(8))}var y=e.readU(8),x=[];if(y)for(var k=0;k<y;k++)x.push(e.readU(8));return{olsIdx:t,numSublayers:r,bitDepthMinus8:a,chromaFormatIdc:i,constantFrameRate:n,generalProfileIdc:o,generalTierFlag:u,generalLevelIdc:c,ptlFrameOnlyConstraintFlag:f,ptlMultilayerEnabledFlag:h,generalConstraintInfo:d,sublayerLevelIdc:l,generalSubProfileIdc:x,maxPictureWidth:e.readU(16),maxPictureHeight:e.readU(16),avgFramerate:e.readU(16)}}function g(e,t,r){var n,i=t[0];if(i){var o=w(i),u=o.generalConstraintInfo;u.length||(u=new Array(12).fill(0));var c=new p.A;if(c.writeU(9,0),c.writeU(3,o.spsMaxSublayersMinus1+1),c.writeU(2,1),c.writeU(2,o.chromaFormatIdc),c.writeU(3,o.bitDepthMinus8),c.writeU(5,31),c.writeU(2,0),c.writeU(6,u.length),c.writeU(7,o.profile),c.writeU1(o.tierFlag),c.writeU(8,o.level),c.writeU1(o.ptlFrameOnlyConstraintFlag),c.writeU1(o.ptlMultilayerEnabledFlag),u.length){for(var f=0;f<u.length-1;f++)c.writeU(8,u[f]);c.writeU(6,u[u.length-1])}else c.writeU(6,63);if(o.spsMaxSublayersMinus1+1>1){for(var h=0,d=o.spsMaxSublayersMinus1-1;d>=0;d--)h=h<<1|o.ptlSublayerLevelPresentFlag[d];c.writeU(o.spsMaxSublayersMinus1,h);for(var l=o.spsMaxSublayersMinus1+1;l<=8&&o.spsMaxSublayersMinus1>0;++l)c.writeU1(0);for(var m=o.spsMaxSublayersMinus1-1;m>=0;m--)o.ptlSublayerLevelPresentFlag[m]&&c.writeU(8,o.sublayerLevelIdc[m])}c.writeU(8,o.generalSubProfileIdc.length);for(var g=0;g<o.generalSubProfileIdc.length;g++)c.writeU(8,o.sublayerLevelIdc[g]);c.writeU(16,o.width),c.writeU(16,o.height),c.writeU(16,0),c.padding(),n=c.getBuffer().subarray(0,c.getPointer())}var A=2+(n?n.length:0);e.length&&(A+=3,A=e.reduce((function(e,t){return e+2+t.length}),A)),t.length&&(A+=3,A=t.reduce((function(e,t){return e+2+t.length}),A)),r.length&&(A+=3,A=r.reduce((function(e,t){return e+2+t.length}),A));var y=new Uint8Array(A),x=new s.A(y,!0);x.writeUint8(v<<1|(n?1:0)|248),n&&x.writeBuffer(n);var k=0;return e.length&&k++,t.length&&k++,r.length&&k++,x.writeUint8(k),e.length&&(x.writeUint8(142),x.writeUint16(e.length),a.__(e,(function(e){x.writeUint16(e.length),x.writeBuffer(e)}))),t.length&&(x.writeUint8(143),x.writeUint16(t.length),a.__(t,(function(e){x.writeUint16(e.length),x.writeBuffer(e)}))),r.length&&(x.writeUint8(144),x.writeUint16(r.length),a.__(r,(function(e){x.writeUint16(e.length),x.writeBuffer(e)}))),y}function A(e){var t,r=!1,n=(0,f.py)(e);if(n.length>=2){var i=[],o=[],u=[];n.forEach((function(e){var t=e[1]>>>3&31;14===t?i.push(e):15===t?o.push(e):16===t&&u.push(e)})),o.length&&u.length&&(t=g(i,o,u),n=n.filter((function(e){var t=e[1]>>>3&31;return 14!==t&&15!==t&&16!==t&&20!==t})))}var h=n.reduce((function(e,t){return e+v+1+t.length}),0),l=(0,d.sY)(h),p=(0,c.s3)(l,h),m=new s.A(p);return a.__(n,(function(e){3===v?m.writeUint32(e.length):2===v?m.writeUint24(e.length):1===v?m.writeUint16(e.length):m.writeUint8(e.length),m.writeBuffer(e.subarray(0));var t=e[1]>>>3&31;8!==t&&7!==t&&9!==t&&10!==t||(r=!0)})),{bufferPointer:l,length:h,extradata:t,key:r}}function y(e,t){var r;if(1&n.f[15](e+36)){var i=(0,h.iI)(e);if(!(0,f.Bs)(i)){for(var a=null!==(r=t.metadata.naluLengthSizeMinusOne)&&void 0!==r?r:v,s=[],u=[],l=[],p=new o.A(i);p.remainingSize()>0;){var m;m=3===a?p.readUint32():2===a?p.readUint24():1===a?p.readUint16():p.readUint8();var A=i.subarray(0|Number(0xffffffffn&p.getPos()),(0|Number(0xffffffffn&p.getPos()))+m);p.skip(m);var y=A[1]>>>3&31;15===y?u.push(A):16===y?l.push(A):14===y&&s.push(A)}if(u.length||l.length||s.length){var x=g(s,u,l),k=(0,d.sY)(x.length);(0,c.lW)(k,x.length,x),(0,h.Ow)(e,1,k,x.length)}}}}function x(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(1&n.f[15](e+36)||t){var r=(0,h.iI)(e);if((0,f.Bs)(r)){var a=(0,f.py)(r);if(a.length>2){var s=[],o=[],u=[];if(a.forEach((function(e){var t=e[1]>>>3&31;14===t?s.push(e):15===t?o.push(e):16===t&&u.push(e)})),s.length&&o.length&&u.length){var l=g(s,o,u),p=(0,d.sY)(l.length);(0,c.lW)(p,l.length,l),(0,h.Ow)(e,1,p,l.length),i.M[15](e+36,1|n.f[15](e+36))}}}}}function k(e,t){var r=w(t),n=r.profile,i=r.level,a=r.width,s=r.height;e.codecpar.profile=n,e.codecpar.level=i,e.codecpar.width=a,e.codecpar.height=s}function b(e,t){if(!t&&e.sideData[1]&&(t=e.sideData[1]),t&&t.length>=6){e.metadata.naluLengthSizeMinusOne=t[0]>>>1&3;var r=function(e){var t=new o.A(e,!0);if(1&t.readUint8()){var r=new u.A;r.appendBuffer(e.subarray(1)),m(r),t.skip(r.getPos())}for(var n=[],i=[],a=[],s=t.readUint8(),c=0;c<s;c++){var f=31&t.readUint8(),h=1;13!==f&&12!==f&&(h=t.readUint16());for(var d=[],l=0;l<h;l++){var p=t.readUint16();d.push(t.readBuffer(p))}14===f?n=d:15===f?i=d:16===f&&(a=d)}return{vpss:n,spss:i,ppss:a}}(t).spss;r.length&&k(e,r[0])}}function w(e){if(e&&!(e.length<3)){var t=0;0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(t=4);var r,n,i,a,s=0,o=0,c=0,h=0,d=0,p=[],v=[],m=[],g=[],A=(0,f.BN)(e.subarray(t)),y=new u.A(A.length);y.appendBuffer(A),y.readU1(),y.readU1(),y.readU(6),y.readU(5),y.readU(3),y.readU(8);var x=y.readU(3);a=y.readU(2);var k=y.readU(2);if(y.readU(1)){if(s=y.readU(7),c=y.readU(1),o=y.readU(8),h=y.readU(1),d=y.readU(1),y.readU(1)){for(var b=0;b<8;b++)p[b]=y.readU(8);p[8]=y.readU(7);var w=y.readU(8);y.readU(w)}y.skipPadding();for(var _=x-1;_>=0;_--)v[_]=y.readU(1);y.skipPadding();for(var T=x-1;T>=0;T--)v[T]&&(m[T]=y.readU(8));var I=y.readU(8);if(I)for(var S=0;S<I;S++)g[S]=y.readU(32)}y.readU1(),y.readU1()&&y.readU1();var P=r=l.xb(y),B=n=l.xb(y);if(y.readU1()&&(l.xb(y),l.xb(y),l.xb(y),l.xb(y)),y.readU1()){var C,M=l.xb(y),R=k+5,U=1<<R,E=P/(1<<R),D=B/(1<<R),L=Math.ceil(Math.log2(E)),F=Math.ceil(Math.log2(D)),O=0,N=0;M>0&&(N=y.readU1(),O=y.readU1());for(var z=0;M>0&&z<=M;z++)O&&0!=z||(z>0&&P>U&&y.readU(L),z>0&&B>U&&y.readU(F),z<M&&P>U&&y.readU(L),z<M&&B>U&&y.readU(F)),N||y.readU(2);if(C=l.xb(y)+1,y.readU(1)&&y.readU(1))for(var V=0;V<=M;V++)y.readU(C)}i=l.xb(y),y.readU(1),y.readU(1);var W=y.readU(4),j=y.readU(1),G=0;j&&(G=l.xb(y));for(var q=[],H=y.readU(2),Y=0;Y<8*H;Y++)q[Y]=y.readU(1);return{profile:s,level:o,width:r,height:n,chromaFormatIdc:a,bitDepthMinus8:i,generalProfileSpace:0,tierFlag:c,generalConstraintInfo:p,generalSubProfileIdc:g,ptlFrameOnlyConstraintFlag:h,ptlMultilayerEnabledFlag:d,spsMaxSublayersMinus1:x,ptlSublayerLevelPresentFlag:v,sublayerLevelIdc:m,sps_log2_max_pic_order_cnt_lsb_minus4:W,sps_poc_msb_cycle_flag:j,sps_poc_msb_cycle_len_minus1:G,sps_num_extra_ph_bytes:H,sps_extra_ph_bit_present_flag:q}}}function _(e){0===e[0]&&0===e[1]&&0===e[2]&&1===e[3]&&(e=function(e){var t=(0,f.py)(e);if(t.length>=2){var r=[],n=[],i=[];if(t.forEach((function(e){var t=e[1]>>>3&31;14===t?r.push(e):15===t?n.push(e):16===t&&i.push(e)})),n.length&&i.length)return g(r,n,i)}}(e));var t=new u.A;return t.appendBuffer(e),1&t.readU(8)?m(t):{}}},16160:(e,t,r)=>{"use strict";r.d(t,{V:()=>i,v:()=>n});var n=256e3,i=BigInt(5e3)},75:(e,t,r)=>{"use strict";r.d(t,{Cj:()=>U,Ib:()=>P,ho:()=>_,jF:()=>D});var n=r(25182),i=r(36443),a=r.n(i),s=r(61499),o=r(63939),u=r(9599),c=r(29170),f=r(95335),h=r(72739),d=r(77231),l=r(31425),p=r(44328),v=r(71517),m=r(16160),g=r(9705),A=r(4624),y=r(40417),x=r(75742),k=r(56024),b="src/avformat/demux.ts",w={fastOpen:!1,maxAnalyzeDuration:1e3};function _(e){return T.apply(this,arguments)}function T(){return T=(0,n.A)(a().mark((function e(t){var r,n,i=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},n=f.extend({},w,r),t.ioReader||A.h2("need IOReader",b,65),t.iformat||A.h2("need iformat",b,68),2===t.iformat.type&&(n.maxAnalyzeDuration=Math.max(n.maxAnalyzeDuration,2e3)),t.iformat.init(t),t.options=n,e.abrupt("return",t.iformat.readHeader(t));case 8:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function I(e){return S.apply(this,arguments)}function S(){return(S=(0,n.A)(a().mark((function e(t){var r,n,i,s,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.ioReader.fileSize();case 2:if(!((r=e.sent)<=BigInt(0))){e.next=5;break}return e.abrupt("return");case 5:n=t.interval.packetBuffer,t.interval.packetBuffer=[],i=t.ioReader.getPos(),s=0,u=a().mark((function e(){var n,u,c,f,l,p,g;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r-BigInt(Math.floor(m.v<<s)),e.next=3,t.iformat.seek(t,null,n,2);case 3:(u=e.sent)>BigInt(0)&&(i=u),c={},f=(0,v._5)();case 7:return e.next=10,U(t,f);case 10:if(!(e.sent<0)){e.next=15;break}return e.abrupt("break",21);case 15:l=o.f[17](f+8),(p=t.getStreamByIndex(o.f[15](f+32))).startTime!==d.Dh?l-=p.startTime:l-=p.firstDTS,l>BigInt(0)&&((p.duration===d.Dh||!c[o.f[15](f+32)]||p.duration<l&&Math.abs(Number(l-p.duration))<60*p.timeBase.den/p.timeBase.num)&&(p.duration=l),c[f.streamIndex]=l);case 19:e.next=7;break;case 21:if((0,v.Qe)(f),g=!0,h.__(t.streams,(function(e){if(e.duration===d.Dh)return g=!1,!1})),!g){e.next=26;break}return e.abrupt("return",1);case 26:s++;case 27:case"end":return e.stop()}}),e)}));case 10:if(!(s<4)){e.next=16;break}return e.delegateYield(u(),"t0",12);case 12:if(!e.t0){e.next=14;break}return e.abrupt("break",16);case 14:e.next=10;break;case 16:return h.__(t.interval.packetBuffer,(function(e){(0,v.Qe)(e)})),t.interval.packetBuffer=n,e.next=20,t.iformat.seek(t,null,i,2);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return B.apply(this,arguments)}function B(){return(B=(0,n.A)(a().mark((function e(t){var r,n,i,h,m,g,A,b,w,_,T;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_=function(){if(!t.getDecoderResource)return!0;for(var e=0;e<t.streams.length;e++)if(b[t.streams[e].index]&&!w[t.streams[e].index])return!1;return!0},r=t.iformat.getAnalyzeStreamsCount(),n={},i={},h={},m=0,g=[],A=0,b={},w={},T=a().mark((function e(){var T,I,S,P,B,C,M,R,E;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.streams.length>=r&&(0,l.$)(t)&&t.options.fastOpen&&_())){e.next=2;break}return e.abrupt("return",0);case 2:return m||(m=(0,v._5)()),T=!1,e.next=6,U(t,m);case 6:if(0===(A=e.sent)){e.next=9;break}return e.abrupt("return",0);case 9:if(I=t.getStreamByIndex(o.f[15](m+32)),!o.f[15](m+28)){e.next=29;break}if(T=!0,g.push(m),n[I.index]||(I.firstDTS=o.f[17](m+16),I.startTime=o.f[17](m+8),n[I.index]=!0),o.f[17](m+8)<I.startTime&&(I.startTime=o.f[17](m+8)),i[I.index]?i[I.index].push(o.f[17](m+16)):i[I.index]=[o.f[17](m+16)],h[I.index]?h[I.index]+=o.f[15](m+28):h[I.index]=o.f[15](m+28),w[I.index]||!t.getDecoderResource){e.next=29;break}if(S=b[I.index]){e.next=28;break}return e.next=22,t.getDecoderResource(I.codecpar.codecType,I.codecpar.codecId);case 22:if(!(P=e.sent)){e.next=28;break}return 1===I.codecpar.codecType?S=new x.A({resource:P,onReceiveFrame:function(e){I.codecpar.format=o.f[15](e+80),I.codecpar.frameSize=o.f[15](e+76),(0,k.xj)(e),w[I.index]=!0},onError:function(){w[I.index]=!0}}):0===I.codecpar.codecType&&(P.threadModule&&delete P.threadModule,S=new y.A({resource:P,onReceiveFrame:function(e){I.codecpar.format=o.f[15](e+80),I.codecpar.colorSpace=o.f[15](e+220),I.codecpar.colorPrimaries=o.f[15](e+212),I.codecpar.colorTrc=o.f[15](e+216),I.codecpar.chromaLocation=o.f[15](e+224),I.codecpar.sampleAspectRatio=(0,c.A)(e+92,u.P),(0,k.xj)(e),w[I.index]=!0},onError:function(){w[I.index]=!0}})),e.next=27,S.open(I.codecpar[s.o9]);case 27:b[I.index]=S;case 28:S&&S.decode(m);case 29:if(i[I.index]&&12===i[I.index].length){for(B=BigInt(0),C=1;C<i[I.index].length;C++)B+=i[I.index][C]-i[I.index][C-1];M=Number(B)/(i[I.index].length-1),1===I.codecpar.codecType&&I.codecpar.sampleRate>0?I.codecpar.frameSize=Math.round(M/I.timeBase.den*I.timeBase.num*I.codecpar.sampleRate):0===I.codecpar.codecType&&(R=I.timeBase.den*I.timeBase.num/M,I.codecpar.framerate.num=Math.round(R),I.codecpar.framerate.den=1),(E=Number(o.f[17](m+16)-I.firstDTS)*I.timeBase.num/I.timeBase.den)&&(I.codecpar.bitRate=BigInt(Math.floor(8*h[I.index]/E)))}if(!(o.f[17](m+16)-I.startTime>(0,p.k)(BigInt(Math.floor(t.options.maxAnalyzeDuration)),d.i0,I.timeBase))){e.next=34;break}return f.each(i,(function(e,r){var n=t.getStreamByIndex(+r);if(e&&e.length>1){for(var a=BigInt(0),s=1;s<e.length;s++)a+=e[s]-e[s-1];var u=Number(a)/(i[n.index].length-1);if(1===n.codecpar.codecType&&n.codecpar.sampleRate>0)n.codecpar.frameSize=Math.round(u/n.timeBase.den*n.timeBase.num*n.codecpar.sampleRate);else if(0===n.codecpar.codecType){var c=n.timeBase.den*n.timeBase.num/u;n.codecpar.framerate.num=Math.round(c),n.codecpar.framerate.den=1}var f=Number(o.f[17](m+16)-n.firstDTS)*n.timeBase.num/n.timeBase.den;f&&(n.codecpar.bitRate=BigInt(Math.floor(8*h[n.index]/f)))}})),T&&(m=0),e.abrupt("return",0);case 34:T&&(m=0);case 35:case"end":return e.stop()}}),e)}));case 11:return e.delegateYield(T(),"t0",13);case 13:if(0!==e.t0){e.next=16;break}return e.abrupt("break",18);case 16:e.next=11;break;case 18:if(m&&(0,v.Qe)(m),g.length&&(t.interval.packetBuffer=g.concat(t.interval.packetBuffer)),f.each(b,(function(e){e&&e.close()})),-1048576!==A){e.next=25;break}return e.abrupt("return",0);case 25:if(0===A){e.next=27;break}return e.abrupt("return",A);case 27:if(!(2===t.iformat.type&&1&t.ioReader.flags)){e.next=30;break}return e.next=30,I(t);case 30:return e.abrupt("return",0);case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){var r=h.El(e.sampleIndexes,(function(e){return e.pts<o.f[17](t+8)?1:-1})),n={dts:o.f[17](t+16),pts:o.f[17](t+8),pos:o.f[17](t+56),size:o.f[15](t+28),duration:o.f[17](t+48),flags:o.f[15](t+36)};r>-1?(e.sampleIndexesPosMap.set(o.f[17](t+56),r),e.sampleIndexes.splice(r,0,n)):(e.sampleIndexesPosMap.set(o.f[17](t+56),e.sampleIndexes.length),e.sampleIndexes.push(n))}function M(e,t){return R.apply(this,arguments)}function R(){return(R=(0,n.A)(a().mark((function e(t,r){var n,i,s,f,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.getStreamByIndex(o.f[15](r+32)),i=0,!n||27!==n.codecpar.codecId&&173!==n.codecpar.codecId&&196!==n.codecpar.codecId&&86018!==n.codecpar.codecId){e.next=37;break}if(o.f[15](r+28)||!(0,v.fQ)(r,1)){e.next=35;break}case 4:return s=(0,v._5)(),e.next=8,t.iformat.readAVPacket(t,s);case 8:if(0===(i=e.sent)){e.next=17;break}if(!t.interval.packetBuffer.length){e.next=16;break}return f=t.interval.packetBuffer.shift(),(0,v.Up)(r),(0,v.rN)(r,f),(0,v.Qe)(f),e.abrupt("return",M(t,r));case 16:return e.abrupt("return",i);case 17:if(o.f[15](s+32)!==o.f[15](r+32)){e.next=30;break}if(!o.f[15](s+28)){e.next=24;break}return(0,v.Zx)(r,s),(0,v.Qe)(s),e.abrupt("return",0);case 24:return(0,v.Up)(r),(0,v.rN)(r,s),(0,v.Qe)(s),e.abrupt("continue",4);case 28:e.next=31;break;case 30:t.interval.packetBuffer.push(s);case 31:e.next=4;break;case 33:e.next=37;break;case 35:if(!(32&o.f[15](r+36))){e.next=37;break}return e.abrupt("return",U(t,r));case 37:return 1&t.ioReader.flags&&(n.sampleIndexesPosMap.has(o.f[17](r+56))||(0===n.codecpar.codecType?1&o.f[15](r+36)&&C(n,r):1===n.codecpar.codecType&&(l=h.El(n.sampleIndexes,(function(e){return e.pts<o.f[17](r+8)?1:-1})),(!n.sampleIndexes.length||l<0&&(0,p.k)(o.f[17](r+8)-n.sampleIndexes[n.sampleIndexes.length-1].pts,(0,c.A)(r+72,u.P),d.i0)>=m.V||l>0&&l<n.sampleIndexes.length-1&&(0,p.k)(o.f[17](r+8)-n.sampleIndexes[l-1].pts,(0,c.A)(r+72,u.P),d.i0)>=m.V||0===l&&(0,p.k)(n.sampleIndexes[0].pts-o.f[17](r+8),(0,c.A)(r+72,u.P),d.i0)>=m.V)&&C(n,r)))),e.abrupt("return",0);case 39:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t){return E.apply(this,arguments)}function E(){return(E=(0,n.A)(a().mark((function e(t,r){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=0,(0,v.Up)(r),!t.interval.packetBuffer.length){e.next=7;break}return i=t.interval.packetBuffer.shift(),(0,v.rN)(r,i),(0,v.Qe)(i),e.abrupt("return",M(t,r));case 7:return e.next=9,t.iformat.readAVPacket(t,r);case 9:if(0===(n=e.sent)){e.next=13;break}return(0,v.Up)(r),e.abrupt("return",n);case 13:return e.abrupt("return",M(t,r));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,r,n){return L.apply(this,arguments)}function L(){return(L=(0,n.A)(a().mark((function e(t,r,n,i){var s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((s=r>-1?t.streams.find((function(e){return e.index===r})):null)||((s=t.getStreamByMediaType(0))||(s=t.getStreamByMediaType(1)),s||(s=t.getStreamByMediaType(3))),s){e.next=5;break}return A.z3("not found any stream to seek, streamIndex: ".concat(s.index),b,543),e.abrupt("return",BigInt(g.LR));case 5:return A.Yz("seek in ".concat(0===s.codecpar.codecType?"video":"audio"," stream, streamIndex: ").concat(s.index,", timestamp: ").concat(n,", flags: ").concat(i),b,547),n=(0,p.k)(n,d.i0,s.timeBase),e.next=9,t.iformat.seek(t,s,n,i);case 9:if(!((o=e.sent)>=BigInt(0))){e.next=14;break}return h.__(t.interval.packetBuffer,(function(e){(0,v.Qe)(e)})),t.interval.packetBuffer.length=0,e.abrupt("return",BigInt(0));case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},548:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>B,L_:()=>S,eG:()=>I,yl:()=>T});var n=r(69736),i=r.n(n),a=r(61499),s=r(63939),o=r(9599),u=r(29170),c=r(44315),f=r(95335),h=r(62751),d=r(67672),l=r(44328),p=r(77231),v=r(20525),m=r(62100),g=r(58469),A=r(20620),y=r(53e3),x=r(90412),k=r(58919),b=r(89088);function w(e){e<0&&(e=BigInt(0));var t=0|Number(e%BigInt(1e3)&0xffffffffn),r=0|Number(e/BigInt(1e3)%BigInt(60)&0xffffffffn),n=0|Number(e/BigInt(1e3)/BigInt(60)%BigInt(60)&0xffffffffn),i=0|Number(e/BigInt(1e3)/BigInt(3600)&0xffffffffn);return v.GP("%02d:%02d:%02d.%03d",i,n,r,t)}function _(e){return e<BigInt(1e4)?(0,m.A)(0|Number(0xffffffffn&e))+" bps/s":(0|Number(e/BigInt(1e3)&0xffffffffn))+" kbps/s"}function T(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unknown";return f.each(e,(function(e,n){if(t===e)return r=n,!1})),r}function I(e,t){return 1===e?T(h.n1,t):0===e?T(h._R,t):3===e?T(h.Xp,t):"unknown"}function S(e){return T(h.iW,e)}function P(e,t){switch(e){case 86018:return g.uF[t]||"LC";case 86017:return b.He[t]||"Layer3";case 27:return A.tZ[t]||"High";case 173:return y.dT[t]||"Main";case 225:return x.zk[t]||"Main";case 167:return k.wN[t]||"Profile0"}}function B(e,t){var r="";return e.forEach((function(e,n){if(e instanceof c.oD){for(var v=[],g=0;g<e.streams.length;g++){var A=e.streams[g];v.push({index:A.index,id:A.id,codecpar:A.codecpar[a.o9],nbFrames:A.nbFrames,metadata:A.metadata,duration:A.duration,startTime:A.startTime,disposition:A.disposition,timeBase:A.timeBase[a.o9]})}e={metadata:e.metadata,format:e.format,chapters:e.chapters,streams:v}}r+=function(e,t,r){var n="".concat(r.tag," #").concat(t,", ").concat(T(h.iW,e.format),", from '").concat(r.from,"':\n");i()(e.metadata).length&&(n+="  Metadata:\n",f.each(e.metadata,(function(e,t){d.Ik(e)&&d.YO(e)||(n+="    ".concat(t,": ").concat(e,"\n"))})));var a=BigInt(0),c=BigInt(0),v=-BigInt(1);return e.streams.forEach((function(e){var t=(0,l.k)(e.duration,(0,u.A)(e.timeBase,o.P),p.i0),r=(0,l.k)(e.startTime,(0,u.A)(e.timeBase,o.P),p.i0);t>a&&(a=t),(r<v||v===-BigInt(1))&&(v=r),c+=s.f[17](e.codecpar+32)})),n+="  Duration: ".concat(w(a),", start: ").concat(w(v),", bitrate: ").concat(_(c),"\n"),e.streams.forEach((function(e,r){n+=function(e,t,r){var n,a=T(h.Mb,s.f[15](e.codecpar)),c=[];if(1===s.f[15](e.codecpar)){var v=P(s.f[15](e.codecpar+4),s.f[15](e.codecpar+48)),g=T(h.n1,s.f[15](e.codecpar+4));c.push("".concat(g).concat(v?" (".concat(v,")"):"")),c.push("".concat(s.f[15](e.codecpar+136)," Hz"));var A="".concat(s.f[15](e.codecpar+116)," channels");1===s.f[15](e.codecpar+116)?A="mono":2===s.f[15](e.codecpar+116)&&(A="stereo"),c.push(A),c.push(T(h.Sz,s.f[15](e.codecpar+28))),s.f[17](e.codecpar+32)>BigInt(0)&&c.push("".concat(_(s.f[17](e.codecpar+32))))}else if(0===s.f[15](e.codecpar)){var y=P(s.f[15](e.codecpar+4),s.f[15](e.codecpar+48)),x=T(h._R,s.f[15](e.codecpar+4));if(c.push("".concat(x).concat(y?" (".concat(y,")"):"")),s.f[15](e.codecpar+28)!==p.N_){var k=T(h.qO,s.f[15](e.codecpar+28)),b=T(h.mX,s.f[15](e.codecpar+84),"tv"),w=T(h._m,s.f[15](e.codecpar+96),"bt709");c.push("".concat(k,"(").concat(b,", ").concat(w,")"))}var I={num:s.f[15](e.codecpar+56)*s.f[15](e.codecpar+64),den:s.f[15](e.codecpar+60)*s.f[15](e.codecpar+68)};(0,l.iU)(I),c.push("".concat(s.f[15](e.codecpar+56),"x").concat(s.f[15](e.codecpar+60)," [SAR: ").concat(s.f[15](e.codecpar+64),":").concat(s.f[15](e.codecpar+68)," DAR ").concat(I.num,":").concat(I.den,"]")),s.f[17](e.codecpar+32)>BigInt(0)&&c.push("".concat(_(s.f[17](e.codecpar+32)))),(0,l.lb)((0,u.A)(e.codecpar+72,o.P))>0&&(c.push("".concat((0,l.lb)((0,u.A)(e.codecpar+72,o.P)).toFixed(2)," fps")),c.push("".concat((0,l.lb)((0,u.A)(e.codecpar+72,o.P)).toFixed(2)," tbr"))),c.push("".concat((n=BigInt(Math.floor((0,l.lb)({num:s.f[15](e.timeBase+4),den:s.f[15](e.timeBase)}))))<BigInt(1e4)?(0,m.A)(0|Number(0xffffffffn&n)):(0|Number(n/BigInt(1e3)&0xffffffffn))+"k"," tbn"))}else if(3===s.f[15](e.codecpar)){var S=T(h.Xp,s.f[15](e.codecpar+4));c.push(S),s.f[17](e.codecpar+32)>BigInt(0)&&c.push("".concat(_(s.f[17](e.codecpar+32))))}else s.f[17](e.codecpar+32)>BigInt(0)&&c.push("".concat(_(s.f[17](e.codecpar+32))));var B="";e.disposition&&(B=" ",1&e.disposition&&(B+="(".concat(T(h.Ki,1),") ")),2&e.disposition&&(B+="(".concat(T(h.Ki,2),") ")),4&e.disposition&&(B+="(".concat(T(h.Ki,4),") ")),8&e.disposition&&(B+="(".concat(T(h.Ki,8),") ")),16&e.disposition&&(B+="(".concat(T(h.Ki,16),") ")),32&e.disposition&&(B+="(".concat(T(h.Ki,32),") ")),64&e.disposition&&(B+="(".concat(T(h.Ki,64),") ")),128&e.disposition&&(B+="(".concat(T(h.Ki,128),") ")),256&e.disposition&&(B+="(".concat(T(h.Ki,256),") ")),512&e.disposition&&(B+="(".concat(T(h.Ki,512),") ")),1024&e.disposition&&(B+="(".concat(T(h.Ki,1024),") ")),2048&e.disposition&&(B+="(".concat(T(h.Ki,2048),") ")),65536&e.disposition&&(B+="(".concat(T(h.Ki,65536),") ")),131072&e.disposition&&(B+="(".concat(T(h.Ki,131072),") ")),262144&e.disposition&&(B+="(".concat(T(h.Ki,262144),") ")),524288&e.disposition&&(B+="(".concat(T(h.Ki,524288),") ")),1048576&e.disposition&&(B+="(".concat(T(h.Ki,1048576),") ")));var C="".concat(r,"Stream #").concat(t,":").concat(e.index," ").concat(a,": ").concat(c.join(", ")).concat(B,"\n");return i()(e.metadata).length&&(C+="".concat(r,"  Metadata:\n"),f.each(e.metadata,(function(e,t){d.Ik(e)||d.YO(e)||(C+="".concat(r,"    ").concat(t,": ").concat(e,"\n"))}))),C}(e,t,"  ")})),n}(e,n,t[n])})),r}},51597:(e,t,r)=>{"use strict";r.d(t,{A:()=>o,E:()=>u});var n,i=r(78716),a=r(81570),s=r(134),o=function(){function e(){(0,i.A)(this,e),(0,s.A)(this,"type",-1)}return(0,a.A)(e,[{key:"destroy",value:function(e){}}]),e}(),u=(n={},(0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)(n,12,[86018]),7,[86017,86019,86018,12,27]),14,[86028]),0,[86017,86018,86051,69645,86049,65543,65542,12,27,173,225,167,196]),4,[139,167]),5,[86021,86076,86018,86017,86028,86032,86020,86056,65557,65537,65536,139,167,225,27,173,196,12,30,94226]),6,[86021,86076,139,167,225,94226]),1,[86021,86076,86018,86017,86028,86051,86019,86056,167,225,27,173,196,12,94226,94213]),11,[86017]),2,[86076,86018,86017,86019,,86020,86065,86056,12,225,27,173,196]),(0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)(n,3,[86021]),13,[]),15,[94226]),17,[94230,94212]),16,[94225]),18,[94232]),8,[27]),9,[173]),10,[196]))},69765:(e,t,r)=>{"use strict";r.d(t,{A:()=>V});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134),l=r(61499),p=r(63939),v=r(9599),m=r(29170),g=r(51597),A=r(9690),y=r(65977),x=r(75473),k=r(38106),b=r(3384),w=r(35336),_=r(72739),T=r(4624),I=r(92647),S=r(79804),P=r(77231),B=r(95335),C=r(20841),M=r(59989),R=r(44328),U=r(71517),E=r(26173),D=r(67672),L=r(87771);function F(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,O()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function O(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(O=function(){return!!e})()}var N="src/avformat/formats/OMovFormat.ts",z={fragmentMode:0,movMode:0,fragment:!1,fastOpen:!1,defaultBaseIsMoof:!1},V=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.A)(this,t),e=F(this,t),(0,d.A)((0,u.A)(e),"type",1),(0,d.A)((0,u.A)(e),"context",void 0),(0,d.A)((0,u.A)(e),"options",void 0),(0,d.A)((0,u.A)(e),"annexb2AvccFilter",void 0),e.options=B.extend({},z,r),e.context=(0,A.A)(),e}return(0,h.A)(t,e),(0,s.A)(t,[{key:"init",value:function(e){e.ioWriter.setEndian(!0);var t=e.getStreamByMediaType(0);return t&&(this.annexb2AvccFilter=new E.A,this.annexb2AvccFilter.init(t.codecpar[l.o9],t.timeBase[l.o9])),0}},{key:"destroy",value:function(e){(0,c.A)((0,f.A)(t.prototype),"destroy",this).call(this,e),this.annexb2AvccFilter&&(this.annexb2AvccFilter.destroy(),this.annexb2AvccFilter=null)}},{key:"enableStreams",value:function(e){for(var t=[],r=[],n=0;n<5;n++)t[n]=0,r[n]=-1;_.__(e.streams,(function(e,n){if(-1===e.codecpar.codecType||e.codecpar.codecType>=5)return!0;r[e.codecpar.codecType]<0&&(r[e.codecpar.codecType]=n),1&e.disposition&&(t[e.codecpar.codecType]++,e.privData.flags|=1)}));for(var i=0;i<5;i++)switch(i){case 0:case 1:case 3:t[i]>1&&(e.streams[t[i]].privData.perStreamGrouping=!0),!t[i]&&r[i]>=0&&(e.streams[r[i]].privData.flags|=1)}}},{key:"writeHeader",value:function(e){var t=this;if(this.context.majorBrand=(0,y.A)("isom"),this.context.minorVersion=512,this.context.compatibleBrand=[(0,y.A)("isom")],this.context.timescale=1e3,this.options.fragment&&(this.context.compatibleBrand.push((0,y.A)("iso6")),this.context.fragment=!0),1===this.options.movMode&&(this.context.isom=!0,this.context.majorBrand=(0,y.A)("qt  "),this.context.compatibleBrand=[this.context.majorBrand]),1!==this.options.movMode){this.context.compatibleBrand.push((0,y.A)("iso2"));var r=e.getStreamByMediaType(0);r&&27===r.codecpar.codecId&&this.context.compatibleBrand.push((0,y.A)("avc1")),this.context.compatibleBrand.push((0,y.A)("mp41"))}if(x.l7(e.ioWriter,this.context),this.context.holdMoovPos=e.ioWriter.getPos(),this.options.fragment)this.context.currentFragment={pos:BigInt(0),currentTrack:null,sequence:1,tracks:[],size:0,firstWrote:!1},_.__(e.streams,(function(e,r){var n=(0,k.A)();e.privData=n,n.chunkOffsets=[],n.cttsSampleCounts=[],n.cttsSampleOffsets=[],n.stscFirstChunk=[],n.stscSamplesPerChunk=[],n.stscSampleDescriptionIndex=[],n.stssSampleNumbers=[],n.sampleSizes=[],n.sttsSampleCounts=[],n.sttsSampleDeltas=[],n.alternateGroup=r;var i=(0,b.A)();i.baseIsMoof=t.options.defaultBaseIsMoof,i.streamIndex=e.index,i.trackId=t.context.nextTrackId++,n.trackId=i.trackId,i.ioWriter=new w.A,i.ioWriter.onFlush=function(e){return i.buffers.push(e.slice()),0},t.context.currentFragment.tracks.push(i)})),this.enableStreams(e),x.dI(e.ioWriter,e,this.context),e.ioWriter.flush();else{_.__(e.streams,(function(e,r){var n=(0,k.A)();e.privData=n,n.trackId=t.context.nextTrackId++,n.chunkOffsets=[],n.cttsSampleCounts=[],n.cttsSampleOffsets=[],n.stscFirstChunk=[],n.stscSamplesPerChunk=[],n.stscSampleDescriptionIndex=[],n.stssSampleNumbers=[],n.sampleSizes=[],n.sttsSampleCounts=[],n.sttsSampleDeltas=[],n.alternateGroup=r})),this.enableStreams(e);var n=e.ioWriter.getPos();e.ioWriter.writeUint32(0),e.ioWriter.writeUint32((0,y.A)("mdat")),this.context.boxsPositionInfo.push({pos:n,type:"mdat",size:0})}return 0}},{key:"updateCurrentChunk",value:function(e){var t=this.context.currentChunk;if(t.sampleCount){var r=e.streams.find((function(e){return e.index===t.streamIndex})).privData;r.chunkCount++,r.chunkOffsets.push(t.pos),r.stscFirstChunk.length?r.lastStscCount!==t.sampleCount&&(r.stscFirstChunk.push(r.chunkCount),r.stscSamplesPerChunk.push(t.sampleCount),r.stscSampleDescriptionIndex.push(1),r.lastStscCount=t.sampleCount):(r.stscFirstChunk.push(r.chunkCount),r.stscSamplesPerChunk.push(t.sampleCount),r.stscSampleDescriptionIndex.push(1),r.lastStscCount=t.sampleCount)}}},{key:"checkMdat",value:function(e,t){var r=this.context.boxsPositionInfo[this.context.boxsPositionInfo.length-1];if("mdat"===r.type){var n=e.ioWriter.getPos(),i=Number(n-r.pos);i+t>P.f7&&(r.size=i,e.ioWriter.writeUint32(0),e.ioWriter.writeUint32((0,y.A)("mdat")),this.context.boxsPositionInfo.push({pos:n,type:"mdat",size:0}))}else T.z3("last box is not mdat",N,301)}},{key:"updateCurrentFragment",value:function(e,t){if(this.context.currentFragment.firstWrote){_.__(this.context.currentFragment.tracks,(function(r){var n=e.streams.find((function(e){return e.index===r.streamIndex}));if(!r.sampleCount||!n)return!0;var i,a=n.privData;r.baseDataOffset=e.ioWriter.getPos(),r.sampleDurations.length?t&&r.sampleDurations.length===r.sampleSizes.length-1&&r.sampleDurations.push(Number(t-a.lastDts)):1===n.codecpar.codecType?t?r.sampleDurations.push(Number(t-a.lastDts)):n.codecpar.frameSize>0?r.sampleDurations.push(Number((0,R.k)(BigInt(n.codecpar.frameSize/n.codecpar.sampleRate*P.SF),P.KR,n.timeBase))):(n.codecpar.codecId,r.sampleDurations.push(Number((0,R.k)(BigInt(1024/n.codecpar.sampleRate*P.SF),P.KR,n.timeBase)))):0===n.codecpar.codecType?t?r.sampleDurations.push(Number(t-a.lastDts)):(0,R.lb)(n.codecpar.framerate)>0?r.sampleDurations.push(Number((0,R.k)(BigInt(Math.floor(1/(0,R.lb)(n.codecpar.framerate)*P.SF)),P.KR,n.timeBase))):r.sampleDurations.push(n.timeBase.den/(30*n.timeBase.num)>>>0):r.sampleDurations.push(0),a.lastDuration=r.sampleDurations[r.sampleSizes.length-1],(1===r.sampleFlags.length||(0,M.A)(r.sampleFlags,1))&&(r.firstSampleFlags=r.sampleFlags[0],r.defaultSampleFlags=null!==(i=r.sampleFlags[1])&&void 0!==i?i:r.firstSampleFlags,r.sampleFlags=[]),(1===r.sampleSizes.length||(0,M.A)(r.sampleSizes))&&(r.defaultSampleSize=r.sampleSizes[0],r.sampleSizes=[]),(1===r.sampleDurations.length||(0,M.A)(r.sampleDurations))&&(r.defaultSampleDuration=r.sampleDurations[0],r.sampleDurations=[]),1===n.codecpar.codecType?r.defaultSampleFlags=33554432:r.sampleFlags.length&&(r.defaultSampleFlags=r.sampleFlags[0]),r.sampleSizes.length&&(r.defaultSampleSize=r.sampleSizes[0]),r.sampleDurations.length&&(r.defaultSampleDuration=r.sampleDurations[0])})),e.ioWriter.flush(),x.Ro(e.ioWriter,e,this.context);var r=this.context.currentFragment.size+8,n=[],i=8;_.__(this.context.currentFragment.tracks,(function(t){if(!t.sampleCount)return!0;t.ioWriter.flush();var a=(0,I.A)(Uint8Array,t.buffers);t.dataOffset=r,r+=a.length,i+=a.length,n.push(a),(0,C.A)(e.ioWriter,t.dataOffsetPos,t.dataOffset,"int32"),t.buffers=[],t.sampleFlags=[],t.sampleSizes=[],t.sampleDurations=[],t.sampleCompositionTimeOffset=[],t.sampleCount=0,t.firstSampleFlags=0})),e.ioWriter.writeUint32(i),e.ioWriter.writeUint32((0,y.A)("mdat")),_.__(n,(function(t){e.ioWriter.writeBuffer(t)})),(0,S.A)(e.ioWriter,this.context),e.ioWriter.flush(),this.context.currentFragment.firstWrote=!1,this.context.currentFragment.sequence++}}},{key:"handleEAC3",value:function(e,t){this.context.ac3Info||(this.context.ac3Info={done:!1,numBlocks:0,dataRate:0,ac3BitrateCode:-1,numIndSub:0,substream:[]});var r=this.context.ac3Info,n=L.R(p.f[20](e+24),p.f[15](e+28));if(D.ai(n))r.done=!0;else if(r.dataRate=Math.max(r.dataRate,n.bitRate/1e3),r.ac3BitrateCode=Math.max(r.ac3BitrateCode,n.ac3BitrateCode),!r.done){if(n.bitstreamId<=10&&0!=n.substreamId)return;if(0===n.frameType||2==n.frameType){var i;if(n.substreamId>r.numIndSub+1)return;if(n.substreamId==r.numIndSub+1)return;if(n.substreamId<r.numIndSub||0==n.substreamId&&null!==(i=r.substream[0])&&void 0!==i&&i.bsid)return void(r.done=!0)}else if(0!=n.substreamId)return;if(r.substream[n.substreamId]||(r.substream[n.substreamId]={fscod:0,bsid:0,bsmod:0,acmod:0,lfeon:0,numDepSub:0,chanLoc:0}),r.substream[n.substreamId].fscod=n.srCode,r.substream[n.substreamId].bsid=n.bitstreamId,r.substream[n.substreamId].bsmod=n.bitstreamMode,r.substream[n.substreamId].acmod=n.channelMode,r.substream[n.substreamId].lfeon=n.lfeOn,86019===t.codecpar.codecId)return void(r.done=!0)}}},{key:"writeAVPacket",value:function(e,t){if(!p.f[15](t+28))return T.R8("packet's size is 0: ".concat(p.f[15](t+32),", ignore it"),N,542),0;var r=e.getStreamByIndex(p.f[15](t+32));if(r){var n=r.privData,i=(0,R.k)(p.f[17](t+16),(0,m.A)(t+72,v.P),r.timeBase),a=(0,R.k)(p.f[17](t+8)<BigInt(0)?p.f[17](t+16):p.f[17](t+8),(0,m.A)(t+72,v.P),r.timeBase);if(27!==r.codecpar.codecId&&173!==r.codecpar.codecId&&196!==r.codecpar.codecId||2!==p.f[15](t+80)?86019!==r.codecpar.codecId&&86056!==r.codecpar.codecId||this.context.ac3Info&&this.context.ac3Info.done||this.handleEAC3(t,r):(this.annexb2AvccFilter.sendAVPacket(t),this.annexb2AvccFilter.receiveAVPacket(t)),this.context.fragment){var s=this.context.currentFragment.tracks.find((function(e){return e.streamIndex===p.f[15](t+32)}));if(s){if((0===this.options.fragmentMode&&0===r.codecpar.codecType&&1&p.f[15](t+36)||1===this.options.fragmentMode)&&(1===this.context.currentFragment.tracks.length?this.updateCurrentFragment(e,i):this.updateCurrentFragment(e)),s.ioWriter.writeBuffer((0,U.iI)(t)),s.sampleSizes.length||(s.baseMediaDecodeTime=i),s.sampleSizes.length&&(!s.sampleDurations[s.sampleSizes.length-1]||s.sampleDurations[s.sampleSizes.length-1]<=0)&&(s.sampleDurations[s.sampleSizes.length-1]=Number(i-n.lastDts)),p.f[17](t+48)>0&&s.sampleDurations.push(Number((0,R.k)(p.f[17](t+48),(0,m.A)(t+72,v.P),r.timeBase))),s.sampleSizes.push(p.f[15](t+28)),0===r.codecpar.codecType){var o=0;1&p.f[15](t+36)?o|=33554432:o|=16842752,s.sampleCompositionTimeOffset.push(Number((a||i)-i)),s.sampleFlags.push(o)}s.sampleCount++,n.lastPts=a>n.lastPts?a:n.lastPts,n.lastDts=i,this.context.currentFragment.firstWrote=!0}else T.R8("can not found track width streamIndex ".concat(p.f[15](t+32),", ignore it"),N,635)}else{this.checkMdat(e,p.f[15](t+28));var u=e.ioWriter.getPos(),c=this.context.currentChunk;if(c?c.streamIndex!==p.f[15](t+32)?(this.updateCurrentChunk(e),c.streamIndex=p.f[15](t+32),c.sampleCount=1,c.pos=u):c.sampleCount++:c=this.context.currentChunk={pos:u,streamIndex:p.f[15](t+32),sampleCount:1},e.ioWriter.writeBuffer((0,U.iI)(t)),n.sampleSizes.push(p.f[15](t+28)),0===r.codecpar.codecType&&1&p.f[15](t+36)&&n.stssSampleNumbers.push(n.sampleSizes.length),n.firstWrote){var f=Number(i-n.lastDts);n.sttsSampleCounts.length&&n.sttsSampleDeltas[n.sttsSampleDeltas.length-1]===f?n.sttsSampleCounts[n.sttsSampleCounts.length-1]++:(n.sttsSampleCounts.push(1),n.sttsSampleDeltas.push(f))}else n.startDts=i,n.startCT=Number((a||i)-i),n.firstWrote=!0;if(0===r.codecpar.codecType){var h=Number((a||i)-i);n.cttsSampleCounts.length&&n.cttsSampleOffsets[n.cttsSampleOffsets.length-1]===h?n.cttsSampleCounts[n.cttsSampleCounts.length-1]++:(n.cttsSampleCounts.push(1),n.cttsSampleOffsets.push(h))}n.lastPts=(a||i)>n.lastPts?a||i:n.lastPts,n.lastDts=i}return 0}T.R8("can not found the stream width the avpacket's streamIndex: ".concat(p.f[15](t+32),", ignore it"),N,549)}},{key:"writeTrailer",value:function(e){if(this.context.fragment)_.__(this.context.currentFragment.tracks,(function(t){var r=e.streams.find((function(e){return e.index===t.streamIndex})).privData;t.sampleCount&&(t.sampleDurations.length?t.sampleDurations.push(t.sampleDurations[t.sampleDurations.length-1]):t.sampleDurations=[r.lastDuration])})),this.updateCurrentFragment(e),e.ioWriter.writeUint32(8),e.ioWriter.writeString("mfra"),e.ioWriter.flush();else{this.updateCurrentChunk(e);var t,r=BigInt(0);_.__(e.streams,(function(e){var n=e.privData;n.sampleSizes.length&&(n.sttsSampleDeltas.length?n.sttsSampleCounts[n.sttsSampleCounts.length-1]++:(n.sttsSampleCounts=[1],n.sttsSampleDeltas=[0])),n.lastPts>r&&(r=n.lastPts,t=e.timeBase)})),r&&(this.context.duration=(0,R.k)(r,t,{den:1e3,num:1}));var n=this.context.boxsPositionInfo[this.context.boxsPositionInfo.length-1];if("mdat"!==n.type&&T.z3("last box is not mdat",N,751),n.size=Number(e.ioWriter.getPos()-n.pos),(0,S.A)(e.ioWriter,this.context),this.options.fastOpen){e.ioWriter.flush();var i=[],a=e.ioWriter.onFlush;e.ioWriter.onFlush=function(e){return i.push(e.slice()),0},x.dI(e.ioWriter,e,this.context),e.ioWriter.flush();var s=(0,I.A)(Uint8Array,i);_.__(e.streams,(function(e){var t=e.privData;if(t.chunkOffsets.length)for(var r=0;r<t.chunkOffsets.length;r++)t.chunkOffsets[r]+=BigInt(Math.floor(s.length))})),i=[],x.dI(e.ioWriter,e,this.context),e.ioWriter.flush(),s=(0,I.A)(Uint8Array,i),a&&a(s,this.context.holdMoovPos),e.ioWriter.onFlush=a}else x.dI(e.ioWriter,e,this.context),e.ioWriter.flush()}return 0}},{key:"flush",value:function(e){return this.options.fragment&&(_.__(this.context.currentFragment.tracks,(function(t){var r=e.streams.find((function(e){return e.index===t.streamIndex})).privData;t.sampleCount&&(t.sampleDurations.length?t.sampleDurations.push(t.sampleDurations[t.sampleDurations.length-1]):t.sampleDurations=[r.lastDuration])})),this.updateCurrentFragment(e)),e.ioWriter.flush(),0}}]),t}(g.A)},5028:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n});var n=["ReadOrder","Layer","Start","End","Style","Name","MarginL","MarginR","MarginV","Effect","Text"]},51785:(e,t,r)=>{"use strict";r.d(t,{Bp:()=>f,Ew:()=>d,wj:()=>l});var n=r(6550),i=(r(7210),r(4624)),a=r(5028),s=r(54825),o=r(44453),u=r(93935),c="src/avformat/formats/ass/iass.ts";function f(e){return function(e,t){for(var r=t.match(/Format\s*:\s*(.*)/i)[1].split(/\s*,\s*/),n=[],a=function(t){var a=e.find((function(e){return e.toLowerCase()===r[t].toLowerCase()}));a||i.R8("not support ass field(".concat(r[t],")"),c,40),n.push(a||r[t])},s=0;s<r.length;s++)a(s);return n}(a.Q,e)}function h(e,t){var r=t.split(",");if(r.length>e.length){var n=r.slice(e.length-1).join(",");(r=r.slice(0,e.length-1)).push(n)}return r}function d(e,t,r,i){var a=t.match(/^(\w+?)\s*:\s*(.*)/i),o=h(e,(0,n.A)(a,3)[2]);return{start:(0,s.j)(o[r]),end:(0,s.j)(o[i])}}function l(e,t){var r=t.match(/^(\w+?)\s*:\s*(.*)/i),i=(0,n.A)(r,3),a=i[1],c=i[2],f=0;switch(a){case"Comment":f=2;break;case"Dialogue":f=1;break;case"Command":f=6;break;case"Movie":f=5;break;case"Picture":f=3;break;case"Sound":f=4}for(var d=h(e,c),l={type:f},p=0;p<d.length;p++){l[e[p]]=d[p];var v=e[p],m=d[p].trim();switch(v){case"Layer":case"MarginL":case"MarginR":case"MarginV":l[v]=+m;break;case"Start":case"End":l[v]=(0,s.j)(m);break;case"Effect":l[v]=(0,o.d)(m);break;case"Text":l[v]=(0,u.r)(m);break;default:l[v]=m}}return l}},21071:(e,t,r)=>{"use strict";r.d(t,{_l:()=>n,gQ:()=>i});var n=["hmhd","nmhd","iods","xml ","url ","bxml","ipro","mere","stts","ctts","stss","stsz","stz2","stsc","stco","co64","stsd","dref","mvhd","tkhd","mdhd","hdlr"],i=["moov","trak","edts","mdia","minf","dinf","stbl","mvex","moof","traf","vttc","tref","iref","mfra","hnti","hinf","strd","sinf","rinf","schi","trgr","udta","iprp","ipco","strk","meco"]},3384:(e,t,r)=>{"use strict";function n(){return{trackId:0,baseDataOffset:BigInt(0),defaultSampleDuration:0,defaultSampleSize:0,defaultSampleFlags:0,baseMediaDecodeTime:BigInt(0),sampleCount:0,dataOffset:0,dataOffsetPos:BigInt(0),firstSampleFlags:0,sampleDurations:[],sampleSizes:[],sampleFlags:[],sampleCompositionTimeOffset:[],baseIsMoof:!1,ioWriter:null,buffers:[]}}r.d(t,{A:()=>n})},9690:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(77231);function i(){return{isom:!1,timescale:n.N_,duration:n.Dh,foundMoov:!1,foundMdat:!1,majorBrand:0,minorVersion:0,compatibleBrand:[],creationTime:BigInt(0),modificationTime:BigInt(0),rate:n.N_,volume:n.N_,matrix:null,nextTrackId:1,fragment:!1,trexs:[],currentFragment:null,boxsPositionInfo:[],holdMoovPos:BigInt(0),currentChunk:null}}},38106:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(77231);function i(){return{chunkOffsets:null,cttsSampleCounts:null,cttsSampleOffsets:null,stscFirstChunk:null,stscSamplesPerChunk:null,stscSampleDescriptionIndex:null,stssSampleNumbersMap:null,stssSampleNumbers:null,sampleSizes:null,sttsSampleCounts:null,sttsSampleDeltas:null,timescale:0,duration:BigInt(0),trackId:n.N_,layer:0,alternateGroup:0,volume:0,matrix:null,width:0,height:0,audioCid:0,samplesPerFrame:0,bytesPerFrame:0,currentSample:0,sampleEnd:!1,samplesIndex:[],fragIndexes:[],lastPts:BigInt(0),lastDts:BigInt(0),startDts:BigInt(0),startCT:0,lastDuration:0,chunkCount:0,firstWrote:!1,lastStscCount:0,perStreamGrouping:!1,index:0,flags:0}}},79804:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(72739);function i(e,t){var r=e.getPos(),i=e.getPointer(),a=r-BigInt(Math.floor(i)),s=[];n.__(t.boxsPositionInfo,(function(t){t.pos<r&&t.pos>=a?(e.seekInline(i+Number(t.pos-r)),e.writeUint32(t.size)):s.push(t)})),n.__(s,(function(t){e.seek(t.pos),e.writeUint32(t.size)})),s.length?e.seek(r):e.seekInline(i),t.boxsPositionInfo=[]}},14202:(e,t,r)=>{"use strict";r.d(t,{BB:()=>a,Ip:()=>s,Jl:()=>i});var n=r(134),i=(0,n.A)((0,n.A)({},1,(function(e){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},e.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]})),0,(function(e){return[{type:"tkhd"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},e.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]})),a=(0,n.A)((0,n.A)({},1,(function(e){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"smhd"},e.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]})),0,(function(e){return[{type:"tkhd"},{type:"edts"},{type:"mdia",children:[{type:"mdhd"},{type:"hdlr"},{type:"minf",children:[{type:"vmhd"},e.isom?{type:"minf_hdlr"}:null,{type:"dinf",children:[{type:"dref",children:[{type:"url "}]}]},{type:"stbl",children:[{type:"stsd"},{type:"stts"},{type:"stss"},{type:"ctts"},{type:"stsc"},{type:"stsz"},{type:"stco"}]}]}]}]})),s=[{type:"tfhd"},{type:"tfdt"},{type:"trun"}]},6660:(e,t,r)=>{"use strict";r.d(t,{Q9:()=>u,f3:()=>c,uf:()=>f,zs:()=>o});var n,i,a=r(134),s=r(65977),o=(n={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(n,86018,64),86017,105),86076,173),86028,193),86021,221),12,32),27,33),173,35),196,51),167,177),(0,a.A)(n,0,0)),u={32:12,33:27,35:173,51:196,177:167,64:86018,102:86018,103:86018,104:86018,105:86017,107:86017,173:86076,193:86028,221:86021,0:0},c={vide:0,soun:1,clcp:3,sbtl:3,subt:3,subp:3,text:3},f=(i={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(i,(0,s.A)("mp4a"),86018),1836253269,86017),(0,s.A)("Opus"),86076),(0,s.A)("fLaC"),86028),(0,s.A)("spex"),86051),(0,s.A)("SPXN"),86051),(0,s.A)("ac-3"),86019),(0,s.A)("sac3"),86019),s.A.mp4v,12),(0,s.A)("av01"),225),(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(i,(0,s.A)("vp08"),139),(0,s.A)("vp09"),167),(0,s.A)("avc1"),27),(0,s.A)("hev1"),173),(0,s.A)("hvc1"),173),(0,s.A)("vvc1"),196),(0,s.A)("vvi1"),196),(0,s.A)("text"),94213),(0,s.A)("tx3g"),94213))},75473:(e,t,r)=>{"use strict";r.d(t,{Ro:()=>d,dI:()=>h,l7:()=>c});var n=r(65977),i=r(21071),a=r(72739),s=r(80025),o=r(14202),u=r(79804);function c(e,t){e.flush();var r=e.getPointer(),i=e.getPos();e.writeUint32(0),e.writeUint32((0,n.A)("ftyp")),e.writeUint32(t.majorBrand||(0,n.A)("isom")),e.writeUint32(t.minorVersion||512),a.__(t.compatibleBrand,(function(t){e.writeUint32(t)})),function(e,t,r){var n=e.getPointer();e.seekInline(t),e.writeUint32(r),e.seekInline(n)}(e,r,Number(e.getPos()-i)),t.isom?(e.writeUint32(8),e.writeUint32((0,n.A)("wide"))):t.fragment||(e.writeUint32(8),e.writeUint32((0,n.A)("free")))}function f(e,t,r,o){a.__(t,(function(t){if(!t)return!0;if(s.A[t.type])s.A[t.type](e,r,o);else if(t.children){var u=e.getPos();e.writeUint32(0),e.writeUint32((0,n.A)(t.type)),f(e,t.children,r,o),o.boxsPositionInfo.push({pos:u,type:t.type,size:Number(e.getPos()-u)})}else!function(e,t){var r=a.zy(i._l,t);e.writeUint32(r?12:8),e.writeUint32((0,n.A)(t)),r&&e.writeUint32(0)}(e,t.type)}))}function h(e,t,r){var i=e.getPos();if(e.writeUint32(0),e.writeUint32((0,n.A)("moov")),s.A.mvhd(e,null,r),a.__(t.streams,(function(t){var i=e.getPos();e.writeUint32(0),e.writeUint32((0,n.A)("trak")),f(e,r.fragment?o.Jl[t.codecpar.codecType](r):o.BB[t.codecpar.codecType](r),t,r),r.boxsPositionInfo.push({pos:i,type:"trak",size:Number(e.getPos()-i)})})),r.fragment){var c=e.getPos();e.writeUint32(0),e.writeUint32((0,n.A)("mvex")),a.__(t.streams,(function(t){s.A.trex(e,t,r)})),r.boxsPositionInfo.push({pos:c,type:"mvex",size:Number(e.getPos()-c)})}r.boxsPositionInfo.push({pos:i,type:"moov",size:Number(e.getPos()-i)}),(0,u.A)(e,r)}function d(e,t,r){var i=e.getPos();e.writeUint32(0),e.writeUint32((0,n.A)("moof")),s.A.mfhd(e,null,r),a.__(r.currentFragment.tracks,(function(i){if(!i.sampleCount)return!0;var a=e.getPos();e.writeUint32(0),e.writeUint32((0,n.A)("traf"));var s=t.streams.find((function(e){return e.privData.trackId===i.trackId}));f(e,o.Ip,s,r),r.boxsPositionInfo.push({pos:a,type:"traf",size:Number(e.getPos()-a)})}));var u=Number(e.getPos()-i);r.boxsPositionInfo.push({pos:i,type:"moof",size:u}),r.currentFragment.size=u}},39878:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(14686);function i(e,t,r){var i;e.writeUint32(null!==(i=8+t.codecpar.extradataSize)&&void 0!==i?i:0),e.writeString("av1C"),r.fragment&&t.sideData[1]?(e.writeBuffer(t.sideData[1]),delete t.sideData[1]):t.codecpar.extradata&&e.writeBuffer((0,n.s3)(t.codecpar.extradata,t.codecpar.extradataSize))}},61600:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(14686);function i(e,t,r){var i;e.writeUint32(null!==(i=8+t.codecpar.extradataSize)&&void 0!==i?i:0),e.writeString("avcC"),r.fragment&&t.sideData[1]?(e.writeBuffer(t.sideData[1]),delete t.sideData[1]):t.codecpar.extradata&&e.writeBuffer((0,n.s3)(t.codecpar.extradata,t.codecpar.extradataSize))}},93861:(e,t,r)=>{"use strict";function n(e,t,r){e.writeUint32(20),e.writeString("btrt"),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0)}r.d(t,{A:()=>n})},34445:(e,t,r)=>{"use strict";function n(e,t,r){var n=t.privData.chunkOffsets||[];e.writeUint32(8+8*n.length),e.writeString("co64"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(n.length);for(var i=0;i<n.length;i++)e.writeUint64(n[i])}r.d(t,{A:()=>n})},853:(e,t,r)=>{"use strict";function n(e,t,r){var n=t.sideData[28];if(n)e.writeUint32(12+n.length),e.writeString("colr"),e.writeString("prof"),e.writeBuffer(n);else{var i=2===t.codecpar.colorRange;e.writeUint32(19),e.writeString("colr"),e.writeString("nclx"),e.writeUint16(t.codecpar.colorPrimaries),e.writeUint16(t.codecpar.colorTrc),e.writeUint16(t.codecpar.colorSpace),e.writeUint8(i?128:0)}}r.d(t,{A:()=>n})},18387:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(4624),i="src/avformat/formats/mov/writing/ctts.ts";function a(e,t,r){var a=t.privData,s=a.cttsSampleCounts||[],o=a.cttsSampleOffsets||[];s.length!==o.length&&n.R8("ctts sampleCounts's length is not match sampleOffsets's length",i,39);var u=Math.min(s.length,o.length);e.writeUint32(16+8*u),e.writeString("ctts"),e.writeUint8(1),e.writeUint24(0),e.writeUint32(u);for(var c=0;c<u;c++)e.writeUint32(s[c]),e.writeInt32(o[c])}},80648:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(83314);function i(e,t,r){e.writeUint32(11),e.writeString("dac3");var i=new n.A(3),a=r.ac3Info;i.writeU(2,a.substream[0].fscod),i.writeU(5,a.substream[0].bsid),i.writeU(3,a.substream[0].bsmod),i.writeU(3,a.substream[0].acmod),i.writeU(1,a.substream[0].lfeon),i.writeU(5,a.ac3BitrateCode),i.writeU(5,0),e.writeBuffer(i.getBuffer())}},55668:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(83314);function i(e,t,r){var i=r.ac3Info,a=new n.A(2+(34*(i.numIndSub+1)+7>>3));a.writeU(13,i.dataRate),a.writeU(3,i.numIndSub);for(var s=0;s<i.numIndSub;s++)a.writeU(2,i.substream[s].fscod),a.writeU(5,i.substream[s].bsid),a.writeU(1,0),a.writeU(1,0),a.writeU(3,i.substream[s].bsmod),a.writeU(3,i.substream[s].acmod),a.writeU(1,i.substream[s].lfeon),a.writeU(5,0),a.writeU(4,i.substream[s].numDepSub),i.substream[s].numDepSub?a.writeU(9,i.substream[s].chanLoc):a.writeU(1,0);a.padding();var o=a.getPointer();e.writeUint32(8+o),e.writeString("dec3"),e.writeBuffer(a.getBuffer().subarray(0,o))}},47280:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(14686),i=r(4624),a="src/avformat/formats/mov/writing/dfla.ts";function s(e,t,r){var s;r.fragment&&t.sideData[1]?(s=t.sideData[1],delete t.sideData[1]):t.codecpar.extradata&&(s=(0,n.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),s?(e.writeUint32(s.length+16),e.writeString("dfLa"),e.writeUint8(0),e.writeUint24(0),e.writeUint8(128),e.writeUint24(s.length),e.writeBuffer(s)):i.z3("invalid extradata",a,56)}},82181:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(14686),i=r(31865);function a(e,t,r){var a;if(r.fragment&&t.sideData[1]?(a=t.sideData[1],delete t.sideData[1]):t.codecpar.extradata&&(a=(0,n.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),!a||a.length<19)e.writeUint32(19),e.writeString("dOps"),e.writeUint8(0),e.writeUint8(t.codecpar.chLayout.nbChannels),e.writeUint16(t.codecpar.initialPadding),e.writeUint32(t.codecpar.sampleRate),e.writeUint16(0),e.writeUint8(0);else{var s=new i.A(a,!1);e.writeUint32(a.length),e.writeString("dOps"),e.writeUint8(0),s.seek(9),e.writeUint8(s.readUint8()),e.writeUint16(s.readUint16()),e.writeUint32(s.readUint32()),e.writeUint16(s.readUint16()),e.writeBuffer(a.subarray(18))}}},12412:(e,t,r)=>{"use strict";function n(e,t,r){e.writeUint32(28),e.writeString("dref"),e.writeUint32(0),e.writeUint32(1),e.writeUint32(12),e.writeString("url "),e.writeUint32(1)}r.d(t,{A:()=>n})},44473:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(77231),i=r(44328);function a(e,t,r){var a=t.privData,s=(0,i.k)(a.lastPts,t.timeBase,{den:r.timescale,num:1}),o=a.startCT,u=(0,i.k)(a.startDts+BigInt(Math.floor(o)),t.timeBase,{den:a.timescale,num:1}),c=s<n.go?0:1,f=1+(u>0?1:0),h=24+f*(1==(c|=u<n.go?0:1)?20:12);e.writeUint32(h),e.writeString("edts"),e.writeUint32(h-8),e.writeString("elst"),e.writeUint8(c),e.writeUint24(0),e.writeUint32(f),u>0?(1===c?(e.writeUint64(u),e.writeInt64(n.Dh)):(e.writeUint32(Number(u)),e.writeInt32(-1)),e.writeUint32(65536)):(o=-Math.min(Number(a.startDts),0),s+=u),r.fragment&&(s=BigInt(0)),1===c?(e.writeUint64(s),e.writeInt64(BigInt(Math.floor(o)))):(e.writeUint32(Number(s)),e.writeInt32(o)),e.writeUint32(65536)}},4652:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(6660),i=r(14686);function a(e,t,r){e.writeUint8(t);for(var n=3;n>0;n--)e.writeUint8(r>>7*n|128);e.writeUint8(127&r)}function s(e,t,r){var s=t.privData,o=t.codecpar.extradata?5+t.codecpar.extradataSize:0,u=e.getPos();e.writeUint32(0),e.writeString("esds"),e.writeUint32(0),a(e,3,21+o+5+1),e.writeUint16(s.trackId),e.writeUint8(0),a(e,4,13+o),(86016===t.codecpar.codecId||86017===t.codecpar.codecId)&&t.codecpar.sampleRate>24e3?e.writeUint8(107):e.writeUint8(n.zs[t.codecpar.codecId]),94208===t.codecpar.codecId?e.writeUint8(225):1===t.codecpar.codecType?e.writeUint8(21):e.writeUint8(17),e.writeUint24(0),e.writeUint32(0),e.writeUint32(0),t.codecpar.extradata&&(a(e,5,t.codecpar.extradataSize),e.writeBuffer((0,i.s3)(t.codecpar.extradata,t.codecpar.extradataSize))),a(e,6,1),e.writeUint8(2),r.boxsPositionInfo.push({pos:u,type:"esds",size:Number(e.getPos()-u)})}},87384:(e,t,r)=>{"use strict";function n(e,t,r,n,i,a,s){e.writeUint32(t<<16),e.writeUint32(r<<16),e.writeUint32(0),e.writeUint32(n<<16),e.writeUint32(i<<16),e.writeUint32(0),e.writeUint32(a<<16),e.writeUint32(s<<16),e.writeUint32(1073741824)}r.d(t,{A:()=>n})},17923:(e,t,r)=>{"use strict";function n(e,t,r){var n=e.getPos();e.writeUint32(0),e.writeString("hdlr"),e.writeUint8(0),e.writeUint24(0);var i="dhlr",a="url ",s="DataHandler";t&&(i="mhlr",1===t.codecpar.codecType?(a="soun",s="SoundHandler"):0===t.codecpar.codecType?(a="vide",s="VideoHandler"):3===t.codecpar.codecType?(a="text",s="SubtitleHandler"):(t.metadata.handlerName&&(s=t.metadata.handlerName),t.metadata.hdlrType&&(a=t.metadata.hdlrType))),e.writeString(i),e.writeString(a),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),t&&!r.isom||e.writeUint8(s.length),e.writeString(s),t&&!r.isom&&e.writeUint8(0),r.boxsPositionInfo.push({pos:n,type:"hdlr",size:Number(e.getPos()-n)})}r.d(t,{A:()=>n})},78669:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(14686);function i(e,t,r){var i;e.writeUint32(null!==(i=8+t.codecpar.extradataSize)&&void 0!==i?i:0),e.writeString("hvcC"),r.fragment&&t.sideData[1]?(e.writeBuffer(t.sideData[1]),delete t.sideData[1]):t.codecpar.extradata&&e.writeBuffer((0,n.s3)(t.codecpar.extradata,t.codecpar.extradataSize))}},6e3:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(77231);function i(e,t,r){var i=t.privData.lastPts,a=t.metadata.creationTime||0,s=t.metadata.modificationTime||0,o=t.metadata.language||21956,u=BigInt(n.f7);n.f7,u=s<n.f7?0:1,e.writeUint32(1===u?44:32),e.writeString("mdhd"),e.writeUint8(u),e.writeUint24(0),1===u?(e.writeUint64(a),e.writeUint64(s)):(e.writeUint32(Number(a)),e.writeUint32(Number(s))),e.writeUint32(t.timeBase.den),1===u?e.writeUint64(i):e.writeUint32(Number(i)),e.writeUint16(o),e.writeUint16(0)}},31130:(e,t,r)=>{"use strict";function n(e,t,r){e.writeUint32(16),e.writeString("mfhd"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(r.currentFragment.sequence)}r.d(t,{A:()=>n})},48669:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(17923);function i(e,t,r){(0,n.A)(e,null,r)}},7114:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(77231),i=r(87384);function a(e,t,r){var a=r.duration,s=r.creationTime||0,o=r.modificationTime||0,u=r.timescale||0,c=r.nextTrackId||1;r.fragment&&(c=2);var f=BigInt(n.f7);n.f7,f=o<n.f7?0:1,e.writeUint32(1===f?120:108),e.writeString("mvhd"),e.writeUint8(f),e.writeUint24(0),1===f?(e.writeUint64(s),e.writeUint64(o)):(e.writeUint32(Number(s)),e.writeUint32(Number(o))),e.writeUint32(u),1===f?e.writeUint64(a):e.writeUint32(Number(a)),e.writeUint32(65536),e.writeUint16(256),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),(0,i.A)(e,1,0,0,1,0,0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(c)}},65629:(e,t,r)=>{"use strict";function n(e,t,r){e.writeUint32(16),e.writeString("pasp"),e.writeUint32(1),e.writeUint32(1)}r.d(t,{A:()=>n})},11573:(e,t,r)=>{"use strict";function n(e,t,r){e.writeUint32(16),e.writeString("smhd"),e.writeUint32(0),e.writeUint16(0),e.writeUint16(0)}r.d(t,{A:()=>n})},2204:(e,t,r)=>{"use strict";function n(e,t,r){var n=t.privData.chunkOffsets||[];e.writeUint32(16+4*n.length),e.writeString("stco"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(n.length);for(var i=0;i<n.length;i++)e.writeUint32(Number(n[i]))}r.d(t,{A:()=>n})},84360:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(4624),i="src/avformat/formats/mov/writing/stsc.ts";function a(e,t,r){var a=t.privData,s=a.stscFirstChunk,o=a.stscSamplesPerChunk,u=a.stscSampleDescriptionIndex;s.length===o.length&&s.length===u.length||n.R8("ctts firstChunk's length is not match samplesPerChunk's length or sampleDescriptionIndex's length",i,42);var c=Math.min(s.length,o.length,u.length);e.writeUint32(16+12*c),e.writeString("stsc"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(c);for(var f=0;f<c;f++)e.writeUint32(s[f]),e.writeUint32(o[f]),e.writeUint32(u[f])}},69301:(e,t,r)=>{"use strict";r.d(t,{A:()=>b});var n=r(134),i=r(61600),a=r(78669),s=r(1263),o=r(99193),u=r(39878),c=r(47280),f=r(82181),h=r(4652),d=r(853),l=r(65629),p=r(93861),v=r(57756),m=r(80648),g=r(55668),A=r(14686),y=r(61619),x=(0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)({},27,"avc1"),173,"hvc1"),196,"vvc1"),225,"av01"),167,"vp09"),86019,"ac-3"),86056,"ec-3");function k(e){if(e.codecTag)return(0,y.A)(e.codecTag);var t=x[e.codecId];return t||(t=0===e.codecType?"mp4v":1===e.codecType?86076===e.codecId?"Opus":86028===e.codecId?"fLaC":"mp4a":3===e.codecType?"text":"none"),t}function b(e,t,r){var n=e.getPos();e.writeUint32(0),e.writeString("stsd"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(1),1===t.codecpar.codecType?function(e,t,r){var n=e.getPos(),i=k(t.codecpar),a=r.isom?1:0;e.writeUint32(0),e.writeString(i),e.writeUint32(0),e.writeUint16(0),e.writeUint16(1),e.writeUint16(a),e.writeUint16(0),e.writeUint32(0),r.isom?(e.writeUint16(t.codecpar.chLayout.nbChannels),65541===t.codecpar.codecId||65540===t.codecpar.codecId?e.writeUint16(8):69643===t.codecpar.codecId?e.writeUint16(t.codecpar.bitsPerCodedSample):e.writeUint16(16),e.writeUint16(-2)):(86028===t.codecpar.codecId||86032===t.codecpar.codecId||86076===t.codecpar.codecId?e.writeUint16(t.codecpar.chLayout.nbChannels):e.writeUint16(2),86028===t.codecpar.codecId||86032===t.codecpar.codecId?e.writeUint16(t.codecpar.bitsPerCodedSample):e.writeUint16(16),e.writeUint16(0)),e.writeUint16(0),86076===t.codecpar.codecId?e.writeUint16(48e3):86060===t.codecpar.codecId?e.writeUint32(t.codecpar.sampleRate):e.writeUint16(t.codecpar.sampleRate),86060!==t.codecpar.codecId&&e.writeUint16(0),1===a&&(e.writeUint32(t.codecpar.frameSize),e.writeUint32(0),e.writeUint32(0),e.writeUint32(2)),!r.isom||86018!==t.codecpar.codecId&&86019!==t.codecpar.codecId&&86056!==t.codecpar.codecId&&73728!==t.codecpar.codecId&&86032!==t.codecpar.codecId&&69638!==t.codecpar.codecId&&69633!==t.codecpar.codecId&&86035!==t.codecpar.codecId?86028===t.codecpar.codecId?(0,c.A)(e,t,r):86076===t.codecpar.codecId?(0,f.A)(e,t,r):86019===t.codecpar.codecId?(0,m.A)(e,t,r):86056===t.codecpar.codecId?(0,g.A)(e,t,r):"mp4a"==i&&(0,h.A)(e,t,r):(0,v.A)(e,t,r),r.isom||(0,p.A)(e,t,r),r.boxsPositionInfo.push({pos:n,type:i,size:Number(e.getPos()-n)})}(e,t,r):0===t.codecpar.codecType?function(e,t,r){var n=e.getPos(),c=k(t.codecpar),f=13==t.codecpar.codecId&&15==t.codecpar.format||13==t.codecpar.codecId&&1==t.codecpar.format||202==t.codecpar.codecId||203==t.codecpar.codecId||156==t.codecpar.codecId||127==t.codecpar.codecId;e.writeUint32(0),e.writeString(c),e.writeUint32(0),e.writeUint16(0),e.writeUint16(1),e.writeUint16(f?2:0),e.writeUint16(0),r.isom?(e.writeString("FFMP"),13===t.codecpar.codecId||f?(e.writeUint32(0),e.writeUint32(1024)):(e.writeUint32(512),e.writeUint32(512))):(e.writeUint32(0),e.writeUint32(0),e.writeUint32(0)),e.writeUint16(t.codecpar.width),e.writeUint16(t.codecpar.height),e.writeUint32(4718592),e.writeUint32(4718592),e.writeUint32(0),e.writeUint16(1);var v=t.metadata.compressorName||"";if(v=v.slice(0,31),e.writeUint8(v.length),e.writeString(v),v.length<31)for(var m=31-v.length;m>0;)e.writeUint8(0),m--;r.isom&&t.codecpar.bitsPerCodedSample?e.writeUint16(t.codecpar.bitsPerCodedSample):e.writeUint16(24),e.writeUint16(65535),"mp4v"===c?(0,h.A)(e,t,r):27===t.codecpar.codecId?(0,i.A)(e,t,r):173===t.codecpar.codecId?(0,a.A)(e,t,r):196===t.codecpar.codecId?(0,s.A)(e,t,r):167===t.codecpar.codecId?(0,o.A)(e,t,r):225===t.codecpar.codecId&&(0,u.A)(e,t,r),(0,d.A)(e,t,r),(0,l.A)(e,t,r),r.isom||(0,p.A)(e,t,r),r.boxsPositionInfo.push({pos:n,type:c,size:Number(e.getPos()-n)})}(e,t,r):3===t.codecpar.codecType&&function(e,t,r){var n=e.getPos(),i=k(t.codecpar);e.writeUint32(0),e.writeString(i),e.writeUint32(0),e.writeUint16(0),e.writeUint16(1),94208===t.codecpar.codecId?(0,h.A)(e,t,r):t.codecpar.extradata&&e.writeBuffer((0,A.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),r.isom||(0,p.A)(e,t,r),r.boxsPositionInfo.push({pos:n,type:i,size:Number(e.getPos()-n)})}(e,t,r),r.boxsPositionInfo.push({pos:n,type:"esds",size:Number(e.getPos()-n)})}},20184:(e,t,r)=>{"use strict";function n(e,t,r){var n=t.privData.stssSampleNumbers;e.writeUint32(16+4*n.length),e.writeString("stss"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(n.length);for(var i=0;i<n.length;i++)e.writeUint32(n[i])}r.d(t,{A:()=>n})},57247:(e,t,r)=>{"use strict";function n(e,t,r){var n=t.privData.sampleSizes;e.writeUint32(20+4*n.length),e.writeString("stsz"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(0),e.writeUint32(n.length);for(var i=0;i<n.length;i++)e.writeUint32(n[i])}r.d(t,{A:()=>n})},86051:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(4624),i="src/avformat/formats/mov/writing/stts.ts";function a(e,t,r){var a=t.privData,s=a.sttsSampleCounts||[],o=a.sttsSampleDeltas||[];s.length!==o.length&&n.R8("stts sampleCounts's length is not match sampleDeltas's length",i,39);var u=Math.min(s.length,o.length);e.writeUint32(16+8*u),e.writeString("stts"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(u);for(var c=0;c<u;c++)e.writeUint32(s[c]),e.writeInt32(o[c])}},11251:(e,t,r)=>{"use strict";function n(e,t,r){var n=r.currentFragment.tracks.find((function(e){return e.trackId===t.privData.trackId})),i=n?n.baseMediaDecodeTime:BigInt(0);e.writeUint32(20),e.writeString("tfdt"),e.writeUint8(1),e.writeUint24(0),e.writeUint64(i)}r.d(t,{A:()=>n})},11903:(e,t,r)=>{"use strict";function n(e,t,r){var n=r.currentFragment.tracks.find((function(e){return e.trackId===t.privData.trackId})),i=57;n.baseIsMoof&&(i&=-2,i|=131072);var a=e.getPos();e.writeUint32(0),e.writeString("tfhd"),e.writeUint8(0),e.writeUint24(i),e.writeUint32(n.trackId),1&i&&e.writeUint64(n.baseDataOffset),8&i&&e.writeUint32(n.defaultSampleDuration),16&i&&e.writeUint32(n.defaultSampleSize),32&i&&e.writeUint32(n.defaultSampleFlags),r.boxsPositionInfo.push({pos:a,type:"tfhd",size:Number(e.getPos()-a)})}r.d(t,{A:()=>n})},59868:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(77231),i=r(87384),a=r(44328);function s(e,t,r){var s=t.privData,o=(0,a.k)(s.lastPts,t.timeBase,{den:r.timescale,num:1}),u=t.metadata.creationTime||0,c=t.metadata.modificationTime||0,f=s.layer||0,h=s.alternateGroup||0,d=t.codecpar.width>0?t.codecpar.width:0,l=t.codecpar.height>0?t.codecpar.height:0;d<n.zg&&(d<<=16),l<n.zg&&(l<<=16);var p=BigInt(n.f7);n.f7,p=c<n.f7?0:1;var v=2;1&s.flags&&(v|=1),e.writeUint32(1===p?100:92),e.writeString("tkhd"),e.writeUint8(p),e.writeUint24(v),1===p?(e.writeUint64(u),e.writeUint64(c)):(e.writeUint32(Number(u)),e.writeUint32(Number(c))),e.writeUint32(s.trackId),e.writeUint32(0),1===p?e.writeUint64(o):e.writeUint32(Number(o)),e.writeUint32(0),e.writeUint32(0),e.writeInt16(f),e.writeInt16(s.perStreamGrouping?h:t.codecpar.codecType),1===t.codecpar.codecType?e.writeInt16(256):e.writeInt16(0),e.writeInt16(0),(0,i.A)(e,1,0,0,1,0,0),e.writeUint32(d),e.writeUint32(l)}},35010:(e,t,r)=>{"use strict";function n(e,t,r){var n,i,a,s=r.currentFragment.tracks.find((function(e){return e.trackId===t.privData.trackId})),o=r.trexs.find((function(e){e.trackId,t.privData.trackId})),u=null!==(n=null==o?void 0:o.duration)&&void 0!==n?n:0,c=null!==(i=null==o?void 0:o.size)&&void 0!==i?i:0,f=null!==(a=null==o?void 0:o.flags)&&void 0!==a?a:0;e.writeUint32(32),e.writeString("trex"),e.writeUint8(0),e.writeUint24(0),e.writeUint32(s.trackId),e.writeUint32(1),e.writeUint32(u),e.writeUint32(c),e.writeUint32(f)}r.d(t,{A:()=>n})},48516:(e,t,r)=>{"use strict";function n(e,t,r){var n=t.privData,i=r.currentFragment.tracks.find((function(e){return e.trackId===n.trackId})),a=i.firstSampleFlags||0,s=i.dataOffset||0,o=i.sampleDurations,u=i.sampleSizes,c=i.sampleFlags,f=i.sampleCompositionTimeOffset,h=i.sampleCount,d=o.length>0,l=u.length>0,p=c.length>0,v=f.length>0,m=0!==a,g=1;m&&(g|=4),d&&(g|=256),l&&(g|=512),p&&(g|=1024),v&&(g|=2048);var A=e.getPos();e.writeUint32(0),e.writeString("trun"),e.writeUint8(1),e.writeUint24(g),e.writeUint32(h),i.dataOffsetPos=e.getPos(),e.writeInt32(s),m&&e.writeUint32(a);for(var y=0;y<h;y++)d&&e.writeUint32(o[y]||0),l&&e.writeUint32(u[y]||0),p&&e.writeUint32(c[y]||0),v&&e.writeInt32(f[y]||0);r.boxsPositionInfo.push({pos:A,type:"trun",size:Number(e.getPos()-A)})}r.d(t,{A:()=>n})},54012:(e,t,r)=>{"use strict";function n(e,t,r){e.writeUint32(20),e.writeString("vmhd"),e.writeUint8(0),e.writeUint24(1),e.writeUint64(BigInt(0))}r.d(t,{A:()=>n})},99193:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(14686);function i(e,t,r){var i;e.writeUint32(null!==(i=12+t.codecpar.extradataSize)&&void 0!==i?i:0),e.writeString("vpcC"),e.writeUint8(1),e.writeUint24(0),r.fragment&&t.sideData[1]?(e.writeBuffer(t.sideData[1]),delete t.sideData[1]):t.codecpar.extradata&&e.writeBuffer((0,n.s3)(t.codecpar.extradata,t.codecpar.extradataSize))}},1263:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(14686);function i(e,t,r){var i;e.writeUint32(null!==(i=8+t.codecpar.extradataSize)&&void 0!==i?i:0),e.writeString("vvcC"),e.writeUint8(0),e.writeUint24(0),r.fragment&&t.sideData[1]?(e.writeBuffer(t.sideData[1]),delete t.sideData[1]):t.codecpar.extradata&&e.writeBuffer((0,n.s3)(t.codecpar.extradata,t.codecpar.extradataSize))}},57756:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(14686),i=r(4652);function a(e,t,r){var a=e.getPos();e.writeUint32(0),e.writeString("wave"),86035!==t.codecpar.codecId&&(e.writeUint32(12),e.writeString("frma"),e.writeUint32(t.codecpar.codecTag)),86018===t.codecpar.codecId?(e.writeUint32(12),e.writeString("mp4a"),e.writeUint32(0),(0,i.A)(e,t,r)):r.fragment&&t.sideData[1]?(e.writeBuffer(t.sideData[1]),delete t.sideData[1]):t.codecpar.extradata&&e.writeBuffer((0,n.s3)(t.codecpar.extradata,t.codecpar.extradataSize)),e.writeUint32(8),e.writeUint32(0),r.boxsPositionInfo.push({pos:a,type:"wave",size:Number(e.getPos()-a)})}},80025:(e,t,r)=>{"use strict";r.d(t,{A:()=>S});var n,i=r(134),a=r(86051),s=r(18387),o=r(20184),u=r(57247),c=r(84360),f=r(2204),h=r(34445),d=r(6e3),l=r(7114),p=r(59868),v=r(17923),m=r(69301),g=r(54012),A=r(44473),y=r(11573),x=r(12412),k=r(35010),b=r(31130),w=r(11903),_=r(11251),T=r(48516),I=r(48669);const S=(n={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,"stts",a.A),"ctts",s.A),"stss",o.A),"stsz",u.A),"stsc",c.A),"stco",f.A),"co64",h.A),"mdhd",d.A),"mvhd",l.A),"tkhd",p.A),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,"hdlr",v.A),"stsd",m.A),"vmhd",g.A),"edts",A.A),"smhd",y.A),"dref",x.A),"trex",k.A),"mfhd",b.A),"tfhd",w.A),"tfdt",_.A),(0,i.A)((0,i.A)(n,"trun",T.A),"minf_hdlr",I.A))},38115:(e,t,r)=>{"use strict";r.d(t,{q:()=>o});var n=r(79331),i=r(67672),a=r(72739),s=r(54825);function o(e){var t=(0,n.A)(e,{aloneValueName:"context"});if(!t.tt)return{queue:[],head:{}};var r=[];function o(e){var t="";return a.__(e,(function(e){i.Yj(e)?t+=e:e.context?t+="<".concat(e.tagName,">").concat(e.context,"</").concat(e.tagName,">"):t+="<".concat(e.tagName,"/>")})),t}function u(e,t,n){var a,u=(0,s.j)(t||e.begin),c=e.context||"",f=e.region||"Default";i.YO(c)&&(c=o(c)),null!==(a=e.span)&&void 0!==a&&a.context&&(e.span.region&&(f=e.span.region),i.Yj(e.span.context)?c+=e.span.context:c+=o(e.span.context)),r.push({context:c,pts:u,region:f,duration:e.dur?(0,s.j)(e.dur):(0,s.j)(n||e.end)-u})}function c(e,t,r){i.YO(e)?a.__(e,(function(e){u(e,t,r)})):u(e,t,r)}return t.tt.body&&t.tt.body.div&&(i.YO(t.tt.body.div)?a.__(t.tt.body.div,(function(e){e.p&&c(e.p,e.begin,e.end)})):t.tt.body.div.p&&c(t.tt.body.div.p,t.tt.body.div.begin,t.tt.body.end)),{queue:r,head:t.tt.head||{}}}},59989:(e,t,r)=>{"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return!1;if(e.length<2)return!0;for(var r=e[t],n=t+1;n<e.length&&r===e[n];n++);return n===e.length}r.d(t,{A:()=>n})},31425:(e,t,r)=>{"use strict";r.d(t,{$:()=>s});var n=r(77231),i=r(72739),a=r(44328);function s(e){var t=!0;return i.__(e.streams,(function(e){switch(e.codecpar.codecType){case 1:e.codecpar.chLayout.nbChannels!==n.N_&&e.codecpar.sampleRate!==n.N_&&e.codecpar.frameSize!==n.N_&&e.codecpar.bitRate!==BigInt(0)||(t=!1);break;case 0:0!==(0,a.lb)(e.codecpar.framerate)&&e.codecpar.width!==n.N_&&e.codecpar.height!==n.N_&&e.codecpar.bitRate!==BigInt(0)||(t=!1),27!==e.codecpar.codecId&&173!==e.codecpar.codecId&&196!==e.codecpar.codecId&&12!==e.codecpar.codecId||e.codecpar.profile!==n.N_&&e.codecpar.level!==n.N_||(t=!1)}})),t}},61619:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(67672);function i(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r="",i=0;i<t;i++)n.ai(e)?(r=String.fromCharCode(255&e)+r,e>>>=8):(r=String.fromCharCode(Number(e&BigInt(255)))+r,e>>=BigInt(8));return r}},65977:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(4624),i="src/avformat/function/mktag.ts";function a(e){4!==e.length&&n.R8("tag length is not 4, tag: ".concat(e),i,30);for(var t=0,r=0;r<4;r++)t=t<<8|e.charCodeAt(r);return t}},20841:(e,t,r)=>{"use strict";function n(e,t,r,n){var i=e.getPos(),a=e.getPointer(),s=i-BigInt(Math.floor(a)),o=!1;switch(t<i&&t>=s?(e.seekInline(a+Number(t-i)),o=!0):e.seek(t),n){case"uint8":e.writeUint8(255&r);break;case"int8":e.writeInt8(r);break;case"uint16":e.writeUint16(65535&r);break;case"int16":e.writeInt16(r);break;case"uint32":e.writeUint32(r>>>0);break;case"int32":e.writeInt32(r);break;case"uint64":e.writeUint64(BigInt.asUintN(64,r));break;case"int64":e.writeInt64(r);break;case"float":e.writeFloat(r);break;case"double":e.writeDouble(r)}o?e.seekInline(a):e.seek(i)}r.d(t,{A:()=>n})},92174:(e,t,r)=>{"use strict";r.d(t,{XA:()=>g,bX:()=>y,bx:()=>m,dJ:()=>A,ho:()=>v});var n=r(80662),i=r.n(n),a=r(63939),s=r(50932),o=r(95335),u=r(4624),c=r(51597),f=r(72739),h=r(9705),d=r(548),l="src/avformat/mux.ts",p={paddingZero:!1};function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.extend({},p,t);e.ioWriter||u.h2("need ioWriter",l,52),e.oformat||u.h2("need oformat",l,55),e.options=r,e.processPrivateData={first:new(i())};var n=c.E[e.oformat.type];if(n)for(var a=0;a<e.streams.length;a++){var s=e.streams[a].codecpar.codecId;if(13===e.oformat.type){if(s<65536||s>69683)return u.z3("format ".concat((0,d.L_)(e.oformat.type)," not support codecId ").concat((0,d.eG)(e.streams[a].codecpar.codecType,s)),l,71),h.r8}else if(!f.zy(n,s))return u.z3("format ".concat((0,d.L_)(e.oformat.type)," not support codecId ").concat((0,d.eG)(e.streams[a].codecpar.codecType,s)),l,76),h.r8}return e.oformat.init(e)}function m(e){return e.oformat.writeHeader(e),0}function g(e,t){var r=e.processPrivateData;return r.first.has(a.f[15](t+32))||(a.f[17](t+16)>BigInt(0)?r.first.set(a.f[15](t+32),a.f[17](t+16)):r.first.set(a.f[15](t+32),BigInt(0))),e.options.paddingZero&&(s.M[17](t+16,a.f[17](t+16)-r.first.get(a.f[15](t+32))),s.M[17](t+8,a.f[17](t+8)-r.first.get(a.f[15](t+32)))),e.oformat.writeAVPacket(e,t)}function A(e){return e.oformat.writeTrailer(e),0}function y(e){e.oformat.flush(e)}},77580:(e,t,r)=>{"use strict";r.d(t,{A:()=>_});var n=r(88435),i=r.n(n),a=r(25182),s=r(78716),o=r(81570),u=r(77193),c=r(25767),f=r(43070),h=r(31060),d=r(134),l=r(36443),p=r.n(l),v=r(29967),m=r.n(v),g=r(13724),A=r(82800),y=r(95335),x=r(4624);function k(e,t,r){return t=(0,c.A)(t),(0,u.A)(e,b()?i()(t,r||[],(0,c.A)(e).constructor):t.apply(e,r))}function b(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}var w="src/avnetwork/ioLoader/FetchIOLoader.ts",_=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.A)(this,t),e=k(this,t,[r]),(0,d.A)((0,f.A)(e),"contentLength",void 0),(0,d.A)((0,f.A)(e),"receivedLength",void 0),(0,d.A)((0,f.A)(e),"info",void 0),(0,d.A)((0,f.A)(e),"range",void 0),(0,d.A)((0,f.A)(e),"startBytes",void 0),(0,d.A)((0,f.A)(e),"endBytes",void 0),(0,d.A)((0,f.A)(e),"eofIndex",void 0),(0,d.A)((0,f.A)(e),"abortController",void 0),(0,d.A)((0,f.A)(e),"reader",void 0),(0,d.A)((0,f.A)(e),"buffers",void 0),e}var r,n,i,u,c,l,v,A;return(0,h.A)(t,e),(0,o.A)(t,[{key:"open",value:(A=(0,a.A)(p().mark((function e(t,r){var n,i,a,s;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.info=t,this.range=r,this.range.to||(this.range.to=-1),this.range.from=Math.max(this.range.from,0),this.eofIndex<0&&(this.eofIndex=r.to),this.startBytes=0,this.endBytes=-1,this.receivedLength=0,this.buffers=[],this.range&&!this.options.isLive&&(this.startBytes=null!==(n=this.range.from)&&void 0!==n?n:0),this.status=1,this.options.isLive||this.options.disableSegment){e.next=27;break}return i={method:"HEAD",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"},this.info.headers&&y.each(this.info.headers,(function(e,t){i.headers[t]=e})),this.info.withCredentials&&(i.credentials="include"),this.info.referrerPolicy&&(i.referrerPolicy=this.info.referrerPolicy),AbortController&&(this.abortController=new AbortController,i.signal=this.abortController.signal),e.prev=17,e.next=20,fetch(this.info.url,i);case 20:(a=e.sent).ok&&a.status>=200&&a.status<=299?(null!=(s=a.headers.get("X-Content-Length")||a.headers.get("Content-Length"))&&(this.contentLength=m()(s),this.range.to<0&&(this.eofIndex=this.contentLength+this.range.to)),this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex),this.status=2):this.endBytes=-1,e.next=27;break;case 24:e.prev=24,e.t0=e.catch(17),this.endBytes=-1;case 27:case"end":return e.stop()}}),e,this,[[17,24]])}))),function(e,t){return A.apply(this,arguments)})},{key:"openReader",value:(v=(0,a.A)(p().mark((function e(){var t,r;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"},this.info.headers&&y.each(this.info.headers,(function(e,r){t.headers[r]=e})),this.options.isLive||this.options.disableSegment||(t.headers.range="bytes=".concat(this.startBytes,"-").concat(this.endBytes>0?this.endBytes:"")),this.info.withCredentials&&(t.credentials="include"),this.info.referrerPolicy&&(t.referrerPolicy=this.info.referrerPolicy),this.abortController&&this.abortController.abort(),"function"==typeof AbortController&&(this.abortController=new AbortController,t.signal=this.abortController.signal),e.prev=7,e.next=10,fetch(this.info.url,t);case 10:(r=e.sent).ok&&r.status>=200&&r.status<=299?this.reader=r.body.getReader():(this.status=3,x.h2("FetchStreamLoader: Http code invalid, ".concat(r.status," ").concat(r.statusText),w,189)),e.next=25;break;case 14:if(e.prev=14,e.t0=e.catch(7),!(this.retryCount<this.options.retryCount)||this.options.isLive&&this.receivedLength){e.next=24;break}return this.retryCount++,this.status=1,e.next=21,new g.A(this.options.retryInterval);case 21:return e.abrupt("return",this.openReader());case 24:x.h2("FetchStreamLoader: exception ".concat(e.t0.message),w,202);case 25:case"end":return e.stop()}}),e,this,[[7,14]])}))),function(){return v.apply(this,arguments)})},{key:"readInterval",value:(l=(0,a.A)(p().mark((function e(t){var r,n,i,a,s,o=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=o.length>1&&void 0!==o[1]?o[1]:0,n=0;this.buffers.length&&n<t.length;)(i=this.buffers.shift()).length>t.length-n?(t.set(i.subarray(0,t.length-n),n),this.buffers.unshift(i.subarray(t.length-n)),n=t.length):(t.set(i,n),n+=i.length);if(!(n>=t.length)){e.next=5;break}return e.abrupt("return",t.length+r);case 5:if(4!==this.status){e.next=7;break}return e.abrupt("return",n>0?n+r:r>0?r:-1048576);case 7:if(this.reader){e.next=10;break}return e.next=10,this.openReader();case 10:return e.next=12,this.reader.read();case 12:if(a=e.sent,s=a.value,!a.done){e.next=36;break}if(!(null!==this.contentLength&&this.receivedLength+this.range.from<this.endBytes+1)){e.next=21;break}this.status=3,x.h2("Fetch stream meet Early-EOF",w,241),e.next=34;break;case 21:if(!(this.options.isLive||this.options.disableSegment||this.receivedLength+this.range.from>=this.eofIndex)){e.next=27;break}return this.status=4,this.startBytes=0,e.abrupt("return",n>0?n+r:r>0?r:-1048576);case 27:return e.next=29,this.reader.cancel();case 29:return this.abortController&&this.abortController.abort(),this.reader=null,this.startBytes=this.endBytes+1,this.endBytes=Math.min(this.startBytes+this.options.preload-1,this.eofIndex),e.abrupt("return",this.readInterval(t.subarray(n),n));case 34:e.next=46;break;case 36:if(this.receivedLength+=s.length,!(s.length>t.length-n)){e.next=43;break}return t.set(s.subarray(0,t.length-n),n),this.buffers.push(s.subarray(t.length-n)),e.abrupt("return",t.length+r);case 43:return t.set(s,n),n+=s.length,e.abrupt("return",n+r);case 46:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"read",value:(c=(0,a.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readInterval(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"seek",value:(u=(0,a.A)(p().mark((function e(t){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.abort();case 2:this.receivedLength=Number(t)-this.range.from,this.startBytes=Number(t),this.options.disableSegment||(this.endBytes=Math.min(this.startBytes+this.options.preload,this.eofIndex)),this.buffers.length=0,4===this.status&&(this.status=2);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"size",value:(i=(0,a.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.options.isLive){e.next=2;break}return e.abrupt("return",BigInt(0));case 2:return e.abrupt("return",BigInt(Math.floor(this.contentLength||0)));case 3:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"abort",value:(n=(0,a.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reader){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.reader.cancel();case 4:this.abortController&&this.abortController.abort(),this.reader=null;case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"stop",value:(r=(0,a.A)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.abort();case 2:this.status=0;case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}]),t}(A.A)},79686:(e,t,r)=>{"use strict";r.d(t,{A:()=>k});var n=r(88435),i=r.n(n),a=r(25182),s=r(78716),o=r(81570),u=r(77193),c=r(25767),f=r(43070),h=r(31060),d=r(134),l=r(54001),p=r.n(l),v=r(36443),m=r.n(v),g=r(82800),A=r(67672);function y(e,t,r){return t=(0,c.A)(t),(0,u.A)(e,x()?i()(t,r||[],(0,c.A)(e).constructor):t.apply(e,r))}function x(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}var k=function(e){function t(){var e;(0,s.A)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=y(this,t,[].concat(n)),(0,d.A)((0,f.A)(e),"info",void 0),(0,d.A)((0,f.A)(e),"range",void 0),(0,d.A)((0,f.A)(e),"readPos",void 0),(0,d.A)((0,f.A)(e),"endPos",void 0),(0,d.A)((0,f.A)(e),"reader",void 0),(0,d.A)((0,f.A)(e),"readerResolve",void 0),e}var r,n,i,u,c,l,v;return(0,h.A)(t,e),(0,o.A)(t,[{key:"open",value:(v=(0,a.A)(m().mark((function e(t,r){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.info=t,this.range=r,this.readPos=0,this.endPos=this.info.file.size,r.from>0&&(this.readPos=r.from),r.to>0&&(this.endPos=r.to),this.status=2;case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"readBufferByReader",value:(l=(0,a.A)(m().mark((function e(t){var r,n=this;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.reader||(this.reader=new FileReader,this.reader.onloadend=function(e){n.readerResolve&&n.readerResolve(e.target.result)}),r=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice,e.abrupt("return",new(p())((function(e){n.readerResolve=e,n.reader.readAsArrayBuffer(r.call(n.info.file,n.readPos,n.readPos+t))})));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"read",value:(c=(0,a.A)(m().mark((function e(t){var r;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.readPos>=this.endPos)){e.next=3;break}return this.status,e.abrupt("return",-1048576);case 3:if(r=Math.min(t.length,this.endPos-this.readPos),!A.Pc(Blob.prototype.arrayBuffer)){e.next=14;break}return e.t0=t,e.t1=Uint8Array,e.next=9,this.info.file.slice(this.readPos,this.readPos+r).arrayBuffer();case 9:e.t2=e.sent,e.t3=new e.t1(e.t2),e.t0.set.call(e.t0,e.t3,0),e.next=21;break;case 14:return e.t4=t,e.t5=Uint8Array,e.next=18,this.readBufferByReader(r);case 18:e.t6=e.sent,e.t7=new e.t5(e.t6),e.t4.set.call(e.t4,e.t7,0);case 21:return this.readPos+=r,this.readPos>=this.endPos&&(this.status=4),e.abrupt("return",r);case 24:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"seek",value:(u=(0,a.A)(m().mark((function e(t){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.abort();case 2:return this.readPos=Number(t),4===this.status&&(this.status=2),e.abrupt("return",0);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"size",value:(i=(0,a.A)(m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",BigInt(Math.floor(this.info.file.size)));case 1:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"abort",value:(n=(0,a.A)(m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"stop",value:(r=(0,a.A)(m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.abort();case 2:this.status=0;case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}]),t}(g.A)},82800:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(81570),i=r(78716),a=r(134),s=r(95335),o={isLive:!0,preload:5242880,retryCount:20,retryInterval:1},u=(0,n.A)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.A)(this,e),(0,a.A)(this,"options",void 0),(0,a.A)(this,"status",void 0),(0,a.A)(this,"retryCount",void 0),(0,a.A)(this,"retryTimeout",void 0),this.options=t,this.status=0,this.retryCount=0,this.options=s.extend({},o),s.extend(this.options,t)}))},18667:(e,t,r)=>{"use strict";r.d(t,{A:()=>J});var n=r(88435),i=r.n(n),a=r(69736),s=r.n(a),o=r(44301),u=r.n(o),c=r(82731),f=r.n(c),h=r(59614),d=r.n(h),l=r(969),p=r.n(l),v=r(66681),m=r.n(v),g=r(25182),A=r(134),y=r(78716),x=r(81570),k=r(77193),b=r(25767),w=r(31060),_=r(54001),T=r.n(_),I=r(36443),S=r.n(I),P=r(63939),B=r(50932),C=r(12264),M=r(29170),R=r(9599),U=r(44527),E=r(9705),D=r(84149),L=r(75742),F=r(4624),O=r(16041),N=r(77104),z=r(84290),V=r(72739),W=r(86932),j=r(36204),G=r(44328),q=r(77231);function H(e,t){var r=s()(e);if(u()){var n=u()(e);t&&(n=n.filter((function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){(0,A.A)(e,t,r[t])})):d()?p()(e,d()(r)):H(Object(r)).forEach((function(t){m()(e,t,f()(r,t))}))}return e}function Q(e,t,r){return t=(0,b.A)(t),(0,k.A)(e,$()?i()(t,r||[],(0,b.A)(e).constructor):t.apply(e,r))}function $(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return($=function(){return!!e})()}var K="src/avpipeline/AudioDecodePipeline.ts",J=function(e){function t(){return(0,y.A)(this,t),Q(this,t)}var r,n,i,a,s;return(0,w.A)(t,e),(0,x.A)(t,[{key:"createWebcodecDecoder",value:function(e){return new N.A({onError:function(t){F.z3("audio decode error, taskId: ".concat(e.taskId,", error: ").concat(t),K,86),e.openReject&&(e.openReject(E.r8),e.openReject=null)},onReceiveFrame:function(t){var r=(0,j.t)(t,e.avframePool.alloc());B.M[17](r+104,(0,G.k)(P.f[17](r+104),q.KR,e.timeBase)),B.M[15](r+124,e.timeBase.den),B.M[15](r+120,e.timeBase.num),e.frameCaches.push(r),B.M[17](e.stats+56,P.f[17](e.stats+56)+BigInt(1)),e.lastDecodeTimestamp&&B.M[15](e.stats+240,Math.max((0,W.A)()-e.lastDecodeTimestamp,P.f[15](e.stats+240))),e.lastDecodeTimestamp=(0,W.A)(),t.close()}})}},{key:"createWasmcodecDecoder",value:function(e,t){return new L.A({resource:t,onError:function(t){F.z3("audio decode error, taskId: ".concat(e.taskId,", error: ").concat(t),K,117),e.openReject&&(e.openReject(E.r8),e.openReject=null)},onReceiveFrame:function(t){e.frameCaches.push(t),B.M[17](e.stats+56,P.f[17](e.stats+56)+BigInt(1)),e.lastDecodeTimestamp&&B.M[15](e.stats+240,Math.max((0,W.A)()-e.lastDecodeTimestamp,P.f[15](e.stats+240))),e.lastDecodeTimestamp=(0,W.A)()},avframePool:e.avframePool})}},{key:"createTask",value:function(e){var t=new D.Ay(e.leftPort),r=new D.Ay(e.rightPort),n=[],i=new O.A((0,M.A)(e.avframeList,C.A),e.avframeListMutex),a=Y(Y({},e),{},{frameCaches:n,inputEnd:!1,decoder:null,parameters:0,lastDecodeTimestamp:0,avframePool:i,avpacketPool:new z.A((0,M.A)(e.avpacketList,C.A),e.avpacketListMutex),openReject:null});return e.resource?a.decoder=this.createWasmcodecDecoder(a,e.resource):a.decoder=this.createWebcodecDecoder(a),this.tasks.set(e.taskId,a),r.on(D.S3,function(){var i=(0,g.A)(S().mark((function i(s){var o,u,c,f,h;return S().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=s.method,i.next="pull"===i.t0?3:48;break;case 3:if(!n.length){i.next=9;break}return o=n.shift(),r.reply(s,o),i.abrupt("break",48);case 9:if(a.inputEnd){i.next=46;break}case 10:if(!n.length){i.next=15;break}return u=n.shift(),r.reply(s,u),i.abrupt("break",45);case 15:return i.next=17,t.request("pull");case 17:if(-1048576!==(c=i.sent)){i.next=33;break}return i.next=21,a.decoder.flush();case 21:if(a.inputEnd=!0,!n.length){i.next=28;break}return f=n.shift(),r.reply(s,f),i.abrupt("break",45);case 28:return F.pq("audio decoder ended, taskId: ".concat(a.taskId),K,198),r.reply(s,-1048576),i.abrupt("break",45);case 31:i.next=43;break;case 33:if(!(c>0)){i.next=40;break}return h=a.decoder.decode(c,(0,G.k)(P.f[17](c+8),(0,M.A)(c+72,R.P),q.KR)),a.avpacketPool.release(c),h<0&&(B.M[15](a.stats+48,P.f[15](a.stats+48)+1),F.z3("audio decode error, taskId: ".concat(e.taskId,", ret: ").concat(h),K,211)),i.abrupt("continue",10);case 40:return F.z3("audio decode pull avpacket error, taskId: ".concat(e.taskId,", ret: ").concat(c),K,216),r.reply(s,c),i.abrupt("break",45);case 43:i.next=10;break;case 45:return i.abrupt("break",48);case 46:return r.reply(s,-1048576),i.abrupt("break",48);case 48:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}()),0}},{key:"open",value:(s=(0,g.A)(S().mark((function e(t,r){var n,i,a=arguments;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>2&&void 0!==a[2]?a[2]:{},!(i=this.tasks.get(t))){e.next=5;break}return i.wasmDecoderOptions=n,e.abrupt("return",new(T())(function(){var e=(0,g.A)(S().mark((function e(t,n){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.openReject=t,e.prev=1,e.next=4,i.decoder.open(r,i.wasmDecoderOptions);case 4:i.parameters=r,e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(1),F.z3("open audio decoder failed, error: ".concat(e.t0),K,243),t(E.r8),e.abrupt("return");case 12:t(0);case 13:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,r){return e.apply(this,arguments)}}()));case 5:F.h2("task not found",K,250);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"reopenDecoder",value:(a=(0,g.A)(S().mark((function e(t,r,n,i){var a,s;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=this.tasks.get(t))){e.next=5;break}return i&&(a.wasmDecoderOptions=i),s=n?this.createWasmcodecDecoder(a,n):this.createWebcodecDecoder(a),e.abrupt("return",new(T())(function(){var e=(0,g.A)(S().mark((function e(t,n){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.openReject=t,e.prev=1,e.next=4,s.open(r);case 4:a.parameters=r,a.decoder.close(),a.decoder=s,F.Yz("reopen audio decoder, taskId: ".concat(a.taskId),K,274),e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(1),F.z3("reopen audio decoder failed, error: ".concat(e.t0),K,277),t(E.r8),e.abrupt("return");case 15:t(0);case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,r){return e.apply(this,arguments)}}()));case 5:F.h2("task not found",K,284);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return a.apply(this,arguments)})},{key:"resetTask",value:(i=(0,g.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=10;break}if(!r.decoder){e.next=5;break}return e.next=5,r.decoder.flush();case 5:V.__(r.frameCaches,(function(e){r.avframePool.release(e)})),r.frameCaches.length=0,r.inputEnd=!1,r.lastDecodeTimestamp=(0,W.A)(),F.pq("reset audio decoder, taskId: ".concat(r.taskId),K,300);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"registerTask",value:(n=(0,g.A)(S().mark((function e(t){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tasks.has(t.taskId)){e.next=2;break}return e.abrupt("return",E.lh);case 2:return e.abrupt("return",this.createTask(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unregisterTask",value:(r=(0,g.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))&&(r.rightPort.close(),r.leftPort.close(),r.decoder.close(),r.frameCaches.forEach((function(e){r.avframePool.release(e)})),this.tasks.delete(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]),t}(U.A)},59377:(e,t,r)=>{"use strict";r.d(t,{A:()=>ge});var n=r(88435),i=r.n(n),a=r(69736),s=r.n(a),o=r(44301),u=r.n(o),c=r(82731),f=r.n(c),h=r(59614),d=r.n(h),l=r(969),p=r.n(l),v=r(66681),m=r.n(v),g=r(42096),A=r.n(g),y=r(75062),x=r.n(y),k=r(16091),b=r.n(k),w=r(68632),_=r.n(w),T=r(25182),I=r(78716),S=r(81570),P=r(77193),B=r(43070),C=r(60394),M=r(25767),R=r(31060),U=r(134),E=r(36443),D=r.n(E),L=r(80662),F=r.n(L),O=r(54001),N=r.n(O),z=r(61499),V=r(74503),W=r(12264),j=r(29170),G=r(63939),q=r(50932),H=r(94300),Y=r(44527),Q=r(9705),$=r(84149),K=r(4624),J=r(73783),X=r(16041),Z=r(92246),ee=r(10278),te=r(47442),re=r(37837),ne=r(70089),ie=r(14686),ae=r(44328),se=r(77231),oe=r(86932),ue=r(13724),ce=r(43607);function fe(e,t){var r=void 0!==x()&&e[b()]||e["@@iterator"];if(!r){if(_()(e)||(r=function(e,t){if(e){if("string"==typeof e)return he(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?A()(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?he(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function de(e,t){var r=s()(e);if(u()){var n=u()(e);t&&(n=n.filter((function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?de(Object(r),!0).forEach((function(t){(0,U.A)(e,t,r[t])})):d()?p()(e,d()(r)):de(Object(r)).forEach((function(t){m()(e,t,f()(r,t))}))}return e}function pe(e,t,r){return t=(0,M.A)(t),(0,P.A)(e,ve()?i()(t,r||[],(0,M.A)(e).constructor):t.apply(e,r))}function ve(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(ve=function(){return!!e})()}var me="src/avpipeline/AudioRenderPipeline.ts",ge=function(e){function t(){var e;return(0,I.A)(this,t),e=pe(this,t),(0,U.A)((0,B.A)(e),"avPCMBufferPool",void 0),(0,U.A)((0,B.A)(e),"avPCMBufferList",void 0),(0,U.A)((0,B.A)(e),"avPCMBufferListMutex",void 0),e.avPCMBufferList=(0,V.A)(W.A),e.avPCMBufferListMutex=(0,V.A)(J.eu),e.avPCMBufferPool=new te.A(e.avPCMBufferList,e.avPCMBufferListMutex[z.o9]),e}var r,n,i,a,s,o,u,c,f,h,d,l,p;return(0,R.A)(t,e),(0,S.A)(t,[{key:"createTask",value:(p=(0,T.A)(D().mark((function e(t){var r,n,i,a,s,o,u,c,f,h,d;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:d=function(){return(d=(0,T.A)(D().mark((function e(t){var r,n,i,s,o,f,h,d,l,p,v,m,g,A,y;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=0,!a.seeking){e.next=4;break}return e.next=4,new(N())((function(e){a.receivePCMSync=e}));case 4:if(a.enableJitterBuffer&&G.f[15](a.stats+32)/G.f[15](a.stats+236)*1e3<=G.f[15](a.jitterBuffer)&&u.setPlayRate(a.taskId,1),!a.frameEnded||!a.useStretchpitcher){e.next=11;break}for(n=0,i=0;i<a.playChannels;i++)s=a.stretchpitcher.get(i),G.f[20](G.f[20](t)+4*i)&&(n=s.receiveSamples(G.f[20](G.f[20](t)+4*i)+4*r,G.f[15](t+12)-r));if(r+n<G.f[15](t+12))for(a.stretchpitcherEnded=!0,o=0;o<a.playChannels;o++)(0,ie.sO)(G.f[20](G.f[20](t)+4*o)+r,0,4*(G.f[15](t+12)-r));return q.M[15](t+8,r),e.abrupt("return",0);case 11:if(!(r<G.f[15](t+12))){e.next=29;break}if(f=0,a.useStretchpitcher)for(d=0;d<a.playChannels;d++)l=a.stretchpitcher.get(d),G.f[20](G.f[20](t)+4*d)&&(f=l.receiveSamples(G.f[20](G.f[20](t)+4*d)+4*r,G.f[15](t+12)-r));else if(a.waitPCMBuffer){if(f=Math.min(G.f[15](a.waitPCMBuffer+8)-a.waitPCMBufferPos,G.f[15](t+12)-r)){for(h=0;h<a.playChannels;h++)(0,ie.Mr)(G.f[20](G.f[20](t)+4*h)+4*r,G.f[20](G.f[20](a.waitPCMBuffer)+4*h)+4*a.waitPCMBufferPos,4*f);a.waitPCMBufferPos+=f}G.f[15](a.waitPCMBuffer+8)===a.waitPCMBufferPos&&(a.waitAVFrame&&(q.M[20](a.waitPCMBuffer,0),q.M[15](a.waitPCMBuffer+12,0),a.avframePool.release(a.waitAVFrame),a.waitAVFrame=0),u.avPCMBufferPool.release(a.waitPCMBuffer),a.waitPCMBuffer=0)}if(!((r+=f)<G.f[15](t+12))){e.next=27;break}return e.next=18,c();case 18:if(-1048576!==(p=e.sent)){e.next=25;break}if(a.frameEnded=!0,a.useStretchpitcher){for(v=0;v<a.playChannels;v++)m=a.stretchpitcher.get(v),G.f[20](G.f[20](t)+4*v)&&(m.flush(),p=m.receiveSamples(G.f[20](G.f[20](t)+4*v)+4*r,G.f[15](t+12)-r));if(r+p<G.f[15](t+12))for(a.stretchpitcherEnded=!0,g=0;g<a.playChannels;g++)(0,ie.sO)(G.f[20](G.f[20](t)+4*g)+r,0,4*(G.f[15](t+12)-r));r+=p}return e.abrupt("break",29);case 25:if(!(p<0)){e.next=27;break}return e.abrupt("return",p);case 27:e.next=11;break;case 29:return q.M[15](t+8,r),A=((a.useStretchpitcher?a.stretchpitcher.get(0).getLatency():0)+(3*G.f[15](t+12)>>>1))/a.playSampleRate*1e3>>>0,y=ce.T9(a.currentPTS-BigInt(Math.floor(A)),BigInt(0)),q.M[17](a.stats+312,y),a.currentPTS-a.lastNotifyPTS>=BigInt(1e3)&&(a.lastNotifyPTS=a.currentPTS,a.controlIPCPort.notify("syncPts",{pts:y})),a.seekSync&&(a.seekSync(),a.seekSync=null),e.abrupt("return",0);case 36:case"end":return e.stop()}}),e)})))).apply(this,arguments)},h=function(e){return d.apply(this,arguments)},f=function(){return(f=(0,T.A)(D().mark((function e(){var t,r,n,i,s,o,c,f,h,d;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.paddingAVFrame){e.next=5;break}t=a.paddingAVFrame,a.paddingAVFrame=0,e.next=8;break;case 5:return e.next=7,a.leftIPCPort.request("pull");case 7:t=e.sent;case 8:if(-1048576!==t){e.next=14;break}for(r=0;r<a.playChannels;r++)a.stretchpitcher.get(r).flush();return K.pq("audio render ended, taskId: ".concat(a.taskId),me,203),e.abrupt("return",-1048576);case 14:if(!(t<0)){e.next=19;break}return K.z3("pull audio frame failed, taskId: ".concat(a.taskId),me,207),e.abrupt("return",t);case 19:if(1!==a.playRate||1!==a.playTempo||1!==a.playPitch||a.enableJitterBuffer?a.useStretchpitcher=!0:a.useStretchpitcher=!1,a.firstPlayed||(n=(0,ae.k)(G.f[17](t+104),a.timeBase,se.i0),a.firstPlayed=!0,K.Yz("got first audio frame, pts: ".concat(G.f[17](t+104),"(").concat(n,"ms), taskId: ").concat(a.taskId),me,229)),a.currentPTS=(0,ae.k)(G.f[17](t+104),a.timeBase,se.i0),q.M[17](a.stats+72,G.f[17](a.stats+72)+BigInt(1)),a.lastRenderTimestamp&&q.M[15](a.stats+244,Math.max((0,oe.A)()-a.lastRenderTimestamp,G.f[15](a.stats+244))),a.lastRenderTimestamp=(0,oe.A)(),i=!0,G.f[15](t+152)===a.playSampleRate&&G.f[15](t+80)===a.playFormat&&G.f[15](t+292)===a.playChannels){e.next=40;break}if(a.resampler&&((s=a.resampler.getInputPCMParameters()).format===G.f[15](t+80)&&s.sampleRate===G.f[15](t+152)||(a.resampler.close(),a.resampler=null)),a.resampler){e.next=32;break}return a.resampler=new Z.A({resource:a.resamplerResource}),e.next=32,a.resampler.open({sampleRate:G.f[15](t+152),format:G.f[15](t+80),channels:G.f[15](t+292)},{sampleRate:a.playSampleRate,format:a.playFormat,channels:a.playChannels});case 32:if(o=u.avPCMBufferPool.alloc(),!((c=a.resampler.resample(G.f[20](t+64),o,G.f[15](t+76)))<0)){e.next=37;break}return K.z3("resample error, ret: ".concat(c,", taskId: ").concat(a.taskId),me,277),e.abrupt("return",c);case 37:if(a.useStretchpitcher){for(f=0;f<a.playChannels;f++)a.stretchpitcher.get(f).sendSamples(G.f[20](G.f[20](o)+4*f),G.f[15](o+8));u.avPCMBufferPool.release(o)}else a.waitPCMBuffer=o,a.waitPCMBufferPos=0;e.next=41;break;case 40:if(a.useStretchpitcher)for(d=0;d<a.playChannels;d++)a.stretchpitcher.get(d).sendSamples(G.f[20](G.f[20](t+64)+4*d),G.f[15](t+76));else h=u.avPCMBufferPool.alloc(),q.M[15](h+8,G.f[15](t+76)),q.M[15](h+12,G.f[15](t+76)),q.M[15](h+20,G.f[15](t+152)),q.M[15](h+16,G.f[15](t+292)),q.M[20](h,G.f[20](t+64)),a.waitAVFrame=t,a.waitPCMBuffer=h,a.waitPCMBufferPos=0,i=!1;case 41:q.M[15](a.stats+4,G.f[15](t+152)),q.M[15](a.stats,G.f[15](t+292)),q.M[15](a.stats+8,G.f[15](t+76)),i&&a.avframePool.release(t);case 45:return e.abrupt("return",0);case 46:case"end":return e.stop()}}),e)})))).apply(this,arguments)},c=function(){return f.apply(this,arguments)},r=new $.Ay(t.leftPort),n=new $.Ay(t.rightPort),i=new $.Ay(t.controlPort),(a=le(le({},t),{},{leftIPCPort:r,rightIPCPort:n,controlIPCPort:i,resampler:null,stretchpitcher:new(F()),outPCMBuffer:null,waitPCMBuffer:0,waitAVFrame:0,waitPCMBufferPos:0,frameEnded:!1,stretchpitcherEnded:!1,playRate:1,playTempo:1,playPitch:1,useStretchpitcher:!1,lastNotifyPTS:BigInt(0),currentPTS:se.Dh,firstPlayed:!1,seeking:!1,pausing:!1,seekSync:null,receivePCMSync:null,paddingAVFrame:0,fakePlayStartTimestamp:0,fakePlaySamples:BigInt(0),fakePlayTimer:null,fakePlay:!1,lastRenderTimestamp:0,avframePool:new X.A((0,j.A)(t.avframeList,W.A),t.avframeListMutex)})).startPTS=(0,ae.k)(a.startPTS,a.timeBase,se.i0),s=0;case 10:if(!(s<t.playChannels)){e.next=21;break}return o=new ne.A({resource:t.stretchpitcherResource}),a.stretchpitcher.set(s,o),e.next=15,o.open({sampleRate:t.playSampleRate,channels:1});case 15:o.setTempo(a.playTempo),o.setPitch(a.playPitch),o.setRate(a.playRate);case 18:s++,e.next=10;break;case 21:return u=this,n.on($.S3,function(){var e=(0,T.A)(D().mark((function e(t){var r,i,s,o,u,c,f;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.method,e.next="pull"===e.t0?3:"pullBuffer"===e.t0?13:28;break;case 3:if(a.fakePlay&&(a.fakePlay=!1,a.fakePlayTimer&&(clearTimeout(a.fakePlayTimer),a.fakePlayTimer=null),a.fakePlaySamples=BigInt(0),a.fakePlayStartTimestamp=0),!a.frameEnded||!a.stretchpitcherEnded&&a.useStretchpitcher){e.next=7;break}return n.reply(t,-1048576),e.abrupt("return");case 7:return r=t.params.buffer,e.next=10,h(r);case 10:return i=e.sent,n.reply(t,i),e.abrupt("break",28);case 13:if(a.fakePlay&&(a.fakePlay=!1,a.fakePlayTimer&&(clearTimeout(a.fakePlayTimer),a.fakePlayTimer=null),a.fakePlaySamples=BigInt(0),a.fakePlayStartTimestamp=0),!a.frameEnded||!a.stretchpitcherEnded&&a.useStretchpitcher){e.next=17;break}return n.reply(t,-1048576),e.abrupt("return");case 17:if(s=t.params.nbSamples,!a.outPCMBuffer||a.outPCMBuffer.maxnbSamples!==s){for(a.outPCMBuffer&&((0,re.aI)(a.outPCMBuffer.data),(0,re.aI)(a.outPCMBuffer[z.o9]),(0,H.A)(a.outPCMBuffer)),a.outPCMBuffer=(0,V.A)(ee.A),a.outPCMBuffer.data=(0,re.sY)(4*a.playChannels),o=(0,re.Gy)(4*s*a.playChannels),u=0;u<a.playChannels;u++)q.M[20](a.outPCMBuffer.data+4*u,o+4*s*u);a.outPCMBuffer.maxnbSamples=s}return e.next=21,h(a.outPCMBuffer[z.o9]);case 21:if(!((c=e.sent)<0)){e.next=25;break}return n.reply(t,c),e.abrupt("return");case 25:return f=(0,ie.s3)(G.f[20](a.outPCMBuffer.data),4*a.outPCMBuffer.nbSamples*a.playChannels).slice(),n.reply(t,f.buffer,null,[f.buffer]),e.abrupt("break",28);case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.tasks.set(t.taskId,a),e.abrupt("return",0);case 25:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"checkUseStretchpitcher",value:function(e){var t=1!==e.playRate||1!==e.playTempo||1!==e.playPitch||e.enableJitterBuffer;if(e.useStretchpitcher&&!t)for(var r=0;r<e.playChannels;r++)e.stretchpitcher.get(r).flush()}},{key:"setPlayRate",value:function(e,t){var r=this.tasks.get(e);if(r){r.enableJitterBuffer&&G.f[15](r.stats+32)/G.f[15](r.stats+236)*1e3<=G.f[15](r.jitterBuffer)&&(t=1),r.playRate=t;for(var n=0;n<r.playChannels;n++)r.stretchpitcher.get(n).setRate(t);this.checkUseStretchpitcher(r)}}},{key:"setPlayTempo",value:(l=(0,T.A)(D().mark((function e(t,r){var n,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.tasks.get(t)){for(n.playTempo=r,i=0;i<n.playChannels;i++)n.stretchpitcher.get(i).setTempo(r);this.checkUseStretchpitcher(n)}case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"setPlayPitch",value:function(e,t){var r=this.tasks.get(e);if(r){r.playPitch=t;for(var n=0;n<r.playChannels;n++)r.stretchpitcher.get(n).setPitch(t);this.checkUseStretchpitcher(r)}}},{key:"beforeSeek",value:(d=(0,T.A)(D().mark((function e(t){var r,n,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=13;break}if(r.fakePlay||r.pausing){e.next=8;break}return K.Yz("wait current pull front frame before seek, taskId: ".concat(r.taskId),me,609),e.next=6,new(N())((function(e){r.seekSync=e}));case 6:e.next=9;break;case 8:r.fakePlayTimer&&(clearTimeout(r.fakePlayTimer),r.fakePlayTimer=null);case 9:if(r.seeking=!0,r.stretchpitcher.size){n=fe(r.stretchpitcher.keys());try{for(n.s();!(i=n.n()).done;)a=i.value,r.stretchpitcher.get(a).clear()}catch(e){n.e(e)}finally{n.f()}}r.waitPCMBuffer&&(r.waitAVFrame&&(q.M[20](r.waitPCMBuffer,0),q.M[15](r.waitPCMBuffer+12,0),r.avframePool.release(r.waitAVFrame),r.waitAVFrame=0),this.avPCMBufferPool.release(r.waitPCMBuffer),r.waitPCMBuffer=0),K.Yz("before seek end, taskId: ".concat(r.taskId),me,640);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"syncSeekTime",value:(h=(0,T.A)(D().mark((function e(t,r,n){var i,a,s,o,u,c;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=this.tasks.get(t))){e.next=36;break}a=!1;case 3:s=(0,oe.A)(),o=G.f[15](i.stats+120);case 6:if(!(!a&&n&&G.f[15](i.stats+120)>n)){e.next=13;break}return e.next=9,new ue.A(0);case 9:(0,oe.A)()-s>200&&o===G.f[15](i.stats+120)&&(a=!0),o!==G.f[15](i.stats+120)&&(o=G.f[15](i.stats+120),s=(0,oe.A)()),e.next=6;break;case 13:return e.next=15,i.leftIPCPort.request("pull");case 15:if(!((u=e.sent)<0)){e.next=20;break}return K.R8("pull audio frame end after seek, taskId: ".concat(t),me,670),i.frameEnded=!0,e.abrupt("break",35);case 20:if(!(r<BigInt(0))){e.next=23;break}return K.pq("use the first audio frame because of the seek time".concat(r," < 0"),me,676),e.abrupt("break",35);case 23:if(!((c=(0,ae.k)(G.f[17](u+104),i.timeBase,se.i0))-i.startPTS>=r)){e.next=32;break}return i.paddingAVFrame=u,i.frameEnded=!1,i.lastNotifyPTS=c,q.M[17](i.stats+312,c),e.abrupt("break",35);case 32:i.avframePool.release(u);case 33:e.next=3;break;case 35:K.Yz("sync seek time end, taskId: ".concat(i.taskId),me,701);case 36:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return h.apply(this,arguments)})},{key:"afterSeek",value:(f=(0,T.A)(D().mark((function e(t,r){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&(n.seeking=!1,n.receivePCMSync&&(n.receivePCMSync(),n.receivePCMSync=null),n.pausing||(n.fakePlay&&(n.fakePlayStartTimestamp=(0,oe.A)(),n.fakePlaySamples=BigInt(0),this.fakePlayNext(n)),n.lastRenderTimestamp=(0,oe.A)()),K.Yz("after seek end, taskId: ".concat(n.taskId),me,723));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"restart",value:(c=(0,T.A)(D().mark((function e(t){var r,n,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.tasks.get(t)){if(r.lastNotifyPTS=BigInt(0),r.frameEnded=!1,r.firstPlayed=!1,r.stretchpitcherEnded=!1,null!==(n=r.stretchpitcher)&&void 0!==n&&n.size)for(i=0;i<r.playChannels;i++)null===(a=r.stretchpitcher.get(i))||void 0===a||a.clear();r.fakePlayTimer&&clearTimeout(r.fakePlayTimer),r.fakePlaySamples=BigInt(0),r.fakePlayStartTimestamp=0,r.lastRenderTimestamp=(0,oe.A)(),K.Yz("restart task, taskId: ".concat(r.taskId),me,746)}case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"fakePlayNext",value:(u=(0,T.A)(D().mark((function e(t){var r,n,i,a,s=this;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.leftIPCPort.request("pull");case 2:if(!((r=e.sent)<0)){e.next=8;break}return t.frameEnded=!0,K.pq("audio fake render ended, taskId: ".concat(t.taskId),me,757),t.controlIPCPort.notify("ended"),e.abrupt("return");case 8:if(t.fakePlay&&!t.pausing){e.next=11;break}return t.avframePool.release(r),e.abrupt("return");case 11:n=G.f[15](r+76)/G.f[15](r+152)*1e3>>>0,n/=t.playRate*t.playTempo,i=BigInt(Math.floor((0,oe.A)()-t.fakePlayStartTimestamp))*BigInt(G.f[15](r+152)>>>0)/BigInt(1e3),a=Number(i-t.fakePlaySamples),n-=a/G.f[15](r+152)*1e3>>>0,t.fakePlaySamples+=BigInt(G.f[15](r+76)>>>0),t.avframePool.release(r),t.fakePlayTimer=setTimeout((function(){t.fakePlayTimer=null,s.fakePlayNext(t)}),n);case 19:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"fakePlay",value:(o=(0,T.A)(D().mark((function e(t){var r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))&&(r.fakePlayStartTimestamp=(0,oe.A)(),r.fakePlay=!0,r.fakePlaySamples=BigInt(0),this.fakePlayNext(r),K.pq("start fake play, taskId: ".concat(r.taskId),me,795));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"pause",value:(s=(0,T.A)(D().mark((function e(t){var r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))&&(r.pausing=!0,r.fakePlay&&r.fakePlayTimer&&(clearTimeout(r.fakePlayTimer),r.fakePlayTimer=null),K.pq("task paused, taskId: ".concat(r.taskId),me,810));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"unpause",value:(a=(0,T.A)(D().mark((function e(t){var r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))&&(r.pausing=!1,r.fakePlay&&(r.fakePlayStartTimestamp=(0,oe.A)(),r.fakePlaySamples=BigInt(0),r.lastRenderTimestamp=(0,oe.A)(),this.fakePlayNext(r)),K.pq("task unpaused, taskId: ".concat(r.taskId),me,825));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"registerTask",value:(i=(0,T.A)(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tasks.has(t.taskId)){e.next=2;break}return e.abrupt("return",Q.lh);case 2:return e.next=4,this.createTask(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"unregisterTask",value:(n=(0,T.A)(D().mark((function e(t){var r,n,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.tasks.get(t)){if(r.resampler&&r.resampler.close(),r.stretchpitcher.size){n=fe(r.stretchpitcher.keys());try{for(n.s();!(i=n.n()).done;)a=i.value,r.stretchpitcher.get(a).close()}catch(e){n.e(e)}finally{n.f()}r.stretchpitcher.clear()}r.outPCMBuffer&&((0,re.aI)(r.outPCMBuffer.data),(0,re.aI)(r.outPCMBuffer[z.o9]),(0,H.A)(r.outPCMBuffer)),r.waitPCMBuffer&&(r.waitAVFrame&&(q.M[20](r.waitPCMBuffer,0),q.M[15](r.waitPCMBuffer+12,0),r.avframePool.release(r.waitAVFrame)),this.avPCMBufferPool.release(r.waitPCMBuffer),r.waitPCMBuffer=0),r.paddingAVFrame&&r.avframePool.release(r.paddingAVFrame),r.leftIPCPort.destroy(),r.rightIPCPort.destroy(),this.tasks.delete(t)}case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"clear",value:(r=(0,T.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.A)((0,M.A)(t.prototype),"clear",this).call(this);case 2:this.avPCMBufferList.clear((function(e){G.f[20](e)&&((0,re.aI)(G.f[20](e)),(0,re.aI)(e))}),20),(0,H.A)(this.avPCMBufferList),(0,H.A)(this.avPCMBufferListMutex);case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}]),t}(Y.A)},72480:(e,t,r)=>{"use strict";r.d(t,{A:()=>le});var n=r(88435),i=r.n(n),a=r(69736),s=r.n(a),o=r(44301),u=r.n(o),c=r(82731),f=r.n(c),h=r(59614),d=r.n(h),l=r(969),p=r.n(l),v=r(66681),m=r.n(v),g=r(42096),A=r.n(g),y=r(75062),x=r.n(y),k=r(16091),b=r.n(k),w=r(68632),_=r.n(w),T=r(134),I=r(25182),S=r(78716),P=r(81570),B=r(77193),C=r(25767),M=r(31060),R=r(80662),U=r.n(R),E=r(36443),D=r.n(E),L=r(61499),F=r(12264),O=r(29170),N=r(63939),z=r(50932),V=r(9599),W=r(44527),j=r(9705),G=r(84149),q=r(44315),H=r(24175),Y=r(75),Q=r(37837),$=r(79630),K=r(4624),J=r(84290),X=r(39148),Z=r(72739),ee=r(44328),te=r(77231),re=r(43607),ne=r(71517),ie=r(14686);function ae(e,t){var r=void 0!==x()&&e[b()]||e["@@iterator"];if(!r){if(_()(e)||(r=function(e,t){if(e){if("string"==typeof e)return se(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?A()(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?se(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function oe(e,t){var r=s()(e);if(u()){var n=u()(e);t&&(n=n.filter((function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){(0,T.A)(e,t,r[t])})):d()?p()(e,d()(r)):oe(Object(r)).forEach((function(t){m()(e,t,f()(r,t))}))}return e}function ce(e,t,r){return t=(0,C.A)(t),(0,B.A)(e,fe()?i()(t,r||[],(0,C.A)(e).constructor):t.apply(e,r))}function fe(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(fe=function(){return!!e})()}var he="src/avpipeline/DemuxPipeline.ts",de=-1,le=function(e){function t(){return(0,S.A)(this,t),ce(this,t)}var n,i,a,s,o,u,c,f,h,d,l;return(0,M.A)(t,e),(0,P.A)(t,[{key:"judgeFormat",value:(l=(0,I.A)(D().mark((function e(t){var r,n,i,a=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:-1,e.next=3,t.peekString(8);case 3:if(n=e.sent,!/^FLV/.test(n)){e.next=8;break}return e.abrupt("return",0);case 8:if(!/^DKIF/.test(n)){e.next=12;break}return e.abrupt("return",4);case 12:if(!/^ftyp/.test(n.slice(4,8))){e.next=16;break}return e.abrupt("return",1);case 16:if(!/^OggS/.test(n)){e.next=20;break}return e.abrupt("return",3);case 20:if(!/^ID3/.test(n)){e.next=24;break}return e.abrupt("return",11);case 24:if(!/^fLaC/.test(n)){e.next=28;break}return e.abrupt("return",14);case 28:if(!/^RIFF/.test(n)){e.next=36;break}return e.next=31,t.peekString(12);case 31:if(i=e.sent.slice(8),!/^WAVE/.test(i)){e.next=34;break}return e.abrupt("return",13);case 34:e.next=41;break;case 36:return e.next=38,t.peekUint32();case 38:if(e.t0=e.sent,440786851!==e.t0){e.next=41;break}return e.abrupt("return",5);case 41:return e.abrupt("return",r);case 42:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"createTask",value:function(e){var t,r;if(e.mainTaskId){var n=this.tasks.get(e.mainTaskId);t=n.leftIPCPort,r=n.controlIPCPort}else t=new G.Ay(e.leftPort),e.controlPort&&(r=new G.Ay(e.controlPort));var i=e.bufferLength||1048576,a=(0,Q.sY)(i);if(!a)return j.gR;var s=new $.A(a,i),o=new H.A(i,!0,s);e.isLive||(o.flags|=1),e.flags&&(o.flags|=e.flags),o.onFlush=function(){var r=(0,I.A)(D().mark((function r(n){var i,a;return D().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={pointer:n.byteOffset,length:n.length},e.ioloaderOptions&&(i.ioloaderOptions=e.ioloaderOptions),r.prev=2,r.next=5,t.request("read",i);case 5:return a=r.sent,r.abrupt("return",a);case 9:return r.prev=9,r.t0=r.catch(2),r.abrupt("return",-1048574);case 12:case"end":return r.stop()}}),r,null,[[2,9]])})));return function(e){return r.apply(this,arguments)}}(),o.onSeek=function(){var r=(0,I.A)(D().mark((function r(n){var i;return D().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,i={pos:n},e.ioloaderOptions&&(i.ioloaderOptions=e.ioloaderOptions),r.next=5,t.request("seek",i);case 5:return r.abrupt("return",0);case 8:return r.prev=8,r.t0=r.catch(0),r.abrupt("return",-1048574);case 11:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(e){return r.apply(this,arguments)}}(),o.onSize=(0,I.A)(D().mark((function e(){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.request("size");case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",BigInt(-1048574));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));var u=(0,q.Xv)();return u.ioReader=o,u.getDecoderResource=function(){var e=(0,I.A)(D().mark((function e(t,n){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",r.request("getDecoderResource",{codecId:n,mediaType:t}));case 3:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),this.tasks.set(e.taskId,ue(ue({},e),{},{leftIPCPort:t,rightIPCPorts:new(U()),controlIPCPort:r,formatContext:u,ioReader:o,buffer:a,cacheAVPackets:new(U()),cacheRequests:new(U()),streamIndexFlush:new(U()),realFormat:-1,demuxEnded:!1,loop:null,gopCounter:0,lastKeyFramePts:BigInt(0),lastAudioDts:BigInt(0),lastVideoDts:BigInt(0),avpacketPool:new J.A((0,O.A)(e.avpacketList,F.A),e.avpacketListMutex)})),0}},{key:"openStream",value:(d=(0,I.A)(D().mark((function e(t){var n,i,a,s,o=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:3e3,!(i=this.tasks.get(t))){e.next=110;break}return e.next=5,i.leftIPCPort.request("open");case 5:return e.prev=5,e.next=8,this.judgeFormat(i.ioReader,i.format);case 8:a=e.sent,i.format=a,e.next=15;break;case 12:return e.prev=12,e.t0=e.catch(5),e.abrupt("return",j.LR);case 15:e.t1=a,e.next=0===e.t1?18:1===e.t1?23:2===e.t1?28:4===e.t1?33:3===e.t1?38:11===e.t1?43:5===e.t1||6===e.t1?48:12===e.t1?53:14===e.t1?58:13===e.t1?63:15===e.t1?68:16===e.t1?73:17===e.t1?78:18===e.t1?83:8===e.t1?88:9===e.t1?93:10===e.t1?98:103;break;case 18:return e.next=20,r.e(531).then(r.bind(r,28773));case 20:return e.t2=e.sent.default,s=new e.t2,e.abrupt("break",105);case 23:return e.next=25,r.e(809).then(r.bind(r,92047));case 25:return e.t3=e.sent.default,s=new e.t3,e.abrupt("break",105);case 28:return e.next=30,r.e(905).then(r.bind(r,59331));case 30:return e.t4=e.sent.default,s=new e.t4,e.abrupt("break",105);case 33:return e.next=35,r.e(634).then(r.bind(r,16634));case 35:return e.t5=e.sent.default,s=new e.t5,e.abrupt("break",105);case 38:return e.next=40,r.e(473).then(r.bind(r,69979));case 40:return e.t6=e.sent.default,s=new e.t6,e.abrupt("break",105);case 43:return e.next=45,r.e(157).then(r.bind(r,6839));case 45:return e.t7=e.sent.default,s=new e.t7,e.abrupt("break",105);case 48:return e.next=50,r.e(941).then(r.bind(r,34577));case 50:return e.t8=e.sent.default,s=new e.t8,e.abrupt("break",105);case 53:return e.next=55,r.e(94).then(r.bind(r,47094));case 55:return e.t9=e.sent.default,s=new e.t9,e.abrupt("break",105);case 58:return e.next=60,r.e(391).then(r.bind(r,18453));case 60:return e.t10=e.sent.default,s=new e.t10,e.abrupt("break",105);case 63:return e.next=65,r.e(197).then(r.bind(r,3791));case 65:return e.t11=e.sent.default,s=new e.t11,e.abrupt("break",105);case 68:return e.next=70,r.e(611).then(r.bind(r,85611));case 70:return e.t12=e.sent.default,s=new e.t12,e.abrupt("break",105);case 73:return e.next=75,r.e(70).then(r.bind(r,78070));case 75:return e.t13=e.sent.default,s=new e.t13,e.abrupt("break",105);case 78:return e.next=80,r.e(344).then(r.bind(r,47344));case 80:return e.t14=e.sent.default,s=new e.t14,e.abrupt("break",105);case 83:return e.next=85,r.e(854).then(r.bind(r,98854));case 85:return e.t15=e.sent.default,s=new e.t15,e.abrupt("break",105);case 88:return e.next=90,r.e(299).then(r.bind(r,5299));case 90:return e.t16=e.sent.default,s=new e.t16,e.abrupt("break",105);case 93:return e.next=95,r.e(487).then(r.bind(r,85487));case 95:return e.t17=e.sent.default,s=new e.t17,e.abrupt("break",105);case 98:return e.next=100,r.e(196).then(r.bind(r,95808));case 100:return e.t18=e.sent.default,s=new e.t18,e.abrupt("break",105);case 103:return K.z3("format not support",he,439),e.abrupt("return",j.E$);case 105:return i.realFormat=a,i.formatContext.iformat=s,e.abrupt("return",Y.ho(i.formatContext,{maxAnalyzeDuration:n,fastOpen:i.isLive}));case 110:K.h2("task not found",he,454);case 111:case"end":return e.stop()}}),e,this,[[5,12]])}))),function(e){return d.apply(this,arguments)})},{key:"getFormat",value:(h=(0,I.A)(D().mark((function e(t){var r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=5;break}return e.abrupt("return",r.realFormat);case 5:K.h2("task not found",he,464);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"analyzeStreams",value:(f=(0,I.A)(D().mark((function e(t){var r,n,i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=9;break}return e.next=4,Y.Ib(r.formatContext);case 4:for(n=[],i=0;i<r.formatContext.streams.length;i++)a=r.formatContext.streams[i],n.push({index:a.index,id:a.id,codecpar:a.codecpar[L.o9],nbFrames:a.nbFrames,metadata:a.metadata,duration:a.duration,startTime:a.startTime,disposition:a.disposition,timeBase:a.timeBase[L.o9]});return e.abrupt("return",{metadata:r.formatContext.metadata,format:r.realFormat,chapters:r.formatContext.chapters,streams:n});case 9:K.h2("task not found",he,497);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"connectStreamTask",value:(c=(0,I.A)(D().mark((function e(t,r,n){var i,a;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=this.tasks.get(t))?(a=new G.Ay(n),i.cacheAVPackets.set(r,[]),a.streamIndex=r,a.on(G.S3,function(){var e=(0,I.A)(D().mark((function e(t){var r,n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.method,e.next="pull"===e.t0?3:6;break;case 3:return(r=i.cacheAVPackets.get(a.streamIndex)).length?(n=r.shift(),0!==i.stats&&(1===i.formatContext.streams[N.f[15](n+32)].codecpar.codecType?z.M[15](i.stats+32,N.f[15](i.stats+32)-1):0===i.formatContext.streams[N.f[15](n+32)].codecpar.codecType&&z.M[15](i.stats+120,N.f[15](i.stats+120)-1)),a.reply(t,n)):i.demuxEnded?a.reply(t,-1048576):(i.cacheRequests.set(a.streamIndex,t),i.loop&&i.loop.isStarted()&&i.loop.resetInterval()),e.abrupt("break",6);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i.rightIPCPorts.set(r,a),K.Yz("connect stream ".concat(r,", taskId: ").concat(i.taskId),he,542)):K.h2("task not found",he,545);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return c.apply(this,arguments)})},{key:"changeConnectStream",value:(u=(0,I.A)(D().mark((function e(t,r,n){var i,a,s,o,u,c=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(c.length>3&&void 0!==c[3])||c[3],!(a=this.tasks.get(t))){e.next=22;break}if(r!==n){e.next=5;break}return e.abrupt("return");case 5:return s=a.cacheAVPackets.get(n),o=a.rightIPCPorts.get(n),u=a.cacheRequests.get(n),s||K.R8("oldStreamIndex ".concat(n," not found"),he,563),e.next=11,a.loop.stopBeforeNextTick();case 11:i?(Z.__(s,(function(e){a.avpacketPool.release(e)})),s.length=0):a.streamIndexFlush.set(r,!0),o.streamIndex=r,a.cacheAVPackets.set(r,s),a.rightIPCPorts.set(r,o),a.cacheAVPackets.delete(n),a.rightIPCPorts.delete(n),u&&(a.cacheRequests.set(r,u),a.cacheRequests.delete(n)),i||a.loop.start(),K.Yz("changed connect stream, new ".concat(r,", old: ").concat(n,", force: ").concat(i,", taskId: ").concat(a.taskId),he,595),e.next=23;break;case 22:K.h2("task not found",he,598);case 23:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return u.apply(this,arguments)})},{key:"startDemux",value:(o=(0,I.A)(D().mark((function e(t,r,n){var i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=this.tasks.get(t))?(n=Math.max(n,2===i.format?20:10),i.loop&&i.loop.destroy(),i.loop=new X.A((0,I.A)(D().mark((function e(){var a,s,o,u,c,f,h,d,l,p,v;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=6;break}if(a=!1,i.cacheAVPackets.forEach((function(e,t){var r=i.formatContext.streams.find((function(e){return e.index===t}));e.length<n&&(3!==r.codecpar.codecType||1===i.cacheAVPackets.size)&&(a=!0)})),a){e.next=6;break}return i.loop.emptyTask(),e.abrupt("return");case 6:return s=i.avpacketPool.alloc(),e.next=9,Y.Cj(i.formatContext,s);case 9:if(o=e.sent){i.avpacketPool.release(s),-1048576!==o&&K.z3("demux error, ret: ".concat(o,", taskId: ").concat(t),he,758),i.demuxEnded=!0,K.pq("demuxer ended, taskId: ".concat(i.taskId),he,763),l=ae(i.cacheRequests.keys());try{for(l.s();!(p=l.n()).done;)v=p.value,i.cacheAVPackets.get(v).length||(i.rightIPCPorts.get(v).reply(i.cacheRequests.get(v),-1048576),i.cacheRequests.delete(v))}catch(e){l.e(e)}finally{l.f()}i.loop.stop()}else u=N.f[15](s+32),0!==i.stats&&(1===i.formatContext.streams[u].codecpar.codecType&&i.cacheAVPackets.has(u)?(z.M[17](i.stats+24,N.f[17](i.stats+24)+BigInt(1)),z.M[17](i.stats+16,N.f[17](i.stats+16)+BigInt(N.f[15](s+28)>>>0)),N.f[17](i.stats+24)>1&&N.f[17](s+16)>i.lastAudioDts&&((c=i.cacheAVPackets.get(u))&&c.length?z.M[15](i.stats+236,Math.round(N.f[15](s+76)/N.f[15](s+72)/((0|Number(N.f[17](s+16)-N.f[17](c[0]+16)&0xffffffffn))/c.length))):z.M[15](i.stats+236,Math.round(N.f[15](s+76)/N.f[15](s+72)/(0|Number(N.f[17](s+16)-i.lastAudioDts&0xffffffffn))))),i.lastAudioDts=N.f[17](s+16)):0===i.formatContext.streams[u].codecpar.codecType&&i.cacheAVPackets.has(u)&&(z.M[17](i.stats+112,N.f[17](i.stats+112)+BigInt(1)),z.M[17](i.stats+104,N.f[17](i.stats+104)+BigInt(N.f[15](s+28)>>>0)),1&N.f[15](s+36)?(z.M[17](i.stats+176,N.f[17](i.stats+176)+BigInt(1)),N.f[17](i.stats+176)>1&&N.f[17](s+8)>i.lastKeyFramePts&&(z.M[15](i.stats+96,i.gopCounter),i.gopCounter=1,z.M[15](i.stats+92,0|Number(0xffffffffn&(0,ee.k)(N.f[17](s+8)-i.lastKeyFramePts,(0,O.A)(s+72,V.P),te.i0)))),i.lastKeyFramePts=N.f[17](s+8)):i.gopCounter++,N.f[17](i.stats+112)>1&&N.f[17](s+16)>i.lastVideoDts&&((f=i.cacheAVPackets.get(u))&&f.length?z.M[15](i.stats+224,Math.round(N.f[15](s+76)/N.f[15](s+72)/((0|Number(N.f[17](s+16)-N.f[17](f[0]+16)&0xffffffffn))/f.length))):z.M[15](i.stats+224,Math.round(N.f[15](s+76)/N.f[15](s+72)/(0|Number(N.f[17](s+16)-i.lastVideoDts&0xffffffffn))))),i.lastVideoDts=N.f[17](s+16))),i.streamIndexFlush.get(u)&&(h=i.formatContext.streams.find((function(e){return e.index===u})),!(0,ne.rU)(s,1)&&h&&h.codecpar.extradataSize&&(d=(0,Q.sY)(h.codecpar.extradataSize),(0,ie.Mr)(d,h.codecpar.extradata,h.codecpar.extradataSize),(0,ne.Ow)(s,1,d,h.codecpar.extradataSize)),i.streamIndexFlush.set(u,!1)),i.cacheRequests.has(u)?(i.rightIPCPorts.get(u).reply(i.cacheRequests.get(u),s),i.cacheRequests.delete(u)):i.cacheAVPackets.has(u)?(i.cacheAVPackets.get(u).push(s),0!==i.stats&&(1===i.formatContext.streams[u].codecpar.codecType?z.M[15](i.stats+32,N.f[15](i.stats+32)+1):0===i.formatContext.streams[u].codecpar.codecType&&z.M[15](i.stats+120,N.f[15](i.stats+120)+1)),3===i.formatContext.streams[u].codecpar.codecType&&i.cacheAVPackets.get(u).length>n&&i.avpacketPool.release(i.cacheAVPackets.get(u).shift())):i.rightIPCPorts.has(de)?i.cacheRequests.has(de)?(i.rightIPCPorts.get(de).reply(i.cacheRequests.get(de),s),i.cacheRequests.delete(de)):i.cacheAVPackets.get(de).push(s):i.avpacketPool.release(s);case 11:case"end":return e.stop()}}),e)}))),0,0,!0,!1),i.loop.start(),K.Yz("start demux loop, taskId: ".concat(i.taskId),he,778)):K.h2("task not found",he,781);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return o.apply(this,arguments)})},{key:"seek",value:(s=(0,I.A)(D().mark((function e(t,r,n){var i,a,s,o,u,c,f,h=arguments;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=h.length>3&&void 0!==h[3]?h[3]:-1,!(a=this.tasks.get(t))){e.next=46;break}if(!a.loop){e.next=39;break}return e.next=6,a.loop.stopBeforeNextTick();case 6:return e.next=8,Y.jF(a.formatContext,i,r,n);case 8:if(!((s=e.sent)>=BigInt(0))){e.next=36;break}a.cacheAVPackets.forEach((function(e){Z.__(e,(function(e){a.avpacketPool.release(e)})),e.length=0})),0!==a.stats&&a.cacheAVPackets.forEach((function(e,t){var r=a.formatContext.streams.find((function(e){return e.index===t}));1===r.codecpar.codecType?z.M[15](a.stats+32,0):0===r.codecpar.codecType&&z.M[15](a.stats+120,0)})),o=a.avpacketPool.alloc();case 13:return e.next=16,Y.Cj(a.formatContext,o);case 16:if(!((s=e.sent)<0||a.cacheAVPackets.has(N.f[15](o+32)))){e.next=19;break}return e.abrupt("break",21);case 19:e.next=13;break;case 21:if(!(s>=0)){e.next=32;break}return a.demuxEnded=!1,u=N.f[15](o+32),a.cacheAVPackets.get(u).push(o),0!==a.stats&&(1===a.formatContext.streams[N.f[15](o+32)].codecpar.codecType?z.M[15](a.stats+32,N.f[15](a.stats+32)+1):0===a.formatContext.streams[N.f[15](o+32)].codecpar.codecType&&z.M[15](a.stats+120,N.f[15](a.stats+120)+1)),a.loop.start(),c=N.f[17](o+8),a.formatContext.streams[u].startTime!==te.Dh?c-=a.formatContext.streams[u].startTime:c-=a.formatContext.streams[u].firstDTS,e.abrupt("return",(0,ee.k)(re.T9(c,BigInt(0)),(0,O.A)(o+72,V.P),te.i0));case 32:return K.R8("got first packet failed after seek, taskId: ".concat(a.taskId),he,849),a.avpacketPool.release(o),a.demuxEnded=!0,e.abrupt("return",r);case 36:return e.abrupt("return",s);case 39:return K.pq("seek before demux loop start",he,860),e.next=42,Y.jF(a.formatContext,-1,r,n);case 42:if(!((f=e.sent)<0)){e.next=45;break}return e.abrupt("return",f);case 45:return e.abrupt("return",r);case 46:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return s.apply(this,arguments)})},{key:"croppingAVPacketQueue",value:(a=(0,I.A)(D().mark((function e(t,r){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&n.cacheAVPackets.forEach((function(e,t){var i=N.f[17](e[e.length-1]+16),a=e.length-2;for(a=e.length-2;a>=0&&!(1&N.f[15](e[a]+36)&&(0,ee.k)(i-N.f[17](e[a]+16),(0,O.A)(e[a]+72,V.P),te.i0)>=r);a--);a>0&&(e.splice(0,a).forEach((function(e){n.avpacketPool.release(e)})),0!==n.stats&&(1===n.formatContext.streams[t].codecpar.codecType?z.M[15](n.stats+32,e.length):0===n.formatContext.streams[t].codecpar.codecType&&z.M[15](n.stats+120,e.length)))}));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"registerTask",value:(i=(0,I.A)(D().mark((function e(t){return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tasks.has(t.taskId)){e.next=2;break}return e.abrupt("return",j.lh);case 2:return e.abrupt("return",this.createTask(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"unregisterTask",value:(n=(0,I.A)(D().mark((function e(t){var r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=13;break}if(!r.loop){e.next=6;break}return e.next=5,r.loop.stopBeforeNextTick();case 5:r.loop.destroy();case 6:r.leftIPCPort.destroy(),r.rightIPCPorts.forEach((function(e){e.destroy()})),r.rightIPCPorts.clear(),r.formatContext.destroy(),(0,Q.Eb)(r.buffer),r.cacheAVPackets.forEach((function(e){e.forEach((function(e){r.avpacketPool.release(e)}))})),this.tasks.delete(t);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(W.A)},87243:(e,t,r)=>{"use strict";r.d(t,{A:()=>z});var n=r(88435),i=r.n(n),a=r(69736),s=r.n(a),o=r(44301),u=r.n(o),c=r(82731),f=r.n(c),h=r(59614),d=r.n(h),l=r(969),p=r.n(l),v=r(66681),m=r.n(v),g=r(134),A=r(25182),y=r(78716),x=r(81570),k=r(77193),b=r(25767),w=r(31060),_=r(36443),T=r.n(_),I=r(63939),S=r(50932),P=r(44527),B=r(77580),C=r(9705),M=r(84149),R=r(14686),U=r(79686),E=r(4624);function D(e,t){var r=s()(e);if(u()){var n=u()(e);t&&(n=n.filter((function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){(0,g.A)(e,t,r[t])})):d()?p()(e,d()(r)):D(Object(r)).forEach((function(t){m()(e,t,f()(r,t))}))}return e}function F(e,t,r){return t=(0,b.A)(t),(0,k.A)(e,O()?i()(t,r||[],(0,b.A)(e).constructor):t.apply(e,r))}function O(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(O=function(){return!!e})()}var N="src/avpipeline/IOPipeline.ts",z=function(e){function t(){return(0,y.A)(this,t),F(this,t)}var n,i,a,s,o,u,c,f,h,d,l,p,v,m,g;return(0,w.A)(t,e),(0,x.A)(t,[{key:"createTask",value:(g=(0,A.A)(T().mark((function e(t){var n,i,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next=0===e.t0?3:1===e.t0?5:2===e.t0?7:3===e.t0?13:19;break;case 3:return n=new B.A(t.options),e.abrupt("break",19);case 5:return n=new U.A(t.options),e.abrupt("break",19);case 7:return e.next=9,r.e(866).then(r.bind(r,15433));case 9:return e.t1=e.sent.default,e.t2=t.options,n=new e.t1(e.t2),e.abrupt("break",19);case 13:return e.next=15,r.e(576).then(r.bind(r,41576));case 15:return e.t3=e.sent.default,e.t4=t.options,n=new e.t3(e.t4),e.abrupt("break",19);case 19:if(n){e.next=21;break}return e.abrupt("return",C.UY);case 21:return i=new M.Ay(t.rightPort),a=L(L({},t),{},{ioLoader:n,ipcPort:i}),i.on(M.S3,function(){var e=(0,A.A)(T().mark((function e(r){var s,o,u,c,f,h,d;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r.method,e.next="open"===e.t0?3:"read"===e.t0?14:"seek"===e.t0?31:"size"===e.t0?44:51;break;case 3:return e.prev=3,e.next=6,n.open(t.info,t.range);case 6:i.reply(r,{}),e.next=13;break;case 9:e.prev=9,e.t1=e.catch(3),E.z3("loader open error, ".concat(e.t1,", taskId: ").concat(t.taskId),N,118),i.reply(r,null,e.t1);case 13:return e.abrupt("break",51);case 14:return s=r.params.pointer,o=r.params.length,u=r.params.ioloaderOptions,c=(0,R.JW)(s,o),e.prev=18,e.next=21,n.read(c,u);case 21:f=e.sent,S.M[17](a.stats+192,I.f[17](a.stats+192)+BigInt(f>>>0)),i.reply(r,f),e.next=30;break;case 26:e.prev=26,e.t2=e.catch(18),E.z3("loader read error, ".concat(e.t2,", taskId: ").concat(t.taskId),N,139),i.reply(r,C.LR);case 30:return e.abrupt("break",51);case 31:return h=r.params.pos,d=r.params.ioloaderOptions,e.prev=33,e.next=36,n.seek(h,d);case 36:i.reply(r),e.next=43;break;case 39:e.prev=39,e.t3=e.catch(33),E.z3("loader seek error, ".concat(e.t3,", taskId: ").concat(t.taskId),N,157),i.reply(r,null,e.t3);case 43:return e.abrupt("break",51);case 44:return e.t4=i,e.t5=r,e.next=48,n.size();case 48:return e.t6=e.sent,e.t4.reply.call(e.t4,e.t5,e.t6),e.abrupt("break",51);case 51:case"end":return e.stop()}}),e,null,[[3,9],[18,26],[33,39]])})));return function(t){return e.apply(this,arguments)}}()),this.tasks.set(t.taskId,a),e.abrupt("return",0);case 26:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"open",value:(m=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=5;break}return e.next=4,r.ioLoader.open(r.info,r.range);case 4:return e.abrupt("return",0);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"getDuration",value:(v=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=5;break}if(2!==r.type&&3!==r.type){e.next=4;break}return e.abrupt("return",r.ioLoader.getDuration());case 4:return e.abrupt("return",0);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"hasAudio",value:(p=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=5;break}if(3!==r.type){e.next=4;break}return e.abrupt("return",r.ioLoader.hasAudio());case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"hasVideo",value:(l=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=5;break}if(3!==r.type){e.next=4;break}return e.abrupt("return",r.ioLoader.hasVideo());case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"hasSubtitle",value:(d=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=5;break}if(3!==r.type){e.next=4;break}return e.abrupt("return",r.ioLoader.hasSubtitle());case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getVideoList",value:(h=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=9;break}if(3!==r.type){e.next=6;break}return e.abrupt("return",r.ioLoader.getVideoList());case 6:if(2!==r.type){e.next=8;break}return e.abrupt("return",r.ioLoader.getVideoList());case 8:return e.abrupt("return",{list:[],selectedIndex:0});case 9:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"getAudioList",value:(f=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=5;break}if(3!==r.type){e.next=4;break}return e.abrupt("return",r.ioLoader.getAudioList());case 4:return e.abrupt("return",{list:[],selectedIndex:0});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getSubtitleList",value:(c=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=5;break}if(3!==r.type){e.next=4;break}return e.abrupt("return",r.ioLoader.getSubtitleList());case 4:return e.abrupt("return",{list:[],selectedIndex:0});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"selectVideo",value:(u=(0,A.A)(T().mark((function e(t,r){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.tasks.get(t))){e.next=8;break}if(3!==n.type){e.next=6;break}n.ioLoader.selectVideo(r),e.next=8;break;case 6:if(2!==n.type){e.next=8;break}return e.abrupt("return",n.ioLoader.selectVideo(r));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"selectAudio",value:(o=(0,A.A)(T().mark((function e(t,r){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&3===n.type&&n.ioLoader.selectAudio(r);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"selectSubtitle",value:(s=(0,A.A)(T().mark((function e(t,r){var n;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&3===n.type&&n.ioLoader.selectSubtitle(r);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"getMinBuffer",value:(a=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=7;break}if(3!==r.type){e.next=4;break}return e.abrupt("return",r.ioLoader.getMinBuffer());case 4:if(2!==r.type){e.next=6;break}return e.abrupt("return",r.ioLoader.getMinBuffer());case 6:return e.abrupt("return",0);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"registerTask",value:(i=(0,A.A)(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tasks.has(t.taskId)){e.next=2;break}return e.abrupt("return",C.lh);case 2:return e.abrupt("return",this.createTask(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"unregisterTask",value:(n=(0,A.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=6;break}return e.next=4,r.ioLoader.stop();case 4:r.ipcPort.destroy(),this.tasks.delete(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),t}(P.A)},44527:(e,t,r)=>{"use strict";r.d(t,{A:()=>b});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(80662),f=r.n(c),h=r(42096),d=r.n(h),l=r(75062),p=r.n(l),v=r(16091),m=r.n(v),g=r(68632),A=r.n(g),y=r(4624);function x(e,t){var r=void 0!==p()&&e[m()]||e["@@iterator"];if(!r){if(A()(e)||(r=function(e,t){if(e){if("string"==typeof e)return k(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?d()(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var b=function(){function e(){(0,i.A)(this,e),(0,s.A)(this,"tasks",void 0),this.tasks=new(f())}var t,r,o;return(0,a.A)(e,[{key:"clear",value:(o=(0,n.A)(u().mark((function e(){var t,r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tasks.size){e.next=18;break}t=x(this.tasks.keys()),e.prev=2,t.s();case 4:if((r=t.n()).done){e.next=10;break}return n=r.value,e.next=8,this.unregisterTask(n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(){return o.apply(this,arguments)})},{key:"setLogLevel",value:(r=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y.V$(t);case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"getTaskCount",value:(t=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.tasks.size);case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}()},31138:(e,t,r)=>{"use strict";r.d(t,{A:()=>ee});var n=r(88435),i=r.n(n),a=r(69736),s=r.n(a),o=r(44301),u=r.n(o),c=r(82731),f=r.n(c),h=r(59614),d=r.n(h),l=r(969),p=r.n(l),v=r(66681),m=r.n(v),g=r(25182),A=r(134),y=r(78716),x=r(81570),k=r(77193),b=r(25767),w=r(31060),_=r(36443),T=r.n(_),I=r(54001),S=r.n(I),P=r(63939),B=r(50932),C=r(12264),M=r(29170),R=r(9599),U=r(44527),E=r(9705),D=r(84149),L=r(40417),F=r(71039),O=r(4624),N=r(16041),z=r(67672),V=r(72739),W=r(13724),j=r(84290),G=r(39638),q=r(44328),H=r(86932),Y=r(95797),Q=r(72703);function $(e,t){var r=s()(e);if(u()){var n=u()(e);t&&(n=n.filter((function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$(Object(r),!0).forEach((function(t){(0,A.A)(e,t,r[t])})):d()?p()(e,d()(r)):$(Object(r)).forEach((function(t){m()(e,t,f()(r,t))}))}return e}function J(e,t,r){return t=(0,b.A)(t),(0,k.A)(e,X()?i()(t,r||[],(0,b.A)(e).constructor):t.apply(e,r))}function X(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(X=function(){return!!e})()}var Z="src/avpipeline/VideoDecodePipeline.ts",ee=function(e){function t(){return(0,y.A)(this,t),J(this,t)}var r,n,i,a,s,o,u,c;return(0,w.A)(t,e),(0,x.A)(t,[{key:"createWebcodecDecoder",value:function(e){var t=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new F.A({onError:function(r){if(e.hardwareRetryCount>3||!e.firstDecoded)e.targetDecoder===e.hardwareDecoder&&(e.targetDecoder=e.softwareDecoder,e.hardwareDecoder.close(),e.hardwareDecoder=null,e.decoderReady=t.openSoftwareDecoder(e),O.R8("video decode error width hardware(".concat(e.hardwareRetryCount,"), taskId: ").concat(e.taskId,", error: ").concat(r,", try to fallback to software decoder"),Z,121));else{e.hardwareRetryCount++;try{O.pq("retry open hardware decoder(".concat(e.hardwareRetryCount,"), taskId: ").concat(e.taskId),Z,127),e.decoderReady=e.hardwareDecoder.open(e.parameters)}catch(r){O.R8("retry open hardware decoder failed, fallback to software decoder, taskId: ".concat(e.taskId),Z,131)}}e.needKeyFrame=!0,e.leftIPCPort.request("requestKeyframe")},onReceiveFrame:function(t){e.firstDecoded=!0,e.frameCaches.push(t),B.M[17](e.stats+144,P.f[17](e.stats+144)+BigInt(1)),e.lastDecodeTimestamp&&B.M[15](e.stats+248,Math.max((0,H.A)()-e.lastDecodeTimestamp,P.f[15](e.stats+248))),e.lastDecodeTimestamp=(0,H.A)()},enableHardwareAcceleration:r})}},{key:"createWasmcodecDecoder",value:function(e,t){return new L.A({resource:t,onError:function(t){O.z3("video decode error, taskId: ".concat(e.taskId,", error: ").concat(t),Z,157),e.openReject&&(e.openReject(E.r8),e.openReject=null)},onReceiveFrame:function(t){e.firstDecoded=!0,e.frameCaches.push(t),B.M[17](e.stats+144,P.f[17](e.stats+144)+BigInt(1)),e.lastDecodeTimestamp&&B.M[15](e.stats+248,Math.max((0,H.A)()-e.lastDecodeTimestamp,P.f[15](e.stats+248))),e.lastDecodeTimestamp=(0,H.A)()},avframePool:e.avframePool})}},{key:"createTask",value:function(e){var t=this,r=new D.Ay(e.leftPort),n=new D.Ay(e.rightPort),i=[],a=new N.A((0,M.A)(e.avframeList,C.A),e.avframeListMutex),s=K(K({},e),{},{leftIPCPort:r,rightIPCPort:n,softwareDecoder:null,hardwareDecoder:null,frameCaches:i,inputEnd:!1,targetDecoder:null,needKeyFrame:!0,parameters:0,hardwareRetryCount:0,lastDecodeTimestamp:0,firstDecoded:!1,decoderReady:null,softwareDecoderOpened:!1,avframePool:a,avpacketPool:new j.A((0,M.A)(e.avpacketList,C.A),e.avpacketListMutex)});return s.softwareDecoder=e.resource?this.createWasmcodecDecoder(s,s.resource):Y.A.videoDecoder?this.createWebcodecDecoder(s,!1):null,s.softwareDecoder?(Y.A.videoDecoder&&e.enableHardware&&(s.hardwareDecoder=this.createWebcodecDecoder(s)),s.targetDecoder=s.hardwareDecoder||s.softwareDecoder,this.tasks.set(e.taskId,s),n.on(D.S3,function(){var a=(0,g.A)(T().mark((function a(o){var u,c,f,h,d,l;return T().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.t0=o.method,a.next="pull"===a.t0?3:137;break;case 3:if(!i.length){a.next=9;break}return u=i.shift(),n.reply(o,u,null,(0,Q.A)(u)||z.ai(u)?null:[u]),a.abrupt("break",137);case 9:if(s.inputEnd){a.next=134;break}case 10:if(!i.length){a.next=15;break}return c=i.shift(),n.reply(o,c,null,(0,Q.A)(c)||z.ai(c)?null:[c]),a.abrupt("break",133);case 15:if(!s.decoderReady){a.next=19;break}return a.next=18,s.decoderReady;case 18:s.decoderReady=null;case 19:return a.next=21,r.request("pull");case 21:if(-1048576!==(f=a.sent)){a.next=47;break}if(s.targetDecoder!==s.hardwareDecoder){a.next=30;break}return a.next=26,S().race([new W.A(2),s.targetDecoder.flush()]);case 26:h=a.sent,z.ai(h)&&O.R8("video hardware decoder flush failed, ignore it, taskId: ".concat(s.taskId),Z,259),a.next=32;break;case 30:return a.next=32,s.targetDecoder.flush();case 32:if(s.inputEnd=!0,s.targetDecoder!==s.hardwareDecoder){a.next=36;break}return a.next=36,new W.A(0);case 36:if(!i.length){a.next=42;break}return d=i.shift(),n.reply(o,d,null,s.targetDecoder===s.hardwareDecoder?[d]:null),a.abrupt("break",133);case 42:return O.pq("video decoder ended, taskId: ".concat(s.taskId),Z,276),n.reply(o,-1048576),a.abrupt("break",133);case 45:a.next=131;break;case 47:if(!(f>0)){a.next=128;break}if(!s.needKeyFrame){a.next=55;break}if(!(1&P.f[15](f+36))){a.next=53;break}s.needKeyFrame=!1,a.next=55;break;case 53:return s.avpacketPool.release(f),a.abrupt("continue",10);case 55:if(!((l=s.targetDecoder.decode(f))<0)){a.next=119;break}if(B.M[15](s.stats+136,P.f[15](s.stats+136)+1),!(s.targetDecoder instanceof F.A&&s.softwareDecoder)){a.next=115;break}if(O.R8("video decode error width hardware, taskId: ".concat(s.taskId,", error: ").concat(l,", try to fallback to software decoder"),Z,303),s.targetDecoder!==s.hardwareDecoder){a.next=65;break}s.hardwareDecoder.close(),s.hardwareDecoder=null,a.next=73;break;case 65:if(!s.resource){a.next=70;break}s.softwareDecoder.close(),s.softwareDecoder=t.createWasmcodecDecoder(s,s.resource),a.next=73;break;case 70:return O.z3("cannot fallback to wasm video decoder because of resource not found , taskId: ".concat(e.taskId),Z,314),n.reply(o,E.r8),a.abrupt("break",133);case 73:return a.prev=73,a.next=76,t.openSoftwareDecoder(s);case 76:s.targetDecoder=s.softwareDecoder,a.next=84;break;case 79:return a.prev=79,a.t1=a.catch(73),O.z3("video software decoder open error, taskId: ".concat(e.taskId),Z,324),n.reply(o,E.r8),a.abrupt("break",133);case 84:if(!(1&P.f[15](f+36))){a.next=111;break}if(!((l=s.targetDecoder.decode(f))>=0)){a.next=89;break}return s.avpacketPool.release(f),a.abrupt("continue",10);case 89:if(!(s.targetDecoder instanceof F.A&&s.resource)){a.next=109;break}return O.R8("video decode error width webcodecs soft decoder, taskId: ".concat(s.taskId,", error: ").concat(l,", try to fallback to wasm software decoder"),Z,338),s.softwareDecoder.close(),s.softwareDecoder=t.createWasmcodecDecoder(s,s.resource),s.softwareDecoderOpened=!1,a.prev=94,a.next=97,t.openSoftwareDecoder(s);case 97:s.targetDecoder=s.softwareDecoder,a.next=105;break;case 100:return a.prev=100,a.t2=a.catch(94),O.z3("video wasm software decoder open error, taskId: ".concat(e.taskId),Z,348),n.reply(o,E.r8),a.abrupt("break",133);case 105:if(!((l=s.targetDecoder.decode(f))>=0)){a.next=109;break}return s.avpacketPool.release(f),a.abrupt("continue",10);case 109:a.next=115;break;case 111:return s.avpacketPool.release(f),s.needKeyFrame=!0,s.leftIPCPort.request("requestKeyframe"),a.abrupt("continue",10);case 115:return s.avpacketPool.release(f),O.z3("video decode error, taskId: ".concat(e.taskId,", ret: ").concat(l),Z,367),n.reply(o,l),a.abrupt("break",133);case 119:s.avpacketPool.release(f);case 120:if(!(s.targetDecoder instanceof F.A&&s.targetDecoder.getQueueLength()>20)){a.next=125;break}return a.next=123,new W.A(0);case 123:a.next=120;break;case 125:return a.abrupt("continue",10);case 128:return O.z3("video decode pull avpacket error, taskId: ".concat(e.taskId,", ret: ").concat(f),Z,381),n.reply(o,f),a.abrupt("break",133);case 131:a.next=10;break;case 133:return a.abrupt("break",137);case 134:return O.pq("video decoder ended, taskId: ".concat(s.taskId),Z,388),n.reply(o,-1048576),a.abrupt("break",137);case 137:case"end":return a.stop()}}),a,null,[[73,79],[94,100]])})));return function(e){return a.apply(this,arguments)}}()),0):(O.z3("software decoder not support",Z,216),E.lh)}},{key:"openSoftwareDecoder",value:(c=(0,g.A)(T().mark((function e(t){var r,n,i,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.softwareDecoder||t.softwareDecoderOpened){e.next=22;break}return r=t.parameters,n=1,(0,G.A)()&&(i=P.f[15](r+56)*P.f[15](r+60),a=(0,q.lb)((0,M.A)(r+72,R.P)),i>=2073600&&i<=2211840?(173!==P.f[15](r+4)&&196!==P.f[15](r+4)&&225!==P.f[15](r+4)||(n=2),a>30?(n=2,173!==P.f[15](r+4)&&196!==P.f[15](r+4)&&225!==P.f[15](r+4)||(n=4)):a>60&&(n=4,173!==P.f[15](r+4)&&196!==P.f[15](r+4)&&225!==P.f[15](r+4)||(n=6))):i>2211840&&i<=8294400?(n=4,173!==P.f[15](r+4)&&196!==P.f[15](r+4)&&225!==P.f[15](r+4)||(n=6)):i>8294400&&(n=6,173!==P.f[15](r+4)&&196!==P.f[15](r+4)&&225!==P.f[15](r+4)||(n=8)),n=Math.min(n,navigator.hardwareConcurrency)),e.prev=4,e.next=7,t.softwareDecoder.open(r,n,t.wasmDecoderOptions);case 7:e.next=21;break;case 9:if(e.prev=9,e.t0=e.catch(4),!(t.softwareDecoder instanceof F.A&&t.resource)){e.next=20;break}return O.R8("webcodecs software decoder open failed, ".concat(e.t0,", try to fallback to wasm software decoder"),Z,459),t.softwareDecoder.close(),t.softwareDecoder=this.createWasmcodecDecoder(t,t.resource),e.next=17,t.softwareDecoder.open(r,n);case 17:t.targetDecoder=t.softwareDecoder,e.next=21;break;case 20:throw e.t0;case 21:t.softwareDecoderOpened=!0;case 22:case"end":return e.stop()}}),e,this,[[4,9]])}))),function(e){return c.apply(this,arguments)})},{key:"reopenDecoder",value:(u=(0,g.A)(T().mark((function e(t,r,n,i){var a,s,o,u=this;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=this.tasks.get(t))){e.next=6;break}return i&&(a.wasmDecoderOptions=i),s=a.preferWebCodecs&&Y.A.videoDecoder&&F.A.isSupported(r,!1)?this.createWebcodecDecoder(a,!1):n?this.createWasmcodecDecoder(a,n):Y.A.videoDecoder?this.createWebcodecDecoder(a,!1):null,o=Y.A.videoDecoder&&a.enableHardware?this.createWebcodecDecoder(a,!0):null,e.abrupt("return",new(S())(function(){var e=(0,g.A)(T().mark((function e(t,n){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.openReject=t,a.softwareDecoder&&a.softwareDecoder.close(),a.hardwareDecoder&&a.hardwareDecoder.close(),a.softwareDecoder=s,a.hardwareDecoder=o,a.targetDecoder=a.hardwareDecoder||a.softwareDecoder,a.hardwareRetryCount=0,!a.hardwareDecoder){e.next=20;break}return e.prev=8,e.next=11,a.hardwareDecoder.open(r);case 11:O.Yz("reopen video hardware decoder, taskId: ".concat(a.taskId),Z,514),e.next=20;break;case 14:e.prev=14,e.t0=e.catch(8),O.z3("cannot reopen hardware decoder, ".concat(e.t0,", taskId: ").concat(a.taskId),Z,517),a.hardwareDecoder.close(),a.hardwareDecoder=null,a.targetDecoder=a.softwareDecoder;case 20:if(a.parameters=r,a.targetDecoder!==a.softwareDecoder){e.next=34;break}return e.prev=22,e.next=25,u.openSoftwareDecoder(a);case 25:O.Yz("reopen video soft decoder, taskId: ".concat(a.taskId),Z,530),e.next=34;break;case 28:if(e.prev=28,e.t1=e.catch(22),O.z3("reopen video software decoder failed, error: ".concat(e.t1),Z,533),a.hardwareDecoder){e.next=34;break}return t(E.r8),e.abrupt("return");case 34:t(0);case 35:case"end":return e.stop()}}),e,null,[[8,14],[22,28]])})));return function(t,r){return e.apply(this,arguments)}}()));case 6:O.h2("task not found",Z,543);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return u.apply(this,arguments)})},{key:"open",value:(o=(0,g.A)(T().mark((function e(t,r){var n,i,a,s=this,o=arguments;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>2&&void 0!==o[2]?o[2]:{},!(i=this.tasks.get(t))){e.next=6;break}return i.wasmDecoderOptions=n,i.preferWebCodecs&&Y.A.videoDecoder&&F.A.isSupported(r,!1)&&i.softwareDecoder instanceof L.A&&(i.softwareDecoder.close(),a=this.createWebcodecDecoder(i,!1),i.softwareDecoder===i.targetDecoder&&(i.targetDecoder=a),i.softwareDecoder=a),e.abrupt("return",new(S())(function(){var e=(0,g.A)(T().mark((function e(t,n){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.openReject=t,!i.hardwareDecoder){e.next=13;break}return e.prev=2,e.next=5,i.hardwareDecoder.open(r);case 5:e.next=13;break;case 7:e.prev=7,e.t0=e.catch(2),O.z3("cannot open hardware decoder, ".concat(e.t0),Z,570),i.hardwareDecoder.close(),i.hardwareDecoder=null,i.targetDecoder=i.softwareDecoder;case 13:if(i.parameters=r,i.targetDecoder!==i.softwareDecoder){e.next=26;break}return e.prev=15,e.next=18,s.openSoftwareDecoder(i);case 18:e.next=26;break;case 20:if(e.prev=20,e.t1=e.catch(15),O.z3("open video software decoder failed, error: ".concat(e.t1),Z,584),i.hardwareDecoder){e.next=26;break}return t(E.r8),e.abrupt("return");case 26:t(0);case 27:case"end":return e.stop()}}),e,null,[[2,7],[15,20]])})));return function(t,r){return e.apply(this,arguments)}}()));case 6:O.h2("task not found",Z,594);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"setPlayRate",value:(s=(0,g.A)(T().mark((function e(t,r){var n,i,a;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&n.softwareDecoder&&(-16,a=(0,q.lb)((0,M.A)(n.parameters+72,R.P)),i=a>=120?r<=1?-16:r<1.5||r<3?8:32:a>=60?r<1.5?-16:r<3?8:r<8?24:32:-16,n.softwareDecoder.setSkipFrameDiscard(i));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"resetTask",value:(a=(0,g.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=19;break}if(r.targetDecoder!==r.softwareDecoder){e.next=7;break}return e.next=5,r.targetDecoder.flush();case 5:e.next=13;break;case 7:if(r.targetDecoder!==r.hardwareDecoder){e.next=13;break}return r.hardwareDecoder.close(),r.hardwareDecoder=this.createWebcodecDecoder(r),e.next=12,r.hardwareDecoder.open(r.parameters);case 12:r.targetDecoder=r.hardwareDecoder;case 13:V.__(r.frameCaches,(function(e){(0,Q.A)(e)?r.avframePool.release(e):e.close()})),r.frameCaches.length=0,r.needKeyFrame=!0,r.inputEnd=!1,r.lastDecodeTimestamp=(0,H.A)(),O.pq("reset video decoder, taskId: ".concat(r.taskId),Z,665);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"registerTask",value:(i=(0,g.A)(T().mark((function e(t){return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tasks.has(t.taskId)){e.next=2;break}return e.abrupt("return",E.lh);case 2:return e.abrupt("return",this.createTask(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"unregisterTask",value:(n=(0,g.A)(T().mark((function e(t){var r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))&&(r.rightPort.close(),r.leftPort.close(),r.softwareDecoder&&r.softwareDecoder.close(),r.hardwareDecoder&&r.hardwareDecoder.close(),r.frameCaches.forEach((function(e){(0,Q.A)(e)?r.avframePool.release(e):e.close()})),this.tasks.delete(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getTasksInfo",value:(r=(0,g.A)(T().mark((function e(){var t;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.tasks.forEach((function(e){t.push({codecId:P.f[15](e.parameters+4),width:P.f[15](e.parameters+56),height:P.f[15](e.parameters+60),framerate:(0,q.lb)((0,M.A)(e.parameters+72,R.P)),hardware:e.targetDecoder===e.hardwareDecoder})})),e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}]),t}(U.A)},33968:(e,t,r)=>{"use strict";r.d(t,{A:()=>pe});var n=r(88435),i=r.n(n),a=r(69736),s=r.n(a),o=r(44301),u=r.n(o),c=r(82731),f=r.n(c),h=r(59614),d=r.n(h),l=r(969),p=r.n(l),v=r(66681),m=r.n(v),g=r(134),A=r(25182),y=r(78716),x=r(81570),k=r(77193),b=r(25767),w=r(31060),_=r(54001),T=r.n(_),I=r(36443),S=r.n(I),P=r(12264),B=r(29170),C=r(63939),M=r(50932),R=r(44527),U=r(9705),E=r(84149),D=r(67672),L=r(72739),F=r(16041),O=r(95797),N=r(39148),z=r(86932),V=r(44328),W=r(77231),j=r(86834),G=r(4624),q=r(43607),H=r(15045),Y=r(88103),Q=r(54750),$=r(55196),K=r(43813),J=r(99293),X=r(37977),Z=r(1052),ee=r(90058),te=r(39638),re=r(7972),ne=r(72703);function ie(e,t){var r=s()(e);if(u()){var n=u()(e);t&&(n=n.filter((function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(r),!0).forEach((function(t){(0,g.A)(e,t,r[t])})):d()?p()(e,d()(r)):ie(Object(r)).forEach((function(t){m()(e,t,f()(r,t))}))}return e}function se(e,t,r){return t=(0,b.A)(t),(0,k.A)(e,oe()?i()(t,r||[],(0,b.A)(e).constructor):t.apply(e,r))}function oe(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(oe=function(){return!!e})()}var ue="src/avpipeline/VideoRenderPipeline.ts",ce=[X.A,Z.A];ce.push(ee.A);var fe,he=[$.A,K.A];he.push(J.A),function(e){e[e.None=0]="None",e[e.Accelerate=1]="Accelerate",e[e.Decelerate=2]="Decelerate"}(fe||(fe={}));var de=!1,le=["bt2020","bt2100","st2048","p3-dcl","hlg"],pe=function(e){function t(){return(0,y.A)(this,t),se(this,t)}var r,n,i,a,s,o,u,c,f,h,d,l,p,v,m,g,k,b,_,I;return(0,w.A)(t,e),(0,x.A)(t,[{key:"createTask",value:(I=(0,A.A)(S().mark((function e(t){var r,n,i;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new E.Ay(t.leftPort),n=new E.Ay(t.controlPort),(i=ae(ae({},t),{},{leftIPCPort:r,controlIPCPort:n,render:null,currentPTS:W.Dh,firstPTS:BigInt(0),startTimestamp:BigInt(0),playRate:BigInt(100),targetRate:BigInt(100),frontFrame:null,backFrame:null,renderFrame:null,renderFrameCount:BigInt(0),loop:null,renderRedyed:!1,adjust:fe.None,adjustDiff:BigInt(0),lastAdjustTimestamp:BigInt(0),firstRendered:!1,canvasUpdated:!1,renderCreating:!1,pauseTimestamp:0,pauseCurrentPts:BigInt(0),lastNotifyPTS:BigInt(0),skipRender:!1,isSupport:function(){return!1},frontBuffered:!1,ended:!1,seeking:!1,seekSync:null,afterPullResolver:null,pausing:!1,lastRenderTimestamp:0,avframePool:new F.A((0,B.A)(t.avframeList,P.A),t.avframeListMutex)})).startPTS=(0,V.k)(i.startPTS,i.timeBase,W.i0),n.on(E.Wo,function(){var e=(0,A.A)(S().mark((function e(t){var r,n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.method,e.next="syncPts"===e.t0?3:"skipRender"===e.t0?7:9;break;case 3:return r=t.params.pts,(n=Math.abs(Number(r-i.currentPTS)))>100&&i.currentPTS>BigInt(0)&&(r>i.currentPTS?(i.adjust=fe.Accelerate,G.Yz("video render sync pts accelerate, targetPTS: ".concat(r,", currentPTS: ").concat(i.currentPTS,", diff: ").concat(n,", taskId: ").concat(i.taskId),ue,236)):(i.adjust=fe.Decelerate,G.Yz("video render sync pts decelerate, targetPTS: ".concat(r,", currentPTS: ").concat(i.currentPTS,", diff: ").concat(n," taskId: ").concat(i.taskId),ue,240)),i.adjustDiff=BigInt(Math.floor(n))),e.abrupt("break",9);case 7:return i.skipRender=t.params.skipRender,e.abrupt("break",9);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.tasks.set(t.taskId,i),e.abrupt("return",0);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"swap",value:function(e){var t=this;if(!e.seeking){if(e.backFrame&&((0,ne.A)(e.backFrame)?e.avframePool.release(e.backFrame):e.backFrame.close()),e.backFrame=null,!e.frontBuffered)return!1;if(e.backFrame=e.frontFrame,e.frontFrame=null,!e.ended){e.frontBuffered=!1;var r=(0,z.A)();return e.leftIPCPort.request("pull").then((function(n){if(e.afterPullResolver&&e.afterPullResolver(),D.ai(n)&&n<0)return e.ended=!0,void(e.frontFrame=null);var i=(0,z.A)()-r;if(i>1e3&&(e.startTimestamp+=BigInt(Math.floor(i))),e.frontFrame=n,e.frontBuffered=!0,e.seekSync)return e.seekSync(),void(e.seekSync=null);e.backFrame||t.swap(e)})),!0}}}},{key:"createRender",value:(_=(0,A.A)(S().mark((function e(t,r){var n,i,a,s,o=arguments;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>2&&void 0!==o[2]&&o[2],!t.renderCreating){e.next=3;break}return e.abrupt("return");case 3:if(t.renderCreating=!0,t.renderRedyed=!1,t.render&&t.render.destroy(),(0,ne.A)(r)?t.enableWebGPU&&O.A.webgpu&&!de?L.__(ce,(function(e){if(e.isSupport(r))return t.render=new e(t.canvas,{devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,onRenderContextLost:function(){t.canvasUpdated=!1,t.renderRedyed=!1,G.R8("render context lost",ue,374),t.controlIPCPort.notify("updateCanvas")}}),t.isSupport=e.isSupport,!1})):L.__(he,(function(e){if(e.isSupport(r))return t.render=new e(t.canvas,{devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,onRenderContextLost:function(){t.canvasUpdated=!1,t.renderRedyed=!1,G.R8("render context lost",ue,392),t.controlIPCPort.notify("updateCanvas")}}),t.isSupport=e.isSupport,!1})):t.enableWebGPU&&O.A.webgpu&&!de&&((j.A.chrome||j.A.newEdge)&&j.A.checkVersion(j.A.majorVersion,"116",!0)||j.A.safari&&j.A.checkVersion(j.A.majorVersion,"17.4",!0)||j.A.firefox&&j.A.checkVersion(j.A.majorVersion,"129",!0))&&(u=r.colorSpace.primaries,!L.zy(le,u))?(t.render=new Q.A(t.canvas,{devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode,onRenderContextLost:function(){t.canvasUpdated=!1,t.renderRedyed=!1,G.R8("render context lost",ue,344),t.controlIPCPort.notify("updateCanvas")}}),t.isSupport=Q.A.isSupport):(t.render=new Y.A(t.canvas,{devicePixelRatio:t.devicePixelRatio,renderMode:t.renderMode}),t.isSupport=Y.A.isSupport),t.render){e.next=10;break}return t.renderCreating=!1,e.abrupt("return");case 10:return e.prev=10,e.next=13,t.render.init();case 13:t.render.viewport(t.viewportWidth,t.viewportHeight),t.render.setRotate(null!==(i=t.renderRotate)&&void 0!==i?i:0),t.render.enableHorizontalFlip(null!==(a=t.flipHorizontal)&&void 0!==a&&a),t.render.enableVerticalFlip(null!==(s=t.flipVertical)&&void 0!==s&&s),t.render.render(r),t.render.clear(),e.next=35;break;case 21:if(e.prev=21,e.t0=e.catch(10),!(t.render instanceof H.A)){e.next=30;break}return de=!0,t.renderCreating=!1,G.R8("not support webgpu render, try to fallback to webgl render",ue,420),e.abrupt("return",this.createRender(t,r,!0));case 30:if(!n){e.next=35;break}return t.renderCreating=!1,G.R8("canvas context lost after fallback, wait for recreate canvas",ue,425),t.controlIPCPort.notify("updateCanvas"),e.abrupt("return");case 35:t.renderRedyed=!0,t.renderCreating=!1;case 37:case"end":return e.stop()}var u}),e,this,[[10,21]])}))),function(e,t){return _.apply(this,arguments)})},{key:"play",value:(b=(0,A.A)(S().mark((function e(t){var r,n,i,a,s=this;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=31;break}return r.loop&&G.h2("task has already call play",ue,438),e.next=5,r.leftIPCPort.request("pull");case 5:if(r.backFrame=e.sent,!(D.ai(r.backFrame)&&r.backFrame<0)){e.next=11;break}return r.backFrame=0,G.pq("video render ended, taskId: ".concat(r.taskId),ue,445),r.controlIPCPort.notify("ended"),e.abrupt("return");case 11:return e.next=13,r.leftIPCPort.request("pull");case 13:return r.frontFrame=e.sent,r.frontBuffered=!0,r.ended=!1,D.ai(r.frontFrame)&&r.frontFrame<0&&(r.ended=!0,r.frontBuffered=!1,r.frontFrame=0),n=this,e.next=20,this.createRender(r,r.backFrame);case 20:r.firstPTS=(0,V.k)((0,ne.A)(r.backFrame)?C.f[17](r.backFrame+104):BigInt(Math.floor(r.backFrame.timestamp)),r.timeBase,W.i0),G.Yz("got first video frame, pts: ".concat((0,ne.A)(r.backFrame)?C.f[17](r.backFrame+104):BigInt(Math.floor(r.backFrame.timestamp)),"(").concat(r.firstPTS,"ms), taskId: ").concat(r.taskId),ue,471),r.firstPTS<BigInt(1e3)&&(r.firstPTS=BigInt(0)),r.currentPTS=r.firstPTS,r.startTimestamp=BigInt(Math.floor((0,z.A)()))-r.firstPTS*BigInt(100)/r.playRate,i=(0,te.A)(),a=i&&O.A.shareArrayBuffer?0:10,r.loop=new N.A((function(){if(r.backFrame){if(!r.isSupport(r.backFrame)){if(r.render)return r.renderRedyed=!1,r.renderFrame=r.backFrame,void r.controlIPCPort.notify("updateCanvas");s.createRender(r,r.backFrame)}var e=(0,V.k)((0,ne.A)(r.backFrame)?C.f[17](r.backFrame+104):BigInt(Math.floor(r.backFrame.timestamp)),r.timeBase,W.i0);if(e<r.currentPTS){if(!(r.currentPTS-e>BigInt(5e3)))return G.R8("dropping frame with pts ".concat(e,", which is earlier then the last rendered frame(").concat(r.currentPTS,"), taskId: ").concat(r.taskId),ue,529),void s.swap(r);r.startTimestamp=BigInt(Math.floor((0,z.A)()))-e*BigInt(100)/r.targetRate}else e-r.currentPTS>BigInt(5e3)&&(r.startTimestamp=BigInt(Math.floor((0,z.A)()))-e*BigInt(100)/r.targetRate);if(r.adjust===fe.Accelerate){if(r.adjustDiff<=0)r.adjust=fe.None,r.startTimestamp=BigInt(Math.floor((0,z.A)()))-e*BigInt(100)/r.targetRate,r.lastAdjustTimestamp=BigInt(0);else if(BigInt(Math.floor((0,z.A)()))-r.lastAdjustTimestamp>=BigInt(200)){var t=r.adjustDiff<=BigInt(100)?r.adjustDiff:q.jk(r.adjustDiff,BigInt(100))*BigInt(100)/r.targetRate;r.startTimestamp-=t,r.adjustDiff-=t,G.Yz("video render accelerate startTimestamp sub: ".concat(t,", taskId: ").concat(r.taskId),ue,554),r.lastAdjustTimestamp=BigInt(Math.floor((0,z.A)()))}}else if(r.adjust===fe.Decelerate)if(r.adjustDiff<=0)r.adjust=fe.None,r.startTimestamp=BigInt(Math.floor((0,z.A)()))-e*BigInt(100)/r.targetRate,r.lastAdjustTimestamp=BigInt(0);else if(BigInt(Math.floor((0,z.A)()))-r.lastAdjustTimestamp>=BigInt(300)){var a=r.adjustDiff<BigInt(50)?r.adjustDiff:q.jk(r.adjustDiff,BigInt(50))*BigInt(100)/r.targetRate;r.startTimestamp+=a,r.adjustDiff-=a,G.Yz("video render decelerate startTimestamp add: ".concat(a,", taskId: ").concat(r.taskId),ue,575),r.lastAdjustTimestamp=BigInt(Math.floor((0,z.A)()))}r.enableJitterBuffer&&C.f[15](r.stats+120)/C.f[15](r.stats+224)*1e3<=C.f[15](r.jitterBuffer)&&n.setPlayRate(r.taskId,1);var o=e*BigInt(100)/r.playRate+r.startTimestamp-BigInt(Math.floor((0,z.A)()));o<=0?(r.renderRedyed&&!r.skipRender&&(i||-o<BigInt(100)||r.renderFrameCount&BigInt(1))?(r.render.render(r.backFrame),M.M[17](r.stats+320,e),M.M[17](r.stats+160,C.f[17](r.stats+160)+BigInt(1)),r.lastRenderTimestamp&&M.M[15](r.stats+252,Math.max((0,z.A)()-r.lastRenderTimestamp,C.f[15](r.stats+252))),r.lastRenderTimestamp=(0,z.A)()):M.M[15](r.stats+168,C.f[15](r.stats+168)+1),r.renderFrameCount++,(0,ne.A)(r.backFrame)?(M.M[15](r.stats+84,C.f[15](r.backFrame+68)),M.M[15](r.stats+88,C.f[15](r.backFrame+72))):(M.M[15](r.stats+84,r.backFrame.displayWidth),M.M[15](r.stats+88,r.backFrame.displayHeight)),r.firstRendered||(r.controlIPCPort.notify(r.canvasUpdated?"firstRenderedAfterUpdateCanvas":"firstRendered"),r.firstRendered=!0,r.canvasUpdated=!1),r.playRate!==r.targetRate&&(r.startTimestamp=BigInt(Math.floor((0,z.A)()))-e*BigInt(100)/r.targetRate,r.playRate=r.targetRate),r.currentPTS=e,e-r.lastNotifyPTS>=BigInt(1e3)&&(r.lastNotifyPTS=e,r.controlIPCPort.notify("syncPts",{pts:e})),s.swap(r)):r.loop.emptyTask()}else r.ended?(r.render&&r.renderRedyed&&r.render.clear(),r.loop.stop(),r.adjust=fe.None,G.pq("video render ended, taskId: ".concat(r.taskId),ue,499),r.controlIPCPort.notify("ended")):r.loop.emptyTask()}),0,a),r.loop.start(),e.next=32;break;case 31:G.h2("task not found",ue,647);case 32:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"restart",value:(k=(0,A.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=22;break}return r.loop||G.h2("task has not played",ue,655),r.loop.isStarted()&&G.h2("task has already run",ue,659),r.backFrame&&((0,ne.A)(r.backFrame)?r.avframePool.release(r.backFrame):r.backFrame.close()),r.frontFrame&&((0,ne.A)(r.frontFrame)?r.avframePool.release(r.frontFrame):r.frontFrame.close()),e.next=8,r.leftIPCPort.request("pull");case 8:return r.backFrame=e.sent,e.next=11,r.leftIPCPort.request("pull");case 11:r.frontFrame=e.sent,r.frontBuffered=!0,r.ended=!1,r.adjust=fe.None,r.lastNotifyPTS=W.Dh,r.firstRendered=!1,r.firstPTS=(0,V.k)((0,ne.A)(r.backFrame)?C.f[17](r.backFrame+104):BigInt(Math.floor(r.backFrame.timestamp)),r.timeBase,W.i0),r.currentPTS=r.firstPTS,r.firstPTS<BigInt(1e3)&&(r.firstPTS=BigInt(0)),r.startTimestamp=BigInt(Math.floor((0,z.A)()))-r.firstPTS*BigInt(100)/r.playRate,r.loop.start();case 22:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"pause",value:(g=(0,A.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))&&(r.loop||G.h2("task has not played",ue,710),r.pauseTimestamp=(0,z.A)(),r.pauseCurrentPts=r.currentPTS,r.loop.stop(),r.pausing=!0,G.pq("task paused, taskId: ".concat(r.taskId),ue,717));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"unpause",value:(m=(0,A.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=11;break}if(!r.seeking){e.next=4;break}return e.abrupt("return");case 4:r.loop||G.h2("task has not played",ue,728),r.startTimestamp+=BigInt(Math.floor((0,z.A)()-r.pauseTimestamp)),r.startTimestamp-=r.currentPTS-r.pauseCurrentPts,r.seeking||r.loop.start(),r.pausing=!1,r.lastRenderTimestamp=(0,z.A)(),G.pq("task unpaused, taskId: ".concat(r.taskId),ue,738);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"updateCanvas",value:(v=(0,A.A)(S().mark((function e(t,r){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))?(n.canvas=r,n.render&&(n.render.destroy(),n.render=null),n.isSupport=function(){return!1},n.canvasUpdated=!0,n.firstRendered=!1,n.renderRedyed=!1):G.h2("task not found",ue,756);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"setPlayRate",value:(p=(0,A.A)(S().mark((function e(t,r){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&(n.enableJitterBuffer&&C.f[15](n.stats+120)/C.f[15](n.stats+224)*1e3<=C.f[15](n.jitterBuffer)&&(r=1),n.targetRate=BigInt(Math.floor(Math.floor(100*r))));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"setRenderMode",value:(l=(0,A.A)(S().mark((function e(t,r){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&n.render&&(n.renderMode=r,n.render.setRenderMode(r),(0,re.A)((function(){n.pausing&&n.backFrame&&n.render&&n.render.render(n.backFrame)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"setRenderRotate",value:(d=(0,A.A)(S().mark((function e(t,r){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&n.render&&(n.renderRotate=r,n.render.setRotate(r),(0,re.A)((function(){n.pausing&&n.backFrame&&n.render&&n.render.render(n.backFrame)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return d.apply(this,arguments)})},{key:"enableHorizontalFlip",value:(h=(0,A.A)(S().mark((function e(t,r){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&n.render&&(n.flipHorizontal=r,n.render.enableHorizontalFlip(r),(0,re.A)((function(){n.pausing&&n.backFrame&&n.render&&n.render.render(n.backFrame)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"enableVerticalFlip",value:(f=(0,A.A)(S().mark((function e(t,r){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&n.render&&(n.flipVertical=r,n.render.enableVerticalFlip(r),(0,re.A)((function(){n.pausing&&n.backFrame&&n.render&&n.render.render(n.backFrame)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"resize",value:(c=(0,A.A)(S().mark((function e(t,r,n){var i;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=this.tasks.get(t))&&i.render&&(i.render.viewport(r,n),(0,re.A)((function(){i.pausing&&i.backFrame&&i.render&&i.render.render(i.backFrame)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return c.apply(this,arguments)})},{key:"setSkipRender",value:(u=(0,A.A)(S().mark((function e(t,r){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))&&(n.skipRender=r);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"beforeSeek",value:(o=(0,A.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=14;break}if(r.ended||r.frontBuffered){e.next=6;break}return G.Yz("wait current pull front frame before seek, taskId: ".concat(r.taskId),ue,859),e.next=6,new(T())((function(e){r.seekSync=e}));case 6:r.seeking=!0,r.loop.stop(),r.backFrame&&((0,ne.A)(r.backFrame)?r.avframePool.release(r.backFrame):r.backFrame.close()),r.frontFrame&&((0,ne.A)(r.frontFrame)?r.avframePool.release(r.frontFrame):r.frontFrame.close()),r.frontFrame=null,r.backFrame=null,r.currentPTS=W.Dh,G.Yz("before seek end, taskId: ".concat(r.taskId),ue,887);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"syncSeekTime",value:(s=(0,A.A)(S().mark((function e(t,r,n){var i,a;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=this.tasks.get(t))){e.next=25;break}case 2:return e.next=5,i.leftIPCPort.request("pull");case 5:if(i.backFrame=e.sent,!(D.ai(i.backFrame)&&i.backFrame<0)){e.next=14;break}return i.ended=!0,i.seeking=!1,i.adjust=fe.None,i.backFrame=null,G.R8("pull video frame end after seek, taskId: ".concat(t),ue,903),i.controlIPCPort.notify("ended"),e.abrupt("return");case 14:if(!(r<BigInt(0))){e.next=17;break}return G.pq("use the first video frame because of the seek time".concat(r," < 0"),ue,909),e.abrupt("break",24);case 17:if(!((a=(0,V.k)((0,ne.A)(i.backFrame)?C.f[17](i.backFrame+104):BigInt(Math.floor(i.backFrame.timestamp)),i.timeBase,W.i0))-i.startPTS>=r)){e.next=21;break}return M.M[17](i.stats+320,a),e.abrupt("break",24);case 21:(0,ne.A)(i.backFrame)?i.avframePool.release(i.backFrame):i.backFrame.close(),e.next=2;break;case 24:G.Yz("sync seek time end, taskId: ".concat(i.taskId),ue,937);case 25:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return s.apply(this,arguments)})},{key:"afterSeek",value:(a=(0,A.A)(S().mark((function e(t,r){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.tasks.get(t))){e.next=18;break}if(!n.ended){e.next=4;break}return e.abrupt("return");case 4:return n.startTimestamp=BigInt(Math.floor((0,z.A)()))-(r+n.startPTS)*BigInt(100)/n.playRate,e.next=7,n.leftIPCPort.request("pull");case 7:n.frontFrame=e.sent,D.ai(n.frontFrame)&&n.frontFrame<0?(n.frontFrame=null,n.frontBuffered=!1,n.ended=!0):n.frontBuffered=!0,n.ended=!1,n.adjust=fe.None,n.lastRenderTimestamp=(0,z.A)(),n.currentPTS=(0,V.k)((0,ne.A)(n.backFrame)?C.f[17](n.backFrame+104):BigInt(Math.floor(n.backFrame.timestamp)),n.timeBase,W.i0),M.M[17](n.stats+320,n.currentPTS),G.Yz("got first video frame, pts: ".concat((0,ne.A)(n.backFrame)?C.f[17](n.backFrame+104):BigInt(Math.floor(n.backFrame.timestamp)),"(").concat(n.currentPTS,"ms), taskId: ").concat(n.taskId),ue,972),n.seeking=!1,n.pausing?n.backFrame&&(n.render.render(n.backFrame),n.pauseCurrentPts=n.currentPTS,n.pauseTimestamp=(0,z.A)()):n.loop.start(),G.Yz("after seek end, taskId: ".concat(n.taskId),ue,988);case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"renderNextFrame",value:(i=(0,A.A)(S().mark((function e(t){var r,n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))&&r.backFrame&&(n=(0,V.k)((0,ne.A)(r.backFrame)?C.f[17](r.backFrame+104):BigInt(Math.floor(r.backFrame.timestamp)),r.timeBase,W.i0),r.render.render(r.backFrame),M.M[17](r.stats+320,n),M.M[17](r.stats+160,C.f[17](r.stats+160)+BigInt(1)),r.currentPTS=n,this.swap(r));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"registerTask",value:(n=(0,A.A)(S().mark((function e(t){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tasks.has(t.taskId)){e.next=2;break}return e.abrupt("return",U.lh);case 2:return e.next=4,this.createTask(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unregisterTask",value:(r=(0,A.A)(S().mark((function e(t){var r,n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=17;break}if(n=!!r.loop,!r.loop){e.next=8;break}return e.next=6,r.loop.stopBeforeNextTick();case 6:r.loop.destroy(),r.loop=null;case 8:if(!n||r.ended||r.frontFrame){e.next=11;break}return e.next=11,new(T())((function(e){r.afterPullResolver=e}));case 11:r.render&&(r.render.destroy(),r.render=null),r.backFrame&&((0,ne.A)(r.backFrame)&&r.backFrame>0?r.avframePool.release(r.backFrame):r.backFrame.close(),r.backFrame=null),r.frontFrame&&((0,ne.A)(r.frontFrame)&&r.frontFrame>0?r.avframePool.release(r.frontFrame):r.frontFrame.close(),r.frontFrame=null),r.leftIPCPort.destroy(),r.controlIPCPort.destroy(),this.tasks.delete(t);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]),t}(R.A)},69721:(e,t,r)=>{"use strict";r.d(t,{n:()=>d});var n,i,a=r(81570),s=r(78716),o=r(134),u=r(80662),c=r.n(u),f=r(61499),h=r(12085),d=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"min",void 0),(0,o.A)(this,"max",void 0)}));n=d.prototype,(i=new(c())).set("min",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("max",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,4),(0,h.A)(n,f.g7,8),(0,h.A)(n,f.JY,i)},30128:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n,i,a=r(81570),s=r(78716),o=r(134),u=r(80662),c=r.n(u),f=r(61499),h=r(12085),d=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"channels",void 0),(0,o.A)(this,"sampleRate",void 0),(0,o.A)(this,"audioFrameSize",void 0),(0,o.A)(this,"audioPacketBytes",void 0),(0,o.A)(this,"audioPacketCount",void 0),(0,o.A)(this,"audioPacketQueueLength",void 0),(0,o.A)(this,"audioDropPacketCount",void 0),(0,o.A)(this,"audioDecodeErrorPacketCount",void 0),(0,o.A)(this,"audioEncodeErrorFrameCount",void 0),(0,o.A)(this,"audioFrameDecodeCount",void 0),(0,o.A)(this,"audioPacketEncodeCount",void 0),(0,o.A)(this,"audioFrameRenderCount",void 0),(0,o.A)(this,"audioFrameDropCount",void 0),(0,o.A)(this,"width",void 0),(0,o.A)(this,"height",void 0),(0,o.A)(this,"keyFrameInterval",void 0),(0,o.A)(this,"gop",void 0),(0,o.A)(this,"videoPacketBytes",void 0),(0,o.A)(this,"videoPacketCount",void 0),(0,o.A)(this,"videoPacketQueueLength",void 0),(0,o.A)(this,"videoDropPacketCount",void 0),(0,o.A)(this,"videoDecodeErrorPacketCount",void 0),(0,o.A)(this,"videoEncodeErrorFrameCount",void 0),(0,o.A)(this,"videoFrameDecodeCount",void 0),(0,o.A)(this,"videoPacketEncodeCount",void 0),(0,o.A)(this,"videoFrameRenderCount",void 0),(0,o.A)(this,"videoFrameDropCount",void 0),(0,o.A)(this,"keyFrameCount",void 0),(0,o.A)(this,"bufferDropBytes",void 0),(0,o.A)(this,"bufferReceiveBytes",void 0),(0,o.A)(this,"bufferOutputBytes",void 0),(0,o.A)(this,"audioBitrate",void 0),(0,o.A)(this,"videoBitrate",void 0),(0,o.A)(this,"videoDecodeFramerate",void 0),(0,o.A)(this,"videoRenderFramerate",void 0),(0,o.A)(this,"videoEncodeFramerate",void 0),(0,o.A)(this,"audioDecodeFramerate",void 0),(0,o.A)(this,"audioRenderFramerate",void 0),(0,o.A)(this,"audioEncodeFramerate",void 0),(0,o.A)(this,"audioFrameDecodeIntervalMax",void 0),(0,o.A)(this,"audioFrameRenderIntervalMax",void 0),(0,o.A)(this,"videoFrameDecodeIntervalMax",void 0),(0,o.A)(this,"videoFrameRenderIntervalMax",void 0),(0,o.A)(this,"bandwidth",void 0),(0,o.A)(this,"jitter",void 0),(0,o.A)(this,"audioStutter",void 0),(0,o.A)(this,"videoStutter",void 0),(0,o.A)(this,"audiocodec",void 0),(0,o.A)(this,"videocodec",void 0),(0,o.A)(this,"firstAudioMuxDts",void 0),(0,o.A)(this,"lastAudioMuxDts",void 0),(0,o.A)(this,"firstVideoMuxDts",void 0),(0,o.A)(this,"lastVideoMuxDts",void 0),(0,o.A)(this,"audioCurrentTime",void 0),(0,o.A)(this,"videoCurrentTime",void 0)}));n=d.prototype,(i=new(c())).set("channels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),i.set("audioFrameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),i.set("audioPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),i.set("audioPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),i.set("audioPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),i.set("audioDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),i.set("audioDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),i.set("audioEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),i.set("audioFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),i.set("audioPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),i.set("audioFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),i.set("audioFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),i.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),i.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),i.set("keyFrameInterval",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),i.set("gop",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),i.set("videoPacketBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),i.set("videoPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),i.set("videoPacketQueueLength",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),i.set("videoDropPacketCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),i.set("videoDecodeErrorPacketCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),i.set("videoEncodeErrorFrameCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),i.set("videoFrameDecodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),i.set("videoPacketEncodeCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),i.set("videoFrameRenderCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),i.set("videoFrameDropCount",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:168,8:0}),i.set("keyFrameCount",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:176,8:0}),i.set("bufferDropBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:184,8:0}),i.set("bufferReceiveBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),i.set("bufferOutputBytes",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),i.set("audioBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),i.set("videoBitrate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:212,8:0}),i.set("videoDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),i.set("videoRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),i.set("videoEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),i.set("audioDecodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:228,8:0}),i.set("audioRenderFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),i.set("audioEncodeFramerate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:236,8:0}),i.set("audioFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),i.set("audioFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:244,8:0}),i.set("videoFrameDecodeIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:248,8:0}),i.set("videoFrameRenderIntervalMax",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),i.set("bandwidth",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),i.set("jitter",{0:19,1:0,2:0,3:0,4:0,5:0,6:0,7:264,8:0}),i.set("audioStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),i.set("videoStutter",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:276,8:0}),i.set("firstAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),i.set("lastAudioMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),i.set("firstVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:296,8:0}),i.set("lastVideoMuxDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:304,8:0}),i.set("audioCurrentTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:312,8:0}),i.set("videoCurrentTime",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:320,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,8),(0,h.A)(n,f.g7,328),(0,h.A)(n,f.JY,i)},61634:(e,t,r)=>{"use strict";r.d(t,{default:()=>Xe});var n=r(88435),i=r.n(n),a=r(69736),s=r.n(a),o=r(44301),u=r.n(o),c=r(82731),f=r.n(c),h=r(59614),d=r.n(h),l=r(969),p=r.n(l),v=r(23509),m=r(25182),g=r(77193),A=r(43070),y=r(60394),x=r(25767),k=r(31060),b=r(81570),w=r(78716),_=r(134),T=r(36443),I=r.n(T),S=r(80662),P=r.n(S),B=r(66681),C=r.n(B),M=r(54001),R=r.n(M),U=r(73146),E=r.n(U),D=r(61499),L=r(12085),F=r(12264),O=r(73783),N=r(69721),z=r(74503),V=r(63939),W=r(9599),j=r(29170),G=r(77162),q=r(94300),H=r(87243),Y=r(72480),Q=r(31138),$=r(18667),K=r(88506),J=r(96172),X=r(8284),Z=r(67672),ee=r(95335),te=r(76045),re=r(56024),ne=r(71517),ie=r(59377),ae=r(33968),se=r(8507),oe=r(26429),ue=r(41324),ce=r(88397),fe=r(11473),he=r(11628),de=r(28090),le=r(47595),pe=r(4624),ve=r(95797),me=r(48641),ge=r(36),Ae=r(86834),ye=r(44328),xe=r(77231),ke=r(30128),be=r(14686),we=r(86368),_e=r(94663),Te=r(10333),Ie=r(85224),Se=r(25115),Pe=r(21233),Be=r(13724),Ce=r(78201),Me=r(43607),Re=r(76750),Ue=r(2368),Ee=r(1984),De=r(62751),Le=r(548),Fe=r(72739),Oe=r(24310),Ne=r(93147),ze=r(40031);function Ve(e,t){var r=s()(e);if(u()){var n=u()(e);t&&(n=n.filter((function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(r),!0).forEach((function(t){(0,_.A)(e,t,r[t])})):d()?p()(e,d()(r)):Ve(Object(r)).forEach((function(t){C()(e,t,f()(r,t))}))}return e}function je(e,t,r){return t=(0,x.A)(t),(0,g.A)(e,Ge()?i()(t,r||[],(0,x.A)(e).constructor):t.apply(e,r))}function Ge(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(Ge=function(){return!!e})()}var qe,He,Ye="src/avplayer/AVPlayer.ts",Qe=(0,_.A)((0,_.A)({},1,"cover"),0,"contain"),$e=[27,173,12,196,225,139,167,30,86018,86017,86076,86028,86051,86021,86019,86056,86020,94226,94225,94230,94212,94232,94213,94210],Ke={enableHardware:!0,enableWebGPU:!0,loop:!1,jitterBufferMax:10,jitterBufferMin:4,lowLatency:!1,preLoadTime:4},Je=(0,b.A)((function e(){(0,w.A)(this,e),(0,_.A)(this,"avpacketList",void 0),(0,_.A)(this,"avframeList",void 0),(0,_.A)(this,"avpacketListMutex",void 0),(0,_.A)(this,"avframeListMutex",void 0),(0,_.A)(this,"jitterBuffer",void 0)}));qe=Je.prototype,(He=new(P())).set("avpacketList",{0:F.A,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),He.set("avframeList",{0:F.A,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),He.set("avpacketListMutex",{0:O.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),He.set("avframeListMutex",{0:O.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),He.set("jitterBuffer",{0:N.n,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),(0,L.A)(qe,D.Og,!0),(0,L.A)(qe,D.dc,4),(0,L.A)(qe,D.g7,40),(0,L.A)(qe,D.JY,He);var Xe=function(e){function t(e){var r;return(0,w.A)(this,t),r=je(this,t,[!0]),(0,_.A)((0,A.A)(r),"VideoDecoderThread",void 0),(0,_.A)((0,A.A)(r),"GlobalData",void 0),(0,_.A)((0,A.A)(r),"taskId",void 0),(0,_.A)((0,A.A)(r),"subTaskId",void 0),(0,_.A)((0,A.A)(r),"subtitleTaskId",void 0),(0,_.A)((0,A.A)(r),"ext",void 0),(0,_.A)((0,A.A)(r),"source",void 0),(0,_.A)((0,A.A)(r),"options",void 0),(0,_.A)((0,A.A)(r),"ioloader2DemuxerChannel",void 0),(0,_.A)((0,A.A)(r),"demuxer2VideoDecoderChannel",void 0),(0,_.A)((0,A.A)(r),"demuxer2AudioDecoderChannel",void 0),(0,_.A)((0,A.A)(r),"videoDecoder2VideoRenderChannel",void 0),(0,_.A)((0,A.A)(r),"audioDecoder2AudioRenderChannel",void 0),(0,_.A)((0,A.A)(r),"audioRender2AudioWorkletChannel",void 0),(0,_.A)((0,A.A)(r),"audioSourceNode",void 0),(0,_.A)((0,A.A)(r),"gainNode",void 0),(0,_.A)((0,A.A)(r),"formatContext",void 0),(0,_.A)((0,A.A)(r),"canvas",void 0),(0,_.A)((0,A.A)(r),"updateCanvas",void 0),(0,_.A)((0,A.A)(r),"video",void 0),(0,_.A)((0,A.A)(r),"audio",void 0),(0,_.A)((0,A.A)(r),"controller",void 0),(0,_.A)((0,A.A)(r),"volume",void 0),(0,_.A)((0,A.A)(r),"playRate",void 0),(0,_.A)((0,A.A)(r),"renderMode",void 0),(0,_.A)((0,A.A)(r),"renderRotate",void 0),(0,_.A)((0,A.A)(r),"flipHorizontal",void 0),(0,_.A)((0,A.A)(r),"flipVertical",void 0),(0,_.A)((0,A.A)(r),"useMSE",void 0),(0,_.A)((0,A.A)(r),"audioEnded",void 0),(0,_.A)((0,A.A)(r),"videoEnded",void 0),(0,_.A)((0,A.A)(r),"status",void 0),(0,_.A)((0,A.A)(r),"lastStatus",void 0),(0,_.A)((0,A.A)(r),"stats",void 0),(0,_.A)((0,A.A)(r),"statsController",void 0),(0,_.A)((0,A.A)(r),"jitterBufferController",void 0),(0,_.A)((0,A.A)(r),"selectedVideoStream",void 0),(0,_.A)((0,A.A)(r),"selectedAudioStream",void 0),(0,_.A)((0,A.A)(r),"selectedSubtitleStream",void 0),(0,_.A)((0,A.A)(r),"lastSelectedInnerSubtitleStreamIndex",void 0),(0,_.A)((0,A.A)(r),"subtitleRender",void 0),(0,_.A)((0,A.A)(r),"externalSubtitleTasks",void 0),r.options=ee.extend({},Ke,e),r.taskId=(0,X.A)(),r.status=0,r.volume=1,r.playRate=1,r.renderMode=0,r.renderRotate=0,r.flipHorizontal=!1,r.flipVertical=!1,r.stats=(0,z.A)(ke.A),r.statsController=new Ce.A(r.stats[D.o9]),r.externalSubtitleTasks=[],r.lastSelectedInnerSubtitleStreamIndex=-1,r.GlobalData=(0,z.A)(Je),O.Ts(r.GlobalData[D.o9]+24),O.Ts(r.GlobalData[D.o9]+28),pe.pq("create player, taskId: ".concat(r.taskId),Ye,340),r}var r,n,i,a,s,o,u,c,f,h,d,l,p,g,T,S,P,B,M,U,L,F,N,J,Ve,Ge,qe;return(0,k.A)(t,e),(0,b.A)(t,[{key:"currentTime",get:function(){var e;return this.useMSE?BigInt(Math.floor(1e3*((null===(e=this.video||this.audio)||void 0===e?void 0:e.currentTime)||0))):this.selectedAudioStream?this.stats.audioCurrentTime:this.selectedVideoStream?this.stats.videoCurrentTime:BigInt(0)}},{key:"isCodecIdSupported",value:function(e){return e>65536&&e<=65572||Fe.zy($e,e)}},{key:"findBestStream",value:function(e,t){var r=this;if(this.options.findBestStream)return this.options.findBestStream(e,t);var n=e.filter((function(e){return V.f[15](e.codecpar)===t}));if(n.length){if(1===n.length)return n[0];var i=n.find((function(e){return!!(1&e.disposition)}));return i&&this.isCodecIdSupported(V.f[15](i.codecpar+4))?i:n.find((function(e){return r.isCodecIdSupported(V.f[15](e.codecpar+4))}))||n[0]}}},{key:"checkUseMSE",value:(qe=(0,m.A)(I().mark((function e(){var t,r,n;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ve.A.mse){e.next=2;break}return e.abrupt("return",!1);case 2:if(ve.A.wasmBaseSupported){e.next=4;break}return e.abrupt("return",!0);case 4:if(t=this.findBestStream(this.formatContext.streams,0),r=this.findBestStream(this.formatContext.streams,1),!t||(0,Re.A)().isTypeSupported((0,Te.A)(t.codecpar))){e.next=9;break}return pe.R8("can not support mse for codec: ".concat((0,Te.A)(t.codecpar),", taskId: ").concat(this.taskId),Ye,401),e.abrupt("return",!1);case 9:if(!r||(0,Re.A)().isTypeSupported((0,Ie.A)(r.codecpar))){e.next=12;break}return pe.R8("can not support mse for codec: ".concat((0,Ie.A)(r.codecpar),", taskId: ").concat(this.taskId),Ye,405),e.abrupt("return",!1);case 12:if(!this.options.checkUseMES){e.next=14;break}return e.abrupt("return",this.options.checkUseMES(this.formatContext.streams));case 14:if(!t){e.next=33;break}if(!(0,Oe.A)(t.codecpar)){e.next=18;break}return pe.pq("use mse because of hdr",Ye,417),e.abrupt("return",!0);case 18:if(!(V.f[15](t.codecpar+56)*V.f[15](t.codecpar+60)>2073600)){e.next=30;break}if(ve.A.videoDecoder){e.next=21;break}return e.abrupt("return",!0);case 21:return n=null,0!==V.f[20](t.codecpar+12)&&(n=(0,be.s3)(V.f[20](t.codecpar+12),V.f[15](t.codecpar+16))),e.next=25,VideoDecoder.isConfigSupported({codec:(0,_e.A)(t.codecpar),codedWidth:V.f[15](t.codecpar+56),codedHeight:V.f[15](t.codecpar+60),description:n,hardwareAcceleration:(0,Pe.C)(!0)});case 25:if(e.sent.supported){e.next=28;break}return e.abrupt("return",!0);case 28:e.next=33;break;case 30:if(V.f[15](t.codecpar+56)*V.f[15](t.codecpar+60)!=2073600){e.next=33;break}if(!(Ae.A.safari&&!Ae.A.checkVersion(Ae.A.version,"16.1",!0)&&(0,ye.lb)((0,j.A)(t.codecpar+72,W.P))>30)){e.next=33;break}return e.abrupt("return",!0);case 33:return e.abrupt("return",!1);case 34:case"end":return e.stop()}}),e,this)}))),function(){return qe.apply(this,arguments)})},{key:"createCanvas",value:function(){var e=this,t=document.createElement("canvas");return t.id="avplayer-canvas-"+(0,X.A)(),t.className="avplayer-canvas",t.width=this.options.container.offsetWidth*devicePixelRatio,t.height=this.options.container.offsetHeight*devicePixelRatio,t.style.cssText="\n      width: 100%;\n      height: 100%;\n    ",t.ondragstart=function(){return!1},C()(t,"currentTime",{enumerable:!0,configurable:!1,get:function(){return Number(e.currentTime)/1e3},set:function(t){e.seek(BigInt(Math.floor(Math.floor(1e3*t))))}}),t}},{key:"createVideo",value:function(){this.video&&this.options.container.removeChild(this.video);var e=document.createElement("video");e.autoplay=!0,e.className="avplayer-video",e.style.cssText="\n      width: 100%;\n      height: 100%;\n    ",this.options.container.appendChild(e),this.video=e}},{key:"createAudio",value:function(){this.audio&&this.options.container.removeChild(this.audio);var e=document.createElement("audio");e.autoplay=!0,e.className="avplayer-audio",this.options.container.appendChild(e),this.audio=e}},{key:"handleTimeupdate",value:function(e){var r=this,n=0;e.ontimeupdate=function(){var i=e.currentTime;Math.abs(i-n)>=1&&(6===r.status&&(r.fire(de.E9,[r.currentTime]),t.MSEThread.setCurrentTime(r.taskId,i)),n=i)},e.onended=function(){r.audioEnded=!0,r.videoEnded=!0,r.handleEnded()},e.onwaiting=function(){r.audio===e?r.stats.audioStutter++:(r.stats.audioStutter++,r.stats.videoStutter++)},e.oncanplay=function(){6===r.status&&e.play()}}},{key:"handleEnded",value:(Ge=(0,m.A)(I().mark((function e(){var r,n,i,a,s,o;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.audioEnded||!this.videoEnded){e.next=72;break}if(pe.pq("player ended, taskId: ".concat(this.taskId),Ye,546),!this.options.loop||this.options.isLive){e.next=65;break}if(pe.pq("loop play, taskId: ".concat(this.taskId),Ye,550),!this.isHls()){e.next=9;break}return e.next=7,t.DemuxerThread.seek(this.taskId,BigInt(0),16);case 7:e.next=22;break;case 9:if(!this.isDash()){e.next=20;break}return e.next=12,t.DemuxerThread.seek(this.taskId,BigInt(0),16);case 12:if(!this.subTaskId){e.next=15;break}return e.next=15,t.DemuxerThread.seek(this.subTaskId,BigInt(0),16);case 15:if(!this.subtitleTaskId){e.next=18;break}return e.next=18,t.DemuxerThread.seek(this.subtitleTaskId,BigInt(0),16);case 18:e.next=22;break;case 20:return e.next=22,t.DemuxerThread.seek(this.taskId,BigInt(0),8);case 22:r=0;case 23:if(!(r<this.externalSubtitleTasks.length)){e.next=29;break}return e.next=26,t.DemuxerThread.seek(this.externalSubtitleTasks[0].taskId,BigInt(0),8);case 26:r++,e.next=23;break;case 29:if(this.fire(de.E9,[BigInt(0)]),!this.useMSE){e.next=44;break}return null!==(n=this.video||this.audio)&&void 0!==n&&n.src&&URL.revokeObjectURL((this.video||this.audio).src),e.next=34,t.MSEThread.restart(this.taskId);case 34:return e.next=36,t.MSEThread.getMediaSource(this.taskId);case 36:if(!(i=e.sent)){e.next=42;break}return ve.A.workerMSE&&i instanceof MediaSourceHandle?(this.video||this.audio).srcObject=i:(this.video||this.audio).src=URL.createObjectURL(i),this.video?(this.video.currentTime=0,this.video.playbackRate=this.playRate):this.audio&&(this.audio.currentTime=0,this.audio.playbackRate=this.playRate),e.next=42,R().all([null===(a=this.video)||void 0===a?void 0:a.play(),null===(s=this.audio)||void 0===s?void 0:s.play()]);case 42:e.next=62;break;case 44:if(!this.audioDecoder2AudioRenderChannel){e.next=49;break}return e.next=47,t.AudioDecoderThread.resetTask(this.taskId);case 47:return e.next=49,t.AudioRenderThread.restart(this.taskId);case 49:if(!this.audioSourceNode){e.next=56;break}return e.next=52,this.audioSourceNode.request("restart");case 52:if("suspended"!==t.audioContext.state){e.next=55;break}return e.next=55,t.AudioRenderThread.fakePlay(this.taskId);case 55:this.audioEnded=!1;case 56:if(!this.videoDecoder2VideoRenderChannel){e.next=62;break}return e.next=59,this.VideoDecoderThread.resetTask(this.taskId);case 59:return e.next=61,t.VideoRenderThread.restart(this.taskId);case 61:this.videoEnded=!1;case 62:this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start()),e.next=72;break;case 65:return null!==(o=this.video||this.audio)&&void 0!==o&&o.src&&URL.revokeObjectURL((this.video||this.audio).src),this.video&&(this.options.container.removeChild(this.video),this.video=null),this.audio&&(this.options.container.removeChild(this.audio),this.audio=null),this.canvas&&(this.options.container.removeChild(this.canvas),this.canvas=null),e.next=71,this.stop();case 71:this.fire(de.hV);case 72:case"end":return e.stop()}}),e,this)}))),function(){return Ge.apply(this,arguments)})},{key:"isHls",value:function(){return"m3u8"===this.ext||"m3u"===this.ext}},{key:"isDash",value:function(){return"mpd"===this.ext}},{key:"getResource",value:(Ve=(0,m.A)(I().mark((function e(r,n,i){var a,s,o;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=n?"".concat(r,"-").concat(n):r,!t.Resource.has(a)){e.next=3;break}return e.abrupt("return",t.Resource.get(a));case 3:if(!(s=this.options.getWasm(r,n,i))){e.next=19;break}if(!Z.Yj(s)&&!Z.sv(s)){e.next=16;break}return e.next=8,(0,te.A)({source:s});case 8:if(o=e.sent,!oe._7||0!==i){e.next=13;break}return e.next=12,(0,te.A)({source:Ae.A.firefox?s:o.buffer},{child:!0});case 12:o.threadModule=e.sent;case 13:delete o.buffer,e.next=17;break;case 16:o=s;case 17:return t.Resource.set(a,o),e.abrupt("return",o);case 19:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return Ve.apply(this,arguments)})},{key:"createSubtitleRender",value:function(e,r){var n,i,a,s,o=this;this.subtitleRender=new ze.A({dom:this.canvas||this.video||this.options.container,getCurrentTime:function(){return o.currentTime},avpacketList:this.GlobalData[D.o9],avpacketListMutex:this.GlobalData[D.o9]+24,codecpar:e.codecpar,container:this.options.container,videoWidth:null!==(n=V.f[15]((null===(i=this.selectedVideoStream)||void 0===i?void 0:i.codecpar)+56))&&void 0!==n?n:0,videoHeight:null!==(a=V.f[15]((null===(s=this.selectedVideoStream)||void 0===s?void 0:s.codecpar)+60))&&void 0!==a?a:0}),this.subtitleRender.setDemuxTask(r),this.selectedSubtitleStream=e,r===this.taskId&&(this.lastSelectedInnerSubtitleStreamIndex=e.index),t.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(r)).invoke(r,e.index,this.subtitleRender.getDemuxerPort(r))}},{key:"loadExternalSubtitle",value:(J=(0,m.A)(I().mark((function e(r){var n,i,a,s,o,u,c,f;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==this.status&&2!==this.status||pe.h2("player has already destroyed",Ye,743),r.source||pe.h2("external subtitle must has source",Ye,747),!this.externalSubtitleTasks.some((function(e){return e.source===r.source}))){e.next=5;break}return pe.R8("external subtitle has already loaded",Ye,751),e.abrupt("return");case 5:if(n=(0,X.A)(),i=(0,we.A)(),a=ee.extend({taskId:n,streamId:-1,ioloader2DemuxerChannel:i},r),s="",o=0,!Z.Yj(r.source)){e.next=17;break}return s=se.qg(r.source).file.split(".").pop(),e.next=14,t.IOThread.registerTask.transfer(i.port1).invoke({type:0,info:{url:r.source},range:{from:-1,to:-1},taskId:n,options:{isLive:this.options.isLive},rightPort:i.port1,stats:this.stats[D.o9]});case 14:o=e.sent,e.next=21;break;case 17:return s=r.source.name.split(".").pop(),e.next=20,t.IOThread.registerTask.transfer(i.port1).invoke({type:1,info:{file:r.source},range:{from:-1,to:-1},taskId:n,options:{isLive:this.options.isLive},rightPort:i.port1,stats:this.stats[D.o9]});case 20:o=e.sent;case 21:return o<0&&pe.h2("register io task failed, ret: ".concat(o,", taskId: ").concat(this.taskId),Ye,812),e.next=24,t.DemuxerThread.registerTask.transfer(i.port2).invoke({taskId:n,leftPort:i.port2,format:De.HR[s],stats:0,isLive:!1,flags:0,avpacketList:this.GlobalData[D.o9],avpacketListMutex:this.GlobalData[D.o9]+24});case 24:return e.next=26,t.DemuxerThread.openStream(n);case 26:return(o=e.sent)<0&&pe.h2("open external subtitle failed, ret: ".concat(o,", taskId: ").concat(n),Ye,829),e.next=30,t.DemuxerThread.analyzeStreams(n);case 30:if(u=e.sent,!Z.ai(u)&&u.streams.length||pe.h2("analyze stream failed, ret: ".concat(u),Ye,833),c=u.streams[0],this.formatContext.streams.push(c),a.streamId=c.id,r.lang&&(c.metadata.language=r.lang),r.title&&(c.metadata.title=r.title),!(f=7===this.status||6===this.status||8===this.status||9===this.status)){e.next=41;break}return e.next=41,t.DemuxerThread.seek(n,this.currentTime,8);case 41:if(!f||this.subtitleRender){e.next=46;break}this.createSubtitleRender(c,n),this.subtitleRender.start(),e.next=49;break;case 46:if(!this.subtitleRender){e.next=49;break}return e.next=49,t.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(n)).invoke(n,c.index,this.subtitleRender.getDemuxerPort(n));case 49:return e.next=51,t.DemuxerThread.startDemux(n,!1,10);case 51:return this.externalSubtitleTasks.push(a),this.fire(de.xv),e.abrupt("return",0);case 54:case"end":return e.stop()}}),e,this)}))),function(e){return J.apply(this,arguments)})},{key:"load",value:(N=(0,m.A)(I().mark((function e(r){var n,i,a,s,o,u,c,f,h,d,l,p,v,m=this,g=arguments;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=g.length>1&&void 0!==g[1]?g[1]:[],pe.pq("call load, taskId: ".concat(this.taskId),Ye,883),this.status=3,this.fire(de.F5),this.controller=new he.A(this),this.ioloader2DemuxerChannel=(0,we.A)(),(0,be.sO)(this.stats[D.o9],0,328),this.externalSubtitleTasks.length=0,e.next=10,t.startDemuxPipeline();case 10:if(i=0,!Z.Yj(r)){e.next=18;break}return this.ext=se.qg(r).file.split(".").pop(),e.next=15,t.IOThread.registerTask.transfer(this.ioloader2DemuxerChannel.port1).invoke({type:null!==(a=De.$$[this.ext])&&void 0!==a?a:0,info:{url:r},range:{from:-1,to:-1},taskId:this.taskId,options:{isLive:this.options.isLive},rightPort:this.ioloader2DemuxerChannel.port1,stats:this.stats[D.o9]});case 15:i=e.sent,e.next=23;break;case 18:return this.options.isLive=!1,this.ext=r.name.split(".").pop(),e.next=22,t.IOThread.registerTask.transfer(this.ioloader2DemuxerChannel.port1).invoke({type:1,info:{file:r},range:{from:-1,to:-1},taskId:this.taskId,options:{isLive:!1},rightPort:this.ioloader2DemuxerChannel.port1,stats:this.stats[D.o9]});case 22:i=e.sent;case 23:if(i<0&&pe.h2("register io task failed, ret: ".concat(i,", taskId: ").concat(this.taskId),Ye,944),!this.isDash()){e.next=45;break}return e.next=27,t.IOThread.open(this.taskId);case 27:return e.next=29,t.IOThread.hasAudio(this.taskId);case 29:return s=e.sent,e.next=32,t.IOThread.hasVideo(this.taskId);case 32:if(o=e.sent,!s||!o){e.next=41;break}return this.subTaskId=(0,X.A)(),e.next=37,t.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:De.HR[this.ext],stats:this.stats[D.o9],isLive:this.options.isLive,flags:2,ioloaderOptions:{mediaType:"audio"},avpacketList:this.GlobalData[D.o9],avpacketListMutex:this.GlobalData[D.o9]+24});case 37:return e.next=39,t.DemuxerThread.registerTask({taskId:this.subTaskId,mainTaskId:this.taskId,flags:2,format:De.HR[this.ext],stats:this.stats[D.o9],isLive:this.options.isLive,ioloaderOptions:{mediaType:"video"},avpacketList:this.GlobalData[D.o9],avpacketListMutex:this.GlobalData[D.o9]+24});case 39:e.next=43;break;case 41:return e.next=43,t.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:De.HR[this.ext],stats:this.stats[D.o9],isLive:this.options.isLive,flags:2,ioloaderOptions:{mediaType:s?"audio":"video"},avpacketList:this.GlobalData[D.o9],avpacketListMutex:this.GlobalData[D.o9]+24});case 43:e.next=47;break;case 45:return e.next=47,t.DemuxerThread.registerTask.transfer(this.ioloader2DemuxerChannel.port2,this.controller.getDemuxerControlPort()).invoke({taskId:this.taskId,leftPort:this.ioloader2DemuxerChannel.port2,controlPort:this.controller.getDemuxerControlPort(),format:De.HR[this.ext],stats:this.stats[D.o9],isLive:this.options.isLive,flags:this.isHls()?2:0,avpacketList:this.GlobalData[D.o9],avpacketListMutex:this.GlobalData[D.o9]+24});case 47:if(!this.isDash()&&!this.isHls()){e.next=55;break}return e.next=50,t.IOThread.hasSubtitle(this.taskId);case 50:if(!e.sent){e.next=55;break}return this.subtitleTaskId=(0,X.A)(),e.next=55,t.DemuxerThread.registerTask({taskId:this.subtitleTaskId,mainTaskId:this.taskId,flags:2,format:De.HR[this.ext],stats:this.stats[D.o9],isLive:this.options.isLive,ioloaderOptions:{mediaType:"subtitle"},avpacketList:this.GlobalData[D.o9],avpacketListMutex:this.GlobalData[D.o9]+24});case 55:return this.fire(de.Gd,[0]),e.next=58,t.DemuxerThread.openStream(this.taskId);case 58:return(i=e.sent)<0&&pe.h2("open stream failed, ret: ".concat(i,", taskId: ").concat(this.taskId),Ye,1045),this.fire(de.Gd,[1,this.ext]),e.next=63,t.DemuxerThread.analyzeStreams(this.taskId);case 63:if(u=e.sent,!Z.ai(u)&&u.streams.length||pe.h2("analyze stream failed, ret: ".concat(u),Ye,1052),!this.subTaskId){e.next=75;break}return e.next=68,t.DemuxerThread.openStream(this.subTaskId);case 68:return(i=e.sent)<0&&pe.h2("open stream failed, ret: ".concat(i,", taskId: ").concat(this.subTaskId),Ye,1058),e.next=72,t.DemuxerThread.analyzeStreams(this.subTaskId);case 72:c=e.sent,!Z.ai(c)&&c.streams.length||pe.h2("analyze stream failed, ret: ".concat(c),Ye,1062),u.streams=u.streams.concat(c.streams);case 75:if(!this.subtitleTaskId){e.next=85;break}return e.next=78,t.DemuxerThread.openStream(this.subtitleTaskId);case 78:return(i=e.sent)<0&&pe.h2("open subtitle stream failed, ret: ".concat(i,", taskId: ").concat(this.subtitleTaskId),Ye,1070),e.next=82,t.DemuxerThread.analyzeStreams(this.subtitleTaskId);case 82:f=e.sent,!Z.ai(f)&&f.streams.length||pe.h2("analyze subtitle stream failed, ret: ".concat(f),Ye,1074),u.streams=u.streams.concat(f.streams);case 85:this.formatContext=u,this.source=r,h=0;case 88:if(!(h<n.length)){e.next=94;break}return e.next=91,this.loadExternalSubtitle(n[h]);case 91:h++,e.next=88;break;case 94:if(u.streams.forEach((function(e){1===V.f[15](e.codecpar)?m.stats.audiocodec=(0,Ee.A)(e.codecpar):0===V.f[15](e.codecpar)&&(m.stats.videocodec=(0,_e.A)(e.codecpar))})),pe.pq("\n"+(0,Le.Ay)([u],[{from:Z.Yj(r)?r:r.name,tag:"Input"}]),Ye,1095),!this.isHls()&&!this.isDash()){e.next=102;break}return e.next=99,t.IOThread.getDuration(this.taskId);case 99:if(e.t0=e.sent,(d=1e3*e.t0)>0)for(l=0;l<this.formatContext.streams.length;l++)this.formatContext.streams[l].duration=(0,ye.k)(BigInt(Math.floor(d)),xe.i0,(0,j.A)(this.formatContext.streams[l].timeBase,W.P));case 102:if(!this.options.isLive||!this.options.lowLatency){e.next=112;break}return e.t1=Math,e.next=106,t.IOThread.getMinBuffer(this.taskId);case 106:e.t2=e.sent,e.t3=this.options.jitterBufferMin,p=e.t1.max.call(e.t1,e.t2,e.t3),(v=this.options.jitterBufferMax)<=p&&(v=p+(this.isHls()||this.isDash()?p:1)),this.jitterBufferController=new Ue.A({stats:this.stats[D.o9],jitterBuffer:this.GlobalData[D.o9]+32,lowLatencyStart:!(this.isHls()||this.isDash()),useMse:this.useMSE,max:v,min:p,observer:{onCroppingBuffer:function(e){var r;pe.Yz("cropping buffer by jitter buffer, max: ".concat(e,", taskId: ").concat(m.taskId),Ye,1131),null===(r=t.DemuxerThread)||void 0===r||r.croppingAVPacketQueue(m.taskId,BigInt(e>>>0))},onSetPlayRate:function(e){pe.Yz("set play rate by jitter buffer, rate: ".concat(e,", taskId: ").concat(m.taskId),Ye,1135),m.useMSE?(t.MSEThread.setPlayRate(m.taskId,e),m.video?m.video.playbackRate=e:m.audio&&(m.audio.playbackRate=e)):(m.audioDecoder2AudioRenderChannel&&t.AudioRenderThread.setPlayTempo(m.taskId,e),m.videoDecoder2VideoRenderChannel&&t.VideoRenderThread.setPlayRate(m.taskId,e))}}});case 112:this.status=4,this.fire(de.S2);case 114:case"end":return e.stop()}}),e,this)}))),function(e){return N.apply(this,arguments)})},{key:"play",value:(F=(0,m.A)(I().mark((function e(){var r,n,i,a,s,o,u,c,f,h,d,l,p,v,g,A,y,x,k,b,w,_,T,S,P=this,B=arguments;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=B.length>0&&void 0!==B[0]?B[0]:{audio:!0,video:!0,subtitle:!0},pe.pq("call play, options: ".concat(E()(r),", status: ").concat(this.status," taskId: ").concat(this.taskId),Ye,1188),6!==this.status){e.next=4;break}return e.abrupt("return");case 4:if(r.audio||r.video||(pe.R8("video and audio must play one, ignore options, we will try to play video and audio, taskId: ".concat(this.taskId),Ye,1195),r.audio=!0,r.video=!0),n=[],7!==this.status){e.next=12;break}if(!(this.selectedAudioStream&&this.selectedVideoStream&&this.stats.videoCurrentTime-this.stats.audioCurrentTime>BigInt(400))){e.next=10;break}return e.next=10,t.AudioRenderThread.syncSeekTime(this.taskId,this.stats.videoCurrentTime);case 10:return this.useMSE?(n.push(t.MSEThread.unpause(this.taskId)),this.audio?this.audio.play():this.video&&this.video.play()):(this.audioSourceNode&&(n.push(this.audioSourceNode.request("unpause")),n.push(t.AudioRenderThread.unpause(this.taskId))),this.videoDecoder2VideoRenderChannel&&n.push(t.VideoRenderThread.unpause(this.taskId))),e.abrupt("return",R().all(n).then((function(){P.status=6,P.fire(de.CN),P.jitterBufferController&&P.jitterBufferController.start(),P.subtitleRender&&P.subtitleRender.start()})));case 12:return this.status=5,this.fire(de.d6),e.next=16,this.checkUseMSE();case 16:if(this.useMSE=e.sent,this.audioEnded=!0,this.videoEnded=!0,!this.useMSE){e.next=66;break}return e.next=22,t.startMSEPipeline();case 22:return i=this.findBestStream(this.formatContext.streams,0),a=this.findBestStream(this.formatContext.streams,1),s=!1,e.t0=t.MSEThread.registerTask.transfer(this.controller.getMuxerControlPort()),e.t1=this.taskId,e.t2=this.stats[D.o9],e.next=30,t.DemuxerThread.getFormat(this.taskId);case 30:return e.t3=e.sent,e.t4=this.controller.getMuxerControlPort(),e.t5=this.options.isLive,e.t6=this.GlobalData[D.o9],e.t7=this.GlobalData[D.o9]+24,e.t8=!!this.jitterBufferController,e.t9=this.GlobalData[D.o9]+32,e.t10={taskId:e.t1,stats:e.t2,format:e.t3,controlPort:e.t4,isLive:e.t5,avpacketList:e.t6,avpacketListMutex:e.t7,enableJitterBuffer:e.t8,jitterBuffer:e.t9},e.next=40,e.t0.invoke.call(e.t0,e.t10);case 40:if(!i||!r.video){e.next=50;break}return this.fire(de.Gd,[3,i]),s=!0,this.selectedVideoStream=i,this.videoEnded=!1,this.demuxer2VideoDecoderChannel=(0,we.A)(),e.next=48,t.DemuxerThread.connectStreamTask.transfer(this.demuxer2VideoDecoderChannel.port1).invoke(this.subTaskId||this.taskId,i.index,this.demuxer2VideoDecoderChannel.port1);case 48:return e.next=50,t.MSEThread.addStream.transfer(this.demuxer2VideoDecoderChannel.port2).invoke(this.taskId,i.index,i.codecpar,i.timeBase,i.startTime,this.demuxer2VideoDecoderChannel.port2);case 50:if(!a||!r.audio){e.next=59;break}return this.fire(de.Gd,[2,a]),this.selectedAudioStream=a,this.audioEnded=!1,this.demuxer2AudioDecoderChannel=(0,we.A)(),e.next=57,t.DemuxerThread.connectStreamTask.transfer(this.demuxer2AudioDecoderChannel.port1).invoke(this.taskId,a.index,this.demuxer2AudioDecoderChannel.port1);case 57:return e.next=59,t.MSEThread.addStream.transfer(this.demuxer2AudioDecoderChannel.port2).invoke(this.taskId,a.index,a.codecpar,a.timeBase,a.startTime,this.demuxer2AudioDecoderChannel.port2);case 59:return s?this.createVideo():this.createAudio(),e.next=62,t.MSEThread.getMediaSource(this.taskId);case 62:(o=e.sent)&&(ve.A.workerMSE&&o instanceof MediaSourceHandle?(this.video||this.audio).srcObject=o:(this.video||this.audio).src=URL.createObjectURL(o),this.handleTimeupdate(this.video||this.audio)),e.next=171;break;case 66:if(u=BigInt(0),c=BigInt(0),f=this.findBestStream(this.formatContext.streams,0),h=this.findBestStream(this.formatContext.streams,1),!f||!r.video){e.next=100;break}return this.fire(de.Gd,[3,f]),this.selectedVideoStream=f,e.next=75,this.createVideoDecoderThread();case 75:return e.next=77,t.startVideoRenderPipeline();case 77:return c=(0,ye.k)(f.startTime,(0,j.A)(f.timeBase,W.P),xe.i0),this.demuxer2VideoDecoderChannel=(0,we.A)(),this.videoDecoder2VideoRenderChannel=(0,we.A)(),e.next=82,this.getResource("decoder",V.f[15](f.codecpar+4),V.f[15](f.codecpar));case 82:if(d=e.sent){e.next=92;break}if(!ve.A.videoDecoder){e.next=91;break}return e.next=87,VideoDecoder.isConfigSupported({codec:(0,_e.A)(f.codecpar)});case 87:e.sent.supported||pe.h2("".concat((0,Le.eG)(V.f[15](f.codecpar),V.f[15](f.codecpar+4))," codecId ").concat(V.f[15](f.codecpar+4)," not support"),Ye,1352),e.next=92;break;case 91:pe.h2("".concat((0,Le.eG)(V.f[15](f.codecpar),V.f[15](f.codecpar+4))," codecId ").concat(V.f[15](f.codecpar+4)," not support"),Ye,1356);case 92:return e.next=94,this.VideoDecoderThread.registerTask.transfer(this.demuxer2VideoDecoderChannel.port2,this.videoDecoder2VideoRenderChannel.port1).invoke({taskId:this.taskId,resource:d,leftPort:this.demuxer2VideoDecoderChannel.port2,rightPort:this.videoDecoder2VideoRenderChannel.port1,stats:this.stats[D.o9],enableHardware:this.options.enableHardware,avpacketList:this.GlobalData[D.o9],avpacketListMutex:this.GlobalData[D.o9]+24,avframeList:this.GlobalData[D.o9]+12,avframeListMutex:this.GlobalData[D.o9]+28,preferWebCodecs:!(0,Oe.A)(f.codecpar)&&!(0,Ne.A)(f.codecpar)});case 94:return e.next=96,this.VideoDecoderThread.open(this.taskId,f.codecpar);case 96:return e.sent<0&&pe.h2("cannot open video ".concat((0,Le.eG)(V.f[15](f.codecpar),V.f[15](f.codecpar+4))," decoder"),Ye,1379),e.next=100,t.DemuxerThread.connectStreamTask.transfer(this.demuxer2VideoDecoderChannel.port1).invoke(this.subTaskId||this.taskId,f.index,this.demuxer2VideoDecoderChannel.port1);case 100:if(!h||!r.audio){e.next=131;break}return this.fire(de.Gd,[2,h]),this.selectedAudioStream=h,e.next=105,t.startAudioPipeline();case 105:if("suspended"!==t.audioContext.state){e.next=108;break}return e.next=108,R().race([t.audioContext.resume(),new Be.A(.1)]);case 108:return u=(0,ye.k)(h.startTime,(0,j.A)(h.timeBase,W.P),xe.i0),this.demuxer2AudioDecoderChannel=(0,we.A)(),this.audioDecoder2AudioRenderChannel=(0,we.A)(),e.next=113,this.getResource("decoder",V.f[15](h.codecpar+4),V.f[15](h.codecpar));case 113:if(l=e.sent){e.next=123;break}if(!ve.A.audioDecoder){e.next=122;break}return e.next=118,AudioDecoder.isConfigSupported({codec:(0,Ee.A)(h.codecpar),sampleRate:V.f[15](h.codecpar+136),numberOfChannels:V.f[15](h.codecpar+116)});case 118:e.sent.supported||pe.h2("".concat((0,Le.eG)(V.f[15](h.codecpar),V.f[15](h.codecpar+4))," codecId ").concat(V.f[15](h.codecpar+4)," not support"),Ye,1413),e.next=123;break;case 122:pe.h2("".concat((0,Le.eG)(V.f[15](h.codecpar),V.f[15](h.codecpar+4))," codecId ").concat(V.f[15](h.codecpar+4)," not support"),Ye,1417);case 123:return e.next=125,t.AudioDecoderThread.registerTask.transfer(this.demuxer2AudioDecoderChannel.port2,this.audioDecoder2AudioRenderChannel.port1).invoke({taskId:this.taskId,resource:l,leftPort:this.demuxer2AudioDecoderChannel.port2,rightPort:this.audioDecoder2AudioRenderChannel.port1,stats:this.stats[D.o9],timeBase:{num:V.f[15](h.timeBase),den:V.f[15](h.timeBase+4)},avpacketList:this.GlobalData[D.o9],avpacketListMutex:this.GlobalData[D.o9]+24,avframeList:this.GlobalData[D.o9]+12,avframeListMutex:this.GlobalData[D.o9]+28});case 125:return e.next=127,t.AudioDecoderThread.open(this.taskId,h.codecpar);case 127:return e.sent<0&&pe.h2("cannot open audio ".concat((0,Le.eG)(V.f[15](h.codecpar),V.f[15](h.codecpar+4))," decoder"),Ye,1442),e.next=131,t.DemuxerThread.connectStreamTask.transfer(this.demuxer2AudioDecoderChannel.port1).invoke(this.taskId,h.index,this.demuxer2AudioDecoderChannel.port1);case 131:if(!this.videoDecoder2VideoRenderChannel){e.next=142;break}return this.canvas=this.createCanvas(),this.options.container.appendChild(this.canvas),p=(0,le.A)()&&oe._7?this.canvas.transferControlToOffscreen():this.canvas,v=this.formatContext.streams.find((function(e){return 0===V.f[15](e.codecpar)})),e.next=138,t.VideoRenderThread.registerTask.transfer(this.videoDecoder2VideoRenderChannel.port2,this.controller.getVideoRenderControlPort(),p).invoke({taskId:this.taskId,leftPort:this.videoDecoder2VideoRenderChannel.port2,controlPort:this.controller.getVideoRenderControlPort(),canvas:p,renderMode:this.renderMode,renderRotate:this.renderRotate,flipHorizontal:this.flipHorizontal,flipVertical:this.flipVertical,timeBase:{num:V.f[15](v.timeBase),den:V.f[15](v.timeBase+4)},viewportWidth:this.options.container.offsetWidth,viewportHeight:this.options.container.offsetHeight,devicePixelRatio,stats:this.stats[D.o9],enableWebGPU:this.options.enableWebGPU,startPTS:v.startTime,avframeList:this.GlobalData[D.o9]+12,avframeListMutex:this.GlobalData[D.o9]+28,enableJitterBuffer:!!this.jitterBufferController&&!this.audioDecoder2AudioRenderChannel,jitterBuffer:this.GlobalData[D.o9]+32});case 138:return this.videoEnded=!1,e.next=141,t.VideoRenderThread.setPlayRate(this.taskId,this.playRate);case 141:n.push(t.VideoRenderThread.play(this.taskId));case 142:if(!this.audioDecoder2AudioRenderChannel){e.next=169;break}return g=this.formatContext.streams.find((function(e){return 1===V.f[15](e.codecpar)})),this.audioRender2AudioWorkletChannel=new MessageChannel,A=Math.max(V.f[15](g.codecpar+116),Math.min(t.audioContext.destination.channelCount,2)),e.next=148,this.getResource("resampler");case 148:return y=e.sent,e.next=151,this.getResource("stretchpitcher");case 151:return x=e.sent,y||pe.h2("resampler not found",Ye,1511),x||pe.h2("stretch pitcher not found",Ye,1514),e.next=156,t.AudioRenderThread.registerTask.transfer(this.audioDecoder2AudioRenderChannel.port2,this.audioRender2AudioWorkletChannel.port1,this.controller.getAudioRenderControlPort()).invoke({taskId:this.taskId,leftPort:this.audioDecoder2AudioRenderChannel.port2,rightPort:this.audioRender2AudioWorkletChannel.port1,controlPort:this.controller.getAudioRenderControlPort(),playFormat:8,playSampleRate:t.audioContext.sampleRate,playChannels:A,resamplerResource:y,stretchpitcherResource:x,stats:this.stats[D.o9],timeBase:{num:V.f[15](g.timeBase),den:V.f[15](g.timeBase+4)},startPTS:g.startTime,avframeList:this.GlobalData[D.o9]+12,avframeListMutex:this.GlobalData[D.o9]+28,enableJitterBuffer:!!this.jitterBufferController,jitterBuffer:this.GlobalData[D.o9]+32});case 156:if(k=ve.A.audioWorklet?ce.A:me.A,this.audioSourceNode=new k(t.audioContext,{onEnded:function(){P.onAudioEnded()},onFirstRendered:function(){P.onFirstAudioRendered()},onStutter:function(){P.onStutter()}},{numberOfInputs:1,numberOfOutputs:1,outputChannelCount:[A]}),!oe._7||!ve.A.audioWorklet||Ae.A.safari&&!Ae.A.checkVersion(Ae.A.version,"16.1",!0)){e.next=161;break}return e.next=161,this.audioSourceNode.request("init",{memory:fe.ce});case 161:return e.next=163,t.AudioRenderThread.setPlayTempo(this.taskId,this.playRate);case 163:this.gainNode=t.audioContext.createGain(),this.gainNode.connect(t.audioContext.destination),this.audioSourceNode.connect(this.gainNode),this.setVolume(this.volume),this.audioEnded=!1,n.push(this.audioSourceNode.request("start",{port:this.audioRender2AudioWorkletChannel.port2,channels:A},[this.audioRender2AudioWorkletChannel.port2]));case 169:this.audioDecoder2AudioRenderChannel?this.controller.setTimeUpdateListenType(1):this.videoDecoder2VideoRenderChannel&&this.controller.setTimeUpdateListenType(0),this.videoDecoder2VideoRenderChannel&&this.audioDecoder2AudioRenderChannel&&Me.tn(c-u)>BigInt(1e4)&&this.controller.setEnableAudioVideoSync(!1);case 171:if((b=this.findBestStream(this.formatContext.streams,3))&&r.subtitle&&this.isCodecIdSupported(V.f[15](b.codecpar+4))&&(w=this.externalSubtitleTasks.find((function(e){return e.streamId===b.id})),this.createSubtitleRender(b,w?w.taskId:this.subtitleTaskId||this.taskId)),!this.subtitleRender||!this.externalSubtitleTasks.length){e.next=181;break}_=I().mark((function e(r){var n;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=P.formatContext.streams.find((function(e){return e.id===P.externalSubtitleTasks[r].streamId})))===b){e.next=4;break}return e.next=4,t.DemuxerThread.connectStreamTask.transfer(P.subtitleRender.getDemuxerPort(P.externalSubtitleTasks[r].taskId)).invoke(P.externalSubtitleTasks[r].taskId,n.index,P.subtitleRender.getDemuxerPort(P.externalSubtitleTasks[r].taskId));case 4:case"end":return e.stop()}}),e)})),T=0;case 176:if(!(T<this.externalSubtitleTasks.length)){e.next=181;break}return e.delegateYield(_(T),"t11",178);case 178:T++,e.next=176;break;case 181:return S=10,Z.Yj(this.source)&&!this.options.isLive&&this.formatContext.streams.forEach((function(e){S=Math.max(Math.ceil((0,ye.lb)((0,j.A)(e.codecpar+72,W.P))*P.options.preLoadTime),S)})),n.push(t.DemuxerThread.startDemux(this.taskId,this.options.isLive,S)),this.subTaskId&&n.push(t.DemuxerThread.startDemux(this.subTaskId,this.options.isLive,S)),this.subtitleTaskId&&n.push(t.DemuxerThread.startDemux(this.subtitleTaskId,this.options.isLive,S)),e.abrupt("return",R().all(n).then((0,m.A)(I().mark((function e(){var r,n;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.status=6,!P.useMSE){e.next=6;break}return e.next=4,R().all([null===(r=P.video)||void 0===r?void 0:r.play(),null===(n=P.audio)||void 0===n?void 0:n.play()]).catch((function(e){if(P.video)return P.video.muted=!0,P.fire(de.IY),pe.R8("the audioContext was not started. It must be resumed after a user gesture",Ye,1658),P.video.play();throw e}));case 4:e.next=14;break;case 6:if(!P.audioSourceNode||"suspended"!==t.audioContext.state){e.next=14;break}if("suspended"===t.audioContext.state&&(P.fire(de.IY),pe.R8("the audioContext was not started. It must be resumed after a user gesture",Ye,1670)),!P.videoDecoder2VideoRenderChannel){e.next=13;break}t.AudioRenderThread.fakePlay(P.taskId),P.controller.setTimeUpdateListenType(0),e.next=14;break;case 13:throw new Error("the audioContext was not started. It must be resumed after a user gesture");case 14:P.fire(de.CN),P.statsController.start(),P.jitterBufferController&&P.jitterBufferController.start(),P.subtitleRender&&P.subtitleRender.start();case 18:case"end":return e.stop()}}),e)})))));case 187:case"end":return e.stop()}}),e,this)}))),function(){return F.apply(this,arguments)})},{key:"pause",value:(L=(0,m.A)(I().mark((function e(){var r,n=this;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pe.pq("call pause, taskId: ".concat(this.taskId),Ye,1698),this.options.isLive){e.next=7;break}return r=[],this.useMSE?(this.audio&&this.audio.pause(),this.video&&this.video.pause(),r.push(t.MSEThread.pause(this.taskId))):(this.audioSourceNode&&(r.push(this.audioSourceNode.request("pause")),r.push(t.AudioRenderThread.pause(this.taskId))),this.videoDecoder2VideoRenderChannel&&r.push(t.VideoRenderThread.pause(this.taskId))),e.abrupt("return",R().all(r).then((function(){8===n.status?n.lastStatus=7:n.status=7,n.fire(de.NN),n.jitterBufferController&&n.jitterBufferController.stop(),n.subtitleRender&&n.subtitleRender.pause()})));case 7:pe.R8("pause can only used in vod, taskId: ".concat(this.taskId),Ye,1738);case 8:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"doSeek",value:(U=(0,m.A)(I().mark((function e(r,n){var i,a,s,o,u,c,f,h,d,l,p,v,m,g,A,y,x,k=arguments;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=k.length>2&&void 0!==k[2]?k[2]:{},!this.useMSE){e.next=6;break}return e.next=4,t.MSEThread.beforeSeek(this.taskId);case 4:e.next=8;break;case 6:return e.next=8,R().all([null===(a=t.AudioRenderThread)||void 0===a?void 0:a.beforeSeek(this.taskId),null===(s=t.VideoRenderThread)||void 0===s?void 0:s.beforeSeek(this.taskId)]);case 8:if(!i.onBeforeSeek){e.next=11;break}return e.next=11,i.onBeforeSeek();case 11:if(o=-BigInt(1),!this.isHls()){e.next=18;break}return e.next=15,t.DemuxerThread.seek(this.taskId,r,16);case 15:o=e.sent,e.next=30;break;case 18:if(!this.isDash()){e.next=27;break}return e.next=21,t.DemuxerThread.seek(this.taskId,r,16);case 21:if(o=e.sent,!this.subTaskId){e.next=25;break}return e.next=25,t.DemuxerThread.seek(this.subTaskId,r,16);case 25:e.next=30;break;case 27:return e.next=29,t.DemuxerThread.seek(this.taskId,r,8,n);case 29:o=e.sent;case 30:if(!this.subtitleTaskId){e.next=33;break}return e.next=33,t.DemuxerThread.seek(this.subtitleTaskId,r,16);case 33:o>=BigInt(0)?pe.Yz("seeked to packet timestamp: ".concat(o,", taskId: ").concat(this.taskId),Ye,1780):pe.z3("demuxer seek failed, code: ".concat(o,", taskId: ").concat(this.taskId),Ye,1783),u=0;case 35:if(!(u<this.externalSubtitleTasks.length)){e.next=41;break}return e.next=38,t.DemuxerThread.seek(this.externalSubtitleTasks[u].taskId,r,8);case 38:u++,e.next=35;break;case 41:if(this.subtitleRender&&this.subtitleRender.reset(),!this.useMSE){e.next=54;break}if(!(o>=BigInt(0))){e.next=50;break}return e.next=46,t.MSEThread.afterSeek(this.taskId,o>r?o:r);case 46:c=e.sent,this.video?this.video.currentTime=c:this.audio&&(this.audio.currentTime=c),e.next=52;break;case 50:return e.next=52,t.MSEThread.afterSeek(this.taskId,xe.Dh);case 52:e.next=70;break;case 54:if(f=20,this.formatContext.streams.forEach((function(e){0===V.f[15](e.codecpar)&&(f=Math.max(Math.ceil((0,ye.lb)((0,j.A)(e.codecpar+72,W.P))),f))})),!(o>=BigInt(0))){e.next=65;break}return e.next=59,R().all([null===(h=t.AudioDecoderThread)||void 0===h?void 0:h.resetTask(this.taskId),null===(d=this.VideoDecoderThread)||void 0===d?void 0:d.resetTask(this.taskId)]);case 59:return e.next=61,R().all([null===(l=t.AudioRenderThread)||void 0===l?void 0:l.syncSeekTime(this.taskId,o>r?o:r,f),null===(p=t.VideoRenderThread)||void 0===p?void 0:p.syncSeekTime(this.taskId,o>r?o:r,f)]);case 61:return e.next=63,R().all([null===(v=t.AudioRenderThread)||void 0===v?void 0:v.afterSeek(this.taskId,o>r?o:r),null===(m=t.VideoRenderThread)||void 0===m?void 0:m.afterSeek(this.taskId,o>r?o:r)]);case 63:e.next=69;break;case 65:return e.next=67,R().all([null===(g=t.AudioRenderThread)||void 0===g?void 0:g.syncSeekTime(this.taskId,xe.Dh,f),null===(A=t.VideoRenderThread)||void 0===A?void 0:A.syncSeekTime(this.taskId,xe.Dh,f)]);case 67:return e.next=69,R().all([null===(y=t.AudioRenderThread)||void 0===y?void 0:y.afterSeek(this.taskId,xe.Dh),null===(x=t.VideoRenderThread)||void 0===x?void 0:x.afterSeek(this.taskId,xe.Dh)]);case 69:this.jitterBufferController&&this.jitterBufferController.reset();case 70:case"end":return e.stop()}}),e,this)}))),function(e,t){return U.apply(this,arguments)})},{key:"seek",value:(M=(0,m.A)(I().mark((function e(t){var r;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pe.pq("call seek, timestamp: ".concat(t,", taskId: ").concat(this.taskId),Ye,1861),this.formatContext.streams.length){e.next=4;break}return pe.z3("cannot found any stream to seek, taskId: ".concat(this.taskId),Ye,1864),e.abrupt("return");case 4:if(8!==this.status){e.next=7;break}return pe.R8("player is seeking now, taskId: ".concat(this.taskId),Ye,1869),e.abrupt("return");case 7:if(this.options.isLive){e.next=19;break}return this.lastStatus=this.status,this.status=8,this.fire(de.Nz),r=-1,this.selectedVideoStream?r=this.selectedVideoStream.index:this.selectedAudioStream&&(r=this.selectedAudioStream.index),e.next=15,this.doSeek(t,r);case 15:this.status=this.lastStatus,this.fire(de.mQ),e.next=20;break;case 19:pe.R8("seek can only used in vod, taskId: ".concat(this.taskId),Ye,1894);case 20:case"end":return e.stop()}}),e,this)}))),function(e){return M.apply(this,arguments)})},{key:"getStreams",value:function(){return this.formatContext.streams.map((function(e){return We(We({},e),{},{mediaType:(0,Le.yl)(De.Mb,V.f[15](e.codecpar)),codecparProxy:(0,j.A)(e.codecpar,G.A),timeBaseProxy:(0,j.A)(e.timeBase,W.P)})}))}},{key:"getSelectedVideoStreamId",value:function(){return this.selectedVideoStream?this.selectedVideoStream.id:-1}},{key:"getSelectedAudioStreamId",value:function(){return this.selectedAudioStream?this.selectedAudioStream.id:-1}},{key:"getSelectedSubtitleStreamId",value:function(){return this.selectedSubtitleStream?this.selectedSubtitleStream.id:-1}},{key:"getChapters",value:function(){return this.formatContext.chapters}},{key:"getDuration",value:function(){if(!this.options.isLive){var e=BigInt(0);return this.formatContext.streams.forEach((function(t){if(1===V.f[15](t.codecpar)||0===V.f[15](t.codecpar)){var r=(0,ye.k)(t.duration,{den:V.f[15](t.timeBase+4),num:V.f[15](t.timeBase)},xe.i0);r>e&&(e=r)}})),e}return BigInt(0)}},{key:"stop",value:(B=(0,m.A)(I().mark((function e(){var r,n;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pe.pq("call stop, taskId: ".concat(this.taskId),Ye,1999),0!==this.status){e.next=4;break}return pe.R8("player has already stopped, taskId: ".concat(this.taskId),Ye,2002),e.abrupt("return");case 4:if(!this.audioSourceNode){e.next=9;break}return e.next=7,this.audioSourceNode.request("stop");case 7:this.audioSourceNode.disconnect(),this.audioSourceNode=null;case 9:if(!t.VideoRenderThread){e.next=12;break}return e.next=12,t.VideoRenderThread.unregisterTask(this.taskId);case 12:if(!t.AudioRenderThread){e.next=15;break}return e.next=15,t.AudioRenderThread.unregisterTask(this.taskId);case 15:if(!this.VideoDecoderThread){e.next=18;break}return e.next=18,this.VideoDecoderThread.unregisterTask(this.taskId);case 18:if(!t.AudioDecoderThread){e.next=21;break}return e.next=21,t.AudioDecoderThread.unregisterTask(this.taskId);case 21:if(!t.MSEThread){e.next=24;break}return e.next=24,t.MSEThread.unregisterTask(this.taskId);case 24:if(!t.DemuxerThread){e.next=33;break}return e.next=27,t.DemuxerThread.unregisterTask(this.taskId);case 27:if(!this.subTaskId){e.next=30;break}return e.next=30,t.DemuxerThread.unregisterTask(this.subTaskId);case 30:if(!this.subtitleTaskId){e.next=33;break}return e.next=33,t.DemuxerThread.unregisterTask(this.subtitleTaskId);case 33:if(!t.IOThread){e.next=36;break}return e.next=36,t.IOThread.unregisterTask(this.taskId);case 36:n=0;case 37:if(!(n<this.externalSubtitleTasks.length)){e.next=45;break}return e.next=40,t.DemuxerThread.unregisterTask(this.externalSubtitleTasks[n].taskId);case 40:return e.next=42,t.IOThread.unregisterTask(this.externalSubtitleTasks[n].taskId);case 42:n++,e.next=37;break;case 45:this.subtitleRender&&(this.subtitleRender.destroy(),this.subtitleRender=null),this.gainNode&&(this.gainNode.disconnect(),this.gainNode=null),this.controller&&this.controller.destroy(),null!==(r=this.video||this.audio)&&void 0!==r&&r.src&&URL.revokeObjectURL((this.video||this.audio).src),this.video&&(this.options.container.removeChild(this.video),this.video=null),this.audio&&(this.options.container.removeChild(this.audio),this.audio=null),this.canvas&&(this.options.container.removeChild(this.canvas),this.canvas=null),this.ioloader2DemuxerChannel=null,this.demuxer2VideoDecoderChannel=null,this.demuxer2AudioDecoderChannel=null,this.videoDecoder2VideoRenderChannel=null,this.audioDecoder2AudioRenderChannel=null,this.audioRender2AudioWorkletChannel=null,this.selectedAudioStream=null,this.selectedVideoStream=null,this.selectedSubtitleStream=null,this.lastSelectedInnerSubtitleStreamIndex=-1,this.source=null,this.ext="",this.statsController.stop(),this.jitterBufferController&&(this.jitterBufferController.stop(),this.jitterBufferController=null),this.fire(de.yd),this.status=0;case 68:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"setPlaybackRate",value:function(e){var r,n,i;this.options.isLive?pe.R8("setPlaybackRate can only used in playback, taskId: ".concat(this.taskId),Ye,2122):(this.playRate=(0,ge.A)(e,.5,2),this.useMSE?(t.MSEThread.setPlayRate(this.taskId,this.playRate),this.video?this.video.playbackRate=this.playRate:this.audio&&(this.audio.playbackRate=this.playRate)):(null===(r=t.AudioRenderThread)||void 0===r||r.setPlayTempo(this.taskId,this.playRate),null===(n=t.VideoRenderThread)||void 0===n||n.setPlayRate(this.taskId,this.playRate),null===(i=this.VideoDecoderThread)||void 0===i||i.setPlayRate(this.taskId,this.playRate)),pe.pq("player call setPlaybackRate, set ".concat(this.playRate,", taskId: ").concat(this.taskId),Ye,2119))}},{key:"getPlaybackRate",value:function(){return this.playRate}},{key:"resume",value:(P=(0,m.A)(I().mark((function e(){var r;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("suspended"!==(null===(r=t.audioContext)||void 0===r?void 0:r.state)){e.next=4;break}return e.next=3,R().race([t.audioContext.resume(),new Be.A(.1)]);case 3:"suspended"===t.audioContext.state?pe.R8("the audioContext was not allowed to start. It must be resumed after a user gesture",Ye,2145):(this.audioSourceNode&&this.controller.setTimeUpdateListenType(1),this.video&&(this.video.muted=!1));case 4:if(!this.video){e.next=11;break}if(this.video.muted=!1,this.video.played){e.next=9;break}return e.next=9,this.video.play();case 9:e.next=16;break;case 11:if(!this.audio){e.next=16;break}if(this.audio.muted=!1,this.audio.played){e.next=16;break}return e.next=16,this.audio.play();case 16:pe.pq("call resume, taskId: ".concat(this.taskId),Ye,2169);case 17:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.volume=(0,ge.A)(e,0,3),this.gainNode&&t.audioContext?(this.gainNode.gain.cancelScheduledValues(t.audioContext.currentTime),Ae.A.firefox&&!r?this.gainNode.gain.setValueAtTime(this.volume,t.audioContext.currentTime+1):0===this.gainNode.gain.value||0===this.volume||r?this.gainNode.gain.value=this.volume:this.gainNode.gain.exponentialRampToValueAtTime(this.volume,t.audioContext.currentTime+1)):this.video?this.video.volume=this.volume:this.audio&&(this.audio.volume=this.volume),this.fire(de.Wu,[this.volume]),pe.pq("player call setVolume, set ".concat(e,", used ").concat(this.volume,", taskId: ").concat(this.taskId),Ye,2213)}},{key:"getRenderMode",value:function(){return this.renderMode}},{key:"setRenderMode",value:function(e){var r;this.renderMode=e,this.useMSE&&this.video?this.video.style["object-fit"]=Qe[this.renderMode]:null===(r=t.VideoRenderThread)||void 0===r||r.setRenderMode(this.taskId,e),pe.pq("player call setRenderMode, mode: ".concat(e,", taskId: ").concat(this.taskId),Ye,2243)}},{key:"getVideoTransformContext",value:function(){var e="";return 0!==this.renderRotate&&(e+="rotateZ(".concat(this.renderRotate,"deg)")),this.flipHorizontal&&(e+="".concat(e.length?" ":"","scaleX(-1)")),this.flipVertical&&(e+="".concat(e.length?" ":"","scaleY(-1)")),e}},{key:"setRotate",value:function(e){var r;this.renderRotate=e,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(r=t.VideoRenderThread)||void 0===r||r.setRenderRotate(this.taskId,e),pe.pq("player call setRotate, angle: ".concat(e,", taskId: ").concat(this.taskId),Ye,2273)}},{key:"enableHorizontalFlip",value:function(e){var r;this.flipHorizontal=e,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(r=t.VideoRenderThread)||void 0===r||r.enableHorizontalFlip(this.taskId,e),pe.pq("player call enableHorizontalFlip, enable: ".concat(e,", taskId: ").concat(this.taskId),Ye,2284)}},{key:"enableVerticalFlip",value:function(e){var r;this.flipVertical=e,this.useMSE&&this.video?this.video.style.transform=this.getVideoTransformContext():null===(r=t.VideoRenderThread)||void 0===r||r.enableVerticalFlip(this.taskId,e),pe.pq("player call enableVerticalFlip, enable: ".concat(e,", taskId: ").concat(this.taskId),Ye,2295)}},{key:"setLoop",value:function(e){this.options.loop=e,pe.pq("call setLoop, enable: ".concat(e,", taskId: ").concat(this.taskId),Ye,2307)}},{key:"setSubTitleDelay",value:function(e){this.subtitleRender&&this.subtitleRender.setDelay(BigInt(e>>>0))}},{key:"setSubtitleEnable",value:function(e){var r=this;if(this.subtitleRender&&this.selectedSubtitleStream)if(e){var n=this.externalSubtitleTasks.find((function(e){return e.streamId===r.selectedSubtitleStream.id}));n&&t.DemuxerThread.seek(n.taskId,this.currentTime,8),this.subtitleRender.reset(),this.subtitleRender.start()}else this.subtitleRender.stop()}},{key:"resize",value:function(e,r){var n;this.useMSE||null===(n=t.VideoRenderThread)||void 0===n||n.resize(this.taskId,e,r),pe.pq("player call resize, width: ".concat(e,", height: ").concat(r,", taskId: ").concat(this.taskId),Ye,2355)}},{key:"isMSE",value:function(){return this.useMSE}},{key:"isLive",value:function(){return this.options.isLive}},{key:"getVideoList",value:(S=(0,m.A)(I().mark((function e(){var r;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=t.IOThread)||void 0===r?void 0:r.getVideoList(this.taskId));case 1:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)})},{key:"getAudioList",value:(T=(0,m.A)(I().mark((function e(){var r;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=t.IOThread)||void 0===r?void 0:r.getAudioList(this.taskId));case 1:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"getSubtitleList",value:(g=(0,m.A)(I().mark((function e(){var r;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===(r=t.IOThread)||void 0===r?void 0:r.getSubtitleList(this.taskId));case 1:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"getStatus",value:function(){return this.status}},{key:"hasAudio",value:function(){return!!this.selectedAudioStream}},{key:"hasVideo",value:function(){return!!this.selectedVideoStream}},{key:"hasSubtitle",value:function(){return!!this.selectedSubtitleStream}},{key:"getSource",value:function(){return this.source}},{key:"getFormatContext",value:function(){return this.formatContext}},{key:"getExternalSubtitle",value:function(){return this.externalSubtitleTasks.map((function(e){return{source:e.source,lang:e.lang,title:e.title}}))}},{key:"getOptions",value:function(){return this.options}},{key:"setIsLive",value:function(e){this.options.isLive=e}},{key:"getAudioOutputNode",value:function(){return this.gainNode}},{key:"isPictureInPicture",value:function(){return this.useMSE?this.video&&document.pictureInPictureElement===this.video:!(!this.canvas||"object"!==("undefined"==typeof documentPictureInPicture?"undefined":(0,v.A)(documentPictureInPicture)))&&documentPictureInPicture.window&&documentPictureInPicture.window.document.body.querySelector("#"+this.canvas.id)===this.canvas}},{key:"selectVideo",value:(p=(0,m.A)(I().mark((function e(r){var n,i,a=this;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isHls()&&!this.isDash()){e.next=5;break}return pe.pq("call IOThread selectVideo, index: ".concat(r,", taskId: ").concat(this.taskId),Ye,2520),e.abrupt("return",null===(n=t.IOThread)||void 0===n?void 0:n.selectVideo(this.taskId,r));case 5:if(i=this.formatContext.streams.find((function(e){return e.id===r})),!this.selectedVideoStream||!i||0!==V.f[15](i.codecpar)||i===this.selectedVideoStream){e.next=27;break}if(9!==this.status){e.next=10;break}return pe.R8("player is changing now, taskId: ".concat(this.taskId),Ye,2528),e.abrupt("return");case 10:if(this.lastStatus=this.status,this.status=9,this.fire(de.Wt,[0,i.id,this.selectedVideoStream.id]),!this.useMSE){e.next=18;break}return e.next=16,this.doSeek(this.currentTime,i.index,{onBeforeSeek:function(){var e=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.DemuxerThread.changeConnectStream(a.taskId,i.index,a.selectedVideoStream.index);case 2:return e.next=4,t.MSEThread.reAddStream(a.taskId,i.index,i.codecpar,i.timeBase,i.startTime);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});case 16:e.next=20;break;case 18:return e.next=20,this.doSeek(this.currentTime,i.index,{onBeforeSeek:function(){var e=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.DemuxerThread.changeConnectStream(a.taskId,i.index,a.selectedVideoStream.index);case 2:return e.t0=a.VideoDecoderThread,e.t1=a.taskId,e.t2=i.codecpar,e.next=7,a.getResource("decoder",V.f[15](i.codecpar+4),0);case 7:return e.t3=e.sent,e.next=10,e.t0.reopenDecoder.call(e.t0,e.t1,e.t2,e.t3);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});case 20:pe.pq("changed selected video stream, from ".concat(this.selectedVideoStream.id," to ").concat(i.id,", taskId: ").concat(this.taskId),Ye,2556),this.selectedVideoStream=i,this.subtitleRender&&this.subtitleRender.updateVideoResolution(V.f[15](i.codecpar+56),V.f[15](i.codecpar+60)),this.status=this.lastStatus,this.fire(de.Rj,[0,i.id,this.selectedVideoStream.id]),e.next=28;break;case 27:pe.z3("call selectVideo failed, id: ".concat(r,", taskId: ").concat(this.taskId),Ye,2567);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"selectAudio",value:(l=(0,m.A)(I().mark((function e(r){var n,i,a,s=this;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isHls()&&!this.isDash()){e.next=5;break}return pe.pq("call IOThread selectAudio, index: ".concat(r,", taskId: ").concat(this.taskId),Ye,2580),e.abrupt("return",null===(n=t.IOThread)||void 0===n?void 0:n.selectAudio(this.taskId,r));case 5:if(i=this.formatContext.streams.find((function(e){return e.id===r})),!this.selectedAudioStream||!i||1!==V.f[15](i.codecpar)||i===this.selectedAudioStream){e.next=33;break}if(9!==this.status){e.next=10;break}return pe.R8("player is changing now, taskId: ".concat(this.taskId),Ye,2587),e.abrupt("return");case 10:if(this.lastStatus=this.status,this.status=9,this.fire(de.Wt,[1,i.id,this.selectedAudioStream.id]),V.f[15](i.codecpar+4)===V.f[15](this.selectedAudioStream.codecpar+4)&&(!this.useMSE||V.f[15](i.codecpar+136)===V.f[15](this.selectedAudioStream.codecpar+136)&&V.f[15](i.codecpar+116)===V.f[15](this.selectedAudioStream.codecpar+116))){e.next=25;break}if(a=i.index,this.selectedVideoStream&&(a=this.selectedVideoStream.index),!this.useMSE){e.next=21;break}return e.next=19,this.doSeek(this.currentTime,a,{onBeforeSeek:function(){var e=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.DemuxerThread.changeConnectStream(s.taskId,i.index,s.selectedAudioStream.index);case 2:return e.next=4,t.MSEThread.reAddStream(s.taskId,i.index,i.codecpar,i.timeBase,i.startTime);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});case 19:e.next=23;break;case 21:return e.next=23,this.doSeek(this.currentTime,a,{onBeforeSeek:function(){var e=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.DemuxerThread.changeConnectStream(s.taskId,i.index,s.selectedAudioStream.index);case 2:return e.t0=t.AudioDecoderThread,e.t1=s.taskId,e.t2=i.codecpar,e.next=7,s.getResource("decoder",V.f[15](i.codecpar+4),1);case 7:return e.t3=e.sent,e.next=10,e.t0.reopenDecoder.call(e.t0,e.t1,e.t2,e.t3);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});case 23:e.next=27;break;case 25:return e.next=27,t.DemuxerThread.changeConnectStream(this.taskId,i.index,this.selectedAudioStream.index,!1);case 27:pe.pq("changed selected audio stream, from ".concat(this.selectedAudioStream.id," to ").concat(i.id,", taskId: ").concat(this.taskId),Ye,2628),this.selectedAudioStream=i,this.status=this.lastStatus,this.fire(de.Rj,[1,i.id,this.selectedAudioStream.id]),e.next=34;break;case 33:pe.z3("call selectAudio failed, id: ".concat(r,", taskId: ").concat(this.taskId),Ye,2637);case 34:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"selectSubtitle",value:(d=(0,m.A)(I().mark((function e(r){var n,i,a,s=this;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isHls()&&!this.isDash()){e.next=10;break}return pe.pq("call IOThread selectSubtitle, index: ".concat(r,", taskId: ").concat(this.taskId),Ye,2650),e.next=4,null===(n=t.IOThread)||void 0===n?void 0:n.selectSubtitle(this.taskId,r);case 4:if(!this.subtitleTaskId){e.next=7;break}return e.next=7,t.DemuxerThread.seek(this.subtitleTaskId,this.currentTime,16);case 7:this.subtitleRender&&(this.subtitleRender.reset(),this.subtitleRender.start()),e.next=46;break;case 10:if(i=this.formatContext.streams.find((function(e){return e.id===r})),!this.selectedSubtitleStream||!i||3!==V.f[15](i.codecpar)||i===this.selectedSubtitleStream){e.next=45;break}if(9!==this.status){e.next=15;break}return pe.R8("player is changing now, taskId: ".concat(this.taskId),Ye,2664),e.abrupt("return");case 15:if(this.lastStatus=this.status,this.status=9,this.fire(de.Wt,[3,i.id,this.selectedSubtitleStream.id]),this.subtitleRender.reopenDecoder(i.codecpar),!(a=this.externalSubtitleTasks.find((function(e){return e.streamId===i.id})))){e.next=27;break}return this.subtitleRender.setDemuxTask(a.taskId),this.subtitleRender.reset(),e.next=25,t.DemuxerThread.seek(a.taskId,this.currentTime,8,i.index);case 25:e.next=38;break;case 27:if(this.subtitleRender.setDemuxTask(this.taskId),-1!==this.lastSelectedInnerSubtitleStreamIndex){e.next=33;break}return e.next=31,t.DemuxerThread.connectStreamTask.transfer(this.subtitleRender.getDemuxerPort(this.taskId)).invoke(this.taskId,i.index,this.subtitleRender.getDemuxerPort(this.taskId));case 31:e.next=35;break;case 33:return e.next=35,t.DemuxerThread.changeConnectStream(this.taskId,i.index,this.lastSelectedInnerSubtitleStreamIndex,!1);case 35:this.externalSubtitleTasks.find((function(e){return e.streamId===s.selectedSubtitleStream.id}))&&this.subtitleRender.reset(),this.lastSelectedInnerSubtitleStreamIndex=i.index;case 38:this.subtitleRender&&this.subtitleRender.start(),pe.pq("changed selected subtitle stream, from ".concat(this.selectedSubtitleStream.id," to ").concat(i.id,", taskId: ").concat(this.taskId),Ye,2703),this.selectedSubtitleStream=i,this.status=this.lastStatus,this.fire(de.Rj,[3,i.id,this.selectedSubtitleStream.id]),e.next=46;break;case 45:pe.z3("call selectSubtitle failed, id: ".concat(r,", taskId: ").concat(this.taskId),Ye,2711);case 46:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"playNextFrame",value:(h=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.useMSE||7!==this.status||!this.selectedVideoStream){e.next=3;break}return e.next=3,t.VideoRenderThread.renderNextFrame(this.taskId);case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"enterFullscreen",value:function(){var e=this.options.container;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),pe.pq("player call enterFullscreen, taskId: ".concat(this.taskId),Ye,2742)}},{key:"exitFullscreen",value:function(){document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),pe.pq("player call exitFullscreen, taskId: ".concat(this.taskId),Ye,2758)}},{key:"snapshot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"png",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.useMSE&&this.video){var r=document.createElement("canvas");return r.width=this.video.videoWidth,r.height=this.video.videoHeight,r.getContext("2d").drawImage(this.video,0,0),r.toDataURL("image/".concat(e),t)}if(this.canvas)return this.canvas.toDataURL("image/".concat(e),t)}},{key:"getStats",value:function(){return this.stats}},{key:"destroy",value:(f=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(pe.pq("call destroy, taskId: ".concat(this.taskId),Ye,2797),2!==this.status){e.next=4;break}return pe.R8("player has already destroyed, taskId: ".concat(this.taskId),Ye,2800),e.abrupt("return");case 4:return e.next=6,this.stop();case 6:if((0,q.A)(this.stats),this.stats=null,!this.VideoDecoderThread){e.next=13;break}return e.next=11,this.VideoDecoderThread.clear();case 11:(0,K.nE)(this.VideoDecoderThread),this.VideoDecoderThread=null;case 13:this.GlobalData&&(this.GlobalData.avframeList.clear((function(e){(0,re.to)(e)}),20),this.GlobalData.avpacketList.clear((function(e){(0,ne.Up)(e)}),20),O.zr(this.GlobalData[D.o9]+24),O.zr(this.GlobalData[D.o9]+28),(0,q.A)(this.GlobalData),this.GlobalData=null),this.status=2;case 15:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"onVideoEnded",value:function(){this.videoEnded=!0,this.handleEnded()}},{key:"onAudioEnded",value:function(){this.audioEnded=!0,this.handleEnded()}},{key:"onCanvasUpdated",value:function(){this.updateCanvas=this.createCanvas();var e=(0,le.A)()&&oe._7?this.updateCanvas.transferControlToOffscreen():this.updateCanvas;t.VideoRenderThread.updateCanvas.transfer(e).invoke(this.taskId,e)}},{key:"onGetDecoderResource",value:(c=(0,m.A)(I().mark((function e(t,r){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getResource("decoder",r,t));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"onFirstVideoRendered",value:function(){pe.pq("first video frame rendered, taskId: ".concat(this.taskId),Ye,2872),this.fire(de.NX)}},{key:"onFirstAudioRendered",value:function(){pe.pq("first audio frame rendered, taskId: ".concat(this.taskId),Ye,2880),this.fire(de.Sw)}},{key:"onStutter",value:function(){this.stats.audioStutter++}},{key:"onFirstVideoRenderedAfterUpdateCanvas",value:function(){this.updateCanvas&&(this.canvas&&this.options.container.removeChild(this.canvas),this.canvas=this.updateCanvas,this.options.container.appendChild(this.canvas),this.updateCanvas=null)}},{key:"onTimeUpdate",value:function(e){this.fire(de.E9,[e])}},{key:"onMSESeek",value:function(e){this.audio?this.audio.currentTime=e:this.video&&(this.video.currentTime=e)}},{key:"createVideoDecoderThread",value:(u=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.VideoDecoderThread){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,K.pt)(Q.A,{name:"VideoDecoderThread",disableWorker:Ae.A.safari&&!Ae.A.checkVersion(Ae.A.version,"16.1",!0)},31138).run();case 4:this.VideoDecoderThread=e.sent,this.VideoDecoderThread.setLogLevel(t.level);case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"on",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,y.A)((0,x.A)(t.prototype),"on",this).call(this,e,ee.extend({fn:r},n)),this}},{key:"one",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,y.A)((0,x.A)(t.prototype),"on",this).call(this,e,ee.extend({fn:r,max:1},n)),this}}],[{key:"startDemuxPipeline",value:(o=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.DemuxThreadReady){e.next=2;break}return e.abrupt("return",t.DemuxThreadReady);case 2:return e.abrupt("return",t.DemuxThreadReady=new(R())(function(){var e=(0,m.A)(I().mark((function e(r){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,K.pt)(H.A,{name:"IOThread"},87243).run();case 2:return t.IOThread=e.sent,t.IOThread.setLogLevel(t.level),e.next=6,(0,K.pt)(Y.A,{name:"DemuxerThread"},72480).run();case 6:t.DemuxerThread=e.sent,t.DemuxerThread.setLogLevel(t.level),r();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})},{key:"startAudioPipeline",value:(s=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.AudioThreadReady){e.next=2;break}return e.abrupt("return",t.AudioThreadReady);case 2:return e.abrupt("return",t.AudioThreadReady=new(R())(function(){var e=(0,m.A)(I().mark((function e(r){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.audioContext=new(AudioContext||webkitAudioContext),!ve.A.audioWorklet){e.next=4;break}return e.next=4,(0,ue.A)(t.audioContext,!oe._7||Ae.A.safari&&!Ae.A.checkVersion(Ae.A.version,"16.1",!0)?34268:5676);case 4:return e.next=6,(0,K.pt)($.A,{name:"AudioDecoderThread",disableWorker:Ae.A.safari&&!Ae.A.checkVersion(Ae.A.version,"16.1",!0)},18667).run();case 6:return t.AudioDecoderThread=e.sent,t.AudioDecoderThread.setLogLevel(t.level),e.next=10,(0,K.pt)(ie.A,{name:"AudioRenderThread",disableWorker:Ae.A.safari&&!Ae.A.checkVersion(Ae.A.version,"16.1",!0)},59377).run();case 10:t.AudioRenderThread=e.sent,t.AudioRenderThread.setLogLevel(t.level),r();case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)})},{key:"startVideoRenderPipeline",value:(a=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.VideoThreadReady){e.next=2;break}return e.abrupt("return",t.VideoThreadReady);case 2:return e.abrupt("return",t.VideoThreadReady=new(R())(function(){var e=(0,m.A)(I().mark((function e(r){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,K.pt)(ae.A,{name:"VideoRenderThread",disableWorker:!(0,le.A)()},33968).run();case 2:t.VideoRenderThread=e.sent,t.VideoRenderThread.setLogLevel(t.level),r();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"startMSEPipeline",value:(i=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.MSEThreadReady){e.next=2;break}return e.abrupt("return",t.MSEThreadReady);case 2:return e.abrupt("return",t.MSEThreadReady=new(R())(function(){var e=(0,m.A)(I().mark((function e(r){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,K.pt)(Se.A,{name:"MSEThread",disableWorker:!ve.A.workerMSE},25115).run();case 2:t.MSEThread=e.sent,t.MSEThread.setLogLevel(t.level),r();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"startPipelines",value:(n=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.startDemuxPipeline();case 2:return e.next=4,t.startAudioPipeline();case 4:return e.next=6,t.startVideoRenderPipeline();case 6:return e.next=8,t.startMSEPipeline();case 8:pe.pq("AVPlayer pipelines started",Ye,3026);case 9:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"stopPipelines",value:(r=(0,m.A)(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.VideoRenderThread){e.next=4;break}return e.next=3,t.VideoRenderThread.clear();case 3:(0,K.nE)(t.VideoRenderThread);case 4:if(!t.AudioRenderThread){e.next=8;break}return e.next=7,t.AudioRenderThread.clear();case 7:(0,K.nE)(t.AudioRenderThread);case 8:if(!t.AudioDecoderThread){e.next=12;break}return e.next=11,t.AudioDecoderThread.clear();case 11:(0,K.nE)(t.AudioDecoderThread);case 12:if(!t.DemuxerThread){e.next=16;break}return e.next=15,t.DemuxerThread.clear();case 15:(0,K.nE)(t.DemuxerThread);case 16:if(!t.IOThread){e.next=20;break}return e.next=19,t.IOThread.clear();case 19:(0,K.nE)(t.IOThread);case 20:if(!t.MSEThread){e.next=24;break}return e.next=23,t.MSEThread.clear();case 23:(0,K.nE)(t.MSEThread);case 24:t.AudioDecoderThread=null,t.DemuxerThread=null,t.IOThread=null,t.audioContext=null,t.MSEThread=null,pe.pq("AVPlayer pipelines stopped",Ye,3066);case 30:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"setLogLevel",value:function(e){t.level=e,pe.V$(e),t.IOThread&&t.IOThread.setLogLevel(e),t.DemuxerThread&&t.DemuxerThread.setLogLevel(e),t.AudioDecoderThread&&t.AudioDecoderThread.setLogLevel(e),t.AudioRenderThread&&t.AudioRenderThread.setLogLevel(e),t.VideoRenderThread&&t.VideoRenderThread.setLogLevel(e),t.MSEThread&&t.MSEThread.setLogLevel(e),pe.pq("set log level: ".concat(e),Ye,3098)}}]),t}(J.A);(0,_.A)(Xe,"level",pe.rD),(0,_.A)(Xe,"DemuxThreadReady",void 0),(0,_.A)(Xe,"AudioThreadReady",void 0),(0,_.A)(Xe,"VideoThreadReady",void 0),(0,_.A)(Xe,"MSEThreadReady",void 0),(0,_.A)(Xe,"IOThread",void 0),(0,_.A)(Xe,"DemuxerThread",void 0),(0,_.A)(Xe,"AudioDecoderThread",void 0),(0,_.A)(Xe,"AudioRenderThread",void 0),(0,_.A)(Xe,"VideoRenderThread",void 0),(0,_.A)(Xe,"MSEThread",void 0),(0,_.A)(Xe,"audioContext",void 0),(0,_.A)(Xe,"Resource",new(P()))},11628:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(84149),f=r(86368),h=function(){function e(t){var r=this;(0,i.A)(this,e),(0,s.A)(this,"videoRenderControlChannel",void 0),(0,s.A)(this,"audioRenderControlChannel",void 0),(0,s.A)(this,"muxerControlChannel",void 0),(0,s.A)(this,"demuxerControlChannel",void 0),(0,s.A)(this,"videoRenderControlIPCPort",void 0),(0,s.A)(this,"audioRenderControlIPCPort",void 0),(0,s.A)(this,"muxerControlIPCPort",void 0),(0,s.A)(this,"demuxerControlIPCPort",void 0),(0,s.A)(this,"observer",void 0),(0,s.A)(this,"visibilityHidden",void 0),(0,s.A)(this,"onVisibilityChange",void 0),(0,s.A)(this,"timeUpdateListenType",void 0),(0,s.A)(this,"enableAudioVideoSync",void 0),this.observer=t,this.videoRenderControlChannel=(0,f.A)(),this.audioRenderControlChannel=(0,f.A)(),this.muxerControlChannel=(0,f.A)(),this.demuxerControlChannel=(0,f.A)(),this.videoRenderControlIPCPort=new c.Ay(this.videoRenderControlChannel.port2),this.audioRenderControlIPCPort=new c.Ay(this.audioRenderControlChannel.port2),this.muxerControlIPCPort=new c.Ay(this.muxerControlChannel.port2),this.demuxerControlIPCPort=new c.Ay(this.demuxerControlChannel.port2),this.enableAudioVideoSync=!0,this.videoRenderControlIPCPort.on(c.Wo,(function(e){switch(e.method){case"ended":r.observer.onVideoEnded();break;case"updateCanvas":r.observer.onCanvasUpdated();break;case"firstRendered":r.observer.onFirstVideoRendered();break;case"firstRenderedAfterUpdateCanvas":r.observer.onFirstVideoRenderedAfterUpdateCanvas();break;case"syncPts":0===r.timeUpdateListenType&&r.observer.onTimeUpdate(e.params.pts)}})),this.audioRenderControlIPCPort.on(c.Wo,(function(e){switch(e.method){case"syncPts":r.enableAudioVideoSync&&r.videoRenderControlIPCPort.notify("syncPts",e.params),1===r.timeUpdateListenType&&r.observer.onTimeUpdate(e.params.pts);break;case"ended":r.observer.onAudioEnded()}})),this.muxerControlIPCPort.on(c.Wo,(function(e){"seek"===e.method&&r.observer.onMSESeek(e.params.time)})),this.demuxerControlIPCPort.on(c.S3,function(){var e=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.method,e.next="getDecoderResource"===e.t0?3:10;break;case 3:return e.t1=r.demuxerControlIPCPort,e.t2=t,e.next=7,r.observer.onGetDecoderResource(t.params.mediaType,t.params.codecId);case 7:return e.t3=e.sent,e.t1.reply.call(e.t1,e.t2,e.t3),e.abrupt("break",10);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.onVisibilityChange=function(e){r.visibilityHidden="hidden"===document.visibilityState&&!r.observer.isPictureInPicture(),r.videoRenderControlIPCPort.notify("skipRender",{skipRender:r.visibilityHidden})},this.visibilityHidden="hidden"===document.visibilityState&&!this.observer.isPictureInPicture(),document.addEventListener("visibilitychange",this.onVisibilityChange)}return(0,a.A)(e,[{key:"getVideoRenderControlPort",value:function(){return this.videoRenderControlChannel.port1}},{key:"getAudioRenderControlPort",value:function(){return this.audioRenderControlChannel.port1}},{key:"getMuxerControlPort",value:function(){return this.muxerControlChannel.port1}},{key:"getDemuxerControlPort",value:function(){return this.demuxerControlChannel.port1}},{key:"setTimeUpdateListenType",value:function(e){this.timeUpdateListenType=e}},{key:"setEnableAudioVideoSync",value:function(e){this.enableAudioVideoSync=e}},{key:"destroy",value:function(){this.videoRenderControlIPCPort&&this.videoRenderControlIPCPort.destroy(),this.audioRenderControlIPCPort&&this.audioRenderControlIPCPort.destroy(),this.muxerControlIPCPort&&this.muxerControlIPCPort.destroy(),this.demuxerControlIPCPort&&this.demuxerControlIPCPort.destroy(),this.onVisibilityChange&&(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.onVisibilityChange=null),this.videoRenderControlIPCPort=this.audioRenderControlIPCPort=this.muxerControlIPCPort=this.videoRenderControlChannel=this.audioRenderControlChannel=this.demuxerControlChannel=this.muxerControlChannel=null}}]),e}()},2368:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(78716),i=r(81570),a=r(134),s=r(63939),o=r(50932),u=r(54058),c=r(38724),f=200,h=function(){function e(t){var r=this;(0,n.A)(this,e),(0,a.A)(this,"timer",void 0),(0,a.A)(this,"interval",void 0),(0,a.A)(this,"data",void 0),(0,a.A)(this,"lastIncomingPacketCount",void 0),(0,a.A)(this,"shutterCount",void 0),(0,a.A)(this,"lastShutterCount",void 0),(0,a.A)(this,"isFirst",void 0),(0,a.A)(this,"max",void 0),(0,a.A)(this,"min",void 0),(0,a.A)(this,"targetPlaybackRate",void 0),(0,a.A)(this,"currentPlaybackRate",void 0),(0,a.A)(this,"playbackRateTimer",void 0),(0,a.A)(this,"options",void 0),this.options=t,this.interval=1e3,this.isFirst=!0,this.data=[],this.lastIncomingPacketCount=BigInt(0),this.shutterCount=0,this.lastShutterCount=0,this.max=1e3*t.max>>>0,this.min=1e3*t.min>>>0,o.M[15](this.options.jitterBuffer,this.min),o.M[15](this.options.jitterBuffer+4,this.max),t.lowLatencyStart&&o.M[15](this.options.jitterBuffer+4,this.min+f),this.targetPlaybackRate=1,this.currentPlaybackRate=1,this.playbackRateTimer=new u.A((function(){if(r.currentPlaybackRate>r.targetPlaybackRate){var e=Math.max(r.targetPlaybackRate,r.currentPlaybackRate-.01);r.options.observer.onSetPlayRate(e),r.currentPlaybackRate=e}else if(r.currentPlaybackRate<r.targetPlaybackRate){var t=Math.min(r.targetPlaybackRate,r.currentPlaybackRate+.01);r.options.observer.onSetPlayRate(t),r.currentPlaybackRate=t}else r.playbackRateTimer.stop()}),0,200),this.timer=new c.A(this.onTimer.bind(this),1e3,this.interval)}return(0,i.A)(e,[{key:"start",value:function(){this.timer.start(),this.isFirst=!0,this.lastIncomingPacketCount=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112),this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+276)+s.f[15](this.options.stats+272),this.computePlayRate()}},{key:"stop",value:function(){this.timer.stop(),this.data.length=0,this.isFirst=!0,this.playbackRateTimer.isStarted()&&(this.playbackRateTimer.stop(),this.targetPlaybackRate=this.currentPlaybackRate=1,this.options.observer.onSetPlayRate(1))}},{key:"reset",value:function(){this.data.length=0,this.isFirst=!0,this.lastIncomingPacketCount=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112),this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+276)+s.f[15](this.options.stats+272),this.targetPlaybackRate=this.currentPlaybackRate=1}},{key:"setPlayRate",value:function(e){this.targetPlaybackRate=e,this.options.useMse?(this.options.observer.onSetPlayRate(this.targetPlaybackRate),this.currentPlaybackRate=this.targetPlaybackRate):this.currentPlaybackRate===e||this.playbackRateTimer.isStarted()||this.playbackRateTimer.start()}},{key:"computePlayRate",value:function(){var e=s.f[15](this.options.stats+236)?s.f[15](this.options.stats+32)/s.f[15](this.options.stats+236)*1e3:s.f[15](this.options.stats+224)?s.f[15](this.options.stats+120)/s.f[15](this.options.stats+224)*1e3:0;e<s.f[15](this.options.jitterBuffer)>>1&&e<2?this.setPlayRate(.8):e<s.f[15](this.options.jitterBuffer)-f&&e<2?this.setPlayRate(.95):e>s.f[15](this.options.jitterBuffer+4)+f?this.setPlayRate(1.05):this.setPlayRate(1),e>this.max<<1&&this.options.observer.onCroppingBuffer(s.f[15](this.options.jitterBuffer+4))}},{key:"process",value:function(){var e=this.data.reduce((function(e,t,r){return e+t*(r+1)}),0)/55,t=this.data.reduce((function(t,r){return t+Math.pow(r-e,2)}),0)/this.data.length,r=Math.sqrt(t),n=Math.round(e/(this.interval/1e3)),i=s.f[15](this.options.stats+224)+s.f[15](this.options.stats+236);n<i>>1||this.shutterCount>3?(o.M[15](this.options.jitterBuffer,Math.min(2*s.f[15](this.options.jitterBuffer),this.max-f)),o.M[15](this.options.jitterBuffer+4,Math.min(2*s.f[15](this.options.jitterBuffer+4),this.max))):n>=i&&r<50?(o.M[15](this.options.jitterBuffer,Math.max(s.f[15](this.options.jitterBuffer)-f,this.min)),o.M[15](this.options.jitterBuffer+4,Math.max(s.f[15](this.options.jitterBuffer+4)-f,this.min+f))):r>100?(o.M[15](this.options.jitterBuffer,Math.min(s.f[15](this.options.jitterBuffer)+f,this.max-f)),o.M[15](this.options.jitterBuffer+4,Math.min(s.f[15](this.options.jitterBuffer+4)+f,this.max))):r<20?s.f[15](this.options.jitterBuffer)===this.min?o.M[15](this.options.jitterBuffer+4,Math.max(s.f[15](this.options.jitterBuffer+4)-f,this.min+f)):o.M[15](this.options.jitterBuffer,Math.max(s.f[15](this.options.jitterBuffer)-f,this.min)):s.f[15](this.options.jitterBuffer+4)===this.max?o.M[15](this.options.jitterBuffer,Math.min(s.f[15](this.options.jitterBuffer)+f,this.max-f)):o.M[15](this.options.jitterBuffer+4,Math.min(s.f[15](this.options.jitterBuffer+4)+f,this.max)),this.computePlayRate(),o.M[19](this.options.stats+264,r)}},{key:"onTimer",value:function(){var e=s.f[17](this.options.stats+24)+s.f[17](this.options.stats+112);this.isFirst?this.isFirst=!1:this.data.push(0|Number(e-this.lastIncomingPacketCount&0xffffffffn)),this.lastIncomingPacketCount=e,s.f[15](this.options.stats+276)+s.f[15](this.options.stats+272)>this.lastShutterCount?this.shutterCount++:this.shutterCount=0,this.lastShutterCount=s.f[15](this.options.stats+276)+s.f[15](this.options.stats+272),this.data.length>10&&this.data.shift(),10===this.data.length&&this.process()}}]),e}()},78201:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(78716),i=r(81570),a=r(134),s=r(63939),o=r(50932),u=r(54058),c=function(){function e(t){(0,n.A)(this,e),(0,a.A)(this,"stats",void 0),(0,a.A)(this,"timer",void 0),(0,a.A)(this,"videoFrameRenderCount",void 0),(0,a.A)(this,"videoFrameDecodeCount",void 0),(0,a.A)(this,"audioFrameRenderCount",void 0),(0,a.A)(this,"audioFrameDecodeCount",void 0),(0,a.A)(this,"videoPacketBytes",void 0),(0,a.A)(this,"audioPacketBytes",void 0),(0,a.A)(this,"bufferReceiveBytes",void 0),this.stats=t,this.timer=new u.A(this.onTimer.bind(this),1e3,1e3)}return(0,i.A)(e,[{key:"reset",value:function(){this.videoFrameRenderCount=s.f[17](this.stats+160),this.videoFrameDecodeCount=s.f[17](this.stats+144),this.audioFrameRenderCount=s.f[17](this.stats+72),this.audioFrameDecodeCount=s.f[17](this.stats+56),this.videoPacketBytes=s.f[17](this.stats+104),this.audioPacketBytes=s.f[17](this.stats+16),this.bufferReceiveBytes=s.f[17](this.stats+192)}},{key:"start",value:function(){this.reset(),this.timer.start()}},{key:"stop",value:function(){this.timer.stop()}},{key:"onTimer",value:function(){o.M[15](this.stats+240,0),o.M[15](this.stats+244,0),o.M[15](this.stats+248,0),o.M[15](this.stats+252,0),o.M[15](this.stats+220,0|Number(s.f[17](this.stats+160)-this.videoFrameRenderCount&0xffffffffn)),o.M[15](this.stats+216,0|Number(s.f[17](this.stats+144)-this.videoFrameDecodeCount&0xffffffffn)),o.M[15](this.stats+232,0|Number(s.f[17](this.stats+72)-this.audioFrameRenderCount&0xffffffffn)),o.M[15](this.stats+228,0|Number(s.f[17](this.stats+56)-this.audioFrameDecodeCount&0xffffffffn)),o.M[15](this.stats+212,0|Number(s.f[17](this.stats+104)-this.videoPacketBytes&0xffffffffn)),o.M[15](this.stats+208,0|Number(s.f[17](this.stats+16)-this.audioPacketBytes&0xffffffffn)),o.M[15](this.stats+256,0|Number(s.f[17](this.stats+192)-this.bufferReceiveBytes&0xffffffffn)),"visible"===document.visibilityState&&(s.f[15](this.stats+220)<.5*s.f[15](this.stats+224)||s.f[15](this.stats+252)>6e3/s.f[15](this.stats+224))&&o.M[15](this.stats+276,s.f[15](this.stats+276)+1),this.reset()}}]),e}()},28090:(e,t,r)=>{"use strict";r.d(t,{CN:()=>s,E9:()=>p,F5:()=>n,Gd:()=>y,IY:()=>v,NN:()=>o,NX:()=>g,Nz:()=>f,Rj:()=>l,S2:()=>i,Sw:()=>m,Wt:()=>d,Wu:()=>x,d6:()=>a,hV:()=>c,mQ:()=>h,xv:()=>A,yd:()=>u});var n="loading",i="loaded",a="playing",s="played",o="paused",u="stopped",c="ended",f="seeking",h="seeked",d="changing",l="changed",p="time",v="resume",m="firstAudioRendered",g="firstVideoRendered",A="streamUpdate",y="progress",x="volumeChange"},76750:(e,t,r)=>{"use strict";function n(){if("function"==typeof MediaSource)return MediaSource;if("function"==typeof ManagedMediaSource)return ManagedMediaSource;throw new Error("not support mse")}r.d(t,{A:()=>n})},47595:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(95797),i=r(44690),a=r(86834);function s(){var e=n.A.offscreenCanvas;return i.A.mac&&a.A.safari&&(i.A.version<"12"||a.A.version<"17")&&(e=!1),e}},25115:(e,t,r)=>{"use strict";r.d(t,{A:()=>me});var n=r(88435),i=r.n(n),a=r(69736),s=r.n(a),o=r(44301),u=r.n(o),c=r(82731),f=r.n(c),h=r(59614),d=r.n(h),l=r(969),p=r.n(l),v=r(66681),m=r.n(v),g=r(134),A=r(25182),y=r(78716),x=r(81570),k=r(77193),b=r(25767),w=r(31060),_=r(54001),T=r.n(_),I=r(36443),S=r.n(I),P=r(14686),B=r(61499),C=r(63939),M=r(9599),R=r(29170),U=r(50932),E=r(12264),D=r(44315),L=r(44527),F=r(9705),O=r(84149),N=r(4624),z=r(35336),V=r(92174),W=r(69765),j=r(71766),G=r(39148),q=r(60120),H=r(84290),Y=r(77231),Q=r(44328),$=r(86932),K=r(85224),J=r(10333),X=r(50400),Z=r(71517),ee=r(37837),te=r(86834),re=r(85103),ne=r(13724),ie=r(43607),ae=r(65977),se=r(76750),oe=r(39381),ue=r(20620),ce=r(53e3);function fe(e,t){var r=s()(e);if(u()){var n=u()(e);t&&(n=n.filter((function(t){return f()(e,t).enumerable}))),r.push.apply(r,n)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(r),!0).forEach((function(t){(0,g.A)(e,t,r[t])})):d()?p()(e,d()(r)):fe(Object(r)).forEach((function(t){m()(e,t,f()(r,t))}))}return e}function de(e,t,r){return t=(0,b.A)(t),(0,k.A)(e,le()?i()(t,r||[],(0,b.A)(e).constructor):t.apply(e,r))}function le(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(le=function(){return!!e})()}var pe="src/avplayer/mse/MSEPipeline.ts";function ve(e,t,r,n){if(t!==n)return!0;for(var i=!1,a=0;a<t;a++)if(C.f[2](e+a)!==C.f[2](r+a)){i=!0;break}return i}var me=function(e){function t(){return(0,y.A)(this,t),de(this,t)}var r,n,i,a,s,o,u,c,f,h,d,l,p,v,m;return(0,w.A)(t,e),(0,x.A)(t,[{key:"syncToKeyframe",value:(m=(0,A.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,!t.video){e.next=30;break}case 2:return e.next=5,this.pullAVPacket(t.video,t);case 5:if(t.video.backPacket=e.sent,!(t.video.backPacket<0)){e.next=10;break}return t.video.packetEnded=!0,t.video.backPacket=0,e.abrupt("break",30);case 10:if(!t.audio||t.audio.packetEnded||t.audio.backPacket&&!((0,Q.k)(C.f[17](t.audio.backPacket+8),(0,R.A)(t.audio.backPacket+72,M.P),Y.i0)<(0,Q.k)(C.f[17](t.video.backPacket+8),(0,R.A)(t.video.backPacket+72,M.P),Y.i0))){e.next=24;break}case 11:return t.audio.backPacket>0&&t.avpacketPool.release(t.audio.backPacket),e.next=15,this.pullAVPacket(t.audio,t);case 15:if(t.audio.backPacket=e.sent,!(t.audio.backPacket<0)){e.next=20;break}return t.audio.packetEnded=!0,t.audio.backPacket=0,e.abrupt("break",24);case 20:if(!((0,Q.k)(C.f[17](t.audio.backPacket+8),(0,R.A)(t.audio.backPacket+72,M.P),Y.i0)>(0,Q.k)(C.f[17](t.video.backPacket+8),(0,R.A)(t.video.backPacket+72,M.P),Y.i0))){e.next=22;break}return e.abrupt("break",24);case 22:e.next=11;break;case 24:if(!(1&C.f[15](t.video.backPacket+36))){e.next=26;break}return e.abrupt("break",30);case 26:r=!1,t.avpacketPool.release(t.video.backPacket),e.next=2;break;case 30:return e.abrupt("return",r);case 31:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"getSourceOpenHandler",value:function(e){var t=this;return(0,A.A)(S().mark((function r(){var n,i,a,s;return S().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.syncToKeyframe(e);case 2:return n=[],e.audio&&(e.audio.track.setSourceBuffer(t.createSourceBuffer(e.mediaSource,e.audio.oformatContext.streams[0].codecpar[B.o9])),e.audio.enableRawMpeg||(V.ho(e.audio.oformatContext,{paddingZero:!1}),V.bx(e.audio.oformatContext)),n.push(t.startMux(e.audio,e))),e.video&&(e.video.track.setSourceBuffer(t.createSourceBuffer(e.mediaSource,e.video.oformatContext.streams[0].codecpar[B.o9])),e.video.enableRawMpeg||(V.ho(e.video.oformatContext,{paddingZero:!1}),V.bx(e.video.oformatContext)),n.push(t.startMux(e.video,e))),r.next=7,T().all(n);case 7:if(i=!1,a=!1,!e.audio){r.next=24;break}return r.next=12,t.pullAVPacket(e.audio,e);case 12:if(e.audio.backPacket=r.sent,!(e.audio.backPacket>0)){r.next=21;break}return i=!0,r.next=17,t.pullAVPacket(e.audio,e);case 17:e.audio.frontPacket=r.sent,e.audio.frontPacket>0?e.audio.frontBuffered=!0:(e.audio.frontPacket=0,e.audio.packetEnded=!0),r.next=22;break;case 21:e.audio.packetEnded=!0;case 22:e.audio.enableRawMpeg||e.audio.oformatContext.ioWriter.flush(),e.audio.track.addBuffer(e.audio.bufferQueue.flush());case 24:if(!e.video){r.next=39;break}return r.next=27,t.pullAVPacket(e.video,e);case 27:if(e.video.backPacket=r.sent,!(e.video.backPacket>0)){r.next=36;break}return a=!0,r.next=32,t.pullAVPacket(e.video,e);case 32:e.video.frontPacket=r.sent,e.video.frontPacket>0?e.video.frontBuffered=!0:(e.video.frontPacket=0,e.video.packetEnded=!0),r.next=37;break;case 36:e.video.packetEnded=!0;case 37:e.video.enableRawMpeg||e.video.oformatContext.ioWriter.flush(),e.video.track.addBuffer(e.video.bufferQueue.flush());case 39:return e.audio&&(i?(t.createLoop(e.audio,e),e.audio.loop.start()):e.audio.track.end()),e.video&&(a?(t.createLoop(e.video,e),e.video.loop.start()):e.video.track.end()),r.next=43,new ne.A(.1);case 43:s=0,e.audio?s=e.video?Math.max(e.audio.track.getBufferedStart(),e.video.track.getBufferedStart()):e.audio.track.getBufferedStart():e.video&&(s=e.video.track.getBufferedStart()),(te.A.safari||s>.1)&&e.controlIPCPort.notify("seek",{time:s});case 46:case"end":return r.stop()}}),r)})))}},{key:"getMimeType",value:function(e){var t="";return 1===C.f[15](e)?t=(0,K.A)(e):0===C.f[15](e)&&(t=(0,J.A)(e)),t||N.h2("invalid stream",pe,345),t}},{key:"createSourceBuffer",value:function(e,t){return e.addSourceBuffer(this.getMimeType(t))}},{key:"mixExtradata",value:function(e,t,r,n){t.oformatContext.streams[0].codecpar.codecId;var i=t.oformatContext.streams[0].codecpar;i.extradata&&(0,ee.Eb)(i.extradata),i.extradata=(0,ee.sY)(n),(0,P.Mr)(i.extradata,r,n),i.extradataSize=n}},{key:"pullAVPacket",value:(v=(0,A.A)(S().mark((function e(t,r){var n,i,a,s,o,u;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.pullQueue).ended||n.queue.length){e.next=3;break}return e.abrupt("return",-1048576);case 3:if(!n.queue.length){e.next=7;break}e.t0=n.queue.shift(),e.next=10;break;case 7:return e.next=9,t.pullIPC.request("pull");case 9:e.t0=e.sent;case 10:if(!((i=e.t0)<0)){e.next=14;break}return n.ended=!0,e.abrupt("return",-1048576);case 14:if(C.f[17](i+16)<n.lastDTS&&N.R8("got packet with dts ".concat(C.f[17](i+16),", which is earlier then the last packet(").concat(n.lastDTS,")"),pe,392),!("audio"===t.type&&C.f[17](i+16)>0)){e.next=19;break}U.M[17](i+8,C.f[17](i+16)),e.next=54;break;case 19:if("video"!==t.type||r.isLive){e.next=54;break}if(!(1&C.f[15](i+36)&&(27===C.f[15](r.video.codecpar+4)&&ue.KD(i,C.f[20](r.video.codecpar+12)?4&oe.r8(C.f[20](r.video.codecpar+12)+4):4)||173===C.f[15](r.video.codecpar+4)&&ce.KD(i,C.f[20](r.video.codecpar+12)?4&oe.r8(C.f[20](r.video.codecpar+12)+21):4)))){e.next=53;break}if(!(C.f[17](i+8)<n.lastPTS)){e.next=50;break}return N.R8("got packet with pts ".concat(C.f[17](i+8),", which is earlier then the last packet(").concat(n.lastPTS,"), try to fix it!"),pe,425),U.M[17](i+8,n.lastPTS+(C.f[17](i+16)-n.lastDTS)),e.next=26,t.pullIPC.request("pull");case 26:if(!((a=e.sent)<0)){e.next=31;break}n.ended=!0,e.next=48;break;case 31:n.queue.push(a),s=C.f[17](a+8),o=C.f[17](a+8);case 34:return e.next=37,t.pullIPC.request("pull");case 37:if(!((u=e.sent)<0)){e.next=41;break}return n.ended=!0,e.abrupt("break",47);case 41:if(n.queue.push(u),!(C.f[17](u+8)>o)){e.next=44;break}return e.abrupt("break",47);case 44:s=ie.jk(s,C.f[17](u+8)),e.next=34;break;case 47:s<C.f[17](i+8)&&(n.diff=C.f[17](i+16)-n.lastDTS);case 48:e.next=51;break;case 50:n.diff=BigInt(0);case 51:e.next=54;break;case 53:U.M[17](i+8,C.f[17](i+8)+n.diff);case 54:return C.f[17](i+8)>n.lastPTS&&(n.lastPTS=C.f[17](i+8)),n.lastDTS=C.f[17](i+16),"audio"===t.type&&n.useSampleRateTimeBase&&(n.frameCount===Y.Dh?(n.frameCount=(0,Q.k)(C.f[17](i+16),(0,R.A)(i+72,M.P),t.oformatContext.streams[0].timeBase),U.M[17](i+16,n.frameCount),U.M[17](i+8,n.frameCount)):(n.frameCount=n.frameCount+BigInt(C.f[15](t.codecpar+144)>>>0),U.M[17](i+16,n.frameCount),U.M[17](i+8,n.frameCount)),(0,P.Mr)(i+72,t.oformatContext.streams[0].timeBase[B.o9],8)),e.abrupt("return",i);case 58:case"end":return e.stop()}}),e)}))),function(e,t){return v.apply(this,arguments)})},{key:"writeAVPacket",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.enableRawMpeg){if(!t.timestampOffsetUpdated){var n=(0,Q.k)(C.f[17](e+8),(0,R.A)(e+72,M.P),Y.i0);t.track.updateTimestampOffset((0|Number(0xffffffffn&n))/1e3),t.timestampOffsetUpdated=!0}t.bufferQueue.push((0,P.s3)(C.f[20](e+24),C.f[15](e+28)).slice())}else V.XA(t.oformatContext,e),r&&t.oformatContext.ioWriter.flush()}},{key:"swap",value:function(e,t){var r=this;if(e.backPacket&&t.avpacketPool.release(e.backPacket),e.backPacket=0,!e.frontBuffered)return!1;e.backPacket=e.frontPacket,e.frontPacket=0,e.frontBuffered=!1;var n=(0,$.A)();return this.pullAVPacket(e,t).then((function(i){if(i<0)return e.packetEnded=!0,void(e.frontPacket=0);var a=(0,$.A)()-n;a>5&&(e.startTimestamp+=BigInt(Math.floor(a))),e.frontPacket=i,e.frontBuffered=!0,e.seekSync&&(e.seekSync(),e.seekSync=null),e.backPacket||r.swap(e,t)})),!0}},{key:"createLoop",value:function(e,t){var r=this;e.loop=new G.A((function(){var n=e.track.getBufferedEnd()-(t.currentTime+((0,$.A)()-t.currentTimeNTP)/1e3);if(n>1*(t.playRate>BigInt(100)?Number(t.playRate)/100:1))e.loop.emptyTask();else if(e.backPacket){var i=e.backPacket,a=(0,Q.k)(C.f[17](i+16),(0,R.A)(i+72,M.P),Y.i0);if(t.enableJitterBuffer&&(C.f[15](t.stats+236)?C.f[15](t.stats+32)/C.f[15](t.stats+236)*1e3:C.f[15](t.stats+224)?C.f[15](t.stats+120)/C.f[15](t.stats+224)*1e3:0)<=C.f[15](t.jitterBuffer)&&r.setPlayRate(t.taskId,1),a*BigInt(100)/t.playRate+e.startTimestamp-BigInt(Math.floor((0,$.A)()))<=0||n<.5*(t.playRate>BigInt(100)?Number(t.playRate)/100:1)){e.track.isPaused()&&e.track.enqueue(),U.M[15](i+32,e.oformatContext.streams[0].index);var s=(0,Z.rU)(i,1);s&&ve(e.oformatContext.streams[0].codecpar.extradata,e.oformatContext.streams[0].codecpar.extradataSize,C.f[20](s),C.f[15](s+4))&&r.mixExtradata(i,e,C.f[20](s),C.f[15](s+4)),r.writeAVPacket(i,e,!0),e.track.addBuffer(e.bufferQueue.flush());var o=e.oformatContext.streams[0].codecpar.codecType;if(0===o?(U.M[17](t.stats+144,C.f[17](t.stats+144)+BigInt(1)),U.M[17](t.stats+160,C.f[17](t.stats+160)+BigInt(1))):1===o&&(U.M[17](t.stats+56,C.f[17](t.stats+56)+BigInt(1)),U.M[17](t.stats+72,C.f[17](t.stats+72)+BigInt(1))),t.playRate!==t.targetRate&&(e.startTimestamp=BigInt(Math.floor((0,$.A)()))-a*BigInt(100)/t.targetRate,t.playRate=t.targetRate),e.packetEnded&&!e.frontPacket)return e.ended=!0,e.loop.stop(),e.enableRawMpeg||(V.dJ(e.oformatContext),V.bX(e.oformatContext)),e.bufferQueue.size&&e.track.addBuffer(e.bufferQueue.flush()),void e.track.end();r.swap(e,t)}else e.loop.emptyTask()}else e.packetEnded&&!e.frontPacket?(e.ended=!0,e.loop.stop(),e.enableRawMpeg||(V.dJ(e.oformatContext),V.bX(e.oformatContext)),e.bufferQueue.size&&e.track.addBuffer(e.bufferQueue.flush()),e.track.end()):e.loop.emptyTask()}),0,0)}},{key:"startMux",value:(p=(0,A.A)(S().mark((function e(t,r){var n,i,a,s,o,u;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Y.Dh,i=Y.Dh,a=BigInt(0),o=t.oformatContext.streams[0].timeBase,t.backPacket>0&&(n=C.f[17](t.backPacket+16),i=C.f[17](t.backPacket+8),U.M[15](t.backPacket+32,t.oformatContext.streams[0].index),this.writeAVPacket(t.backPacket,t),r.avpacketPool.release(t.backPacket),t.backPacket=0);case 5:if(!(n<BigInt(0)||(0,Q.k)(a-n,o,Y.i0)<r.cacheDuration)){e.next=21;break}return e.next=8,this.pullAVPacket(t,r);case 8:if(!((s=e.sent)<0)){e.next=12;break}return t.packetEnded=!0,e.abrupt("break",21);case 12:a=C.f[17](s+16),n<BigInt(0)&&(n=a,i=C.f[17](s+8)),C.f[17](s+8)<i&&(i=C.f[17](s+8)),r.video&&r.video.streamIndex===C.f[15](s+32)&&(u=(0,Z.rU)(s,1))&&ve(t.oformatContext.streams[0].codecpar.extradata,t.oformatContext.streams[0].codecpar.extradataSize,C.f[20](u),C.f[15](u+4))&&this.mixExtradata(s,t,C.f[20](u),C.f[15](u+4)),U.M[15](s+32,t.oformatContext.streams[0].index),this.writeAVPacket(s,t),r.avpacketPool.release(s),e.next=5;break;case 21:i!==Y.Dh&&t.startPTS<=BigInt(0)&&(t.startPTS=i),t.pullQueue.diff=BigInt(0),r.currentTimeNTP=(0,$.A)(),r.currentTime=0,t.startTimestamp=BigInt(Math.floor((0,$.A)()))-(0,Q.k)(a,o,Y.i0)*BigInt(100)/r.playRate;case 26:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"resetResource",value:function(e,t){e.bufferQueue.flush();var r=new W.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0});e.oformatContext.oformat=r;var n=new q.A;n.onQuotaExceededError=function(){e.startTimestamp-=BigInt(100)},n.onEnded=function(){t.audio&&!t.audio.ended||t.video&&!t.video.ended||(t.mediaSource.endOfStream(),N.pq("muxer ended, taskId: ".concat(t.taskId),pe,743))},e.track=n,e.packetEnded=!1,e.ended=!1,e.startTimestamp=BigInt(0),e.frontBuffered=!1,e.seekSync=null,e.loop&&(e.loop.destroy(),e.loop=null),e.frontPacket&&(t.avpacketPool.release(e.frontPacket),e.frontPacket=0),e.backPacket&&(t.avpacketPool.release(e.backPacket),e.backPacket=0),e.pullQueue.ended=!1,e.pullQueue.index=0,e.pullQueue.frameCount=Y.Dh,e.pullQueue.lastPTS=BigInt(0),e.pullQueue.lastDTS=BigInt(0),e.pullQueue.diff=BigInt(0)}},{key:"addStream",value:(l=(0,A.A)(S().mark((function e(t,r,n,i,a,s){var o,u,c,f,h,d,l,p,v;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(o=this.tasks.get(t))?(u=new z.A(1048576),c=(0,D.fG)(),f=new W.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0}),h=new X.A,u.onFlush=function(e){return h.push(e.slice()),0},u.onSeek=function(e){return h.seek(e)?0:F.lh},d=c.createStream(),(0,j.Yi)(d.codecpar[B.o9],n),86017===C.f[15](n+4)&&(d.codecpar.codecTag=(0,ae.A)(".mp3")),(l=1===C.f[15](n)&&C.f[15](n+144)&&!o.isLive&&(0,Q.Vt)(i)>(0,Q.lb)({num:1,den:C.f[15](n+136)}))?(d.timeBase.den=C.f[15](n+136),d.timeBase.num=1):(d.timeBase.den=C.f[15](i+4),d.timeBase.num=C.f[15](i)),c.oformat=f,c.ioWriter=u,p=new q.A,v={type:"audio",codecpar:n,ioWriter:u,oformatContext:c,oformat:f,track:p,bufferQueue:h,streamIndex:r,pullIPC:new O.Ay(s),loop:null,frontPacket:0,backPacket:0,frontBuffered:!1,startTimestamp:BigInt(0),packetEnded:!1,ended:!1,seekSync:null,startPTS:a,pullQueue:{queue:[],index:0,frameCount:Y.Dh,diff:BigInt(0),lastPTS:BigInt(0),lastDTS:BigInt(0),ended:!1,useSampleRateTimeBase:l},enableRawMpeg:86017===C.f[15](n+4)&&!te.A.firefox,timestampOffsetUpdated:!1},p.onQuotaExceededError=function(){v.startTimestamp-=BigInt(100)},p.onEnded=function(){o.audio&&!o.audio.ended||o.video&&!o.video.ended||(o.mediaSource.endOfStream(),N.pq("muxer ended, taskId: ".concat(o.taskId),pe,876))},1===C.f[15](n)?(o.audio=v,U.M[15](o.stats+4,C.f[15](n+136)),U.M[15](o.stats,C.f[15](n+116))):0===C.f[15](n)&&(v.type="video",o.video=v,U.M[15](o.stats+84,C.f[15](n+56)),U.M[15](o.stats+88,C.f[15](n+60)),C.f[15](o.stats+84)*C.f[15](o.stats+88)>8294400&&te.A.safari&&(o.cacheDuration=ie.T9(BigInt(3e3),o.cacheDuration)))):N.h2("task not found",pe,897);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,i,a){return l.apply(this,arguments)})},{key:"reAddStream",value:(d=(0,A.A)(S().mark((function e(t,r,n,i,a){var s,o,u,c;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s=this.tasks.get(t))){e.next=22;break}if(!(o=1===C.f[15](n)?s.audio:s.video)){e.next=20;break}return o.bufferQueue.flush(),e.next=7,new(T())((function(e){o.track.removeAllBuffer((function(){e()}))}));case 7:o.track.reset(),u=new W.A({fragmentMode:1,fragment:!0,fastOpen:!0,movMode:0,defaultBaseIsMoof:!0}),o.oformatContext.oformat=u,o.codecpar=n,o.streamIndex=r,o.startPTS=a,c=o.oformatContext.streams[0],(0,j.Yi)(c.codecpar[B.o9],n),86017===C.f[15](n+4)&&(c.codecpar.codecTag=(0,ae.A)(".mp3")),1===C.f[15](n)&&C.f[15](n+144)&&!s.isLive&&(0,Q.Vt)(i)>(0,Q.lb)({num:1,den:C.f[15](n+136)})?(c.timeBase.den=C.f[15](n+136),c.timeBase.num=1):(c.timeBase.den=C.f[15](i+4),c.timeBase.num=C.f[15](i)),o.track.changeMimeType(this.getMimeType(c.codecpar[B.o9])),o.enableRawMpeg||(V.ho(o.oformatContext,{paddingZero:!1}),V.bx(o.oformatContext));case 20:e.next=23;break;case 22:N.h2("task not found",pe,970);case 23:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,i){return d.apply(this,arguments)})},{key:"pause",value:(h=(0,A.A)(S().mark((function e(t){var r,n,i,a,s;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))?(null!==(n=r.audio)&&void 0!==n&&n.loop||null!==(i=r.video)&&void 0!==i&&i.loop||N.h2("task has not played",pe,978),r.pausing=!0,r.pauseTimestamp=(0,$.A)(),null===(a=r.audio)||void 0===a||a.loop.stop(),null===(s=r.video)||void 0===s||s.loop.stop()):N.h2("task not found",pe,986);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"unpause",value:(f=(0,A.A)(S().mark((function e(t){var r,n,i;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))?(null!==(n=r.audio)&&void 0!==n&&n.loop||null!==(i=r.video)&&void 0!==i&&i.loop||N.h2("task has not played",pe,994),r.pausing=!1,r.seeking||(r.audio&&(r.audio.startTimestamp+=BigInt(Math.floor((0,$.A)()-r.pauseTimestamp)),r.audio.loop.start()),r.video&&(r.video.startTimestamp+=BigInt(Math.floor((0,$.A)()-r.pauseTimestamp)),r.video.loop.start()))):N.h2("task not found",pe,1011);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"beforeSeek",value:(c=(0,A.A)(S().mark((function e(t){var r,n,i,a;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=47;break}return a=[],r.audio&&(r.audio.ended||r.audio.frontBuffered||a.push(new(T())((function(e){r.audio.seekSync=e})))),r.video&&(r.video.ended||r.video.frontBuffered||a.push(new(T())((function(e){r.video.seekSync=e})))),e.next=7,T().all(a);case 7:if(r.seeking=!0,null===(n=r.audio)||void 0===n||n.loop.stop(),null===(i=r.video)||void 0===i||i.loop.stop(),!r.audio){e.next=29;break}if(r.audio.enableRawMpeg||V.bX(r.audio.oformatContext),r.audio.bufferQueue.flush(),!te.A.safari){e.next=16;break}return e.next=16,new(T())((function(e){r.audio.track.removeAllBuffer((function(){e()}))}));case 16:r.audio.track.reset(),r.audio.packetEnded=!1,r.audio.timestampOffsetUpdated=!1,r.audio.backPacket&&(r.avpacketPool.release(r.audio.backPacket),r.audio.backPacket=0),r.audio.frontPacket&&(r.avpacketPool.release(r.audio.frontPacket),r.audio.frontPacket=0),r.audio.pullQueue.queue.length&&r.audio.pullQueue.queue.forEach((function(e){r.avpacketPool.release(e)})),r.audio.pullQueue.queue.length=0,r.audio.pullQueue.ended=!1,r.audio.pullQueue.index=0,r.audio.pullQueue.lastPTS=BigInt(0),r.audio.pullQueue.lastDTS=BigInt(0),r.audio.pullQueue.diff=BigInt(0),r.audio.pullQueue.frameCount=Y.Dh;case 29:if(!r.video){e.next=47;break}if(r.video.enableRawMpeg||V.bX(r.video.oformatContext),r.video.bufferQueue.flush(),!te.A.safari){e.next=35;break}return e.next=35,new(T())((function(e){r.video.track.removeAllBuffer((function(){e()}))}));case 35:r.video.track.reset(),r.video.packetEnded=!1,r.video.timestampOffsetUpdated=!1,r.video.backPacket&&(r.avpacketPool.release(r.video.backPacket),r.video.backPacket=0),r.video.frontPacket&&(r.avpacketPool.release(r.video.frontPacket),r.video.frontPacket=0),r.video.pullQueue.queue.length&&r.video.pullQueue.queue.forEach((function(e){r.avpacketPool.release(e)})),r.video.pullQueue.queue.length=0,r.video.pullQueue.ended=!1,r.video.pullQueue.index=0,r.video.pullQueue.diff=BigInt(0),r.video.pullQueue.lastPTS=BigInt(0),r.video.pullQueue.lastDTS=BigInt(0);case 47:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"afterSeek",value:(u=(0,A.A)(S().mark((function e(t,r){var n,i,a,s,o,u,c,f,h;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.tasks.get(t))){e.next=95;break}return i=r,a=r,e.next=6,this.syncToKeyframe(n);case 6:s=e.sent,n.audio&&n.audio.backPacket>0&&((!s||r<BigInt(0))&&(i=(0,Q.k)(C.f[17](n.audio.backPacket+8)-n.audio.startPTS,(0,R.A)(n.audio.backPacket+72,M.P),Y.i0)),U.M[15](n.audio.backPacket+32,n.audio.oformatContext.streams[0].index),this.writeAVPacket(n.audio.backPacket,n.audio),n.avpacketPool.release(n.audio.backPacket),n.audio.backPacket=0),n.video&&n.video.backPacket>0&&((!s||r<BigInt(0))&&(a=(0,Q.k)(C.f[17](n.video.backPacket+8)-n.video.startPTS,(0,R.A)(n.video.backPacket+72,M.P),Y.i0)),U.M[15](n.video.backPacket+32,n.video.oformatContext.streams[0].index),this.writeAVPacket(n.video.backPacket,n.video),n.avpacketPool.release(n.video.backPacket),n.video.backPacket=0),o=ie.T9(i,a);case 10:if(!n.audio||n.audio.packetEnded){e.next=31;break}return e.next=14,this.pullAVPacket(n.audio,n);case 14:if(n.audio.backPacket=e.sent,!(n.audio.backPacket<0)){e.next=20;break}if(n.audio.packetEnded=!0,n.audio.backPacket=0,n.video&&!n.video.packetEnded){e.next=20;break}return e.abrupt("break",52);case 20:if(i<BigInt(0)&&(i=(0,Q.k)(C.f[17](n.audio.backPacket+8)-n.audio.startPTS,(0,R.A)(n.audio.backPacket+72,M.P),Y.i0)),!((0,Q.k)(C.f[17](n.audio.backPacket+8)-n.audio.startPTS,(0,R.A)(n.audio.backPacket+72,M.P),Y.i0)<o+n.cacheDuration)){e.next=30;break}U.M[15](n.audio.backPacket+32,n.audio.oformatContext.streams[0].index),this.writeAVPacket(n.audio.backPacket,n.audio),n.audio.enableRawMpeg||V.bX(n.audio.oformatContext),n.audio.track.addBuffer(n.audio.bufferQueue.flush()),n.avpacketPool.release(n.audio.backPacket),n.audio.backPacket=0,e.next=31;break;case 30:return e.abrupt("break",52);case 31:if(!n.video||n.video.packetEnded){e.next=50;break}return e.next=34,this.pullAVPacket(n.video,n);case 34:if(n.video.backPacket=e.sent,!(n.video.backPacket<0)){e.next=40;break}if(n.video.packetEnded=!0,n.video.backPacket=0,n.audio&&!n.audio.packetEnded){e.next=40;break}return e.abrupt("break",52);case 40:if(!((0,Q.k)(C.f[17](n.video.backPacket+8)-n.video.startPTS,(0,R.A)(n.video.backPacket+72,M.P),Y.i0)<o+n.cacheDuration)){e.next=49;break}U.M[15](n.video.backPacket+32,n.video.oformatContext.streams[0].index),this.writeAVPacket(n.video.backPacket,n.video),n.video.enableRawMpeg||V.bX(n.video.oformatContext),n.video.track.addBuffer(n.video.bufferQueue.flush()),n.avpacketPool.release(n.video.backPacket),n.video.backPacket=0,e.next=50;break;case 49:return e.abrupt("break",52);case 50:e.next=10;break;case 52:return u=[],n.audio&&(n.audio.enableRawMpeg||V.bX(n.audio.oformatContext),u.push(new(T())((function(e){n.audio.track.addBuffer(n.audio.bufferQueue.flush(),(function(){e()}))})))),n.video&&(n.video.enableRawMpeg||V.bX(n.video.oformatContext),u.push(new(T())((function(e){n.video.track.addBuffer(n.video.bufferQueue.flush(),(function(){e()}))})))),e.next=57,T().all(u);case 57:if(!n.audio||n.audio.packetEnded){e.next=70;break}if(!(n.audio.backPacket<=0)){e.next=63;break}return e.next=61,this.pullAVPacket(n.audio,n);case 61:n.audio.backPacket=e.sent,n.audio.backPacket<0&&(n.audio.packetEnded=!0,n.audio.backPacket=0);case 63:if(n.audio.packetEnded){e.next=70;break}return e.next=66,this.pullAVPacket(n.audio,n);case 66:n.audio.frontPacket=e.sent,n.audio.frontPacket<0?(n.audio.frontPacket=0,n.audio.packetEnded=!0,n.audio.frontBuffered=!1):(n.audio.packetEnded=!1,n.audio.frontBuffered=!0),n.audio.startTimestamp=BigInt(Math.floor((0,$.A)()))-(i+n.cacheDuration+(0,Q.k)(n.audio.startPTS,n.audio.oformatContext.streams[0].timeBase,Y.i0))*BigInt(100)/n.playRate,n.pausing?n.pauseTimestamp=(0,$.A)():n.audio.loop.start();case 70:if(!n.video||n.video.packetEnded){e.next=83;break}if(!(n.video.backPacket<=0)){e.next=76;break}return e.next=74,this.pullAVPacket(n.video,n);case 74:n.video.backPacket=e.sent,n.video.backPacket<0&&(n.video.packetEnded=!0,n.video.backPacket=0);case 76:if(n.video.packetEnded){e.next=83;break}return e.next=79,this.pullAVPacket(n.video,n);case 79:n.video.frontPacket=e.sent,n.video.frontPacket<0?(n.video.packetEnded=!0,n.video.frontBuffered=!1,n.video.frontPacket=0):(n.video.packetEnded=!1,n.video.frontBuffered=!0),n.video.startTimestamp=BigInt(Math.floor((0,$.A)()))-(a+n.cacheDuration+(0,Q.k)(n.video.startPTS,n.video.oformatContext.streams[0].timeBase,Y.i0))*BigInt(100)/n.playRate,n.pausing?n.pauseTimestamp=(0,$.A)():n.video.loop.start();case 83:if(s){e.next=86;break}return e.next=86,new ne.A(.5);case 86:return c=0,f=0,n.audio?n.video?(c=Math.max(n.audio.track.getBufferedStart(),n.video.track.getBufferedStart()),f=Math.min(n.audio.track.getBufferedEnd(),n.video.track.getBufferedEnd())):(c=n.audio.track.getBufferedStart(),f=n.audio.track.getBufferedEnd()):n.video&&(c=n.video.track.getBufferedStart(),f=n.video.track.getBufferedEnd()),(h=(0,re.yw)(o))>=c&&h<=f||(h=Math.abs(h-c)>Math.abs(h-f)?f:c),n.currentTimeNTP=(0,$.A)(),n.currentTime=h,n.seeking=!1,e.abrupt("return",h);case 95:return e.abrupt("return",0);case 96:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"setPlayRate",value:(o=(0,A.A)(S().mark((function e(t,r){var n,i;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))?(n.enableJitterBuffer&&(i=C.f[15](n.stats+236)?C.f[15](n.stats+32)/C.f[15](n.stats+236)*1e3:C.f[15](n.stats+224)?C.f[15](n.stats+120)/C.f[15](n.stats+224)*1e3:0)&&i<=C.f[15](n.jitterBuffer)&&(r=1),n.targetRate=BigInt(Math.floor(Math.floor(100*r))),n.enableJitterBuffer||(n.audio&&n.audio.loop&&n.audio.loop.resetInterval(),n.video&&n.video.loop&&n.video.loop.resetInterval())):N.h2("task not found",pe,1372);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"restart",value:(s=(0,A.A)(S().mark((function e(t){var r,n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))&&(r.audio&&this.resetResource(r.audio,r),r.video&&this.resetResource(r.video,r),(n=new((0,se.A)())).onsourceopen=this.getSourceOpenHandler(r),r.mediaSource=n);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"setCurrentTime",value:(a=(0,A.A)(S().mark((function e(t,r){var n;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.tasks.get(t))?(n.audio&&n.audio.track.removeBuffer(r),n.video&&C.f[15](n.stats+92)>0&&(n.video.track.setMediaBufferMax(Math.max(n.video.track.getMediaBufferMax(),Math.ceil(C.f[15](n.stats+92)/1e3*1.5),10)),n.video.track.removeBuffer(r)),n.currentTime=r,n.currentTimeNTP=(0,$.A)()):N.h2("task not found",pe,1414);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"getMediaSource",value:(i=(0,A.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.tasks.get(t))){e.next=10;break}if(!r.mediaSource.handle){e.next=7;break}return this.getMediaSource.transfer.push(r.mediaSource.handle),e.abrupt("return",r.mediaSource.handle);case 7:return e.abrupt("return",r.mediaSource);case 8:e.next=11;break;case 10:N.h2("task not found",pe,1431);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"createTask",value:function(e){var t=new O.Ay(e.controlPort),r=new MediaSource||new ManagedMediaSource,n=he(he({},e),{},{mediaSource:r,audio:null,video:null,playRate:BigInt(100),targetRate:BigInt(100),pauseTimestamp:0,seeking:!1,pausing:!1,controlIPCPort:t,currentTime:0,currentTimeNTP:0,cacheDuration:BigInt(Math.floor(500)),avpacketPool:new H.A((0,R.A)(e.avpacketList,E.A),e.avpacketListMutex)});return this.tasks.set(e.taskId,n),r.onsourceopen=this.getSourceOpenHandler(n),0}},{key:"registerTask",value:(n=(0,A.A)(S().mark((function e(t){return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.tasks.has(t.taskId)){e.next=2;break}return e.abrupt("return",F.lh);case 2:return e.abrupt("return",this.createTask(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"unregisterTask",value:(r=(0,A.A)(S().mark((function e(t){var r;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=this.tasks.get(t))&&(r.audio&&(r.audio.loop&&(r.audio.oformatContext.destroy(),r.audio.loop.destroy()),r.audio.pullIPC&&r.audio.pullIPC.destroy(),r.audio.pullQueue.queue.length&&(r.audio.pullQueue.queue.forEach((function(e){r.avpacketPool.release(e)})),r.audio.pullQueue.queue.length=0)),r.video&&(r.video.loop&&(r.video.oformatContext.destroy(),r.video.loop.destroy()),r.video.pullIPC&&r.video.pullIPC.destroy(),r.video.pullQueue.queue.length&&(r.video.pullQueue.queue.forEach((function(e){r.avpacketPool.release(e)})),r.video.pullQueue.queue.length=0)),r.controlIPCPort&&r.controlIPCPort.destroy(),this.tasks.delete(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]),t}(L.A)},57038:(e,t,r)=>{"use strict";r.d(t,{A:()=>y});var n=r(78716),i=r(81570),a=r(134),s=r(23509),o=r(23873),u=r(77658),c=r(21194),f=r(77334),h=r(8284),d=r(65749),l=r(49963),p=r(78040),v=r(47924),m=r(95335),g='.ASS-box{font-family:Arial;overflow:hidden;pointer-events:none;position:absolute}.ASS-dialogue{font-size:0;position:absolute;z-index:0}.ASS-dialogue span{display:inline-block}.ASS-dialogue [data-text]{display:inline-block;color:var(--ass-fill-color);font-size:calc(var(--ass-scale)*var(--ass-real-fs)*1px);line-height:calc(var(--ass-scale)*var(--ass-tag-fs)*1px);letter-spacing:calc(var(--ass-scale)*var(--ass-tag-fsp)*1px)}.ASS-dialogue [data-wrap-style="0"],.ASS-dialogue [data-wrap-style="3"]{text-wrap:balance}.ASS-dialogue [data-wrap-style="1"]{word-break:break-word;white-space:normal}.ASS-dialogue [data-wrap-style="2"]{word-break:normal;white-space:nowrap}.ASS-dialogue [data-border-style="1"]{position:relative}.ASS-dialogue [data-border-style="1"]::after,.ASS-dialogue [data-border-style="1"]::before{content:attr(data-text);position:absolute;top:0;left:0;z-index:-1;filter:blur(calc(var(--ass-tag-blur)*1px))}.ASS-dialogue [data-border-style="1"]::before{color:var(--ass-shadow-color);transform:translate(calc(var(--ass-scale-stroke)*var(--ass-tag-xshad)*1px),calc(var(--ass-scale-stroke)*var(--ass-tag-yshad)*1px));-webkit-text-stroke:var(--ass-border-width) var(--ass-shadow-color);text-shadow:var(--ass-shadow-delta);opacity:var(--ass-shadow-opacity)}.ASS-dialogue [data-border-style="1"]::after{color:transparent;-webkit-text-stroke:var(--ass-border-width) var(--ass-border-color);text-shadow:var(--ass-border-delta);opacity:var(--ass-border-opacity)}.ASS-dialogue [data-border-style="3"]{padding:calc(var(--ass-scale-stroke)*var(--ass-tag-xbord)*1px) calc(var(--ass-scale-stroke)*var(--ass-tag-ybord)*1px);position:relative;filter:blur(calc(var(--ass-tag-blur)*1px))}.ASS-dialogue [data-border-style="3"]::after,.ASS-dialogue [data-border-style="3"]::before{content:"";width:100%;height:100%;position:absolute;z-index:-1}.ASS-dialogue [data-border-style="3"]::before{background-color:var(--ass-shadow-color);left:calc(var(--ass-scale-stroke)*var(--ass-tag-xshad)*1px);top:calc(var(--ass-scale-stroke)*var(--ass-tag-yshad)*1px)}.ASS-dialogue [data-border-style="3"]::after{background-color:var(--ass-border-color);left:0;top:0}@container style(--ass-tag-xbord: 0) and style(--ass-tag-ybord: 0){.ASS-dialogue [data-border-style="3"]::after{background-color:transparent}}@container style(--ass-tag-xshad: 0) and style(--ass-tag-yshad: 0){.ASS-dialogue [data-border-style="3"]::before{background-color:transparent}}.ASS-dialogue [data-rotate]{transform:perspective(312.5px) rotateY(calc(var(--ass-tag-fry)*1deg)) rotateX(calc(var(--ass-tag-frx)*1deg)) rotateZ(calc(var(--ass-tag-frz)*-1deg))}.ASS-dialogue [data-text][data-rotate]{transform-style:preserve-3d;word-break:normal;white-space:nowrap}.ASS-dialogue [data-scale],.ASS-dialogue [data-skew]{display:inline-block;transform:scale(var(--ass-tag-fscx),var(--ass-tag-fscy)) skew(calc(var(--ass-tag-fax)*1rad),calc(var(--ass-tag-fay)*1rad));transform-origin:var(--ass-align-h) var(--ass-align-v)}.ASS-fix-font-size{font-size:2048px;font-family:Arial;line-height:normal;width:0;height:0;position:absolute;visibility:hidden;overflow:hidden}.ASS-clip-area,.ASS-fix-font-size span{position:absolute}.ASS-clip-area{width:100%;height:100%;top:0;left:0}.ASS-scroll-area{position:absolute;width:100%;overflow:hidden}',A={Name:"Default",Fontname:"Arial",Fontsize:"16",PrimaryColour:"&Hffffff",SecondaryColour:"&Hffffff",OutlineColour:"&H0",BackColour:"&H0",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"1",Shadow:"0",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"0"},y=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:t.parentNode};if((0,n.A)(this,e),(0,a.A)(this,"store",void 0),(0,a.A)(this,"resampling_","video_height"),(0,a.A)(this,"resize_",void 0),(0,a.A)(this,"options",void 0),this.options=m.extend({},r),this.store={video:t,box:document.createElement("div"),svg:(0,f.An)("svg"),defs:(0,f.An)("defs"),observer:null,scale:1,width:0,height:0,scriptRes:{width:r.videoWidth||t.clientWidth,height:r.videoHeight||t.clientHeight},layoutRes:{width:r.videoWidth||t.clientWidth,height:r.videoHeight||t.clientHeight},resampledRes:{width:0,height:0},sbas:!0,styles:null,space:[],actives:[],delay:0,index:0,dialogues:[]},null==r.videoWidth&&(t.videoWidth=r.videoWidth),null==r.videoHeight&&(t.videoHeight=r.videoHeight),!r.container)throw new Error("Missing container.");this.resize_=(0,c.By)(this,this.store),this.updateHeader(r.header),r.container.append(u.Y);var i=this.store,o=i.svg,h=i.defs,d=i.scriptRes,l=i.box;o.setAttributeNS(null,"viewBox","0 0 ".concat(d.width," ").concat(d.height)),o.append(h),r.container.append(o),l.className="ASS-box",r.container.append(l),function(e){var t=e.getRootNode()||document,r=t instanceof Document;!r&&"object"===("undefined"==typeof documentPictureInPicture?"undefined":(0,s.A)(documentPictureInPicture))&&documentPictureInPicture.window&&(r=t===documentPictureInPicture.window.document);var n=r?t.head:t,i=n.querySelector("#ASS-global-style");i||((i=document.createElement("style")).type="text/css",i.id="ASS-global-style",i.append(document.createTextNode(g)),n.append(i)),document.head.querySelector("#ASS-global-style")||((i=document.createElement("style")).type="text/css",i.id="ASS-global-style",i.append(document.createTextNode(g)),document.head.append(i))}(r.container),this.resampling_=r.resampling||"video_height";var p=new ResizeObserver(this.resize.bind(this));return p.observe(t),this.store.observer=p,this}return(0,i.A)(e,[{key:"framing",value:function(e){var t=(0,v.U)(e,this.store);(0,f.MA)(t,"play"),t.__dialogue=e,this.store.actives.push(t)}},{key:"updateHeader",value:function(e){if(e){var t=(0,d.wE)(e,{defaultStyle:A}),r=t.info,n=t.width,i=t.height,a=t.styles;this.store.sbas=/yes/i.test(r.ScaledBorderAndShadow),this.store.layoutRes={width:+r.LayoutResX||this.options.videoWidth||this.store.video.clientWidth,height:+r.LayoutResY||this.options.videoHeight||this.store.video.clientHeight},this.store.scriptRes={width:n||this.store.layoutRes.width,height:i||this.store.layoutRes.height},this.store.styles=a}else this.store.styles=(0,p.W)({info:{WrapStyle:""},style:[],defaultStyle:A}),this.store.scriptRes={width:384,height:288};this.resize_(),this.options.header=e}},{key:"updateVideoResolution",value:function(e,t){if(this.options.header){var r=(0,d.wE)(this.options.header,{defaultStyle:A}),n=r.info,i=r.width,a=r.height;this.store.layoutRes={width:+n.LayoutResX||e||this.store.video.clientWidth,height:+n.LayoutResY||t||this.store.video.clientHeight},this.store.scriptRes={width:i||this.store.layoutRes.width,height:a||this.store.layoutRes.height}}else this.store.layoutRes={width:e,height:t}}},{key:"render",value:function(e){if(1===e.type){e.Start=Number(e.Start)/1e3,e.End=Number(e.End)/1e3;var t=(0,l.b)({styles:this.store.styles,dialogues:[e]})[0];m.extend(t,{d:"ASS-".concat((0,h.A)()),align:{h:(t.alignment+2)%3,v:Math.trunc((t.alignment-1)/3)}}),(0,o.w7)(t,this.store),this.framing(t)}}},{key:"clear",value:function(e){for(var t=(0|Number(0xffffffffn&e))/1e3,r=this.store.actives.length-1;r>=0;r-=1){var n=this.store.actives[r];n.end<t&&(n.$div.remove(),this.store.actives.splice(r,1))}}},{key:"clearAll",value:function(){for(var e=this.store.actives.length-1;e>=0;e-=1)this.store.actives[e].$div.remove();this.store.actives.length=0,this.store.space.length=0}},{key:"resize",value:function(){var e=this.store.actives.slice();this.resize_();for(var t=0;t<e.length;t++)this.framing(e[t].__dialogue)}},{key:"destroy",value:function(){var e=this.store,t=e.video,r=e.box,n=e.svg,i=e.observer;return(0,c.IU)(this.store),u.Y.remove(),n.remove(),r.remove(),i.unobserve(t),this.store.styles={},this}},{key:"show",value:function(){return this.store.box.style.visibility="visible",this}},{key:"hide",value:function(){return this.store.box.style.visibility="hidden",this}},{key:"resampling",get:function(){return this.resampling_},set:function(e){e!==this.resampling_&&/^(video|script)_(width|height)$/.test(e)&&(this.resampling_=e,this.resize())}}]),e}()},40031:(e,t,r)=>{"use strict";r.d(t,{A:()=>R});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(80662),f=r.n(c),h=r(12264),d=r(29170),l=r(63939),p=r(9599),v=r(50932),m=r(53616),g=r(84149),A=r(39148),y=r(4624),x=r(57038),k=r(81238),b=r(50011),w=r(14686),_=r(51785),T=r(84290),I=r(44328),S=r(77231),P=r(95335),B=r(71517),C="src/avplayer/subtitle/SubtitleRender.ts",M=[{reg:/<i>/g,value:"{\\i1}"},{reg:/<\/i>/g,value:"{\\i0}"},{reg:/<b>/g,value:"{\\b1}"},{reg:/<\/b>/g,value:"{\\b0}"},{reg:/<u>/g,value:"{\\u1}"},{reg:/<\/u>/g,value:"{\\u0}"},{reg:/{/g,value:"\\{"},{reg:/}/g,value:"\\}"},{reg:/&gt;/g,value:">"},{reg:/&lt;/g,value:"<"},{reg:/&lrm;/g,value:""},{reg:/&rlm;/g,value:""},{reg:/&amp;/g,value:"&"},{reg:/&nbsp;/g,value:"\\h"},{reg:/(<br\s*\/?>)|\n>/g,value:"\\N"}],R=function(){function e(t){var r=this;(0,i.A)(this,e),(0,s.A)(this,"decoder",void 0),(0,s.A)(this,"loop",void 0),(0,s.A)(this,"demuxer2SubtitleRenderChannels",void 0),(0,s.A)(this,"leftPorts",void 0),(0,s.A)(this,"currentPort",void 0),(0,s.A)(this,"render",void 0),(0,s.A)(this,"queue",void 0),(0,s.A)(this,"ended",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"pulling",void 0),(0,s.A)(this,"formats",void 0),(0,s.A)(this,"avpacketPool",void 0),(0,s.A)(this,"delay",void 0),(0,s.A)(this,"enable",void 0),this.options=P.extend({},t),this.ended=!1,this.pulling=!1,this.queue=[],this.delay=BigInt(0),this.demuxer2SubtitleRenderChannels=new(f()),this.leftPorts=new(f()),t.avpacketList&&(this.avpacketPool=new T.A((0,d.A)(t.avpacketList,h.A),t.avpacketListMutex)),this.createDecoder(),this.render=new x.A(this.options.dom,{header:this.getAssHeader(this.options.codecpar),container:this.options.container,videoWidth:this.options.videoWidth,videoHeight:this.options.videoHeight}),this.loop=new A.A((function(){!r.queue.length&&r.ended&&r.loop.stop(),r.queue.length<6&&!r.ended&&r.pull();var e=r.options.getCurrentTime()-r.delay;for(r.render.clear(e);r.queue.length;){var t=r.queue[0];if(t.Start>e)break;t.End>e&&r.render.render(t),r.queue.shift()}}),0,50,!1)}var t;return(0,a.A)(e,[{key:"getAssHeader",value:function(e){var t="";if(94230===l.f[15](e+4)&&l.f[15](e+16))for(var r=(t=b.decode((0,w.s3)(l.f[20](e+12),l.f[15](e+16)))).split(/\r?\n/),n=!1,i=0;i<r.length;i++){var a=r[i].trim();"[Events]"===a&&(n=!0),/^Format:/.test(a)&&n&&(this.formats=_.Bp(a.trim()))}return t}},{key:"createDecoder",value:function(){var e=this;this.decoder&&this.decoder.close(),this.decoder=new m.A({onReceiveSubtitle:function(t){for(var r=0;r<t.rects.length;r++){var n=t.rects[r];if(n.type===k.G.SUBTITLE_ASS){var i=_.wj(e.formats,n.text);null==i.Start&&(i.Start=t.pts),null==i.End&&(i.End=t.pts+t.duration),e.queue.push(i)}else n.type===k.G.SUBTITLE_WEBVTT?e.queue.push(e.webvtt2AssEvent(n.text,t.pts,t.pts+t.duration)):e.queue.push(e.text2AssEvent(n.text,t.pts,t.pts+t.duration))}}}),this.decoder.open(this.options.codecpar)}},{key:"text2AssEvent",value:function(e,t,r){return{type:1,ReadOrder:0,Layer:0,Start:t,End:r,Style:"Default",Name:"",MarginL:0,MarginR:0,MarginV:0,Text:{raw:e,combined:e,parsed:[{tags:[],text:e,drawing:[]}]}}}},{key:"webvtt2AssEvent",value:function(e,t,r){for(var n=0;n<M.length;n++)e=e.replace(M[n].reg,M[n].value);return this.text2AssEvent(e,t,r)}},{key:"pull",value:(t=(0,n.A)(u().mark((function e(){var t,r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pulling||this.ended){e.next=2;break}return e.abrupt("return");case 2:return this.pulling=!0,t=this.currentPort,e.next=6,this.leftPorts.get(this.currentPort).request("pull");case 6:-1048576===(r=e.sent)?(y.Yz("SubtitleRender end",C,290),this.decoder.flush(),this.ended=!0):r<0?(y.Yz("SubtitleRender pull avpacket error, ret: ".concat(r),C,295),this.ended=!0):this.loop&&t===this.currentPort?(v.M[17](r+8,(0,I.k)(l.f[17](r+8),(0,d.A)(r+72,p.P),S.i0)),v.M[17](r+48,(0,I.k)(l.f[17](r+48),(0,d.A)(r+72,p.P),S.i0)),n=this.decoder.decode(r),this.avpacketPool?this.avpacketPool.release(r):(0,B.Qe)(r),n<0&&(y.Yz("SubtitleRender decode avpacket error, ret: ".concat(r),C,309),this.ended=!0)):this.avpacketPool?this.avpacketPool.release(r):(0,B.Qe)(r),this.pulling=!1;case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getDemuxerPort",value:function(e){if(this.demuxer2SubtitleRenderChannels.has(e))return this.demuxer2SubtitleRenderChannels.get(e).port1;var t=new MessageChannel,r=new g.Ay(t.port2);return this.demuxer2SubtitleRenderChannels.set(e,t),this.leftPorts.set(e,r),t.port1}},{key:"start",value:function(){this.loop.isStarted()||this.loop.start(),this.ended=!1}},{key:"stop",value:function(){this.loop.stop(),this.render.clearAll()}},{key:"pause",value:function(){this.loop.stop()}},{key:"reset",value:function(){this.queue.length=0,this.render.clearAll()}},{key:"reopenDecoder",value:function(e){this.options.codecpar=e,this.createDecoder(),this.render.updateHeader(this.getAssHeader(e))}},{key:"updateVideoResolution",value:function(e,t){e===this.options.videoWidth&&t===this.options.videoHeight||(this.render.updateVideoResolution(e,t),this.options.videoWidth=e,this.options.videoHeight=t)}},{key:"setDemuxTask",value:function(e){this.currentPort!==e&&(this.pulling=!1),this.currentPort=e}},{key:"destroy",value:function(){this.loop.destroy(),this.loop=null,this.leftPorts.clear(),this.demuxer2SubtitleRenderChannels.clear(),this.queue.length=0,this.render.destroy(),this.render=null,this.decoder.close(),this.decoder=null}},{key:"setDelay",value:function(e){this.delay=e}}]),e}()},88103:(e,t,r)=>{"use strict";r.d(t,{A:()=>A});var n=r(88435),i=r.n(n),a=r(25182),s=r(78716),o=r(81570),u=r(77193),c=r(43070),f=r(60394),h=r(25767),d=r(31060),l=r(134),p=r(36443),v=r.n(p);function m(e,t,r){return t=(0,h.A)(t),(0,u.A)(e,g()?i()(t,r||[],(0,h.A)(e).constructor):t.apply(e,r))}function g(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}var A=function(e){function t(e,r){var n;return(0,s.A)(this,t),n=m(this,t,[e,r]),(0,l.A)((0,c.A)(n),"context",void 0),(0,l.A)((0,c.A)(n),"paddingLeft",void 0),(0,l.A)((0,c.A)(n),"paddingTop",void 0),(0,l.A)((0,c.A)(n),"flipX",void 0),(0,l.A)((0,c.A)(n),"flipY",void 0),n.paddingLeft=0,n.paddingTop=0,n.flipX=1,n.flipY=1,n}var r;return(0,d.A)(t,e),(0,o.A)(t,[{key:"init",value:(r=(0,a.A)(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.context=this.canvas.getContext("2d");case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"clear",value:function(){var e=this.canvas.width>>1,t=this.canvas.height>>1;this.rotate&&(this.context.translate(e,t),this.context.rotate(-this.rotate*Math.PI/180),this.context.translate(-e,-t)),this.context.clearRect(0,0,this.canvasWidth*this.options.devicePixelRatio,this.canvasHeight*this.options.devicePixelRatio),this.rotate&&(this.context.translate(e,t),this.context.rotate(this.rotate*Math.PI/180),this.context.translate(-e,-t))}},{key:"checkFrame",value:function(e){e.codedWidth===this.textureWidth&&e.codedHeight===this.videoHeight&&e.codedWidth===this.videoWidth||(this.videoWidth=e.codedWidth,this.videoHeight=e.codedHeight,this.textureWidth=e.codedWidth,this.layout())}},{key:"render",value:function(e){this.lost||(this.checkFrame(e),this.context.drawImage(e,this.paddingLeft,this.paddingTop,this.canvasWidth*this.options.devicePixelRatio-2*this.paddingLeft,this.canvasHeight*this.options.devicePixelRatio-2*this.paddingTop))}},{key:"layout",value:function(){var e=this.videoWidth,t=this.videoHeight,r=this.canvasWidth,n=this.canvasHeight,i=0,a=0;90!==this.rotate&&270!==this.rotate||(a=Math.floor((n-r)/2),i=Math.floor((r-n)/2),r=this.canvasHeight,n=this.canvasWidth);var s,o=e/r,u=t/n;if(s=o>1?!(o<u):o>u,1===this.renderMode&&(s=!s),s){var c=(n-t*r/e)/n;this.paddingTop=(Math.floor(c/2*n)+a)*this.options.devicePixelRatio,this.paddingLeft=i*this.options.devicePixelRatio}else{var f=(r-e*n/t)/r;this.paddingLeft=(Math.floor(f/2*r)+i)*this.options.devicePixelRatio,this.paddingTop=a*this.options.devicePixelRatio}if(this.context){var h=1,d=1;this.flipHorizontal&&(h=-1),this.flipVertical&&(d=-1);var l=this.canvas.width>>1,p=this.canvas.height>>1;this.context.translate(l,p),h!==this.flipX&&this.context.scale(-1,1),d!==this.flipY&&this.context.scale(1,-1),this.context.translate(-l,-p),this.flipX=h,this.flipY=d}}},{key:"setRotate",value:function(e){if((e%=360)!==this.rotate){var t=this.canvas.width>>1,r=this.canvas.height>>1;this.rotate&&(this.context.translate(t,r),this.context.rotate(-this.rotate*Math.PI/180),this.context.translate(-t,-r)),this.clear(),this.rotate=e,this.context&&(this.context.translate(t,r),this.context.rotate(this.rotate*Math.PI/180),this.context.translate(-t,-r)),this.layout()}}},{key:"destroy",value:function(){this.context=null,(0,f.A)((0,h.A)(t.prototype),"destroy",this).call(this)}}],[{key:"isSupport",value:function(e){return e instanceof VideoFrame||e instanceof ImageBitmap}}]),t}(r(43356).A)},43356:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(78716),i=r(81570),a=r(134),s=r(6110),o=function(){function e(t,r){(0,n.A)(this,e),(0,a.A)(this,"canvas",void 0),(0,a.A)(this,"options",void 0),(0,a.A)(this,"textureWidth",void 0),(0,a.A)(this,"videoWidth",void 0),(0,a.A)(this,"videoHeight",void 0),(0,a.A)(this,"canvasWidth",void 0),(0,a.A)(this,"canvasHeight",void 0),(0,a.A)(this,"rotate",void 0),(0,a.A)(this,"renderMode",void 0),(0,a.A)(this,"format",void 0),(0,a.A)(this,"lost",void 0),(0,a.A)(this,"destroyed",void 0),(0,a.A)(this,"srcColorSpace",void 0),(0,a.A)(this,"dstColorSpace",void 0),(0,a.A)(this,"flipHorizontal",void 0),(0,a.A)(this,"flipVertical",void 0),this.canvas=t,this.options=r,this.canvasWidth=t.width,this.canvasHeight=t.height,this.videoWidth=0,this.videoHeight=0,this.textureWidth=0,this.rotate=0,this.renderMode=r.renderMode,this.flipHorizontal=!1,this.flipVertical=!1,this.lost=!1,this.destroyed=!1,r.dstColorSpace?this.dstColorSpace=r.dstColorSpace:this.dstColorSpace=new s.A(1,1,1,1)}return(0,i.A)(e,[{key:"getRotateMatrix",value:function(e){e=Math.PI*e/180;var t=Math.sin(e),r=Math.cos(e);return[r,-t,0,0,t,r,0,0,0,0,1,0,0,0,0,1]}},{key:"setRenderMode",value:function(e){this.renderMode!==e&&(this.renderMode=e,this.layout(),this.clear())}},{key:"enableHorizontalFlip",value:function(e){this.flipHorizontal!==e&&(this.flipHorizontal=e,this.layout(),this.clear())}},{key:"enableVerticalFlip",value:function(e){this.flipVertical!==e&&(this.flipVertical=e,this.layout(),this.clear())}},{key:"viewport",value:function(e,t){var r=this.options.devicePixelRatio;this.canvasWidth=e,this.canvasHeight=t,this.canvas.width=e*r,this.canvas.height=t*r,this.videoWidth&&this.videoHeight&&this.layout()}},{key:"getVideoWidth",value:function(){return this.videoWidth}},{key:"getVideoHeight",value:function(){return this.videoHeight}},{key:"destroy",value:function(){this.canvas=null,this.destroyed=!0}},{key:"setDstColorSpace",value:function(e){this.dstColorSpace=e}}],[{key:"isSupport",value:function(e){return!1}}]),e}()},43813:(e,t,r)=>{"use strict";r.d(t,{A:()=>x});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(31060),f=r(63939),h=r(14686),d=r(97317),l=r(25669),p=r(6110),v=r(37653),m=r(32903),g=r(72703);function A(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,y()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function y(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(y=function(){return!!e})()}var x=function(e){function t(e,r){return(0,a.A)(this,t),A(this,t,[e,r])}return(0,c.A)(t,e),(0,s.A)(t,[{key:"generateFragmentSource",value:function(e,t){var r=(0,l.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:0,outputRGB:!0}),n=["r","g","b","a"],i="texture2D(rgb_Sampler, v_color.xy).".concat(n[t.comp[0].offset]),a="texture2D(rgb_Sampler, v_color.xy).".concat(n[t.comp[1].offset]),s="texture2D(rgb_Sampler, v_color.xy).".concat(n[t.comp[2].offset]),o="1.0";128&t.flags&&4===t.nbComponents&&(o="texture2D(rgb_Sampler, v_color.xy).".concat(n[t.comp[3].offset])),this.fragmentSource="\n      precision highp float;\n      varying vec4 v_color;\n      uniform sampler2D rgb_Sampler;\n      void main () {\n        float r = ".concat(i,";\n        float g = ").concat(a,";\n        float b = ").concat(s,";\n        float alpha = ").concat(o,";\n        vec4 color = vec4(r, g, b, alpha);\n        ").concat(r.reduce((function(e,t){return e+t}),""),"\n        gl_FragColor = color;\n      }\n    ")}},{key:"checkFrame",value:function(e){var t=d.g[f.f[15](e+80)];t&&(f.f[15](e+32)===this.textureWidth&&f.f[15](e+72)===this.videoHeight&&f.f[15](e+68)===this.videoWidth||(this.srcColorSpace=new p.A(f.f[15](e+220),f.f[15](e+212),f.f[15](e+216),f.f[15](e+208)),this.generateFragmentSource(f.f[15](e+80),t),this.program=new m.A(this.fragmentSource),this.useProgram(),4===t.nbComponents&&(this.rgbTexture.setFormat(this.gl.RGBA),this.rgbTexture.setInternalformat(this.gl.RGBA)),this.rgbTexture.setSize(f.f[15](e+32),f.f[15](e+72)),this.videoWidth=f.f[15](e+68),this.videoHeight=f.f[15](e+72),this.textureWidth=f.f[15](e+32),this.format=f.f[15](e+80),this.layout()))}},{key:"render",value:function(e){this.lost||(this.checkFrame(e),this.rgbTexture.fill((0,h.s3)(f.f[20](e),this.rgbTexture.width*this.rgbTexture.height)),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4))}}],[{key:"isSupport",value:function(e){if((0,g.A)(e)){var t=d.g[f.f[15](e+80)];if(t)return 32&t.flags&&t.comp[0].depth+7>>>3==1}return!1}}]),t}(v.A)},37653:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134),l=r(94012),p=r(17397);function v(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,m()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function m(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(m=function(){return!!e})()}var g=function(e){function t(e,r){var n;return(0,a.A)(this,t),n=v(this,t,[e,r]),(0,d.A)((0,u.A)(n),"rgbTexture",void 0),n}return(0,h.A)(t,e),(0,s.A)(t,[{key:"useProgram",value:function(){(0,c.A)((0,f.A)(t.prototype),"useProgram",this).call(this),this.rgbTexture=new p.A(this.gl),this.rgbTexture.bind(0),this.rgbTexture.init(),this.program.bindRGBTexture(0)}},{key:"destroy",value:function(){this.rgbTexture&&(this.rgbTexture.destroy(),this.rgbTexture=null),(0,c.A)((0,f.A)(t.prototype),"destroy",this).call(this)}}]),t}(l.A)},94012:(e,t,r)=>{"use strict";r.d(t,{A:()=>b});var n=r(88435),i=r.n(n),a=r(25182),s=r(78716),o=r(81570),u=r(77193),c=r(43070),f=r(60394),h=r(25767),d=r(31060),l=r(134),p=r(36443),v=r.n(p),m=r(4624),g=r(43356),A=r(38469);function y(e,t,r){return t=(0,h.A)(t),(0,u.A)(e,x()?i()(t,r||[],(0,h.A)(e).constructor):t.apply(e,r))}function x(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}var k="src/avrender/image/WebGLRender.ts",b=function(e){function t(e,r){var n;return(0,s.A)(this,t),n=y(this,t,[e,r]),(0,l.A)((0,c.A)(n),"gl",void 0),(0,l.A)((0,c.A)(n),"VAO",void 0),(0,l.A)((0,c.A)(n),"program",void 0),(0,l.A)((0,c.A)(n),"vertex",void 0),(0,l.A)((0,c.A)(n),"webglContextLostTimer",void 0),(0,l.A)((0,c.A)(n),"onWebglContextLost",void 0),(0,l.A)((0,c.A)(n),"onWebglContextRestored",void 0),(0,l.A)((0,c.A)(n),"fragmentSource",void 0),(0,l.A)((0,c.A)(n),"vertexSource",void 0),n}var r;return(0,d.A)(t,e),(0,o.A)(t,[{key:"init",value:(r=(0,a.A)(v().mark((function e(){var t=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.gl=this.canvas.getContext("webgl2",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer}),this.gl||(this.gl=this.canvas.getContext("webgl",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer})),this.gl||(this.gl=this.canvas.getContext("experimental-webgl",{alpha:!1,antialias:!1,preserveDrawingBuffer:this.options.preserveDrawingBuffer})),this.gl||m.h2("can not support webgl, got WebGLRenderingContext failed",k,96),this.VAO=this.gl.createBuffer(),this.VAO||m.h2("create vao buffer failed",k,101),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.VAO),this.gl.enable(this.gl.BLEND),this.gl.clearColor(0,0,0,0),this.gl.clearDepth(1),this.viewport(this.canvasWidth||this.canvas.width,this.canvasHeight||this.canvas.height),this.onWebglContextLost=function(e){t.destroyed||(t.webglContextLostTimer=setTimeout((function(){t.lost=!0,t.webglContextLostTimer=null,m.z3("webgl context lost",k,118),t.options.onRenderContextLost&&t.options.onRenderContextLost()}),3e3))},this.onWebglContextRestored=function(e){t.webglContextLostTimer&&(clearTimeout(t.webglContextLostTimer),t.webglContextLostTimer=null)},this.canvas.addEventListener("webglcontextlost",this.onWebglContextLost),this.canvas.addEventListener("webglcontextrestored",this.onWebglContextRestored);case 15:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"viewport",value:function(e,r){this.gl.viewport(0,0,e*this.options.devicePixelRatio,r*this.options.devicePixelRatio),(0,f.A)((0,h.A)(t.prototype),"viewport",this).call(this,e,r)}},{key:"useProgram",value:function(){this.program.link(this.gl),this.program.bind(),this.program.setRotateMatrix(this.getRotateMatrix(this.rotate))}},{key:"clear",value:function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"layout",value:function(){var e=this.videoWidth,t=this.videoHeight,r=this.canvasWidth,n=this.canvasHeight;90!==this.rotate&&270!==this.rotate||(r=this.canvasHeight,n=this.canvasWidth);var i,a=e/r,s=t/n;i=a>1?!(a<s):a>s,1===this.renderMode&&(i=!i);var o=0;if(this.textureWidth!==this.videoWidth&&(o=(this.textureWidth-this.videoWidth)/this.textureWidth),i){var u=(n-t*r/e)/n;this.vertex=[-1,1-u,0,0,0,0,0,-1,-1+u,0,0,1,0,0,1,1-u,0,1-o,0,0,0,1,-1+u,0,1-o,1,0,0]}else{var c=(r-e*n/t)/r;this.vertex=[-1+c,1,0,0,0,0,0,-1+c,-1,0,0,1,0,0,1-c,1,0,1-o,0,0,0,1-c,-1,0,1-o,1,0,0]}(0,A.A)(this.vertex,this.flipHorizontal,this.flipVertical),this.gl&&this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.vertex),this.gl.STATIC_DRAW)}},{key:"setRotate",value:function(e){(e%=360)!==this.rotate&&(this.rotate=e,this.gl&&this.program.setRotateMatrix(this.getRotateMatrix(this.rotate)),this.layout(),this.clear())}},{key:"destroy",value:function(){this.program&&this.program.stop(),this.gl=null,this.VAO=null,this.vertex=null,this.onWebglContextLost&&(this.canvas.removeEventListener("webglcontextlost",this.onWebglContextLost),this.onWebglContextLost=null),this.onWebglContextRestored&&(this.canvas.removeEventListener("webglcontextrestored",this.onWebglContextRestored),this.onWebglContextRestored=null),(0,f.A)((0,h.A)(t.prototype),"destroy",this).call(this)}}]),t}(g.A)},99293:(e,t,r)=>{"use strict";r.d(t,{A:()=>M});var n=r(88435),i=r.n(n),a=r(25182),s=r(78716),o=r(81570),u=r(77193),c=r(43070),f=r(60394),h=r(25767),d=r(31060),l=r(134),p=r(36443),v=r.n(p),m=r(74503),g=r(63939),A=r(94300),y=r(14686),x=r(97317),k=r(22594),b=r(25669),w=r(57517),_=r(6110),T=r(20088),I=r(56024),S=r(73039),P=r(72703);function B(e,t,r){return t=(0,h.A)(t),(0,u.A)(e,C()?i()(t,r||[],(0,h.A)(e).constructor):t.apply(e,r))}function C(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}var M=function(e){function t(e,r){var n;return(0,s.A)(this,t),n=B(this,t,[e,r]),(0,l.A)((0,c.A)(n),"hdrMetadata",void 0),(0,l.A)((0,c.A)(n),"ext",void 0),n.hdrMetadata=(0,m.A)(T.A),n.hdrMetadata.multiplier=1,n}var r;return(0,d.A)(t,e),(0,o.A)(t,[{key:"init",value:(r=(0,a.A)(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.A)((0,h.A)(t.prototype),"init",this).call(this);case 2:if(this.ext=this.gl.getExtension("EXT_texture_norm16"),this.ext){e.next=5;break}throw Error("not support");case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"generateFragmentSource",value:function(e,t,r){r.outputRGB=!0;var n=(0,b.A)(this.srcColorSpace,this.dstColorSpace,r),i="texture2D(u_Sampler, v_color.xy).x",a="texture2D(v_Sampler, v_color.xy).x",s="1.0";23===e||189===e?(i="texture2D(u_Sampler, v_color.xy).x",a="texture2D(u_Sampler, v_color.xy).y"):24!==e&&190!==e||(i="texture2D(u_Sampler, v_color.xy).y",a="texture2D(u_Sampler, v_color.xy).x"),128&t.flags&&4===t.nbComponents&&(s="texture2D(a_Sampler, v_color.xy).x"),this.fragmentSource="\n      precision highp float;\n\n      varying vec4 v_color;\n      uniform sampler2D y_Sampler;\n      uniform sampler2D u_Sampler;\n      uniform sampler2D v_Sampler;\n      \n      uniform float v_max;\n\n      uniform float offset;\n      uniform float multiplier;\n      uniform float pq_tonemap_a;\n      uniform float pq_tonemap_b;\n      uniform float hlg_ootf_gamma_minus_one;\n      uniform float hlg_dst_max_luminance_relative;\n      uniform float nits_to_sdr_relative_factor;\n      uniform float sdr_relative_to_nits_factor;\n\n      ".concat(1&t.flags?"\n        float swap(float x) {\n          int value = int(x * 65535.0);\n          int low = value & 0xff;\n          int high = (value >> 8) & 0xff;\n          value = (low << 8) | high;\n          return float(value) / v_max;\n        }\n      ":"","\n      \n      void main () {\n      \n        float y = ").concat("texture2D(y_Sampler, v_color.xy).x",";\n        float u = ").concat(i,";\n        float v = ").concat(a,";\n        float alpha = ").concat(s,";\n        \n        ").concat(1&t.flags?"\n          y = swap(y);\n          u = swap(u);\n          v = swap(v);\n        ":"\n          y = y * 65535.0 / v_max;\n          u = u * 65535.0 / v_max;\n          v = v * 65535.0 / v_max;\n        ","\n        \n        vec4 color = vec4(y, u, v, alpha);\n\n        if (color.a > 0.0) {\n          color.r /= color.a;\n          color.g /= color.a;\n          color.b /= color.a;\n        }\n        color.r -= offset;\n        color.g -= offset;\n        color.b -= offset;\n\n        color.r *= multiplier;\n        color.g *= multiplier;\n        color.b *= multiplier;\n        \n        ").concat(n.reduce((function(e,t){return e+t}),""),"\n\n        color.r *= color.a;\n        color.g *= color.a;\n        color.b *= color.a;\n\n        gl_FragColor = color;\n      }\n    ")}},{key:"checkFrame",value:function(e){var t=x.g[g.f[15](e+80)];if(t){var r=t.comp[0].depth+7>>>3;if(g.f[15](e+32)/r!==this.textureWidth||g.f[15](e+72)!==this.videoHeight||g.f[15](e+68)!==this.videoWidth||g.f[15](e+80)!==this.format){this.srcColorSpace=new _.A(g.f[15](e+220),g.f[15](e+212),g.f[15](e+216),g.f[15](e+208));var n={type:0,bitDepth:t.comp[0].depth,toneMapPQAndHlgToDst:!0,metadata:this.hdrMetadata,dstSdrMaxLuminanceNits:w.kH,dstMaxLuminanceRelative:1},i=(0,I.aH)(e,14);if(i){var a=g.f[20](i+4);g.f[8](a)>0&&(n.maxContentLightLevel=g.f[8](a))}this.generateFragmentSource(g.f[15](e+80),t,n),this.program=new S.A(this.fragmentSource),this.useProgram(),this.program.setMetaData(this.hdrMetadata),this.yTexture.setFormat(this.gl.RED),this.yTexture.setInternalformat(this.ext.R16_EXT),this.yTexture.setDataType(this.gl.UNSIGNED_SHORT),this.uTexture.setFormat(this.gl.RED),this.uTexture.setInternalformat(this.ext.R16_EXT),this.uTexture.setDataType(this.gl.UNSIGNED_SHORT),this.vTexture.setFormat(this.gl.RED),this.vTexture.setInternalformat(this.ext.R16_EXT),this.vTexture.setDataType(this.gl.UNSIGNED_SHORT),this.aTexture.setFormat(this.gl.RED),this.aTexture.setInternalformat(this.ext.R16_EXT),this.aTexture.setDataType(this.gl.UNSIGNED_SHORT),this.yTexture.setSize(g.f[15](e+32)>>>1,g.f[15](e+72)),this.uTexture.setSize(g.f[15](e+32+4)>>>1,g.f[15](e+72)>>>x.g[g.f[15](e+80)].log2ChromaH),t.comp[1].plane!==t.comp[2].plane&&this.vTexture.setSize(g.f[15](e+32+8)>>>1,g.f[15](e+72)>>>x.g[g.f[15](e+80)].log2ChromaH),4===t.nbComponents&&this.aTexture.setSize(g.f[15](e+32+12)>>>1,g.f[15](e+72)),this.program.setMax((1<<t.comp[0].depth)-1),this.videoWidth=g.f[15](e+68),this.videoHeight=g.f[15](e+72),this.textureWidth=g.f[15](e+32)>>>1,this.format=g.f[15](e+80),this.layout()}}}},{key:"render",value:function(e){if(!this.lost){this.checkFrame(e);var t=x.g[g.f[15](e+80)];t&&(this.yTexture.fill((0,y.bg)(g.f[20](e),this.yTexture.width*this.yTexture.height)),this.uTexture.fill((0,y.bg)(g.f[20](e+4),this.uTexture.width*this.uTexture.height)),t.comp[1].plane!==t.comp[2].plane&&this.vTexture.fill((0,y.bg)(g.f[20](e+8),this.vTexture.width*this.vTexture.height)),4===t.nbComponents&&this.aTexture.fill((0,y.bg)(g.f[20](e+12),this.aTexture.width*this.aTexture.height)),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4))}}},{key:"destroy",value:function(){this.hdrMetadata&&((0,A.A)(this.hdrMetadata),this.hdrMetadata=null),(0,f.A)((0,h.A)(t.prototype),"destroy",this).call(this)}}],[{key:"isSupport",value:function(e){if((0,P.A)(e)){var t=x.g[g.f[15](e+80)];if(t)return!(32&t.flags)&&16&t.flags&&t.comp[0].depth+7>>>3==2}return!1}}]),t}(k.A)},55196:(e,t,r)=>{"use strict";r.d(t,{A:()=>x});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(31060),f=r(63939),h=r(14686),d=r(97317),l=r(22594),p=r(91848),v=r(25669),m=r(6110),g=r(72703);function A(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,y()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function y(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(y=function(){return!!e})()}var x=function(e){function t(e,r){return(0,a.A)(this,t),A(this,t,[e,r])}return(0,c.A)(t,e),(0,s.A)(t,[{key:"generateFragmentSource",value:function(e,t){var r=(0,v.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:0,outputRGB:!0}),n="texture2D(u_Sampler, v_color.xy).x",i="texture2D(v_Sampler, v_color.xy).x",a="1.0";23===e||189===e?(n="texture2D(u_Sampler, v_color.xy).x",i="texture2D(u_Sampler, v_color.xy).y"):24!==e&&190!==e||(n="texture2D(u_Sampler, v_color.xy).y",i="texture2D(u_Sampler, v_color.xy).x"),128&t.flags&&4===t.nbComponents&&(a="texture2D(a_Sampler, v_color.xy).x"),this.fragmentSource="\n      precision highp float;\n      varying vec4 v_color;\n      uniform sampler2D y_Sampler;\n      uniform sampler2D u_Sampler;\n      uniform sampler2D v_Sampler;\n      uniform sampler2D a_Sampler;\n      void main () {\n        float y = ".concat("texture2D(y_Sampler, v_color.xy).x",";\n        float u = ").concat(n,";\n        float v = ").concat(i,";\n        float alpha = ").concat(a,";\n        vec4 color = vec4(y, u, v, alpha);\n        ").concat(r.reduce((function(e,t){return e+t}),""),"\n        gl_FragColor = color;\n      }\n    ")}},{key:"checkFrame",value:function(e){var t=d.g[f.f[15](e+80)];t&&(f.f[15](e+32)===this.textureWidth&&f.f[15](e+72)===this.videoHeight&&f.f[15](e+68)===this.videoWidth||(this.srcColorSpace=new m.A(f.f[15](e+220),f.f[15](e+212),f.f[15](e+216),f.f[15](e+208)),this.generateFragmentSource(f.f[15](e+80),t),this.program=new p.A(this.fragmentSource),this.useProgram(),this.yTexture.setSize(f.f[15](e+32),f.f[15](e+72)),this.uTexture.setSize(f.f[15](e+32+4),f.f[15](e+72)>>>d.g[f.f[15](e+80)].log2ChromaH),t.comp[1].plane!==t.comp[2].plane&&this.vTexture.setSize(f.f[15](e+32+8),f.f[15](e+72)>>>d.g[f.f[15](e+80)].log2ChromaH),4===t.nbComponents&&this.aTexture.setSize(f.f[15](e+32+12),f.f[15](e+72)),this.videoWidth=f.f[15](e+68),this.videoHeight=f.f[15](e+72),this.textureWidth=f.f[15](e+32),this.format=f.f[15](e+80),this.layout()))}},{key:"render",value:function(e){if(!this.lost){this.checkFrame(e);var t=d.g[f.f[15](e+80)];t&&(this.yTexture.fill((0,h.s3)(f.f[20](e),this.yTexture.width*this.yTexture.height)),this.uTexture.fill((0,h.s3)(f.f[20](e+4),this.uTexture.width*this.uTexture.height)),t.comp[1].plane!==t.comp[2].plane&&this.vTexture.fill((0,h.s3)(f.f[20](e+8),this.vTexture.width*this.vTexture.height)),4===t.nbComponents&&this.aTexture.fill((0,h.s3)(f.f[20](e+12),this.aTexture.width*this.aTexture.height)),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4))}}}],[{key:"isSupport",value:function(e){if((0,g.A)(e)){var t=d.g[f.f[15](e+80)];if(t)return!(32&t.flags)&&16&t.flags&&t.comp[0].depth+7>>>3==1}return!1}}]),t}(l.A)},22594:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134),l=r(48280);function p(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,v()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function v(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}var m=function(e){function t(e,r){var n;return(0,a.A)(this,t),n=p(this,t,[e,r]),(0,d.A)((0,u.A)(n),"yTexture",void 0),(0,d.A)((0,u.A)(n),"uTexture",void 0),(0,d.A)((0,u.A)(n),"vTexture",void 0),(0,d.A)((0,u.A)(n),"aTexture",void 0),n}return(0,h.A)(t,e),(0,s.A)(t,[{key:"useProgram",value:function(){(0,c.A)((0,f.A)(t.prototype),"useProgram",this).call(this),this.yTexture=new l.A(this.gl),this.yTexture.bind(0),this.yTexture.init(),this.program.bindYTexture(0),this.uTexture=new l.A(this.gl),this.uTexture.bind(1),this.uTexture.init(),this.program.bindUTexture(1),this.vTexture=new l.A(this.gl),this.vTexture.bind(2),this.vTexture.init(),this.program.bindVTexture(2),this.aTexture=new l.A(this.gl),this.aTexture.bind(3),this.aTexture.init(),this.program.bindATexture(3)}},{key:"destroy",value:function(){this.yTexture&&(this.yTexture.destroy(),this.yTexture=null),this.uTexture&&(this.uTexture.destroy(),this.uTexture=null),this.vTexture&&(this.vTexture.destroy(),this.vTexture=null),this.aTexture&&(this.aTexture.destroy(),this.aTexture=null),(0,c.A)((0,f.A)(t.prototype),"destroy",this).call(this)}}]),t}(r(94012).A)},54750:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(60394),c=r(25767),f=r(31060),h=r(54895),d=r(23195);function l(e,t,r){return t=(0,c.A)(t),(0,o.A)(e,p()?i()(t,r||[],(0,c.A)(e).constructor):t.apply(e,r))}function p(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}var v=function(e){function t(e,r){var n;return(0,a.A)(this,t),(n=l(this,t,[e,r])).vertexSource=h.A,n.fragmentSource=d.A,n}return(0,f.A)(t,e),(0,s.A)(t,[{key:"checkFrame",value:function(e){e.codedWidth===this.textureWidth&&e.codedHeight===this.videoHeight&&e.codedWidth===this.videoWidth||(this.videoWidth=e.codedWidth,this.videoHeight=e.codedHeight,this.textureWidth=e.codedWidth,this.layout(),this.generatePipeline())}},{key:"generateBindGroup",value:function(){this.bindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,externalTexture:{}},{binding:2,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}}]})}},{key:"render",value:function(e){if(!this.lost){this.checkFrame(e);var t=this.device.createBindGroup({layout:this.renderPipeline.getBindGroupLayout(0),entries:[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.device.importExternalTexture({source:e})},{binding:2,resource:this.sampler}]}),r=this.device.createCommandEncoder(),n={colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]},i=r.beginRenderPass(n);i.setPipeline(this.renderPipeline),i.setBindGroup(0,t),i.setVertexBuffer(0,this.vbo),i.draw(4,4,0,0),i.end(),this.device.queue.submit([r.finish()])}}},{key:"destroy",value:function(){(0,u.A)((0,c.A)(t.prototype),"destroy",this).call(this)}}],[{key:"isSupport",value:function(e){return e instanceof VideoFrame}}]),t}(r(15045).A)},1052:(e,t,r)=>{"use strict";r.d(t,{A:()=>y});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(31060),f=r(63939),h=r(97317),d=r(14686),l=r(6110),p=r(25669),v=r(56066),m=r(72703);function g(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,A()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function A(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(A=function(){return!!e})()}var y=function(e){function t(e,r){return(0,a.A)(this,t),g(this,t,[e,r])}return(0,c.A)(t,e),(0,s.A)(t,[{key:"generateFragmentSource",value:function(e,t){var r=(0,p.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:1,outputRGB:!0}),n=["r","g","b","a"],i="textureSample(rgbTexture, in_texcoord.xy).".concat(n[t.comp[0].offset]),a="textureSample(rgbTexture, in_texcoord.xy).".concat(n[t.comp[1].offset]),s="textureSample(rgbTexture, in_texcoord.xy).".concat(n[t.comp[2].offset]),o="1.0";128&t.flags&&4===t.nbComponents&&(o="textureSample(rgbTexture, in_texcoord.xy).".concat(n[t.comp[3].offset])),this.fragmentSource="\n      @group(0) @binding(1) var s: sampler;\n      @group(0) @binding(2) var rgbTexture: texture_2d<f32>;\n      \n      @fragment\n      fn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n        let r = ".concat(i,";\n        let g = ").concat(a,";\n        let b = ").concat(s,";\n        let alpha = ").concat(o,";\n        var color = vec4(r, g, b, alpha);\n        ").concat(r.reduce((function(e,t){return e+t}),""),"\n        return color;\n      }\n    ")}},{key:"checkFrame",value:function(e){var t=h.g[f.f[15](e+80)];t&&(f.f[15](e+32)===this.textureWidth&&f.f[15](e+72)===this.videoHeight&&f.f[15](e+68)===this.videoWidth||(this.rgbTexture&&this.rgbTexture.destroy(),this.rgbTexture=this.device.createTexture({size:[f.f[15](e+32),f.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}),this.srcColorSpace=new l.A(f.f[15](e+220),f.f[15](e+212),f.f[15](e+216),f.f[15](e+208)),this.generateFragmentSource(f.f[15](e+80),t),this.videoWidth=f.f[15](e+68),this.videoHeight=f.f[15](e+72),this.textureWidth=f.f[15](e+32),this.format=f.f[15](e+80),this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder()))}},{key:"render",value:function(e){if(!this.lost){this.checkFrame(e),this.device.queue.writeTexture({texture:this.rgbTexture},(0,d.s3)(f.f[20](e),this.rgbTexture.width*this.rgbTexture.height),{offset:0,bytesPerRow:this.rgbTexture.width,rowsPerImage:this.rgbTexture.height},{width:this.rgbTexture.width,height:this.rgbTexture.height,depthOrArrayLayers:1});var t=this.device.createCommandEncoder(),r=t.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});r.executeBundles([this.renderBundle]),r.end(),this.device.queue.submit([t.finish()])}}}],[{key:"isSupport",value:function(e){if((0,m.A)(e)){var t=h.g[f.f[15](e+80)];if(t)return 32&t.flags&&t.comp[0].depth+7>>>3==1}return!1}}]),t}(v.A)},56066:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134),l=r(54895);function p(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,v()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function v(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}var m=function(e){function t(e,r){var n;return(0,a.A)(this,t),n=p(this,t,[e,r]),(0,d.A)((0,u.A)(n),"rgbTexture",void 0),n.vertexSource=l.A,n}return(0,h.A)(t,e),(0,s.A)(t,[{key:"generateBindGroup",value:function(){if(this.rgbTexture){var e=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}];this.bindGroupLayout=this.device.createBindGroupLayout({entries:e});var t=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.sampler},{binding:2,resource:this.rgbTexture.createView()}];this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:t})}}},{key:"destroy",value:function(){this.rgbTexture&&this.rgbTexture.destroy(),(0,c.A)((0,f.A)(t.prototype),"destroy",this).call(this)}}]),t}(r(15045).A)},15045:(e,t,r)=>{"use strict";r.d(t,{A:()=>w});var n=r(88435),i=r.n(n),a=r(25182),s=r(78716),o=r(81570),u=r(77193),c=r(43070),f=r(60394),h=r(25767),d=r(31060),l=r(134),p=r(36443),v=r.n(p),m=r(4624),g=r(43356),A=r(72739),y=r(38469);function x(e,t,r){return t=(0,h.A)(t),(0,u.A)(e,k()?i()(t,r||[],(0,h.A)(e).constructor):t.apply(e,r))}function k(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(k=function(){return!!e})()}var b="src/avrender/image/WebGPURender.ts",w=function(e){function t(e,r){var n;return(0,s.A)(this,t),n=x(this,t,[e,r]),(0,l.A)((0,c.A)(n),"adapter",void 0),(0,l.A)((0,c.A)(n),"device",void 0),(0,l.A)((0,c.A)(n),"context",void 0),(0,l.A)((0,c.A)(n),"vsModule",void 0),(0,l.A)((0,c.A)(n),"fsModule",void 0),(0,l.A)((0,c.A)(n),"rotateMatrixBuffer",void 0),(0,l.A)((0,c.A)(n),"renderPipeline",void 0),(0,l.A)((0,c.A)(n),"rotateMatrix",void 0),(0,l.A)((0,c.A)(n),"vbo",void 0),(0,l.A)((0,c.A)(n),"sampler",void 0),(0,l.A)((0,c.A)(n),"vertex",void 0),(0,l.A)((0,c.A)(n),"fragmentSource",void 0),(0,l.A)((0,c.A)(n),"vertexSource",void 0),(0,l.A)((0,c.A)(n),"renderBundleEncoder",void 0),(0,l.A)((0,c.A)(n),"renderBundle",void 0),(0,l.A)((0,c.A)(n),"bindGroupLayout",void 0),(0,l.A)((0,c.A)(n),"bindGroup",void 0),(0,l.A)((0,c.A)(n),"pipelineLayout",void 0),n}var r;return(0,d.A)(t,e),(0,o.A)(t,[{key:"init",value:(r=(0,a.A)(v().mark((function e(t){var r,n,i=this;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.gpu.requestAdapter({powerPreference:null!==(r=this.options.powerPreference)&&void 0!==r?r:"high-performance"});case 2:return this.adapter=e.sent,this.adapter||m.h2("not support webgpu render",b,86),n=[],A.__(t,(function(e){i.adapter.features.has(e)&&n.push(e)})),e.next=8,this.adapter.requestDevice({requiredFeatures:n.length?n:void 0});case 8:this.device=e.sent,this.device.lost.then((function(){var e;i.destroyed||(i.lost=!0,m.z3("gpu device lost",b,105),null!==(e=i.options)&&void 0!==e&&e.onRenderContextLost&&i.options.onRenderContextLost())})),this.context=this.canvas.getContext("webgpu"),this.context||m.h2("can not support webgpu, got GPUCanvasContext failed",b,114),this.context.configure({device:this.device,format:navigator.gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),this.sampler=this.device.createSampler({magFilter:"linear",minFilter:"linear"}),this.vbo=this.device.createBuffer({size:28*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST}),this.rotateMatrixBuffer=this.device.createBuffer({size:16*Float32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.setRotateMatrix(this.getRotateMatrix(0));case 17:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"generatePipeline",value:function(){this.generateBindGroup(),this.pipelineLayout=this.device.createPipelineLayout({bindGroupLayouts:[this.bindGroupLayout]}),this.vsModule=this.device.createShaderModule({code:this.vertexSource}),this.fsModule=this.device.createShaderModule({code:this.fragmentSource}),this.renderPipeline=this.device.createRenderPipeline({layout:this.pipelineLayout,vertex:{module:this.vsModule,entryPoint:"main",buffers:[{arrayStride:28,attributes:[{shaderLocation:0,offset:0,format:"float32x3"},{shaderLocation:1,offset:12,format:"float32x4"}]}]},fragment:{module:this.fsModule,entryPoint:"main",targets:[{format:navigator.gpu.getPreferredCanvasFormat()}]},primitive:{topology:"triangle-strip"}})}},{key:"generateRenderBundleEncoder",value:function(){this.renderPipeline&&(this.renderBundleEncoder=this.device.createRenderBundleEncoder({colorFormats:[navigator.gpu.getPreferredCanvasFormat()]}),this.renderBundleEncoder.setPipeline(this.renderPipeline),this.renderBundleEncoder.setBindGroup(0,this.bindGroup),this.renderBundleEncoder.setVertexBuffer(0,this.vbo),this.renderBundleEncoder.draw(4,4,0,0),this.renderBundle=this.renderBundleEncoder.finish())}},{key:"setRotateMatrix",value:function(e){this.rotateMatrix=e;var t=new Float32Array(this.rotateMatrix);this.device.queue.writeBuffer(this.rotateMatrixBuffer,0,t.buffer,t.byteOffset,t.byteLength)}},{key:"setVertices",value:function(){var e=new Float32Array(this.vertex);this.device.queue.writeBuffer(this.vbo,0,e.buffer,e.byteOffset,e.byteLength)}},{key:"clear",value:function(){this.context.getCurrentTexture().destroy()}},{key:"layout",value:function(){var e=this.videoWidth,t=this.videoHeight,r=this.canvasWidth,n=this.canvasHeight;90!==this.rotate&&270!==this.rotate||(r=this.canvasHeight,n=this.canvasWidth);var i,a=e/r,s=t/n;i=a>1?!(a<s):a>s,1===this.renderMode&&(i=!i);var o=0;if(this.textureWidth!==this.videoWidth&&(o=(this.textureWidth-this.videoWidth)/this.textureWidth),i){var u=(n-t*r/e)/n;this.vertex=[-1,1-u,0,0,0,0,0,-1,-1+u,0,0,1,0,0,1,1-u,0,1-o,0,0,0,1,-1+u,0,1-o,1,0,0]}else{var c=(r-e*n/t)/r;this.vertex=[-1+c,1,0,0,0,0,0,-1+c,-1,0,0,1,0,0,1-c,1,0,1-o,0,0,0,1-c,-1,0,1-o,1,0,0]}(0,y.A)(this.vertex,this.flipHorizontal,this.flipVertical),this.setVertices()}},{key:"viewport",value:function(e,r){(0,f.A)((0,h.A)(t.prototype),"viewport",this).call(this,e,r)}},{key:"setRotate",value:function(e){(e%=360)!==this.rotate&&(this.rotate=e,this.setRotateMatrix(this.getRotateMatrix(e)),this.layout(),this.clear())}},{key:"destroy",value:function(){this.sampler=null,this.vbo&&this.vbo.destroy(),this.rotateMatrixBuffer&&this.rotateMatrixBuffer.destroy(),this.bindGroupLayout=null,this.bindGroup=null,this.pipelineLayout=null,this.renderBundle=null,this.renderBundleEncoder=null,this.fsModule=null,this.vsModule=null,this.renderPipeline=null,this.rotateMatrix=null,this.vertex=null,this.context=null,this.options=null,this.destroyed=!0,this.device&&(this.device.destroy(),this.device=null),this.adapter&&(this.adapter=null),(0,f.A)((0,h.A)(t.prototype),"destroy",this).call(this)}}]),t}(g.A)},90058:(e,t,r)=>{"use strict";r.d(t,{A:()=>U});var n=r(88435),i=r.n(n),a=r(25182),s=r(78716),o=r(81570),u=r(77193),c=r(43070),f=r(60394),h=r(25767),d=r(31060),l=r(134),p=r(36443),v=r.n(p),m=r(61499),g=r(74503),A=r(63939),y=r(94300),x=r(49393),k=r(97317),b=r(14686),w=r(6110),_=r(62496),T=r(57914),I=r(57517),S=r(25669),P=r(20088),B=r(56024),C=r(72703);function M(e,t,r){return t=(0,h.A)(t),(0,u.A)(e,R()?i()(t,r||[],(0,h.A)(e).constructor):t.apply(e,r))}function R(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(R=function(){return!!e})()}var U=function(e){function t(e,r){var n;return(0,s.A)(this,t),n=M(this,t,[e,r]),(0,l.A)((0,c.A)(n),"metaYBuffer",void 0),(0,l.A)((0,c.A)(n),"metaUBuffer",void 0),(0,l.A)((0,c.A)(n),"metaVBuffer",void 0),(0,l.A)((0,c.A)(n),"metaABuffer",void 0),(0,l.A)((0,c.A)(n),"computeBindGroupLayout",void 0),(0,l.A)((0,c.A)(n),"computeBindGroupY",void 0),(0,l.A)((0,c.A)(n),"computeBindGroupU",void 0),(0,l.A)((0,c.A)(n),"computeBindGroupV",void 0),(0,l.A)((0,c.A)(n),"computeBindGroupA",void 0),(0,l.A)((0,c.A)(n),"computePipelineLayout",void 0),(0,l.A)((0,c.A)(n),"computePipeline",void 0),(0,l.A)((0,c.A)(n),"inputYTexture",void 0),(0,l.A)((0,c.A)(n),"inputUTexture",void 0),(0,l.A)((0,c.A)(n),"inputVTexture",void 0),(0,l.A)((0,c.A)(n),"inputATexture",void 0),(0,l.A)((0,c.A)(n),"computeModule",void 0),(0,l.A)((0,c.A)(n),"uint2Float",void 0),(0,l.A)((0,c.A)(n),"hdrMetadata",void 0),(0,l.A)((0,c.A)(n),"hdrMetadataBuffer",void 0),n.hdrMetadata=(0,g.A)(P.A),n.hdrMetadata.multiplier=1,n}var r;return(0,d.A)(t,e),(0,o.A)(t,[{key:"generateFragmentSource",value:function(e,t,r){r.outputRGB=!0;var n=(0,S.A)(this.srcColorSpace,this.dstColorSpace,r),i="textureSample(uTexture, s, in_texcoord.xy).x",a="textureSample(vTexture, s, in_texcoord.xy).x",s="1.0";23===e||189===e?(i="textureSample(uTexture, s, in_texcoord.xy).x",a="textureSample(uTexture, s, in_texcoord.xy).y"):24!==e&&190!==e||(i="textureSample(uTexture, s, in_texcoord.xy).y",a="textureSample(uTexture, s, in_texcoord.xy).x"),128&t.flags&&4===t.nbComponents&&(s="textureSample(aTexture, s, in_texcoord.xy).x"),this.fragmentSource="\n      struct HdrMetadata {\n        offset: f32,\n        multiplier: f32,\n        pqTonemapA: f32,\n        pqTonemapB: f32,\n        hlgOOTFGammaMinusOne: f32,\n        hlgDstMaxLuminanceRelative: f32,\n        nitsToSdrRelativeFactor: f32,\n        sdrRelativeToNitsFactor: f32\n      };\n\n      @group(0) @binding(1) var s: sampler;\n      @group(0) @binding(2) var<uniform> hdrMetadata: HdrMetadata;\n      @group(0) @binding(3) var yTexture: texture_2d<f32>;\n      @group(0) @binding(4) var uTexture: texture_2d<f32>;\n\n      ".concat(this.vTexture?"@group(0) @binding(5) var vTexture: texture_2d<f32>;":"","\n      ").concat(this.aTexture?"@group(0) @binding(6) var aTexture: texture_2d<f32>;":"","\n\n      @fragment\n      fn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n\n        let offset = hdrMetadata.offset;\n        let multiplier = hdrMetadata.multiplier;\n        let pq_tonemap_a = hdrMetadata.pqTonemapA;\n        let pq_tonemap_b = hdrMetadata.pqTonemapB;\n        let hlg_ootf_gamma_minus_one = hdrMetadata.hlgOOTFGammaMinusOne;\n        let hlg_dst_max_luminance_relative = hdrMetadata.hlgDstMaxLuminanceRelative;\n        let nits_to_sdr_relative_factor = hdrMetadata.nitsToSdrRelativeFactor;\n        let sdr_relative_to_nits_factor = hdrMetadata.sdrRelativeToNitsFactor;\n\n        let y = ").concat("textureSample(yTexture, s, in_texcoord.xy).x;","\n        let u = ").concat(i,";\n        let v = ").concat(a,";\n        let alpha = ").concat(s,";\n        var color = vec4(y, u, v, alpha);\n\n        if (color.a > 0) {\n          color.r /= color.a;\n          color.g /= color.a;\n          color.b /= color.a;\n        }\n        color.r -= offset;\n        color.g -= offset;\n        color.b -= offset;\n\n        color.r *= multiplier;\n        color.g *= multiplier;\n        color.b *= multiplier;\n        \n        ").concat(n.reduce((function(e,t){return e+t}),""),"\n\n        color.r *= color.a;\n        color.g *= color.a;\n        color.b *= color.a;\n\n        return color;\n      }\n    ")}},{key:"init",value:(r=(0,a.A)(v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,f.A)((0,h.A)(t.prototype),"init",this).call(this,["float32-filterable"]);case 2:this.metaYBuffer=this.device.createBuffer({size:4*Uint32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.metaUBuffer=this.device.createBuffer({size:4*Uint32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.metaVBuffer=this.device.createBuffer({size:4*Uint32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.metaABuffer=this.device.createBuffer({size:4*Uint32Array.BYTES_PER_ELEMENT,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.hdrMetadataBuffer=this.device.createBuffer({size:32,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"generateComputeBindGroup",value:function(){this.computeBindGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.COMPUTE,texture:{sampleType:"uint"}},{binding:2,visibility:GPUShaderStage.COMPUTE,storageTexture:{format:"r32float"}}]}),this.computeBindGroupY=this.device.createBindGroup({layout:this.computeBindGroupLayout,entries:[{binding:0,resource:{buffer:this.metaYBuffer,size:4*Uint32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.inputYTexture.createView()},{binding:2,resource:this.yTexture.createView()}]}),this.computeBindGroupU=this.device.createBindGroup({layout:this.computeBindGroupLayout,entries:[{binding:0,resource:{buffer:this.metaUBuffer,size:4*Uint32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.inputUTexture.createView()},{binding:2,resource:this.uTexture.createView()}]}),this.vTexture&&(this.computeBindGroupV=this.device.createBindGroup({layout:this.computeBindGroupLayout,entries:[{binding:0,resource:{buffer:this.metaVBuffer,size:4*Uint32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.inputVTexture.createView()},{binding:2,resource:this.vTexture.createView()}]})),this.aTexture&&(this.computeBindGroupA=this.device.createBindGroup({layout:this.computeBindGroupLayout,entries:[{binding:0,resource:{buffer:this.metaABuffer,size:4*Uint32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.inputATexture.createView()},{binding:2,resource:this.aTexture.createView()}]}))}},{key:"generateComputePipeline",value:function(){this.generateComputeBindGroup(),this.computePipelineLayout=this.device.createPipelineLayout({bindGroupLayouts:[this.computeBindGroupLayout]}),this.computeModule=this.device.createShaderModule({code:this.uint2Float}),this.computePipeline=this.device.createComputePipeline({layout:this.computePipelineLayout,compute:{module:this.computeModule,entryPoint:"main"}})}},{key:"generateBindGroup",value:function(){if(this.yTexture){var e=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}},{binding:4,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}];this.vTexture&&e.push({binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.aTexture&&e.push({binding:6,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.bindGroupLayout=this.device.createBindGroupLayout({entries:e});var t=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.sampler},{binding:2,resource:{buffer:this.hdrMetadataBuffer,size:this.hdrMetadataBuffer.size}},{binding:3,resource:this.yTexture.createView()},{binding:4,resource:this.uTexture.createView()}];this.vTexture&&t.push({binding:5,resource:this.vTexture.createView()}),this.aTexture&&t.push({binding:6,resource:this.aTexture.createView()}),this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:t})}}},{key:"checkFrame",value:function(e){var t=k.g[A.f[15](e+80)];if(t&&(A.f[15](e+32)>>>1!==this.textureWidth||A.f[15](e+72)!==this.videoHeight||A.f[15](e+68)!==this.videoWidth||A.f[15](e+80)!==this.format)){this.yTexture&&this.yTexture.destroy(),this.uTexture&&this.uTexture.destroy(),this.vTexture&&this.vTexture.destroy(),this.aTexture&&this.aTexture.destroy(),this.inputYTexture&&this.inputYTexture.destroy(),this.inputUTexture&&this.inputUTexture.destroy(),this.inputVTexture&&this.inputVTexture.destroy(),this.inputATexture&&this.inputATexture.destroy(),this.yTexture=this.device.createTexture({size:[A.f[15](e+32)>>>1,A.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING,format:"r32float"}),this.uTexture=this.device.createTexture({size:[A.f[15](e+32+4)>>>1,A.f[15](e+72)>>>t.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING,format:"r32float"}),t.comp[1].plane!==t.comp[2].plane&&(this.vTexture=this.device.createTexture({size:[A.f[15](e+32+8)>>>1,A.f[15](e+72)>>>t.log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING,format:"r32float"})),4===t.nbComponents&&(this.aTexture=this.device.createTexture({size:[A.f[15](e+32+12)>>>1,A.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING,format:"r32float"})),this.inputYTexture=this.device.createTexture({size:[this.yTexture.width,this.yTexture.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,format:"r16uint"}),this.inputUTexture=this.device.createTexture({size:[this.uTexture.width,this.uTexture.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,format:"r16uint"}),t.comp[1].plane!==t.comp[2].plane&&(this.inputVTexture=this.device.createTexture({size:[this.vTexture.width,this.vTexture.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,format:"r16uint"})),4===t.nbComponents&&(this.inputATexture=this.device.createTexture({size:[this.aTexture.width,this.aTexture.height],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST,format:"r16uint"}));var r=new Uint32Array([(1<<t.comp[0].depth)-1,this.inputYTexture.width,this.inputYTexture.height]);this.device.queue.writeBuffer(this.metaYBuffer,0,r.buffer,r.byteOffset,r.byteLength);var n=new Uint32Array([(1<<t.comp[1].depth)-1,this.inputUTexture.width,this.inputUTexture.height]);if(this.device.queue.writeBuffer(this.metaUBuffer,0,n.buffer,n.byteOffset,n.byteLength),t.comp[1].plane!==t.comp[2].plane){var i=new Uint32Array([(1<<t.comp[2].depth)-1,this.inputVTexture.width,this.inputVTexture.height]);this.device.queue.writeBuffer(this.metaVBuffer,0,i.buffer,i.byteOffset,i.byteLength)}if(4===t.nbComponents){var a=new Uint32Array([(1<<t.comp[3].depth)-1,this.inputATexture.width,this.inputATexture.height]);this.device.queue.writeBuffer(this.metaABuffer,0,a.buffer,a.byteOffset,a.byteLength)}this.srcColorSpace=new w.A(A.f[15](e+220),A.f[15](e+212),A.f[15](e+216),A.f[15](e+208)),this.videoWidth=A.f[15](e+68),this.videoHeight=A.f[15](e+72),this.textureWidth=A.f[15](e+32)>>>1,this.format=A.f[15](e+80);var s={type:1,bitDepth:t.comp[0].depth,toneMapPQAndHlgToDst:!0,metadata:this.hdrMetadata,dstSdrMaxLuminanceNits:I.kH,dstMaxLuminanceRelative:1},o=(0,B.aH)(e,14);if(o){var u=A.f[20](o+4);A.f[8](u)>0&&(s.maxContentLightLevel=A.f[8](u))}this.generateFragmentSource(A.f[15](e+80),t,s),this.uint2Float=1&t.flags?T.A:_.A,this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder(),this.generateComputePipeline();var c=(0,b.s3)(this.hdrMetadata[m.o9],32).slice();this.device.queue.writeBuffer(this.hdrMetadataBuffer,0,c.buffer,c.byteOffset,c.byteLength)}}},{key:"render",value:function(e){if(!this.lost){this.checkFrame(e);var t=this.device.createCommandEncoder(),r=t.beginComputePass({});r.setPipeline(this.computePipeline),r.setBindGroup(0,this.computeBindGroupY),this.device.queue.writeTexture({texture:this.inputYTexture},(0,b.s3)(A.f[20](e),this.inputYTexture.width*this.inputYTexture.height<<1),{offset:0,bytesPerRow:this.inputYTexture.width<<1,rowsPerImage:this.inputYTexture.height},{width:this.inputYTexture.width,height:this.inputYTexture.height,depthOrArrayLayers:1}),r.dispatchWorkgroups(this.inputYTexture.width+7>>>3,this.inputYTexture.height+7>>>3),r.setBindGroup(0,this.computeBindGroupU),this.device.queue.writeTexture({texture:this.inputUTexture},(0,b.s3)(A.f[20](e+4),this.inputUTexture.width*this.inputUTexture.height<<1),{offset:0,bytesPerRow:this.inputUTexture.width<<1,rowsPerImage:this.inputUTexture.height},{width:this.inputUTexture.width,height:this.inputUTexture.height,depthOrArrayLayers:1}),r.dispatchWorkgroups(this.inputUTexture.width+7>>>3,this.inputUTexture.height+7>>>3),this.inputVTexture&&(r.setBindGroup(0,this.computeBindGroupV),this.device.queue.writeTexture({texture:this.inputVTexture},(0,b.s3)(A.f[20](e+8),this.inputVTexture.width*this.inputVTexture.height<<1),{offset:0,bytesPerRow:this.inputVTexture.width<<1,rowsPerImage:this.inputVTexture.height},{width:this.inputVTexture.width,height:this.inputVTexture.height,depthOrArrayLayers:1}),r.dispatchWorkgroups(this.inputVTexture.width+7>>>3,this.inputVTexture.height+7>>>3)),this.inputATexture&&(r.setBindGroup(0,this.computeBindGroupA),this.device.queue.writeTexture({texture:this.inputATexture},(0,b.s3)(A.f[20](e+12),this.inputATexture.width*this.inputATexture.height<<1),{offset:0,bytesPerRow:this.inputATexture.width<<1,rowsPerImage:this.inputATexture.height},{width:this.inputATexture.width,height:this.inputATexture.height,depthOrArrayLayers:1}),r.dispatchWorkgroups(this.inputATexture.width+7>>>3,this.inputATexture.height+7>>>3)),r.end();var n=t.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});n.executeBundles([this.renderBundle]),n.end(),this.device.queue.submit([t.finish()])}}},{key:"destroy",value:function(){this.inputYTexture&&(this.inputYTexture.destroy(),this.inputYTexture=null),this.inputUTexture&&(this.inputUTexture.destroy(),this.inputUTexture=null),this.inputVTexture&&(this.inputVTexture.destroy(),this.inputVTexture=null),this.metaYBuffer&&(this.metaYBuffer.destroy(),this.metaYBuffer=null),this.metaUBuffer&&(this.metaUBuffer.destroy(),this.metaUBuffer=null),this.metaVBuffer&&(this.metaVBuffer.destroy(),this.metaVBuffer=null),this.hdrMetadata&&((0,y.A)(this.hdrMetadata),this.hdrMetadata=null),this.computeModule=null,this.computeBindGroupY=null,this.computeBindGroupU=null,this.computeBindGroupV=null,this.computeBindGroupLayout=null,this.computePipelineLayout=null,this.computePipeline=null,(0,f.A)((0,h.A)(t.prototype),"destroy",this).call(this)}}],[{key:"isSupport",value:function(e){if((0,C.A)(e)){var t=k.g[A.f[15](e+80)];if(t)return!(32&t.flags)&&16&t.flags&&t.comp[0].depth+7>>>3==2}return!1}}]),t}(x.A)},37977:(e,t,r)=>{"use strict";r.d(t,{A:()=>y});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(31060),f=r(63939),h=r(49393),d=r(97317),l=r(14686),p=r(6110),v=r(25669),m=r(72703);function g(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,A()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function A(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(A=function(){return!!e})()}var y=function(e){function t(e,r){return(0,a.A)(this,t),g(this,t,[e,r])}return(0,c.A)(t,e),(0,s.A)(t,[{key:"generateFragmentSource",value:function(e,t){var r=(0,v.A)(this.srcColorSpace,this.dstColorSpace,{bitDepth:8,type:1,outputRGB:!0}),n="textureSample(uTexture, s, in_texcoord.xy).x",i="textureSample(vTexture, s, in_texcoord.xy).x",a="1.0";23===e||189===e?(n="textureSample(uTexture, s, in_texcoord.xy).x",i="textureSample(uTexture, s, in_texcoord.xy).y"):24!==e&&190!==e||(n="textureSample(uTexture, s, in_texcoord.xy).y",i="textureSample(uTexture, s, in_texcoord.xy).x"),128&t.flags&&4===t.nbComponents&&(a="textureSample(aTexture, s, in_texcoord.xy).x"),this.fragmentSource="\n      @group(0) @binding(1) var s: sampler;\n      @group(0) @binding(2) var yTexture: texture_2d<f32>;\n      @group(0) @binding(3) var uTexture: texture_2d<f32>;\n      ".concat(this.vTexture?"@group(0) @binding(4) var vTexture: texture_2d<f32>;":"","\n      ").concat(this.aTexture?"@group(0) @binding(5) var aTexture: texture_2d<f32>;":"","\n      \n      @fragment\n      fn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n        let y = ").concat("textureSample(yTexture, s, in_texcoord.xy).x",";\n        let u = ").concat(n,";\n        let v = ").concat(i,";\n        let alpha = ").concat(a,";\n        var color = vec4(y, u, v, alpha);\n        ").concat(r.reduce((function(e,t){return e+t}),""),"\n        return color;\n      }\n    ")}},{key:"checkFrame",value:function(e){var t=d.g[f.f[15](e+80)];t&&(f.f[15](e+32)===this.textureWidth&&f.f[15](e+72)===this.videoHeight&&f.f[15](e+68)===this.videoWidth||(this.yTexture&&this.yTexture.destroy(),this.uTexture&&this.uTexture.destroy(),this.vTexture&&this.vTexture.destroy(),this.aTexture&&this.aTexture.destroy(),this.yTexture=this.device.createTexture({size:[f.f[15](e+32),f.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}),this.uTexture=this.device.createTexture({size:[f.f[15](e+32+4),f.f[15](e+72)>>>d.g[f.f[15](e+80)].log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"}),t.comp[1].plane!==t.comp[2].plane&&(this.vTexture=this.device.createTexture({size:[f.f[15](e+32+8),f.f[15](e+72)>>>d.g[f.f[15](e+80)].log2ChromaH],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"})),4===t.nbComponents&&(this.aTexture=this.device.createTexture({size:[f.f[15](e+32+12),f.f[15](e+72)],usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT,format:"r8unorm"})),this.srcColorSpace=new p.A(f.f[15](e+220),f.f[15](e+212),f.f[15](e+216),f.f[15](e+208)),this.generateFragmentSource(f.f[15](e+80),t),this.videoWidth=f.f[15](e+68),this.videoHeight=f.f[15](e+72),this.textureWidth=f.f[15](e+32),this.format=f.f[15](e+80),this.layout(),this.generatePipeline(),this.generateRenderBundleEncoder()))}},{key:"render",value:function(e){if(!this.lost){this.checkFrame(e),this.device.queue.writeTexture({texture:this.yTexture},(0,l.s3)(f.f[20](e),this.yTexture.width*this.yTexture.height),{offset:0,bytesPerRow:this.yTexture.width,rowsPerImage:this.yTexture.height},{width:this.yTexture.width,height:this.yTexture.height,depthOrArrayLayers:1}),this.device.queue.writeTexture({texture:this.uTexture},(0,l.s3)(f.f[20](e+4),this.uTexture.width*this.uTexture.height),{offset:0,bytesPerRow:this.uTexture.width,rowsPerImage:this.uTexture.height},{width:this.uTexture.width,height:this.uTexture.height,depthOrArrayLayers:1}),this.vTexture&&this.device.queue.writeTexture({texture:this.vTexture},(0,l.s3)(f.f[20](e+8),this.vTexture.width*this.vTexture.height),{offset:0,bytesPerRow:this.vTexture.width,rowsPerImage:this.vTexture.height},{width:this.vTexture.width,height:this.vTexture.height,depthOrArrayLayers:1}),this.aTexture&&this.device.queue.writeTexture({texture:this.aTexture},(0,l.s3)(f.f[20](e+12),this.aTexture.width*this.aTexture.height),{offset:0,bytesPerRow:this.aTexture.width,rowsPerImage:this.aTexture.height},{width:this.aTexture.width,height:this.aTexture.height,depthOrArrayLayers:1});var t=this.device.createCommandEncoder(),r=t.beginRenderPass({colorAttachments:[{view:this.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}]});r.executeBundles([this.renderBundle]),r.end(),this.device.queue.submit([t.finish()])}}}],[{key:"isSupport",value:function(e){if((0,m.A)(e)){var t=d.g[f.f[15](e+80)];if(t)return!(32&t.flags)&&16&t.flags&&t.comp[0].depth+7>>>3==1}return!1}}]),t}(h.A)},49393:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134),l=r(54895);function p(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,v()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function v(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(v=function(){return!!e})()}var m=function(e){function t(e,r){var n;return(0,a.A)(this,t),n=p(this,t,[e,r]),(0,d.A)((0,u.A)(n),"yTexture",void 0),(0,d.A)((0,u.A)(n),"uTexture",void 0),(0,d.A)((0,u.A)(n),"vTexture",void 0),(0,d.A)((0,u.A)(n),"aTexture",void 0),n.vertexSource=l.A,n}return(0,h.A)(t,e),(0,s.A)(t,[{key:"generateBindGroup",value:function(){if(this.yTexture){var e=[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}},{binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}];this.vTexture&&e.push({binding:4,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.aTexture&&e.push({binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}),this.bindGroupLayout=this.device.createBindGroupLayout({entries:e});var t=[{binding:0,resource:{buffer:this.rotateMatrixBuffer,size:16*Float32Array.BYTES_PER_ELEMENT}},{binding:1,resource:this.sampler},{binding:2,resource:this.yTexture.createView()},{binding:3,resource:this.uTexture.createView()}];this.vTexture&&t.push({binding:4,resource:this.vTexture.createView()}),this.aTexture&&t.push({binding:5,resource:this.aTexture.createView()}),this.bindGroup=this.device.createBindGroup({layout:this.bindGroupLayout,entries:t})}}},{key:"destroy",value:function(){this.yTexture&&this.yTexture.destroy(),this.uTexture&&this.uTexture.destroy(),this.vTexture&&this.vTexture.destroy(),this.aTexture&&this.aTexture.destroy(),(0,c.A)((0,f.A)(t.prototype),"destroy",this).call(this)}}]),t}(r(15045).A)},6110:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n=r(78716),i=r(81570),a=r(134),s=r(12535),o=r(1064),u=r(86141),c=r(91131),f=function(){function e(t,r,i,s){(0,n.A)(this,e),(0,a.A)(this,"matrixId",void 0),(0,a.A)(this,"primaryId",void 0),(0,a.A)(this,"transferId",void 0),(0,a.A)(this,"rangeId",void 0),this.matrixId=t,this.primaryId=r,this.transferId=i,this.rangeId=s}return(0,i.A)(e,[{key:"getMatrixId",value:function(){return this.matrixId}},{key:"getPrimaryId",value:function(){return this.primaryId}},{key:"getTransferId",value:function(){return this.transferId}},{key:"getRangeId",value:function(){return this.rangeId}},{key:"isWide",value:function(){return 9===this.primaryId||11===this.primaryId||12===this.primaryId}},{key:"isHDR",value:function(){return 18===this.transferId||16===this.transferId}},{key:"isToneMappedByDefault",value:function(){return 18===this.transferId||16===this.transferId}},{key:"isAffectedBySDRWhiteLevel",value:function(){return 18===this.transferId||16===this.transferId}},{key:"fullRangeEncodedValues",value:function(){return 12===this.transferId||11===this.transferId}},{key:"getTransferMatrix",value:function(e){var t=(1<<e-1)/((1<<e)-1),r=0,n=0;switch(this.matrixId){case 0:return new s.A;case 1:case 2:r=.2126,n=.0722;break;case 4:r=.3,n=.11;break;case 5:case 6:r=.299,n=.114;break;case 7:r=.212,n=.087;break;case 8:return s.A.RowMajor([.25,.5,.25,0,-.25,.5,-.25,t,.5,0,-.5,t,0,0,0,1]);case 10:return r=.2627,n=.0593,s.A.RowMajor([1,0,0,0,r,1-r-n,n,0,0,0,1,0,0,0,0,1]);case 9:r=.2627,n=.0593;break;case 11:return s.A.RowMajor([0,1,0,0,0,-.5,.493283,.5,.5,-.495951,0,.5,0,0,0,1])}var i=1-r-n,a=.5/(1-n),o=.5/(1-r);return s.A.RowMajor([r,i,n,0,a*-r,a*-i,a*(1-n),.5,o*(1-r),o*-i,o*-n,.5,0,0,0,1])}},{key:"getRangeAdjustMatrix",value:function(e){if(2===this.rangeId)return new s.A;var t=e-8,r=(1<<e)-1,n=r/(219<<t);switch(this.matrixId){case 0:case 8:return(new s.A).setScale(new o.P([n,n,n])).postTranslate(new o.P([-16/219,-16/219,-16/219]));case 1:case 4:case 5:case 6:case 7:case 9:case 10:case 11:case 2:var i=224<<t,a=r/i,u=(i-r)/(2*i);return(new s.A).setScale(new o.P([n,a,a])).postTranslate(new o.P([-16/219,u,u]))}return new s.A}},{key:"getTransferFunction_",value:function(){switch(this.transferId){case 8:return u.Hi;case 4:return u.$_;case 5:return u.J7;case 7:return u.q;case 1:case 6:case 14:case 15:return u.aP;case 17:return u.Cr;case 18:case 12:case 9:case 10:case 16:case 2:return null}}},{key:"getTransferFunction",value:function(e){return this.transferId,this.getTransferFunction_()}},{key:"getInverseTransferFunction",value:function(e){var t=this.getTransferFunction(e);if(t){var r={a:0,b:0,c:0,d:0,e:0,f:0,g:0};if(t.a>0&&t.g>0){var n=Math.pow(t.a,t.g);r.a=1/n,r.b=-t.e/n,r.g=1/t.g}return r.d=t.c*t.d+t.f,r.e=-t.b/t.a,0!=t.c&&(r.c=1/t.c,r.f=-t.f/t.c),r}}},{key:"hasExtendedSkTransferFn",value:function(){return 0===this.matrixId}},{key:"isValid",value:function(){return 2!==this.matrixId&&2!==this.primaryId&&2!==this.transferId&&0!==this.rangeId}},{key:"getColorSpacePrimaries",value:function(){var e=c.WO;switch(this.primaryId){case 1:return c.P5;case 4:return c.Wc;case 5:return c.cA;case 7:return c.vi;case 8:return c.cp;case 9:return c.Je;case 10:return c.lf;case 11:return c.Rk;case 12:return c.tR}return e}},{key:"getPrimaryMatrix",value:function(){var e=this.getColorSpacePrimaries(),t=c._O(e);return s.A.RowMajor([t.rc(0,0),t.rc(0,1),t.rc(0,2),0,t.rc(1,0),t.rc(1,1),t.rc(1,2),0,t.rc(2,0),t.rc(2,1),t.rc(2,2),0,0,0,0,1])}}]),e}()},91131:(e,t,r)=>{"use strict";r.d(t,{Je:()=>d,P5:()=>o,Rk:()=>p,WO:()=>m,Wc:()=>u,_O:()=>g,cA:()=>c,cp:()=>h,lf:()=>l,tR:()=>v,vi:()=>f});var n=r(45726),i=r(1064),a=r(66551),s=r(60153),o=[.64,.33,.3,.6,.15,.06,.3127,.329],u=[.67,.33,.21,.71,.14,.08,.31,.316],c=[.64,.33,.29,.6,.15,.06,.3127,.329],f=[.63,.34,.31,.595,.155,.07,.3127,.329],h=[.681,.319,.243,.692,.145,.049,.31,.316],d=[.708,.292,.17,.797,.131,.046,.3127,.329],l=[1,0,0,1,0,0,.3333333333333333,.3333333333333333],p=[.68,.32,.265,.69,.15,.06,.314,.351],v=[.68,.32,.265,.69,.15,.06,.3127,.329],m=[0,0,0,0,0,0,0,0];function g(e){var t=n.A.RowMajor([e[0],e[2],e[4],e[1],e[3],e[5],1-e[0]-e[1],1-e[2]-e[3],1-e[4]-e[5]]),r=t.copy().invert(),o=new i.P([e[6]/e[7],1,(1-e[6]-e[7])/e[7]]),u=(0,s.Y3)(r,o),c=new n.A([u.x,0,0,0,u.y,0,0,0,u.z]);c=(0,a.B)(t,c);var f=function(e,t){var r=new i.P([e/t,1,(1-e-t)/t]),o=new i.P([.96422,1,.82521]),u=n.A.RowMajor([.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296]),c=n.A.RowMajor([.9869929,-.1470543,.1599627,.4323053,.5183603,.0492912,-.0085287,.0400428,.9684867]),f=(0,s.Y3)(u,r),h=(0,s.Y3)(u,o),d=new n.A([h.x/f.x,0,0,0,h.y/f.y,0,0,0,h.z/f.z]);return d=(0,a.B)(d,u),(0,a.B)(c,d)}(e[6],e[7]);return(0,a.B)(f,c)}},86141:(e,t,r)=>{"use strict";r.d(t,{$_:()=>n,Cr:()=>u,Hi:()=>s,J7:()=>i,aP:()=>o,q:()=>a});var n={g:2.2,a:1,b:0,c:0,d:0,e:0,f:0},i={g:2.8,a:1,b:0,c:0,d:0,e:0,f:0},a={g:2.222222222222,a:.899626676224,b:.100373323776,c:.25,d:.091286342118,e:0,f:0},s={g:1,a:1,b:0,c:0,d:0,e:0,f:0},o={g:2.4,a:.9478672985781991,b:.05213270142180095,c:.07739938080495357,d:.04045,e:0,f:0},u={g:2.6,a:1.034080527699,b:0,c:0,d:0,e:0,f:0}},89401:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,U:()=>o});var n=r(57517),i=.2627,a=.678,s=.0593;function o(e){e.metadata.hlgDstMaxLuminanceRelative=e.dstMaxLuminanceRelative;var t=e.dstSdrMaxLuminanceNits*e.dstMaxLuminanceRelative;e.metadata.hlgOOTFGammaMinusOne=1.2+.42*Math.log10(t/n.hD)/Math.log10(10)-1}function u(e){return 0===e.type?"\n      {\n        vec4 luma_vec = vec4(".concat(i,", ").concat(a,", ").concat(s,", 0.0);\n        float L = dot(color, luma_vec);\n        if (L > 0.0) {\n          color.r *= pow(L, hlg_ootf_gamma_minus_one);\n          color.g *= pow(L, hlg_ootf_gamma_minus_one);\n          color.b *= pow(L, hlg_ootf_gamma_minus_one);\n          color.r *= hlg_dst_max_luminance_relative;\n          color.g *= hlg_dst_max_luminance_relative;\n          color.b *= hlg_dst_max_luminance_relative;\n        }\n      }\n    "):1===e.type?"\n      {\n        let luma_vec: vec4<f32> = vec4(".concat(i,", ").concat(a,", ").concat(s,", 0.0);\n        let L: f32 = dot(color, luma_vec);\n        if (L > 0.0) {\n          color.r *= pow(L, hlg_ootf_gamma_minus_one);\n          color.g *= pow(L, hlg_ootf_gamma_minus_one);\n          color.b *= pow(L, hlg_ootf_gamma_minus_one);\n          color.r *= hlg_dst_max_luminance_relative;\n          color.g *= hlg_dst_max_luminance_relative;\n          color.b *= hlg_dst_max_luminance_relative;\n        }\n      }\n    "):""}},7511:(e,t,r)=>{"use strict";function n(e,t){var r="",n="";if(0===t.type?(r="mat4",n="vec4"):1===t.type&&(r="mat4x4",n="vec4"),!r||!n)return"";var i="\n      color = ".concat(r,"(\n        ").concat(e.rc(0,0),", ").concat(e.rc(1,0),", ").concat(e.rc(2,0),", 0,\n        ").concat(e.rc(0,1),", ").concat(e.rc(1,1),", ").concat(e.rc(2,1),", 0,\n        ").concat(e.rc(0,2),", ").concat(e.rc(1,2),", ").concat(e.rc(2,2),", 0,\n        0, 0, 0, 1\n      ) * color;\n    ");return 0===e.rc(0,3)&&0===e.rc(1,3)&&0===e.rc(2,3)||(i+="\n        color += ".concat(n,"(").concat(e.rc(0,3),", ").concat(e.rc(1,3),", ").concat(e.rc(2,3),", 0);\n      ")),i}r.d(t,{A:()=>n})},79955:(e,t,r)=>{"use strict";function n(e,t){t.metadata.sdrRelativeToNitsFactor=t.dstSdrMaxLuminanceNits/e}function i(e){return"\n    color.r *= sdr_relative_to_nits_factor;\n    color.g *= sdr_relative_to_nits_factor;\n    color.b *= sdr_relative_to_nits_factor;\n "}r.d(t,{A:()=>i,j:()=>n})},64748:(e,t,r)=>{"use strict";r.d(t,{A:()=>a,n:()=>i});var n=r(57517);function i(e,t,r){var i=r.dstSdrMaxLuminanceNits;t&&(i=n.kH,r.ndwl&&(i=r.ndwl)),r.metadata.nitsToSdrRelativeFactor=e/i}function a(e){return"\n    color.r *= nits_to_sdr_relative_factor;\n    color.g *= nits_to_sdr_relative_factor;\n    color.b *= nits_to_sdr_relative_factor;\n  "}},70194:(e,t,r)=>{"use strict";r.d(t,{A:()=>a,J:()=>i});var n=r(57517);function i(e,t){var r=function(e,t){var r=n.hD;return 18!==e.getTransferId()&&t.maxContentLightLevel>0&&(r=t.maxContentLightLevel),r/t.dstSdrMaxLuminanceNits}(e,t);r>t.dstMaxLuminanceRelative?(t.metadata.pqTonemapA=t.dstMaxLuminanceRelative/(r*r),t.metadata.pqTonemapB=1/t.dstMaxLuminanceRelative):(t.metadata.pqTonemapA=0,t.metadata.pqTonemapB=0)}function a(e){return"\n    {\n      ".concat(1===e.type?"let maximum: f32":"float maximum"," = max(color.r, max(color.g, color.b));\n      if (maximum > 0.0) {\n        color.r *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n        color.g *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n        color.b *= (1.0 + pq_tonemap_a * maximum) / (1.0 + pq_tonemap_b * maximum);\n      }\n    }\n ")}},15380:(e,t,r)=>{"use strict";function n(e){return e===e>>>0?"".concat(e,".0"):e.toString()}r.d(t,{A:()=>n})},25669:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var n=r(6110),i=r(57517),a=r(7511),s=r(5361),o=r(63921),u=r(55168),c=r(16307),f=r(89401),h=r(64748),d=r(70194),l=r(79955),p=r(84272),v=r(51025),m=r(40326);function g(e,t,r){var g=[],A=8===e.getMatrixId(),y=(0,a.A)(e.getRangeAdjustMatrix(r.bitDepth),r);if(A||g.push(y),10===e.getMatrixId()||g.push((0,a.A)(e.getTransferMatrix(r.bitDepth).invert(),r)),A&&g.push(y),t.isValid()){if(e.isHDR()){switch(e.getTransferId()){case 18:g.push((0,s.A)(r));break;case 16:g.push((0,o.A)(r));break;default:var x=e.getTransferFunction();x?g.push((0,u.A)(x,e.hasExtendedSkTransferFn(),r)):g.push((0,c.A)(e.getTransferId(),r))}10===e.getMatrixId()&&g.push((0,a.A)(e.getTransferMatrix(r.bitDepth).invert(),r)),g.push((0,a.A)(e.getPrimaryMatrix(),r));var k=new n.A(0,9,8,2);switch(e.getTransferId()){case 18:r.toneMapPQAndHlgToDst?((0,f.U)(r),g.push((0,f.A)(r))):((0,h.n)(12/i.kH,!1,r),g.push((0,h.A)(r)));break;case 16:(0,h.n)(i.th,!0,r),g.push((0,h.A)(r)),r.toneMapPQAndHlgToDst&&(g.push((0,a.A)(k.getPrimaryMatrix().invert(),r)),(0,d.J)(e,r),g.push((0,d.A)(r)),g.push((0,a.A)(k.getPrimaryMatrix(),r)))}switch(g.push((0,a.A)(t.getPrimaryMatrix().invert(),r)),10===t.getMatrixId()&&g.push((0,a.A)(t.getTransferMatrix(r.bitDepth),r)),t.getTransferId()){case 18:(0,l.j)(i.kH,r),g.push((0,l.A)(r)),g.push((0,p.A)(r));break;case 16:(0,l.j)(i.th,r),g.push((0,l.A)(r)),g.push((0,v.A)(r));default:var b=t.getInverseTransferFunction();b?g.push((0,u.A)(b,e.hasExtendedSkTransferFn(),r)):g.push((0,m.A)(e.getTransferId(),r))}}if(!r.outputRGB){var w=8===t.getMatrixId(),_=(0,a.A)(t.getRangeAdjustMatrix(r.bitDepth).invert(),r);w&&g.push(_),10===t.getMatrixId()||g.push((0,a.A)(t.getTransferMatrix(r.bitDepth),r)),w||g.push(_)}}return g}},57517:(e,t,r)=>{"use strict";r.d(t,{hD:()=>i,kH:()=>n,th:()=>a});var n=203,i=1e3,a=1e4},71323:(e,t,r)=>{"use strict";function n(e,t,r){return t?"\n      {\n        ".concat(1===r.type?"var v: f32":"float v"," = abs(color.r);\n        ").concat(e(),"\n        color.r = sign(color.r) * v;\n      }\n      {\n        ").concat(1===r.type?"var v: f32":"float v"," = abs(color.g);\n        ").concat(e(),"\n        color.g = sign(color.g) * v;\n      }\n      {\n        ").concat(1===r.type?"var v: f32":"float v"," = abs(color.b);\n        ").concat(e(),"\n        color.b = sign(color.b) * v;\n      }\n    "):"\n      {\n        ".concat(1===r.type?"var v: f32":"float v"," = color.r;\n        ").concat(e(),"\n        color.r = v;\n      }\n      {\n        ").concat(1===r.type?"var v: f32":"float v"," = color.g;\n        ").concat(e(),"\n        color.g = v;\n      }\n      {\n        ").concat(1===r.type?"var v: f32":"float v"," = color.b;\n        ").concat(e(),"\n        color.b = v;\n      }\n    ")}r.d(t,{A:()=>n})},40326:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(71323);function i(e,t){return(0,n.A)((function(){switch(e){case 9:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v =  1.0 + log(v) / log(10.0) / 2.0;\n          }\n        ";case 10:return"\n          if (v < sqrt(10.0) / 1000.0)\n            v = 0.0;\n          }\n          else {\n            v = 1.0 + log(v) / log(10.0) / 2.5;\n          }\n        ";case 11:return"\n          ".concat(1===t.type?"let a: f32":"float a"," = 1.099296826809442;\n          ").concat(1===t.type?"let b: f32":"float b","= 0.018053968510807;\n          if (v < -b) {\n            v = -a * pow(-v, 0.45) + (a - 1.0);\n          }\n          else if (v <= b) {\n            v = 4.5 * v;\n          }\n          else {\n            v = a * pow(v, 0.45) - (a - 1.0);\n          }\n        ");case 12:return"\n          ".concat(1===t.type?"let a: f32":"float a"," = 1.099;\n          ").concat(1===t.type?"let b: f32":"float b"," = 0.018;\n          ").concat(1===t.type?"let l: f32":"float l"," = 0.0045;\n\n          if (v < -l) {\n            v = -(a * pow(-4.0 * v, 0.45) + (a - 1.0)) / 4.0;\n          }\n          else if (v <= b) {\n            v = 4.5 * v;\n          }\n          else {\n            v = a * pow(v, 0.45) - (a - 1.0);\n          }\n        ");default:return""}}),!1,t)}},5361:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(71323);function i(e){return(0,n.A)((function(){return"\n      v = max(0.0, v);\n      ".concat(1===e.type?"let a: f32":"float a"," = 0.17883277f;\n      ").concat(1===e.type?"let b: f32":"float b"," = 0.28466892f;\n      ").concat(1===e.type?"let c: f32":"float c"," = 0.55991073f;\n      if (v <= 0.5) {\n        v = v * v + 4.0;\n      }\n      else {\n        v = exp((v - c) / a) + b;\n      }\n      v = v / 12.0;\n    ")}),!1,e)}},84272:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(71323);function i(e){return(0,n.A)((function(){return"\n      v = max(0.0, v);\n      ".concat(1===e.type?"let a: f32":"float a"," = 0.17883277f;\n      ").concat(1===e.type?"let b: f32":"float b"," = 0.28466892f;\n      ").concat(1===e.type?"let c: f32":"float c"," = 0.55991073f;\n      if (v <= 1.0) {\n        v = 0.5 * sqrt(v);\n      }\n      else {\n        v = a * log(v - b) + c;\n      }\n    ")}),!1,e)}},63921:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(71323);function i(e){return(0,n.A)((function(){return"\n      v = max(0.0, v);\n      ".concat(1===e.type?"let m1: f32":"float m1"," = (2610.0 / 4096.0) / 4.0;\n      ").concat(1===e.type?"let m2: f32":"float m2"," = (2523.0 / 4096.0) * 128.0;\n      ").concat(1===e.type?"let c1: f32":"float c1"," = 3424.0 / 4096.0;\n      ").concat(1===e.type?"let c2: f32":"float c2"," = (2413.0 / 4096.0) * 32.0;\n      ").concat(1===e.type?"let c3: f32":"float c3"," = (2392.0 / 4096.0) * 32.0;\n      \n      ").concat(0===e.type?"\n        #ifdef GL_FRAGMENT_PRECISION_HIGH\n        highp float v2 = v;\n        #else\n        float v2 = v;\n        #endif\n      ":"var v2: f32 = v;","\n  \n      v2 = pow(max(pow(v2, 1.0 / m2) - c1, 0.0) / (c2 - c3 * pow(v2, 1.0 / m2)), 1.0 / m1);\n      v = v2;\n    ")}),!1,e)}},51025:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(71323);function i(e){return(0,n.A)((function(){return"\n      v = max(0.0, v);\n      ".concat(1===e.type?"let m1: f32":"float m1"," = (2610.0 / 4096.0) / 4.0;\n      ").concat(1===e.type?"let m2: f32":"float m2"," = (2523.0 / 4096.0) * 128.0;\n      ").concat(1===e.type?"let c1: f32":"float c1"," = 3424.0 / 4096.0;\n      ").concat(1===e.type?"let c2: f32":"float c2"," = (2413.0 / 4096.0) * 32.0;\n      ").concat(1===e.type?"let c3: f32":"float c3"," = (2392.0 / 4096.0) * 32.0;\n      v =  pow((c1 + c2 * pow(v, m1)) / (1.0 + c3 * pow(v, m1)), m2);\n    ")}),!1,e)}},16307:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(71323);function i(e,t){return(0,n.A)((function(){switch(e){case 9:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v = pow(10.0, (v - 1.0) * 2.0);\n          }\n        ";case 10:return"\n          if (v < 0.0) {\n            v = 0.0;\n          }\n          else {\n            v = pow(10.0, (v - 1.0) * 2.5);\n          }\n        ";case 11:return"\n          ".concat(1===t.type?"let a: f32":"float a"," = 1.099296826809442;\n          ").concat(1===t.type?"let from_linear_neg_a: f32":"float from_linear_neg_a"," = -1.047844;\n          ").concat(1===t.type?"let from_linear_b: f32":"float from_linear_b"," = 0.081243;\n          if (v < from_linear_neg_a) {\n            v = -pow((a - 1.0 - v) / a, 1.0 / 0.45);\n          }\n          else if (v <= from_linear_b) {\n            v = v / 4.5;\n          }\n          else {\n            v = pow((v + a - 1.0) / a, 1.0 / 0.45);\n          }\n        ");case 12:return"\n          ".concat(1===t.type?"let a: f32":"float a"," = 1.099;\n          ").concat(1===t.type?"let from_linear_neg_l: f32":"float from_linear_neg_l"," = -0.020250;\n          ").concat(1===t.type?"let from_linear_b: f32":"float from_linear_b"," = 0.081000;\n          if (v < from_linear_neg_l) {\n            v = -pow((1.0 - a - v * 4.0) / a, 1.0 / 0.45) / 4.0;\n          }\n          else if (v <= from_linear_b) {\n            v = v / 4.5;\n          }\n          else {\n            v = pow((v + a - 1.0) / a, 1.0 / 0.45);\n          }\n        ");default:return""}}),!1,t)}},55168:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(71323),i=r(15380);function a(e,t,r){return(0,n.A)((function(){var t=.0009765625,r="v";Math.abs(e.c-1)>t&&(r="".concat((0,i.A)(e.c)," * ").concat(r)),Math.abs(e.f)>t&&(r="".concat(r," + ").concat((0,i.A)(e.f)));var n="v";return Math.abs(e.a=1)>t&&(n="".concat((0,i.A)(e.a)," * ").concat(n)),Math.abs(e.b)>t&&(n="".concat(n," + ").concat((0,i.A)(e.b))),Math.abs(e.g-1)>t&&(n="pow(".concat(n,", ").concat((0,i.A)(e.g),")")),Math.abs(e.e)>t&&(n="".concat(n," + ").concat((0,i.A)(e.e))),"\n      if (v < ".concat((0,i.A)(e.d),") {\n        v = ").concat(r,";\n      }\n      else {\n        v = ").concat(n,";\n      }\n    ")}),!1,r)}},38469:(e,t,r)=>{"use strict";function n(e,t,r){if(t){var n=e[3],i=e[4];e[3]=e[17],e[4]=e[18],e[17]=n,e[18]=i,n=e[10],i=e[11],e[10]=e[24],e[11]=e[25],e[24]=n,e[25]=i}if(r){var a=e[3],s=e[4];e[3]=e[10],e[4]=e[11],e[10]=a,e[11]=s,a=e[17],s=e[18],e[17]=e[24],e[18]=e[25],e[24]=a,e[25]=s}}r.d(t,{A:()=>n})},20088:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n,i,a=r(81570),s=r(78716),o=r(134),u=r(80662),c=r.n(u),f=r(61499),h=r(12085),d=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"offset",void 0),(0,o.A)(this,"multiplier",void 0),(0,o.A)(this,"pqTonemapA",void 0),(0,o.A)(this,"pqTonemapB",void 0),(0,o.A)(this,"hlgOOTFGammaMinusOne",void 0),(0,o.A)(this,"hlgDstMaxLuminanceRelative",void 0),(0,o.A)(this,"nitsToSdrRelativeFactor",void 0),(0,o.A)(this,"sdrRelativeToNitsFactor",void 0)}));n=d.prototype,(i=new(c())).set("offset",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("multiplier",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),i.set("pqTonemapA",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),i.set("pqTonemapB",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),i.set("hlgOOTFGammaMinusOne",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),i.set("hlgDstMaxLuminanceRelative",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),i.set("nitsToSdrRelativeFactor",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),i.set("sdrRelativeToNitsFactor",{0:18,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,4),(0,h.A)(n,f.g7,32),(0,h.A)(n,f.JY,i)},36719:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134);function l(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,p()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function p(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}var v=function(e){function t(e,r){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,a.A)(this,t),n=l(this,t,[e,r]),(0,d.A)((0,u.A)(n),"enableColor",void 0),(0,d.A)((0,u.A)(n),"aPoint",void 0),(0,d.A)((0,u.A)(n),"aColor",void 0),n.enableColor=i,n}return(0,h.A)(t,e),(0,s.A)(t,[{key:"link",value:function(e){(0,c.A)((0,f.A)(t.prototype),"link",this).call(this,e),this.aPoint=this.gl.getAttribLocation(this.program,"point"),this.aColor=this.gl.getAttribLocation(this.program,"color"),this.enableColor?(this.gl.enableVertexAttribArray(this.aPoint),this.gl.enableVertexAttribArray(this.aColor)):this.gl.enableVertexAttribArray(this.aPoint)}},{key:"bind",value:function(){(0,c.A)((0,f.A)(t.prototype),"bind",this).call(this),this.enableColor?(this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0),this.gl.vertexAttribPointer(this.aColor,4,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,3*Float32Array.BYTES_PER_ELEMENT)):this.gl.vertexAttribPointer(this.aPoint,3,this.gl.FLOAT,!1,7*Float32Array.BYTES_PER_ELEMENT,0)}}]),t}(r(9188).A)},9188:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(78716),i=r(81570),a=r(134),s=function(){function e(t,r){(0,n.A)(this,e),(0,a.A)(this,"gl",void 0),(0,a.A)(this,"_program",void 0),(0,a.A)(this,"vertexShader",void 0),(0,a.A)(this,"fragmentShader",void 0),this.vertexShader=t,this.fragmentShader=r}return(0,i.A)(e,[{key:"link",value:function(e){this.gl=e,this.vertexShader&&this.vertexShader.compile(this.gl),this.fragmentShader&&this.fragmentShader.compile(this.gl),this._program=this.gl.createProgram(),this.gl.attachShader(this._program,this.vertexShader.shader),this.gl.attachShader(this._program,this.fragmentShader.shader),this.gl.linkProgram(this._program)}},{key:"stop",value:function(){this.vertexShader.stop(this.gl),this.fragmentShader.stop(this.gl),this.gl.deleteProgram(this._program),this.vertexShader=null,this.fragmentShader=null,this._program=null}},{key:"bind",value:function(){this.gl.useProgram(this._program)}},{key:"program",get:function(){return this._program}}]),e}()},32903:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(88435),i=r.n(n),a=r(81570),s=r(78716),o=r(77193),u=r(25767),c=r(31060);function f(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,h()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function h(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}var d=function(e){function t(e){return(0,s.A)(this,t),f(this,t,[e])}return(0,c.A)(t,e),(0,a.A)(t)}(r(48091).A)},48091:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134);function l(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,p()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function p(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}var v=function(e){function t(e){var r;return(0,a.A)(this,t),r=l(this,t,[e]),(0,d.A)((0,u.A)(r),"rgbSamplerLocation",void 0),r}return(0,h.A)(t,e),(0,s.A)(t,[{key:"link",value:function(e){(0,c.A)((0,f.A)(t.prototype),"link",this).call(this,e),this.rgbSamplerLocation=this.gl.getUniformLocation(this.program,"rgb_Sampler")}},{key:"bindRGBTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.uniform1i(this.rgbSamplerLocation,e)}}]),t}(r(24399).A)},24399:(e,t,r)=>{"use strict";r.d(t,{A:()=>y});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134),l=r(36719),p=r(37022),v=r(36200),m=r(14397);function g(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,A()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function A(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(A=function(){return!!e})()}var y=function(e){function t(e){var r;return(0,a.A)(this,t),r=g(this,t,[new p.A(m.A),new v.A(e)]),(0,d.A)((0,u.A)(r),"rotateMatrixLocation",void 0),r}return(0,h.A)(t,e),(0,s.A)(t,[{key:"link",value:function(e){(0,c.A)((0,f.A)(t.prototype),"link",this).call(this,e),this.rotateMatrixLocation=this.gl.getUniformLocation(this.program,"rotateMatrix")}},{key:"setRotateMatrix",value:function(e){this.gl.uniformMatrix4fv(this.rotateMatrixLocation,!1,new Float32Array(e))}}]),t}(l.A)},73039:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134);function l(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,p()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function p(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}var v=function(e){function t(e){var r;return(0,a.A)(this,t),r=l(this,t,[e]),(0,d.A)((0,u.A)(r),"maxUniformLocation",void 0),(0,d.A)((0,u.A)(r),"offsetLocation",void 0),(0,d.A)((0,u.A)(r),"multiplierLocation",void 0),(0,d.A)((0,u.A)(r),"pqTonemapALocation",void 0),(0,d.A)((0,u.A)(r),"pqTonemapBLocation",void 0),(0,d.A)((0,u.A)(r),"hlgOOTFGammaMinusOneLocation",void 0),(0,d.A)((0,u.A)(r),"hlgDstMaxLuminanceRelativeLocation",void 0),(0,d.A)((0,u.A)(r),"nitsToSdrRelativeFactorLocation",void 0),(0,d.A)((0,u.A)(r),"sdrRelativeToNitsFactorLocation",void 0),r}return(0,h.A)(t,e),(0,s.A)(t,[{key:"link",value:function(e){(0,c.A)((0,f.A)(t.prototype),"link",this).call(this,e),this.maxUniformLocation=this.gl.getUniformLocation(this.program,"v_max"),this.offsetLocation=this.gl.getUniformLocation(this.program,"offset"),this.multiplierLocation=this.gl.getUniformLocation(this.program,"multiplier"),this.pqTonemapALocation=this.gl.getUniformLocation(this.program,"pq_tonemap_a"),this.pqTonemapBLocation=this.gl.getUniformLocation(this.program,"pq_tonemap_b"),this.hlgOOTFGammaMinusOneLocation=this.gl.getUniformLocation(this.program,"hlg_ootf_gamma_minus_one"),this.hlgDstMaxLuminanceRelativeLocation=this.gl.getUniformLocation(this.program,"hlg_dst_max_luminance_relative"),this.nitsToSdrRelativeFactorLocation=this.gl.getUniformLocation(this.program,"nits_to_sdr_relative_factor"),this.sdrRelativeToNitsFactorLocation=this.gl.getUniformLocation(this.program,"sdr_relative_to_nits_factor")}},{key:"setMax",value:function(e){this.gl.uniform1f(this.maxUniformLocation,e)}},{key:"setMetaData",value:function(e){this.gl.uniform1f(this.offsetLocation,e.offset),this.gl.uniform1f(this.multiplierLocation,e.multiplier),this.gl.uniform1f(this.pqTonemapALocation,e.pqTonemapA),this.gl.uniform1f(this.pqTonemapBLocation,e.pqTonemapB),this.gl.uniform1f(this.hlgOOTFGammaMinusOneLocation,e.hlgOOTFGammaMinusOne),this.gl.uniform1f(this.hlgDstMaxLuminanceRelativeLocation,e.hlgDstMaxLuminanceRelative),this.gl.uniform1f(this.nitsToSdrRelativeFactorLocation,e.nitsToSdrRelativeFactor),this.gl.uniform1f(this.sdrRelativeToNitsFactorLocation,e.sdrRelativeToNitsFactor)}}]),t}(r(1706).A)},91848:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(88435),i=r.n(n),a=r(81570),s=r(78716),o=r(77193),u=r(25767),c=r(31060);function f(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,h()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function h(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}var d=function(e){function t(e){return(0,s.A)(this,t),f(this,t,[e])}return(0,c.A)(t,e),(0,a.A)(t)}(r(1706).A)},1706:(e,t,r)=>{"use strict";r.d(t,{A:()=>v});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(43070),c=r(60394),f=r(25767),h=r(31060),d=r(134);function l(e,t,r){return t=(0,f.A)(t),(0,o.A)(e,p()?i()(t,r||[],(0,f.A)(e).constructor):t.apply(e,r))}function p(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}var v=function(e){function t(e){var r;return(0,a.A)(this,t),r=l(this,t,[e]),(0,d.A)((0,u.A)(r),"ySamplerLocation",void 0),(0,d.A)((0,u.A)(r),"uSamplerLocation",void 0),(0,d.A)((0,u.A)(r),"vSamplerLocation",void 0),(0,d.A)((0,u.A)(r),"aSamplerLocation",void 0),r}return(0,h.A)(t,e),(0,s.A)(t,[{key:"link",value:function(e){(0,c.A)((0,f.A)(t.prototype),"link",this).call(this,e),this.ySamplerLocation=this.gl.getUniformLocation(this.program,"y_Sampler"),this.uSamplerLocation=this.gl.getUniformLocation(this.program,"u_Sampler"),this.vSamplerLocation=this.gl.getUniformLocation(this.program,"v_Sampler"),this.aSamplerLocation=this.gl.getUniformLocation(this.program,"a_Sampler")}},{key:"bindYTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.uniform1i(this.ySamplerLocation,e)}},{key:"bindUTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.uniform1i(this.uSamplerLocation,e)}},{key:"bindVTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.uniform1i(this.vSamplerLocation,e)}},{key:"bindATexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.gl.uniform1i(this.aSamplerLocation,e)}}]),t}(r(24399).A)},36200:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(88435),i=r.n(n),a=r(81570),s=r(78716),o=r(77193),u=r(25767),c=r(31060);function f(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,h()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function h(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}var d=function(e){function t(e){return(0,s.A)(this,t),f(this,t,[1,e])}return(0,c.A)(t,e),(0,a.A)(t)}(r(27976).A)},27976:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(78716),i=r(81570),a=r(134),s=function(){function e(t,r){(0,n.A)(this,e),(0,a.A)(this,"type",void 0),(0,a.A)(this,"_shader",void 0),(0,a.A)(this,"_source",void 0),(0,a.A)(this,"compiled",void 0),this.type=t,this._shader=null,this._source=r,this.compiled=!1}return(0,i.A)(e,[{key:"compile",value:function(e){this.compiled||(this._shader=e.createShader(0===this.type?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(this._shader,this._source),e.compileShader(this._shader),this.compiled=!0)}},{key:"stop",value:function(e){e.deleteShader(this._shader),this._shader=null}},{key:"shader",get:function(){return this._shader}}]),e}()},37022:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(88435),i=r.n(n),a=r(81570),s=r(78716),o=r(77193),u=r(25767),c=r(31060);function f(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,h()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function h(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}var d=function(e){function t(e){return(0,s.A)(this,t),f(this,t,[0,e])}return(0,c.A)(t,e),(0,a.A)(t)}(r(27976).A)},17397:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(43070),f=r(31060),h=r(134);function d(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,l()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function l(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}var p=function(e){function t(e,r,n){var i;return(0,a.A)(this,t),i=d(this,t,[e,r,n]),(0,h.A)((0,c.A)(i),"filter",void 0),(0,h.A)((0,c.A)(i),"format",void 0),(0,h.A)((0,c.A)(i),"internalformat",void 0),(0,h.A)((0,c.A)(i),"dataType",void 0),i.format=i.gl.RGB,i.filter=i.gl.LINEAR,i.internalformat=i.gl.RGB,i.dataType=i.gl.UNSIGNED_BYTE,i}return(0,f.A)(t,e),(0,s.A)(t,[{key:"init",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}},{key:"setFormat",value:function(e){this.format=e}},{key:"setInternalformat",value:function(e){this.internalformat=e}},{key:"setDataType",value:function(e){this.dataType=e}},{key:"setFilter",value:function(e){this.filter=e}},{key:"fill",value:function(e){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.setUnpackAlignment(),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,e)}}]),t}(r(22684).A)},22684:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(78716),i=r(81570),a=r(134),s=r(67672),o=function(){function e(t,r,i){(0,n.A)(this,e),(0,a.A)(this,"gl",void 0),(0,a.A)(this,"width",void 0),(0,a.A)(this,"height",void 0),(0,a.A)(this,"texture",void 0),this.gl=t,this.width=r,this.height=i,this.texture=this.gl.createTexture()}return(0,i.A)(e,[{key:"getTexture",value:function(){return this.texture}},{key:"bind",value:function(e){s.ai(e)&&this.gl.activeTexture(this.gl.TEXTURE0+e),this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture)}},{key:"setSize",value:function(e,t){this.width=e,this.height=t}},{key:"setUnpackAlignment",value:function(){this.width%8==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,8):this.width%4==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,4):this.width%2==0?this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,2):this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1)}},{key:"destroy",value:function(){this.texture&&(this.gl.deleteTexture(this.texture),this.texture=null)}}]),e}()},48280:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(43070),f=r(31060),h=r(134);function d(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,l()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function l(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(l=function(){return!!e})()}var p=function(e){function t(e,r,n){var i;return(0,a.A)(this,t),i=d(this,t,[e,r,n]),(0,h.A)((0,c.A)(i),"filter",void 0),(0,h.A)((0,c.A)(i),"format",void 0),(0,h.A)((0,c.A)(i),"internalformat",void 0),(0,h.A)((0,c.A)(i),"dataType",void 0),i.format=i.gl.LUMINANCE,i.filter=i.gl.LINEAR,i.internalformat=i.gl.LUMINANCE,i.dataType=i.gl.UNSIGNED_BYTE,i}return(0,f.A)(t,e),(0,s.A)(t,[{key:"init",value:function(){this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.filter),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE)}},{key:"setFormat",value:function(e){this.format=e}},{key:"setInternalformat",value:function(e){this.internalformat=e}},{key:"setDataType",value:function(e){this.dataType=e}},{key:"setFilter",value:function(e){this.filter=e}},{key:"fill",value:function(e){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.setUnpackAlignment(),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.internalformat,this.width,this.height,0,this.format,this.dataType,e)}}]),t}(r(22684).A)},48641:(e,t,r)=>{"use strict";r.d(t,{A:()=>A});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(63939),f=r(50932),h=r(37837),d=r(11473),l=r(84149),p=r(4624),v=r(26429),m=r(44690),g=m.A.windows||m.A.mac||m.A.linux?10:20,A=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,i.A)(this,e),(0,s.A)(this,"context",void 0),(0,s.A)(this,"observer",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"pullIPC",void 0),(0,s.A)(this,"buffer",void 0),(0,s.A)(this,"channels",void 0),(0,s.A)(this,"ended",void 0),(0,s.A)(this,"float32",void 0),(0,s.A)(this,"buffered",void 0),(0,s.A)(this,"pause",void 0),(0,s.A)(this,"startTime",void 0),(0,s.A)(this,"dest",void 0),(0,s.A)(this,"queue",void 0),(0,s.A)(this,"firstRendered",void 0),this.context=t,this.observer=r,this.options=n}var t,r;return(0,a.A)(e,[{key:"request",value:(r=(0,n.A)(u().mark((function e(t,r,n){var i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="init"===e.t0?3:"start"===e.t0?4:"restart"===e.t0?22:"stop"===e.t0?38:"clear"===e.t0?43:"pause"===e.t0?46:"unpause"===e.t0?48:51;break;case 3:return e.abrupt("break",51);case 4:return i=r.port,a=r.channels,this.channels=a,this.pullIPC=new l.Ay(i),this.buffer=this.allocBuffer(),this.float32=new Float32Array((0,d.eq)().buffer),this.queue=[],this.startTime=0,this.ended=!1,this.pause=!1,this.firstRendered=!1,e.next=16,this.pullIPC.request("pull",{buffer:this.buffer});case 16:return this.buffering(),e.next=19,this.pullIPC.request("pull",{buffer:this.buffer});case 19:case 35:return this.buffered=!0,this.process(),e.abrupt("break",51);case 22:if(this.ended){e.next=24;break}return e.abrupt("return");case 24:return this.buffer=this.allocBuffer(),this.queue=[],this.startTime=0,this.ended=!1,this.pause=!1,this.firstRendered=!1,e.next=32,this.pullIPC.request("pull",{buffer:this.buffer});case 32:return this.buffering(),e.next=35,this.pullIPC.request("pull",{buffer:this.buffer});case 38:return this.freeBuffer(this.buffer),this.buffer=null,this.ended=!0,this.pullIPC.destroy(),e.abrupt("break",51);case 43:return this.queue.forEach((function(e){e.disconnect()})),this.queue.length=0,e.abrupt("break",51);case 46:return this.pause=!0,e.abrupt("break",51);case 48:return this.pause=!1,this.queue.length||this.process(),e.abrupt("break",51);case 51:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"allocBuffer",value:function(){var e=(0,h.Gy)(40);f.M[20](e,(0,h.Gy)(4*this.channels));for(var t=(0,h.Gy)(512*g*this.channels),r=0;r<this.channels;r++)f.M[20](c.f[20](e)+4*r,t+128*g*4*r);return f.M[15](e+12,128*g),e}},{key:"freeBuffer",value:function(e){e&&((0,h.aI)(c.f[20](e)),(0,h.aI)(e),(0,h.Eb)(e))}},{key:"pull",value:(t=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.buffered=!1,e.next=3,this.pullIPC.request("pull",{buffer:this.buffer});case 3:e.sent<0?this.ended=!0:(this.buffered=!0,this.queue.length||this.process());case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"buffering",value:function(){var e=this;this.float32.length||(this.float32=new Float32Array((0,d.eq)().buffer));for(var t=this.context.createBuffer(this.channels,128*g,this.context.sampleRate),r=0;r<this.channels;r++)if(c.f[20](c.f[20](this.buffer)+4*r)){var n=c.f[20](c.f[20](this.buffer)+4*r)>>>2;t.copyToChannel&&!v._7?t.copyToChannel(this.float32.subarray(n,n+128*g),r,0):t.getChannelData(r).set(this.float32.subarray(n,n+128*g),0)}var i=this.context.createBufferSource();i.buffer=t,i.onended=function(){if(e.queue.shift(),e.ended&&!e.queue.length)return e.freeBuffer(e.buffer),p.pq("audio source ended","src/avrender/pcm/AudioSourceBufferNode.ts",230),void e.observer.onEnded();e.process(),e.queue.length||e.observer.onStutter(),e.firstRendered||(e.firstRendered=!0,e.observer.onFirstRendered())},0===this.startTime&&(this.startTime=this.context.currentTime),i.start(this.startTime),this.dest&&i.connect(this.dest),this.startTime+=i.buffer.duration,this.queue.push(i)}},{key:"connect",value:function(e){this.dest=e}},{key:"disconnect",value:function(){for(var e=0;e<this.queue.length;e++)this.queue[e].disconnect();this.dest=null,this.queue.length=0}},{key:"process",value:function(){this.buffer&&!this.pause&&this.buffered&&(this.buffering(),this.pull())}}]),e}()},88397:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(88435),i=r.n(n),a=r(81570),s=r(78716),o=r(77193),u=r(25767),c=r(31060);function f(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,h()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function h(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(h=function(){return!!e})()}var d=function(e){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,s.A)(this,t),f(this,t,[e,r,"audio-source-processor",n])}return(0,c.A)(t,e),(0,a.A)(t)}(r(6534).A)},6534:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(84149),f=r(67672),h=function(){function e(t,r,n){var a=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,i.A)(this,e),(0,s.A)(this,"audioWorkletNode",void 0),(0,s.A)(this,"ipcPort",void 0),(0,s.A)(this,"observer",void 0),this.observer=r,this.audioWorkletNode=new AudioWorkletNode(t,n,o),this.ipcPort=new c.Ay(this.audioWorkletNode.port),this.ipcPort.on(c.Wo,(function(e){switch(e.method){case"ended":a.observer.onEnded();break;case"firstRendered":a.observer.onFirstRendered();break;case"stutter":a.observer.onStutter()}}))}var t;return(0,a.A)(e,[{key:"request",value:(t=(0,n.A)(u().mark((function e(t,r,n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.ipcPort.request(t,r,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,r,n){return t.apply(this,arguments)})},{key:"connect",value:function(e){this.audioWorkletNode.connect(e)}},{key:"getNode",value:function(){return this.audioWorkletNode}},{key:"disconnect",value:function(){this.audioWorkletNode.disconnect()}},{key:"getParameters",value:function(e){var t=this.audioWorkletNode.parameters;if(f.Pc(t.get))return t.get(e);t.forEach((function(t,r){if(r===e)return t}))}}]),e}()},41324:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(25182),i=r(36443),a=r.n(i),s=r(61837);function o(e,t){return u.apply(this,arguments)}function u(){return(u=(0,n.A)(a().mark((function e(t,r){var n,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,s.A)(r,{varName:"processor"}),i=new Blob([n],{type:"text/javascript"}),o=URL.createObjectURL(i),e.next=5,t.audioWorklet.addModule(o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},60120:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n,i=r(78716),a=r(81570),s=r(134),o=r(95335),u=r(4624);!function(e){e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e[e.UPDATE_TIMESTAMP_OFFSET=2]="UPDATE_TIMESTAMP_OFFSET"}(n||(n={}));var c={mediaBufferMax:10},f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.A)(this,e),(0,s.A)(this,"sourceBuffer",void 0),(0,s.A)(this,"operatorQueue",void 0),(0,s.A)(this,"updating",void 0),(0,s.A)(this,"lastRemoveTime",void 0),(0,s.A)(this,"paddingCallback",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"ending",void 0),(0,s.A)(this,"onQuotaExceededError",void 0),(0,s.A)(this,"onEnded",void 0),this.options=o.extend({},c,t),this.operatorQueue=[],this.updating=!1,this.lastRemoveTime=0,this.ending=!1}return(0,a.A)(e,[{key:"setSourceBuffer",value:function(e){var t=this;this.sourceBuffer=e,this.sourceBuffer.onupdateend=function(){t.paddingCallback&&(t.paddingCallback(),t.paddingCallback=null),t.operatorQueue&&t.operatorQueue.length?t.enqueue():(t.updating=!1,t.ending&&t.onEnded&&t.onEnded())},this.sourceBuffer.onerror=function(e){u.z3("track update buffer error: ".concat(e),"src/avrender/track/Track.ts",102)}}},{key:"changeMimeType",value:function(e){this.sourceBuffer&&this.sourceBuffer.changeType(e)}},{key:"enqueue",value:function(){if(this.operatorQueue.length){var e=this.operatorQueue.shift();if(e.operator===n.ADD)try{this.sourceBuffer.appendBuffer(e.buffer),this.updating=!0,e.callback&&(this.paddingCallback=e.callback)}catch(t){if(!(t instanceof DOMException&&"QuotaExceededError"===t.name))throw t;this.operatorQueue.unshift(e),this.onQuotaExceededError&&this.onQuotaExceededError(),this.updating=!1}else e.operator===n.REMOVE?(this.sourceBuffer.remove(e.start,e.end),this.updating=!0,e.callback&&(this.paddingCallback=e.callback)):e.operator===n.UPDATE_TIMESTAMP_OFFSET&&(this.sourceBuffer.timestampOffset=e.timestampOffset,e.callback&&e.callback(),this.enqueue())}}},{key:"addBuffer",value:function(e,t){e?(this.operatorQueue.push({operator:n.ADD,buffer:e,callback:t}),this.updating||this.enqueue()):t&&t()}},{key:"updateTimestampOffset",value:function(e,t){this.operatorQueue.push({operator:n.UPDATE_TIMESTAMP_OFFSET,timestampOffset:e,callback:t}),this.updating||this.enqueue()}},{key:"removeBuffer",value:function(e,t){this.ending||(e=Math.floor(e))-this.lastRemoveTime<this.options.mediaBufferMax<<1||(this.operatorQueue.push({operator:n.REMOVE,start:this.lastRemoveTime,end:e-this.options.mediaBufferMax,callback:t}),this.updating||this.enqueue(),this.lastRemoveTime=e-this.options.mediaBufferMax)}},{key:"removeAllBuffer",value:function(e){this.sourceBuffer.buffered.length?(this.operatorQueue.push({operator:n.REMOVE,start:this.sourceBuffer.buffered.start(0),end:this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1),callback:e}),this.updating||this.enqueue()):e&&e()}},{key:"end",value:function(){this.ending=!0,this.updating||this.operatorQueue.length||this.onEnded&&this.onEnded()}},{key:"stop",value:function(){if(this.sourceBuffer){try{this.sourceBuffer.abort(),this.updating=!1}catch(e){}try{this.sourceBuffer.buffered.length&&(this.updating?this.operatorQueue.push({operator:n.REMOVE,start:this.sourceBuffer.buffered.start(0),end:this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)}):(this.sourceBuffer.remove(this.sourceBuffer.buffered.start(0),this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)),this.updating=!0)),this.paddingCallback&&(this.paddingCallback(),this.paddingCallback=null)}catch(e){}}}},{key:"reset",value:function(){this.stop(),this.operatorQueue.length=0,this.ending=!1}},{key:"isPaused",value:function(){return!this.updating&&this.operatorQueue.length}},{key:"getQueueLength",value:function(){return this.operatorQueue.length}},{key:"getBufferedTime",value:function(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1)-this.sourceBuffer.buffered.start(0):0}},{key:"getBufferedStart",value:function(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.start(0):0}},{key:"getBufferedEnd",value:function(){return this.sourceBuffer&&this.sourceBuffer.buffered.length?this.sourceBuffer.buffered.end(this.sourceBuffer.buffered.length-1):0}},{key:"getSourceBuffer",value:function(){return this.sourceBuffer}},{key:"setMediaBufferMax",value:function(e){this.options.mediaBufferMax=e}},{key:"getMediaBufferMax",value:function(){return this.options.mediaBufferMax}},{key:"destroy",value:function(){this.stop(),this.operatorQueue=null,this.sourceBuffer&&(this.sourceBuffer.onupdateend=this.sourceBuffer.onerror=null,this.sourceBuffer=null)}}]),e}()},85224:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(63939),i=r(1984),a=r(86834);function s(e){return 86017!==n.f[15](e+4)||a.A.firefox?'audio/mp4; codecs="'.concat((0,i.A)(e),'"'):"audio/mpeg"}},10333:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(94663);function i(e){return'video/mp4; codecs="'.concat((0,n.A)(e),'"')}},77231:(e,t,r)=>{"use strict";r.d(t,{Dh:()=>i,KR:()=>u,N_:()=>a,SF:()=>s,f7:()=>d,go:()=>f,i0:()=>c,qs:()=>o,zg:()=>h});var n=r(9599),i=-BigInt(1),a=-1,s=1e6,o=1e3,u=new n.P({den:s,num:1}),c=new n.P({den:o,num:1}),f=(new n.P({den:1,num:1}),2147483647),h=65535,d=4294967295},9705:(e,t,r)=>{"use strict";r.d(t,{E$:()=>n,LR:()=>i,LT:()=>c,OY:()=>u,UY:()=>a,gR:()=>s,lh:()=>o,r8:()=>f});var n=-1,i=-2,a=-3,s=-4,o=-5,u=-6,c=-7,f=-8},36204:(e,t,r)=>{"use strict";r.d(t,{t:()=>u});var n=r(63939),i=r(50932),a=r(56024),s=r(66788),o=r(14686);function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===t&&(t=(0,a.FP)()),i.M[15](t+152,e.sampleRate),i.M[15](t+76,e.numberOfFrames),i.M[15](t+292,e.numberOfChannels),i.M[15](t+80,function(e){switch(e){case"u8":return 0;case"s16":return 1;case"s32":return 2;case"f32":return 3;case"u8-planar":return 5;case"s16-planar":return 6;case"s32-planar":return 7;case"f32-planar":return 8;default:throw new Error("not support")}}(e.format)),i.M[17](t+104,BigInt(Math.floor(e.timestamp))),(0,a.rh)(t);for(var r=(0,s.K0)(n.f[15](t+80))?n.f[15](t+292):1,u=0;u<r;u++)e.copyTo((0,o.s3)(n.f[20](n.f[20](t+64)+4*u),n.f[15](t+32)),{planeIndex:u});return t}},22898:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(63939),i=r(14686);function a(e,t){var r=Number(null!=t?t:n.f[17](e+8)),a=1&n.f[15](e+36);return new EncodedAudioChunk({type:a?"key":"delta",timestamp:r,data:(0,i.s3)(n.f[20](e+24),n.f[15](e+28))})}},28917:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(63939),i=r(14686);function a(e,t){var r=Number(null!=t?t:n.f[17](e+8)),a=1&n.f[15](e+36);return new EncodedVideoChunk({type:a?"key":"delta",timestamp:r,data:(0,i.s3)(n.f[20](e+24),n.f[15](e+28))})}},86368:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(26429),i=r(42577);function a(){return n._7?new MessageChannel:new i.A}},93147:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(63939),i=r(97317);function a(e){if(0!==n.f[15](e))return!1;var t=i.g[n.f[15](e+28)];return t&&128&t.flags}},24310:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(63939),i=r(97317);function a(e){if(0!==n.f[15](e))return!1;var t=i.g[n.f[15](e+28)];return!(!t||t.comp[0].depth<=8||18!==n.f[15](e+92)&&16!==n.f[15](e+92))}},16041:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(78716),i=r(81570),a=r(134),s=r(50932),o=r(40046),u=r(73783),c=r(37837),f=r(56024),h=function(){function e(t,r){(0,n.A)(this,e),(0,a.A)(this,"list",void 0),(0,a.A)(this,"mutex",void 0),this.list=t,this.mutex=r}return(0,i.A)(e,[{key:"alloc",value:function(){var e=this.list.find((function(e){return-1===o.p_(e+320,-1,1,16,2)}),20);return e||(e=(0,c.Gy)(328),(0,f._h)(e),s.M[16](e+320,1),u.s2(this.mutex),this.list.push(e,20),u.Tl(this.mutex)),e}},{key:"release",value:function(e){o.Hh(e+320,16,2)<=0||1===o.jb(e+320,1,16,2)&&((0,f.to)(e),o.M_(e+320,-1,16,2))}}]),e}()},47442:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n=r(78716),i=r(81570),a=r(134),s=r(50932),o=r(40046),u=r(73783),c=r(37837),f=function(){function e(t,r){(0,n.A)(this,e),(0,a.A)(this,"list",void 0),(0,a.A)(this,"mutex",void 0),this.list=t,this.mutex=r}return(0,i.A)(e,[{key:"alloc",value:function(){var e=this.list.find((function(e){return-1===o.p_(e+40,-1,1,16,2)}),20);return e||(e=(0,c.Gy)(48),s.M[16](e+40,1),u.s2(this.mutex),this.list.push(e,20),u.Tl(this.mutex)),e}},{key:"release",value:function(e){o.Hh(e+40,16,2)<=0||1===o.jb(e+40,1,16,2)&&o.M_(e+40,-1,16,2)}}]),e}()},84290:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n=r(78716),i=r(81570),a=r(134),s=r(50932),o=r(40046),u=r(73783),c=r(37837),f=r(71517),h=function(){function e(t,r){(0,n.A)(this,e),(0,a.A)(this,"list",void 0),(0,a.A)(this,"mutex",void 0),this.list=t,this.mutex=r}return(0,i.A)(e,[{key:"alloc",value:function(){var e=this.list.find((function(e){return-1===o.p_(e+88,-1,1,16,2)}),20);return e||(e=(0,c.Gy)(96),(0,f.Pd)(e),s.M[16](e+88,1),u.s2(this.mutex),this.list.push(e,20),u.Tl(this.mutex)),e}},{key:"release",value:function(e){o.Hh(e+88,16,2)<=0||1===o.jb(e+88,1,16,2)&&((0,f.Up)(e),o.M_(e+88,-1,16,2))}}]),e}()},97317:(e,t,r)=>{"use strict";r.d(t,{g:()=>a});var n,i=r(134),a=(n={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,0,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]}),12,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]}),4,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]}),13,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]}),5,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]}),14,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8}]}),23,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:2,offset:0,shift:0,depth:8},{plane:1,step:2,offset:1,shift:0,depth:8}]}),59,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]}),60,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]}),61,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]}),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,62,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]}),122,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]}),123,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]}),124,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]}),125,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]}),46,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]}),45,{nbComponents:3,log2ChromaW:1,log2ChromaH:1,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]}),69,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]}),70,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]}),63,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]}),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,64,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]}),126,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]}),127,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]}),128,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]}),129,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]}),48,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]}),47,{nbComponents:3,log2ChromaW:1,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]}),65,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]}),66,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:9},{plane:1,step:1,offset:0,shift:0,depth:9},{plane:2,step:1,offset:0,shift:0,depth:9}]}),67,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]}),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,68,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:10},{plane:1,step:1,offset:0,shift:0,depth:10},{plane:2,step:1,offset:0,shift:0,depth:10}]}),130,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]}),131,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:12},{plane:1,step:1,offset:0,shift:0,depth:12},{plane:2,step:1,offset:0,shift:0,depth:12}]}),132,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]}),133,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:14},{plane:1,step:1,offset:0,shift:0,depth:14},{plane:2,step:1,offset:0,shift:0,depth:14}]}),50,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:17,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]}),49,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:16,comp:[{plane:0,step:1,offset:0,shift:0,depth:16},{plane:1,step:1,offset:0,shift:0,depth:16},{plane:2,step:1,offset:0,shift:0,depth:16}]}),26,{nbComponents:4,log2ChromaW:0,log2ChromaH:0,flags:160,comp:[{plane:0,step:4,offset:0,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:2,shift:0,depth:8},{plane:0,step:4,offset:3,shift:0,depth:8}]}),119,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:32,comp:[{plane:0,step:4,offset:0,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:2,shift:0,depth:8}]}),28,{nbComponents:4,log2ChromaW:0,log2ChromaH:0,flags:160,comp:[{plane:0,step:4,offset:2,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:0,shift:0,depth:8},{plane:0,step:4,offset:3,shift:0,depth:8}]}),(0,i.A)((0,i.A)(n,121,{nbComponents:3,log2ChromaW:0,log2ChromaH:0,flags:32,comp:[{plane:0,step:4,offset:2,shift:0,depth:8},{plane:0,step:4,offset:1,shift:0,depth:8},{plane:0,step:4,offset:0,shift:0,depth:8}]}),33,{nbComponents:4,log2ChromaW:1,log2ChromaH:1,flags:144,comp:[{plane:0,step:1,offset:0,shift:0,depth:8},{plane:1,step:1,offset:0,shift:0,depth:8},{plane:2,step:1,offset:0,shift:0,depth:8},{plane:3,step:1,offset:0,shift:0,depth:8}]}))},58055:(e,t,r)=>{"use strict";r.d(t,{J:()=>a});var n,i=r(134),a=(n={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,0,{bits:8,planar:!1}),1,{bits:16,planar:!1}),2,{bits:32,planar:!1}),10,{bits:64,planar:!1}),3,{bits:32,planar:!1}),4,{bits:64,planar:!1}),5,{bits:8,planar:!0}),6,{bits:16,planar:!0}),7,{bits:32,planar:!0}),11,{bits:64,planar:!0}),(0,i.A)((0,i.A)(n,8,{bits:32,planar:!0}),9,{bits:64,planar:!0}))},62751:(e,t,r)=>{"use strict";r.d(t,{$$:()=>i,HR:()=>n,Ki:()=>p,Mb:()=>l,Sz:()=>c,Xp:()=>o,_R:()=>a,_m:()=>d,iW:()=>f,mX:()=>h,n1:()=>s,qO:()=>u});var n={flv:0,mp4:1,mov:1,ts:2,ivf:4,opus:3,oggs:3,ogg:3,m3u8:2,m3u:2,mpd:1,mp3:11,mkv:5,mka:5,webm:6,aac:12,flac:14,wav:13,srt:16,vtt:15,ssa:17,ass:17,xml:18,ttml:18,h264:8,264:8,avc:8,h265:9,265:9,hevc:9,h266:10,266:10,vvc:10},i={m3u8:2,m3u:2,mpd:3},a={copy:0,h264:27,avc:27,hevc:173,h265:173,vvc:196,h266:196,av1:225,vp9:167,vp8:139,mpeg4:12,theora:30},s={copy:0,aac:86018,ac3:86019,eac3:86056,dca:86020,mp3:86017,opus:86076,flac:86028,speex:86051,vorbis:86021,pcm_alaw:65543,pcm_mulaw:65542},o={webvtt:94226,subrip:94225,ass:94230,ttml:94232,mov_text:94213,hdmv_pgs:94214,hdmv_text:94231,dvd:94208,dvb:94209,eia_608:94218},u={yuv420p:0,yuv422p:4,yuv444p:5,yuva420p:33,yuva422p:78,yuva444p:79,yuv420p10le:62,yuv422p10le:64,yuv444p10le:68,yuva420p10le:87,yuva422p10le:89,yuva444p10le:91,yuv420p10be:61,yuv422p10be:63,yuv444p10be:67,yuva420p10be:86,yuva422p10be:88,yuva444p10be:90},c={u8:0,"u8-planar":5,s16:1,"s16-planar":6,s32:2,"s32-planar":7,s64:10,"s64-planar":11,float:3,"float-planar":8,double:4,"double-planar":9},f={flv:0,mp4:1,mov:1,ts:2,mpegts:2,ivf:4,opus:3,ogg:3,m3u8:2,m3u:2,mpd:1,mp3:11,mkv:5,matroska:5,mka:5,webm:6,aac:12,flac:14,wav:13,raw_h264:8,raw_h265:9,raw_vvc:10},h={tv:1,pc:2},d={bt709:1,fcc:4,bt470bg:5,smpte170m:6,smpte240m:7,ycgco:8,gbr:0,bt2020ncl:9},l={Audio:1,Video:0,Subtitle:3,Attachment:4,Data:2},p={default:1,dub:2,original:4,comment:8,lyrics:16,karaoke:32,forced:64,"hearing impaired":128,"visual impaired":256,"clean effects":512,"attached pic":1024,"timed thumbnails":2048,captions:65536,descriptions:131072,metadata:262144,dependent:524288,"still image":1048576}},36981:(e,t,r)=>{"use strict";r.d(t,{r:()=>l});var n,i,a=r(81570),s=r(78716),o=r(134),u=r(80662),c=r.n(u),f=r(61499),h=r(12085),d=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"id",void 0),(0,o.A)(this,"name",void 0),(0,o.A)(this,"opaque",void 0)}));n=d.prototype,(i=new(c())).set("id",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("name",{0:4,1:0,2:0,3:1,4:16,5:0,6:0,7:4,8:0}),i.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,4),(0,h.A)(n,f.g7,24),(0,h.A)(n,f.JY,i);var l=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"order",void 0),(0,o.A)(this,"nbChannels",void 0),(0,o.A)(this,"u",void 0),(0,o.A)(this,"opaque",void 0)}));!function(e){var t=new(c());t.set("order",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("nbChannels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("u",{0:function(e){var t=new(c());return t.set("mask",{0:10,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("map",{0:d,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),(0,h.A)(e,f.Og,!0),(0,h.A)(e,f.dc,8),(0,h.A)(e,f.g7,8),(0,h.A)(e,f.JY,t),e}({}),1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,h.A)(e,f.Og,!0),(0,h.A)(e,f.dc,8),(0,h.A)(e,f.g7,24),(0,h.A)(e,f.JY,t)}(l.prototype)},50288:(e,t,r)=>{"use strict";r.d(t,{BU:()=>v});var n,i,a,s=r(81570),o=r(78716),u=r(134),c=r(80662),f=r.n(c),h=r(61499),d=r(12085),l=r(73783),p=(0,s.A)((function e(){(0,o.A)(this,e),(0,u.A)(this,"data",0),(0,u.A)(this,"size",0),(0,u.A)(this,"refcount",0),(0,u.A)(this,"free",0),(0,u.A)(this,"opaque",0),(0,u.A)(this,"flags",0),(0,u.A)(this,"flagsInternal",0)}));i=p.prototype,(a=new(f())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),a.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),a.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),a.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),a.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),a.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),a.set("flagsInternal",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),(0,d.A)(i,h.Og,!0),(0,d.A)(i,h.dc,4),(0,d.A)(i,h.g7,28),(0,d.A)(i,h.JY,a);var v=(0,s.A)((function e(){(0,o.A)(this,e),(0,u.A)(this,"buffer",0),(0,u.A)(this,"data",0),(0,u.A)(this,"size",0)}));!function(e){var t=new(f());t.set("buffer",{0:p,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,d.A)(e,h.Og,!0),(0,d.A)(e,h.dc,4),(0,d.A)(e,h.g7,12),(0,d.A)(e,h.JY,t)}(v.prototype);var m=(0,s.A)((function e(){(0,o.A)(this,e),(0,u.A)(this,"mutex",void 0),(0,u.A)(this,"pool",0),(0,u.A)(this,"refcount",0),(0,u.A)(this,"size",0),(0,u.A)(this,"opaque",0),(0,u.A)(this,"alloc",0),(0,u.A)(this,"alloc2",0),(0,u.A)(this,"poolFree",0)}));!function(e){var t=new(f());t.set("mutex",{0:l.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("pool",{0:n,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("refcount",{0:9,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),t.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),t.set("alloc",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),t.set("alloc2",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),t.set("poolFree",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:28,8:0}),(0,d.A)(e,h.Og,!0),(0,d.A)(e,h.dc,4),(0,d.A)(e,h.g7,32),(0,d.A)(e,h.JY,t)}(m.prototype);var g=(0,s.A)((function e(){(0,o.A)(this,e),(0,u.A)(this,"data",0),(0,u.A)(this,"opaque",0),(0,u.A)(this,"free",0),(0,u.A)(this,"pool",0),(0,u.A)(this,"next",0),(0,u.A)(this,"buffer",void 0)}));!function(e){var t=new(f());t.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("free",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),t.set("pool",{0:m,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),t.set("next",{0:g,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),t.set("buffer",{0:p,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),(0,d.A)(e,h.Og,!0),(0,d.A)(e,h.dc,4),(0,d.A)(e,h.g7,48),(0,d.A)(e,h.JY,t)}(g.prototype),n=g},77162:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var n,i,a=r(78716),s=r(81570),o=r(134),u=r(80662),c=r.n(u),f=r(61499),h=r(12085),d=r(47958),l=r(9599),p=r(36981),v=r(77231),m=r(71766),g=function(){function e(){(0,a.A)(this,e),(0,o.A)(this,"codecType",-1),(0,o.A)(this,"codecId",0),(0,o.A)(this,"codecTag",0),(0,o.A)(this,"extradata",0),(0,o.A)(this,"extradataSize",0),(0,o.A)(this,"codedSideData",0),(0,o.A)(this,"nbCodedSideData",0),(0,o.A)(this,"format",v.N_),(0,o.A)(this,"bitRate",BigInt(0)),(0,o.A)(this,"bitsPerCodedSample",0),(0,o.A)(this,"bitsPerRawSample",0),(0,o.A)(this,"profile",v.N_),(0,o.A)(this,"level",v.N_),(0,o.A)(this,"width",0),(0,o.A)(this,"height",0),(0,o.A)(this,"sampleAspectRatio",new l.P({den:1,num:1})),(0,o.A)(this,"framerate",new l.P({den:1,num:0})),(0,o.A)(this,"fieldOrder",0),(0,o.A)(this,"colorRange",0),(0,o.A)(this,"colorPrimaries",2),(0,o.A)(this,"colorTrc",2),(0,o.A)(this,"colorSpace",2),(0,o.A)(this,"chromaLocation",0),(0,o.A)(this,"videoDelay",0),(0,o.A)(this,"chLayout",void 0),(0,o.A)(this,"sampleRate",v.N_),(0,o.A)(this,"blockAlign",0),(0,o.A)(this,"frameSize",0),(0,o.A)(this,"initialPadding",0),(0,o.A)(this,"trailingPadding",0),(0,o.A)(this,"seekPreroll",0),(0,o.A)(this,"bitFormat",0)}return(0,s.A)(e,[{key:"destroy",value:function(){(0,m.dn)(this[f.o9]),this[f.o9]=0}}]),e}();n=g.prototype,(i=new(c())).set("codecType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("codecId",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),i.set("codecTag",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),i.set("extradata",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),i.set("extradataSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),i.set("codedSideData",{0:d.lg,1:1,2:1,3:0,4:0,5:0,6:0,7:20,8:0}),i.set("nbCodedSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),i.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),i.set("bitRate",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),i.set("bitsPerCodedSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),i.set("bitsPerRawSample",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),i.set("profile",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),i.set("level",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:52,8:0}),i.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),i.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:60,8:0}),i.set("sampleAspectRatio",{0:l.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),i.set("framerate",{0:l.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),i.set("fieldOrder",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),i.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),i.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),i.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),i.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:96,8:0}),i.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:100,8:0}),i.set("videoDelay",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),i.set("chLayout",{0:p.r,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),i.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),i.set("blockAlign",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),i.set("frameSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),i.set("initialPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),i.set("trailingPadding",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),i.set("seekPreroll",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:156,8:0}),i.set("bitFormat",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:160,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,8),(0,h.A)(n,f.g7,168),(0,h.A)(n,f.JY,i)},56490:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n,i,a=r(81570),s=r(78716),o=r(134),u=r(80662),c=r.n(u),f=r(61499),h=r(12085),d=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"key",0),(0,o.A)(this,"value",0)}));n=d.prototype,(i=new(c())).set("key",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("value",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,4),(0,h.A)(n,f.g7,8),(0,h.A)(n,f.JY,i);var l=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"count",0),(0,o.A)(this,"elems",0)}));!function(e){var t=new(c());t.set("count",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("elems",{0:d,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),(0,h.A)(e,f.Og,!0),(0,h.A)(e,f.dc,4),(0,h.A)(e,f.g7,8),(0,h.A)(e,f.JY,t)}(l.prototype)},55833:(e,t,r)=>{"use strict";r.d(t,{pu:()=>S});var n=r(77193),i=r(25767),a=r(43070),s=r(31060),o=r(81570),u=r(78716),c=r(134),f=r(80662),h=r.n(f),d=r(88435),l=r.n(d),p=r(61499),v=r(12085),m=r(56490),g=r(50288),A=r(9599),y=r(94300),x=r(36981),k=r(77231),b=r(56024);function w(e,t,r){return t=(0,i.A)(t),(0,n.A)(e,_()?l()(t,r||[],(0,i.A)(e).constructor):t.apply(e,r))}function _(){try{var e=!Boolean.prototype.valueOf.call(l()(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}var T,I,S=8,P=(0,o.A)((function e(){(0,u.A)(this,e),(0,c.A)(this,"type",0),(0,c.A)(this,"data",0),(0,c.A)(this,"size",0),(0,c.A)(this,"metadata",0),(0,c.A)(this,"buf",0)}));T=P.prototype,(I=new(h())).set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),I.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),I.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),I.set("metadata",{0:m.A,1:1,2:1,3:0,4:0,5:0,6:0,7:12,8:0}),I.set("buf",{0:g.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:16,8:0}),(0,v.A)(T,p.Og,!0),(0,v.A)(T,p.dc,4),(0,v.A)(T,p.g7,20),(0,v.A)(T,p.JY,I),function(e){var t=new(h());t.set("displayPrimaries",{0:A.P,1:0,2:0,3:1,4:6,5:0,6:0,7:0,8:0}),t.set("whitePoint",{0:A.P,1:0,2:0,3:1,4:2,5:0,6:0,7:48,8:0}),t.set("minLuminance",{0:A.P,1:0,2:0,3:0,4:0,5:0,6:0,7:64,8:0}),t.set("maxLuminance",{0:A.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),t.set("hasPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),t.set("hasLuminance",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),(0,v.A)(e,p.Og,!0),(0,v.A)(e,p.dc,4),(0,v.A)(e,p.g7,88),(0,v.A)(e,p.JY,t)}((0,o.A)((function e(){(0,u.A)(this,e),(0,c.A)(this,"displayPrimaries",void 0),(0,c.A)(this,"whitePoint",void 0),(0,c.A)(this,"minLuminance",void 0),(0,c.A)(this,"maxLuminance",void 0),(0,c.A)(this,"hasPrimaries",void 0),(0,c.A)(this,"hasLuminance",void 0)})).prototype),function(e){var t=new(h());t.set("maxCLL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("maxFALL",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,v.A)(e,p.Og,!0),(0,v.A)(e,p.dc,4),(0,v.A)(e,p.g7,8),(0,v.A)(e,p.JY,t)}((0,o.A)((function e(){(0,u.A)(this,e),(0,c.A)(this,"maxCLL",void 0),(0,c.A)(this,"maxFALL",void 0)})).prototype);var B=function(){function e(){(0,u.A)(this,e),(0,c.A)(this,"data",new Array(S).fill(0,0,S)),(0,c.A)(this,"linesize",new Array(S).fill(0,0,S)),(0,c.A)(this,"extendedData",0),(0,c.A)(this,"width",k.N_),(0,c.A)(this,"height",k.N_),(0,c.A)(this,"nbSamples",k.N_),(0,c.A)(this,"format",k.N_),(0,c.A)(this,"keyFrame",0),(0,c.A)(this,"pictType",0),(0,c.A)(this,"sampleAspectRatio",new A.P({den:1,num:0})),(0,c.A)(this,"pts",k.Dh),(0,c.A)(this,"pktDts",k.Dh),(0,c.A)(this,"timeBase",void 0),(0,c.A)(this,"quality",k.N_),(0,c.A)(this,"opaque",0),(0,c.A)(this,"repeatPict",k.N_),(0,c.A)(this,"interlacedFrame",k.N_),(0,c.A)(this,"topFieldFirst",k.N_),(0,c.A)(this,"paletteHasChanged",k.N_),(0,c.A)(this,"sampleRate",k.N_),(0,c.A)(this,"buf",new Array(S).fill(0,0,S)),(0,c.A)(this,"extendedBuf",0),(0,c.A)(this,"nbExtendedBuf",0),(0,c.A)(this,"sideData",0),(0,c.A)(this,"nbSideData",0),(0,c.A)(this,"flags",0),(0,c.A)(this,"colorRange",0),(0,c.A)(this,"colorPrimaries",2),(0,c.A)(this,"colorTrc",2),(0,c.A)(this,"colorSpace",2),(0,c.A)(this,"chromaLocation",0),(0,c.A)(this,"bestEffortTimestamp",k.Dh),(0,c.A)(this,"pktPos",k.Dh),(0,c.A)(this,"metadata",0),(0,c.A)(this,"decodeErrorFlags",0),(0,c.A)(this,"pktSize",k.N_),(0,c.A)(this,"hwFramesCtx",0),(0,c.A)(this,"opaqueRef",0),(0,c.A)(this,"cropTop",0),(0,c.A)(this,"cropBottom",0),(0,c.A)(this,"cropLeft",0),(0,c.A)(this,"cropRight",0),(0,c.A)(this,"privateRef",0),(0,c.A)(this,"chLayout",void 0),(0,c.A)(this,"duration",BigInt(0))}return(0,o.A)(e,[{key:"close",value:function(){(0,b.to)(this[p.o9]),(0,y.A)(this)}}]),e}();!function(e){var t=new(h());t.set("data",{0:2,1:1,2:1,3:1,4:8,5:0,6:0,7:0,8:0}),t.set("linesize",{0:15,1:0,2:0,3:1,4:8,5:0,6:0,7:32,8:0}),t.set("extendedData",{0:2,1:1,2:2,3:0,4:0,5:0,6:0,7:64,8:0}),t.set("width",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:68,8:0}),t.set("height",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),t.set("nbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:76,8:0}),t.set("format",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),t.set("keyFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:84,8:0}),t.set("pictType",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),t.set("sampleAspectRatio",{0:A.P,1:0,2:0,3:0,4:0,5:0,6:0,7:92,8:0}),t.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:104,8:0}),t.set("pktDts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:112,8:0}),t.set("timeBase",{0:A.P,1:0,2:0,3:0,4:0,5:0,6:0,7:120,8:0}),t.set("quality",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:128,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:132,8:0}),t.set("repeatPict",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:136,8:0}),t.set("interlacedFrame",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:140,8:0}),t.set("topFieldFirst",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:144,8:0}),t.set("paletteHasChanged",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:148,8:0}),t.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:152,8:0}),t.set("buf",{0:g.BU,1:1,2:1,3:1,4:8,5:0,6:0,7:156,8:0}),t.set("extendedBuf",{0:g.BU,1:1,2:2,3:0,4:0,5:0,6:0,7:188,8:0}),t.set("nbExtendedBuf",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:192,8:0}),t.set("sideData",{0:P,1:1,2:2,3:0,4:0,5:0,6:0,7:196,8:0}),t.set("nbSideData",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:200,8:0}),t.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:204,8:0}),t.set("colorRange",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:208,8:0}),t.set("colorPrimaries",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:212,8:0}),t.set("colorTrc",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:216,8:0}),t.set("colorSpace",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:220,8:0}),t.set("chromaLocation",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:224,8:0}),t.set("bestEffortTimestamp",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:232,8:0}),t.set("pktPos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:240,8:0}),t.set("metadata",{0:m.A,1:1,2:1,3:0,4:0,5:0,6:0,7:248,8:0}),t.set("decodeErrorFlags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:252,8:0}),t.set("pktSize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:256,8:0}),t.set("hwFramesCtx",{0:g.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:260,8:0}),t.set("opaqueRef",{0:g.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:264,8:0}),t.set("cropTop",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:268,8:0}),t.set("cropBottom",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:272,8:0}),t.set("cropLeft",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:276,8:0}),t.set("cropRight",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:280,8:0}),t.set("privateRef",{0:g.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:284,8:0}),t.set("chLayout",{0:x.r,1:0,2:0,3:0,4:0,5:0,6:0,7:288,8:0}),t.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:312,8:0}),(0,v.A)(e,p.Og,!0),(0,v.A)(e,p.dc,8),(0,v.A)(e,p.g7,320),(0,v.A)(e,p.JY,t)}(B.prototype),function(e){var t=new(h());t.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:320,8:0}),(0,v.A)(e,p.Og,!0),(0,v.A)(e,p.dc,8),(0,v.A)(e,p.g7,328),(0,v.A)(e,p.JY,t)}(function(e){function t(){var e;(0,u.A)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=w(this,t,[].concat(n)),(0,c.A)((0,a.A)(e),"refCount",void 0),e}return(0,s.A)(t,e),(0,o.A)(t)}(B).prototype)},47958:(e,t,r)=>{"use strict";r.d(t,{lg:()=>w});var n=r(77193),i=r(25767),a=r(43070),s=r(31060),o=r(81570),u=r(78716),c=r(134),f=r(80662),h=r.n(f),d=r(88435),l=r.n(d),p=r(61499),v=r(12085),m=r(50288),g=r(9599),A=r(77231);function y(e,t,r){return t=(0,i.A)(t),(0,n.A)(e,x()?l()(t,r||[],(0,i.A)(e).constructor):t.apply(e,r))}function x(){try{var e=!Boolean.prototype.valueOf.call(l()(Boolean,[],(function(){})))}catch(e){}return(x=function(){return!!e})()}var k,b,w=(0,o.A)((function e(){(0,u.A)(this,e),(0,c.A)(this,"data",0),(0,c.A)(this,"size",A.N_),(0,c.A)(this,"type",-1)}));k=w.prototype,(b=new(h())).set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),b.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),b.set("type",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,v.A)(k,p.Og,!0),(0,v.A)(k,p.dc,4),(0,v.A)(k,p.g7,12),(0,v.A)(k,p.JY,b);var _=(0,o.A)((function e(){(0,u.A)(this,e),(0,c.A)(this,"buf",0),(0,c.A)(this,"pts",A.Dh),(0,c.A)(this,"dts",A.Dh),(0,c.A)(this,"data",0),(0,c.A)(this,"size",0),(0,c.A)(this,"streamIndex",A.N_),(0,c.A)(this,"flags",0),(0,c.A)(this,"sideData",0),(0,c.A)(this,"sideDataElems",0),(0,c.A)(this,"duration",A.Dh),(0,c.A)(this,"pos",A.Dh),(0,c.A)(this,"opaque",0),(0,c.A)(this,"opaqueRef",0),(0,c.A)(this,"timeBase",new g.P({den:A.SF,num:1})),(0,c.A)(this,"bitFormat",0)}));!function(e){var t=new(h());t.set("buf",{0:m.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("pts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),t.set("dts",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),t.set("data",{0:2,1:1,2:1,3:0,4:0,5:0,6:0,7:24,8:0}),t.set("size",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:28,8:0}),t.set("streamIndex",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),t.set("flags",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:36,8:0}),t.set("sideData",{0:w,1:1,2:1,3:0,4:0,5:0,6:0,7:40,8:0}),t.set("sideDataElems",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:44,8:0}),t.set("duration",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:48,8:0}),t.set("pos",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:56,8:0}),t.set("opaque",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:64,8:0}),t.set("opaqueRef",{0:m.BU,1:1,2:1,3:0,4:0,5:0,6:0,7:68,8:0}),t.set("timeBase",{0:g.P,1:0,2:0,3:0,4:0,5:0,6:0,7:72,8:0}),t.set("bitFormat",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:80,8:0}),(0,v.A)(e,p.Og,!0),(0,v.A)(e,p.dc,8),(0,v.A)(e,p.g7,88),(0,v.A)(e,p.JY,t)}(_.prototype),function(e){var t=new(h());t.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:88,8:0}),(0,v.A)(e,p.Og,!0),(0,v.A)(e,p.dc,8),(0,v.A)(e,p.g7,96),(0,v.A)(e,p.JY,t)}(function(e){function t(){var e;(0,u.A)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=y(this,t,[].concat(n)),(0,c.A)((0,a.A)(e),"refCount",void 0),e}return(0,s.A)(t,e),(0,o.A)(t)}(_).prototype)},10278:(e,t,r)=>{"use strict";r.d(t,{A:()=>x});var n=r(77193),i=r(25767),a=r(43070),s=r(31060),o=r(81570),u=r(78716),c=r(134),f=r(80662),h=r.n(f),d=r(88435),l=r.n(d),p=r(61499),v=r(12085);function m(e,t,r){return t=(0,i.A)(t),(0,n.A)(e,g()?l()(t,r||[],(0,i.A)(e).constructor):t.apply(e,r))}function g(){try{var e=!Boolean.prototype.valueOf.call(l()(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}var A,y,x=(0,o.A)((function e(){(0,u.A)(this,e),(0,c.A)(this,"data",void 0),(0,c.A)(this,"linesize",void 0),(0,c.A)(this,"nbSamples",void 0),(0,c.A)(this,"maxnbSamples",void 0),(0,c.A)(this,"channels",void 0),(0,c.A)(this,"sampleRate",void 0),(0,c.A)(this,"timestamp",void 0),(0,c.A)(this,"duration",void 0)}));A=x.prototype,(y=new(h())).set("data",{0:2,1:1,2:2,3:0,4:0,5:0,6:0,7:0,8:0}),y.set("linesize",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),y.set("nbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),y.set("maxnbSamples",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:12,8:0}),y.set("channels",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:16,8:0}),y.set("sampleRate",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:20,8:0}),y.set("timestamp",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:24,8:0}),y.set("duration",{0:19,1:0,2:0,3:0,4:0,5:0,6:0,7:32,8:0}),(0,v.A)(A,p.Og,!0),(0,v.A)(A,p.dc,8),(0,v.A)(A,p.g7,40),(0,v.A)(A,p.JY,y),function(e){var t=new(h());t.set("refCount",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:40,8:0}),(0,v.A)(e,p.Og,!0),(0,v.A)(e,p.dc,8),(0,v.A)(e,p.g7,48),(0,v.A)(e,p.JY,t)}(function(e){function t(){var e;(0,u.A)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=m(this,t,[].concat(n)),(0,c.A)((0,a.A)(e),"refCount",void 0),e}return(0,s.A)(t,e),(0,o.A)(t)}(x).prototype)},81238:(e,t,r)=>{"use strict";var n;r.d(t,{G:()=>n}),function(e){e[e.SUBTITLE_NONE=0]="SUBTITLE_NONE",e[e.SUBTITLE_TEXT=1]="SUBTITLE_TEXT",e[e.SUBTITLE_WEBVTT=2]="SUBTITLE_WEBVTT",e[e.SUBTITLE_ASS=3]="SUBTITLE_ASS"}(n||(n={}))},9599:(e,t,r)=>{"use strict";r.d(t,{P:()=>d});var n,i,a=r(81570),s=r(78716),o=r(134),u=r(80662),c=r.n(u),f=r(61499),h=r(12085),d=(0,a.A)((function e(t){(0,s.A)(this,e),(0,o.A)(this,"num",1),(0,o.A)(this,"den",1),t&&(this.den=t.den,this.num=t.num)}));n=d.prototype,(i=new(c())).set("num",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("den",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,4),(0,h.A)(n,f.g7,8),(0,h.A)(n,f.JY,i)},37815:(e,t,r)=>{"use strict";r.d(t,{A6:()=>g,D$:()=>d,Q7:()=>v,VG:()=>l,aw:()=>h,us:()=>m});var n=r(14686),i=r(63939),a=r(50932),s=r(37837),o=r(40046),u=r(73783),c=r(52699),f=1;function h(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=(0,s.Gy)(28);if(!u)return 0;var c=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;a.M[20](e,t),a.M[15](e+4,r),a.M[20](e+12,n),a.M[20](e+16,i),o.M_(e+8,1,9,2),a.M[15](e+20,u);var c=(0,s.Gy)(12);return c?(a.M[20](c,e),a.M[20](c+4,t),a.M[15](c+8,r),c):0}(u,e,t,r,n,i);return c||((0,s.Eb)(u),0)}function d(e){return h((0,s.sY)(e),e)}function l(e){var t=(0,s.Gy)(12);return(0,n.Mr)(t,e,12),o.WQ(i.f[20](e)+8,1,9,2),t}function p(e,t){var r=i.f[20](i.f[20](e));if(t?((0,n.Mr)(i.f[20](e),i.f[20](t),12),(0,s.aI)(t)):(0,s.aI)(e),1===o.jb(r+8,1,9,2)){var a=!(2&i.f[15](r+24));i.f[20](r+16)?A(i.f[20](r+16),i.f[20](r)):(0,s.Eb)(i.f[20](r)),a&&(0,s.Eb)(r)}}function v(e){e&&i.f[20](e)&&p(e,0)}function m(e,t){var r=i.f[20](e);if(!t)return v(e),0;if(r&&i.f[20](r+4)===i.f[20](t+4))return a.M[20](r+4,i.f[20](t+4)),a.M[15](r+8,i.f[15](t+8)),0;var n=l(t);return v(e),a.M[20](e,n),0}function g(e,t){if(!i.f[20](e)){var r=h((0,s.cz)(0,t),t);return a.M[20](e,r),a.M[15](i.f[20](r)+24,i.f[15](i.f[20](r)+24)|f),0}var u=i.f[20](e),d=i.f[20](u);if(i.f[15](u+8)===t)return 0;if(!(i.f[15](d+24)&f&&function(e){return 1&i.f[15](i.f[20](e)+20)?0:1===o.Hh(i.f[20](e)+8,9,2)?1:0}(u)&&i.f[20](u+4)===i.f[20](d))){var l=c.z(4);a.M[20](l,0);var v=g(l,t);return v<0?(c.t(4),v):((0,n.Mr)(i.f[20](i.f[20](l)+4),i.f[20](d),Math.min(t,i.f[15](d+4))),p(e,l),c.t(4),0)}var m=(0,s.cz)(i.f[20](d),t);return a.M[20](u+4,m),a.M[20](d,m),a.M[15](u+8,t),a.M[15](d+4,t),0}function A(e,t){var r=e,n=i.f[20](r+12);u.s2(n),a.M[20](r+16,i.f[20](n+4)),a.M[20](n+4,r),u.Tl(n),1===o.jb(n+8,1,9,2)&&function(e){!function(e){for(;i.f[20](e+4);){var t=i.f[20](e+4);a.M[20](e+4,i.f[20](t+16)),i.f[20](t+4)?A(i.f[20](t+4),i.f[20](t)):(0,s.Eb)(i.f[20](t)),(0,s.Eb)(t)}}(e),u.zr(e),(0,s.Eb)(e)}(n)}},73749:(e,t,r)=>{"use strict";r.d(t,{AO:()=>c,IH:()=>u,a5:()=>h});var n=r(63939),i=r(50932),a=r(11473),s=r(14686),o=r(37837);function u(e){c(n.f[20](e)),(0,o.aI)(e)}function c(e){if(e){for(;i.M[15](e,n.f[15](e)-1),n.f[15](e)+1;)(0,o.aI)(n.f[20](e+4)+8*n.f[15](e)),(0,o.aI)(n.f[20](e+4)+8*n.f[15](e)+4);(0,o.aI)(e+4)}}function f(e,t){var r=0;return e?(t&&(r=1+(t-n.f[20](e+4)>>>3)),r>=n.f[15](e)?0:n.f[20](e+4)+8*r):0}function h(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!e)throw new Error("m is nullptr");var u=0;if(64&o&&(u=function(e,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!e)return 0;var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!t)return 0;for(;i=f(e,i);){var a=(0,s.lH)(n.f[20](i));if(1&r&&(a.toLocaleLowerCase(),t.toLocaleLowerCase()),a===t||2&r&&0===a.indexOf(t))return i}}(e,t,0,o)),u){if(16&o)return 0;32&o&&(r="".concat((0,s.lH)(n.f[20](u+4)),",").concat(r)),a.s_.free(n.f[20](u+4)),i.M[20](u+4,a.s_.malloc(r.length+1)),(0,s.qW)(n.f[20](u+4),r,r.length)}else{var c=a.s_.realloc(n.f[20](e+4),8*(n.f[15](e)+1));i.M[20](e+4,c),i.M[20](n.f[20](e+4)+8*n.f[15](e),a.s_.malloc(t.length+1)),i.M[20](n.f[20](e+4)+8*n.f[15](e)+4,a.s_.malloc(r.length+1)),(0,s.qW)(n.f[20](n.f[20](e+4)+8*n.f[15](e)),t,t.length),(0,s.qW)(n.f[20](n.f[20](e+4)+8*n.f[15](e)+4),r,r.length),i.M[15](e,n.f[15](e)+1)}return 0}},56024:(e,t,r)=>{"use strict";r.d(t,{FP:()=>l,_h:()=>m,aH:()=>v,rh:()=>g,to:()=>A,xj:()=>p});var n=r(63939),i=r(50932),a=r(55833),s=r(37837),o=r(14686),u=r(77231),c=r(37815),f=r(73749),h=r(66788),d=r(9705);function l(){var e=(0,s.Gy)(320);return m(e),e}function p(e){A(e),(0,s.Eb)(e)}function v(e,t){for(var r=0;r<n.f[15](e+200);r++)if(n.f[15](n.f[20](n.f[20](e+196)+4*r))===t)return n.f[20](n.f[20](e+196)+4*r);return 0}function m(e){n.f[20](e+64)!==e&&(0,s.aI)(e+64),(0,o.sO)(e,0,320),i.M[17](e+104,u.Dh),i.M[17](e+112,u.Dh),i.M[17](e+232,u.Dh),i.M[17](e+240,u.Dh),i.M[15](e+256,-1),i.M[15](e+84,1),i.M[15](e+92,0),i.M[15](e+96,1),i.M[15](e+80,-1),i.M[20](e+64,e),i.M[15](e+212,2),i.M[15](e+216,2),i.M[15](e+220,2),i.M[15](e+208,0),i.M[15](e+224,0),i.M[15](e+204,0)}function g(e,t){var r=(0,h.K0)(n.f[15](e+80)),o=n.f[15](e+292),u=r?o:1,f=0;if(!n.f[15](e+32)){if((f=(0,h.f8)(n.f[15](e+80),o,n.f[15](e+76),t))<0)return f;i.M[15](e+32,f)}if(u>a.pu){if(i.M[20](e+64,(0,s.sY)(4*u)),i.M[20](e+188,(0,s.sY)(4*u)),!n.f[20](e+188)||!n.f[20](e+64))return(0,s.aI)(e+64),(0,s.aI)(e+188),d.gR;i.M[15](e+192,u-a.pu)}else i.M[20](e+64,e);for(var l=0;l<Math.min(u,a.pu);l++){if(i.M[20](e+156+4*l,(0,c.D$)(n.f[15](e+32))),!n.f[20](e+156+4*l))return A(e),d.gR;i.M[20](n.f[20](e+64)+4*l,n.f[20](n.f[20](e+156+4*l)+4)),i.M[20](e+4*l,n.f[20](n.f[20](e+156+4*l)+4))}for(var p=0;p<u-a.pu;p++){if(i.M[20](n.f[20](e+188)+4*p,(0,c.D$)(n.f[15](e+32))),!n.f[20](n.f[20](e+188)+4*p))return A(e),d.gR;i.M[20](n.f[20](e+64)+(p+a.pu),n.f[20](n.f[20](n.f[20](e+188)+4*p)+4))}}function A(e){!function(e){for(var t=0;t<n.f[15](e+200);t++)r=n.f[20](e+196)+4*t,void 0,a=n.f[20](r),(0,c.Q7)(a+16),(0,f.IH)(a+12),(0,s.aI)(r);var r,a;i.M[15](e+200,0),(0,s.aI)(e+196)}(e);for(var t=0;t<8;t++)(0,c.Q7)(e+156+4*t);for(var r=0;r<n.f[15](e+192);r++)(0,c.Q7)(n.f[20](e+188)+4*r);(0,s.aI)(e+188),(0,f.IH)(e+248),(0,c.Q7)(e+260),(0,c.Q7)(e+264),(0,c.Q7)(e+284),m(e)}},71517:(e,t,r)=>{"use strict";r.d(t,{E4:()=>p,Is:()=>m,NX:()=>I,NZ:()=>y,Ow:()=>v,Pd:()=>x,Qe:()=>A,Up:()=>_,Zx:()=>T,_5:()=>g,fQ:()=>d,iI:()=>f,rN:()=>w,rU:()=>h,zu:()=>k});var n=r(14686),i=r(63939),a=r(50932),s=r(37837),o=r(77231),u=r(37815),c=64;function f(e,t){return t?(0,n.JW)(i.f[20](e+24),i.f[15](e+28)):(0,n.s3)(i.f[20](e+24),i.f[15](e+28))}function h(e,t){for(var r=0;r<i.f[15](e+44);r++)if(i.f[15](i.f[20](e+40)+12*r+8)===t)return i.f[20](e+40)+12*r;return 0}function d(e,t){for(var r=0;r<i.f[15](e+44);r++)if(i.f[15](i.f[20](e+40)+12*r+8)===t)return!0;return!1}function l(e,t,r,o,u){for(var c=i.f[15](t),f=i.f[20](e),h=0;h<c;h++)if(i.f[15](f+12*h+8)===r)return(0,s.Eb)(i.f[20](f+12*h)),a.M[20](f+12*h,o),void a.M[15](f+12*h+4,u);var d=12*(c+1),l=(0,s.Gy)(d);if(c)for(var p=0;p<c;p++)(0,n.Mr)(l+12*p,f+12*p,12);var v=l+12*c;return a.M[20](v,o),a.M[15](v+8,r),a.M[15](v+4,u),f&&(0,s.Eb)(f),a.M[20](e,l),a.M[15](t,c+1),v}function p(e,t,r,i){var a=(0,s.sY)(i+c);return(0,n.sO)(a+i,0,c),l(e,t,r,a,i)}function v(e,t,r,n){l(e+40,e+44,t,r,n)}function m(e,t){for(var r=-1,o=0;o<i.f[15](e+44);o++)if(i.f[15](i.f[20](e+40)+12*o+8)===t){r=o;break}if(r>-1)if(1===i.f[15](e+44))(0,s.Eb)(i.f[20](i.f[20](e+40))),(0,s.Eb)(i.f[20](e+40)),a.M[20](e+40,0),a.M[15](e+44,0);else{for(var u=12*(i.f[15](e+44)-1),c=(0,s.Gy)(u),f=0;f<i.f[15](e+44);f++)f!==r?(0,n.Mr)(c+12*f,i.f[20](e+40)+12*f,12):(0,s.Eb)(i.f[20](i.f[20](e+40)+12*f));(0,s.Eb)(i.f[20](e+40)),a.M[20](e+40,c),a.M[15](e+44,i.f[15](e+44)-1)}}function g(){var e=(0,s.Gy)(88);return x(e),e}function A(e){_(e),(0,s.Eb)(e)}function y(e,t){var r=i.f[20](e),n=i.f[15](t);if(r){for(var o=0;o<n;o++)(0,s.Eb)(i.f[20](r+12*o));(0,s.aI)(e),a.M[15](t,0)}}function x(e){a.M[20](e+24,0),a.M[15](e+28,0),a.M[20](e+40,0),a.M[15](e+44,0),a.M[15](e+32,o.N_),a.M[17](e+56,o.Dh),a.M[17](e+48,o.Dh),a.M[15](e+36,0),a.M[17](e+16,o.Dh),a.M[17](e+8,o.Dh),a.M[15](e+76,o.SF),a.M[15](e+72,1),a.M[15](e+80,0),a.M[20](e,0)}function k(e,t){return a.M[15](e+32,i.f[15](t+32)),a.M[17](e+56,i.f[17](t+56)),a.M[17](e+48,i.f[17](t+48)),a.M[15](e+36,i.f[15](t+36)),a.M[17](e+16,i.f[17](t+16)),a.M[17](e+8,i.f[17](t+8)),a.M[20](e+64,i.f[20](t+64)),a.M[15](e+76,i.f[15](t+76)),a.M[15](e+72,i.f[15](t+72)),a.M[15](e+80,i.f[15](t+80)),a.M[20](e+68,0),(0,u.us)(e+68,i.f[20](t+68)),function(e,t){if(y(e+40,e+44),i.f[15](t+44)){a.M[20](e+40,(0,s.Gy)(12*i.f[15](t+44)));for(var r=0;r<i.f[15](t+44);r++)a.M[15](i.f[20](e+40)+12*r+4,i.f[15](i.f[20](t+40)+12*r+4)),a.M[15](i.f[20](e+40)+12*r+8,i.f[15](i.f[20](t+40)+12*r+8)),a.M[20](i.f[20](e+40)+12*r,(0,s.sY)(i.f[15](i.f[20](t+40)+12*r+4))),(0,n.Mr)(i.f[20](i.f[20](e+40)+12*r),i.f[20](i.f[20](t+40)+12*r),i.f[15](i.f[20](t+40)+12*r+4));a.M[15](e+44,i.f[15](t+44))}}(e,t),0}function b(e,t){return(0,u.A6)(e,t+c),(0,n.sO)(i.f[20](i.f[20](e)+4)+t,0,c),0}function w(e,t){return i.f[20](e)&&(0,u.Q7)(e),a.M[20](e,0),k(e,t),!i.f[20](t)&&i.f[15](t+28)?(b(e,i.f[15](t+28)),i.f[15](t+28)&&(0,n.Mr)(i.f[20](i.f[20](e)+4),i.f[20](t+24),i.f[15](t+28)),a.M[20](e+24,i.f[20](i.f[20](e)+4))):i.f[20](t)&&(a.M[20](e,(0,u.VG)(i.f[20](t))),a.M[20](e+24,i.f[20](t+24))),a.M[15](e+28,i.f[15](t+28)),0}function _(e){y(e+40,e+44),(0,u.Q7)(e+68),i.f[20](e)?(0,u.Q7)(e):i.f[20](e+24)&&(0,s.Eb)(i.f[20](e+24)),x(e)}function T(e,t){i.f[20](e)&&(0,u.Q7)(e),a.M[20](e,0),!i.f[20](t)&&i.f[15](t+28)?(b(e,i.f[15](t+28)),i.f[15](t+28)&&(0,n.Mr)(i.f[20](i.f[20](e)+4),i.f[20](t+24),i.f[15](t+28)),a.M[20](e+24,i.f[20](i.f[20](e)+4))):i.f[20](t)&&(a.M[20](e,(0,u.VG)(i.f[20](t))),a.M[20](e+24,i.f[20](t+24))),a.M[15](e+28,i.f[15](t+28))}function I(e,t,r){i.f[20](e)?(0,u.Q7)(e):i.f[20](e+24)&&(0,s.Eb)(i.f[20](e+24)),a.M[20](e,(0,u.aw)(t,r+c)),a.M[20](e+24,t),a.M[15](e+28,r)}},99991:(e,t,r)=>{"use strict";r.d(t,{ML:()=>f,bl:()=>c});var n=r(63939),i=r(50932),a=r(85103),s=r(37837),o=r(14686),u=r(9705);function c(e){2==n.f[15](e)&&(0,s.aI)(e+8),(0,o.sO)(e,0,24)}function f(e,t){return t?(i.M[15](e,1),i.M[15](e+4,(0,a.Xb)(BigInt(t>>>0))),i.M[10](e+8,BigInt(t>>>0)),0):u.UY}},71766:(e,t,r)=>{"use strict";r.d(t,{Yi:()=>f,dn:()=>h});var n=r(14686),i=r(63939),a=r(50932),s=r(37837),o=r(99991),u=r(71517),c=r(77231);function f(e,t){a.M[15](e,i.f[15](t)),a.M[15](e+4,i.f[15](t+4)),a.M[8](e+8,i.f[8](t+8)),a.M[15](e+28,i.f[15](t+28)),a.M[17](e+32,i.f[17](t+32)),a.M[15](e+40,i.f[15](t+40)),a.M[15](e+44,i.f[15](t+44)),a.M[15](e+48,i.f[15](t+48)),a.M[15](e+52,i.f[15](t+52)),a.M[15](e+56,i.f[15](t+56)),a.M[15](e+60,i.f[15](t+60)),a.M[15](e+68,i.f[15](t+68)),a.M[15](e+64,i.f[15](t+64)),a.M[15](e+80,i.f[15](t+80)),a.M[15](e+84,i.f[15](t+84)),a.M[15](e+88,i.f[15](t+88)),a.M[15](e+92,i.f[15](t+92)),a.M[15](e+96,i.f[15](t+96)),a.M[15](e+100,i.f[15](t+100)),a.M[15](e+104,i.f[15](t+104)),(0,n.Mr)(e+112,t+112,24),a.M[15](e+136,i.f[15](t+136)),a.M[15](e+140,i.f[15](t+140)),a.M[15](e+144,i.f[15](t+144)),a.M[15](e+148,i.f[15](t+148)),a.M[15](e+152,i.f[15](t+152)),a.M[15](e+156,i.f[15](t+156)),(0,n.Mr)(e+72,t+72,8),i.f[20](t+12)&&(i.f[20](e+12)&&(0,s.Eb)(i.f[20](e+12)),a.M[20](e+12,(0,s.sY)(i.f[15](t+16))),a.M[15](e+16,i.f[15](t+16)),(0,n.Mr)(i.f[20](e+12),i.f[20](t+12),i.f[15](t+16))),i.f[20](t+20)&&function(e,t,r,o){if(r){for(var u=(0,s.Gy)(12*o),c=0;c<o;c++)a.M[15](u+12*c+8,i.f[15](r+12*c+8)),a.M[15](u+12*c+4,i.f[15](r+12*c+4)),a.M[20](u+12*c,(0,s.sY)(i.f[15](r+12*c+4))),(0,n.Mr)(u+12*c,r+12*c,i.f[15](r+12*c+4));a.M[15](t,o),a.M[20](e,u)}}(e+20,e+24,i.f[20](t+20),i.f[15](t+24))}function h(e){e&&(function(e){i.f[20](e+12)&&(0,s.aI)(e+12),(0,o.bl)(e+112),(0,u.NZ)(e+20,e+24),(0,n.sO)(e,0,168),a.M[15](e,-1),a.M[15](e+4,0),a.M[15](e+28,-1),a.M[15](e+112,0),a.M[15](e+80,0),a.M[15](e+84,0),a.M[15](e+88,2),a.M[15](e+92,2),a.M[15](e+96,2),a.M[15](e+100,0),a.M[15](e+64,0),a.M[15](e+68,1),a.M[15](e+72,0),a.M[15](e+72,1),a.M[15](e+48,c.N_),a.M[15](e+52,c.N_)}(e),(0,s.Eb)(e))}},85103:(e,t,r)=>{"use strict";function n(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,(e+=e>>8)+(e>>16)&63}function i(e){return n(Number(0xffffffffn&e))+n(Number(e>>BigInt(32)&0xffffffffn))}function a(e){var t=e/BigInt(1e3),r=e-t*BigInt(1e3);return Number(t)+Number(r)/1e3}function s(e,t){return e+t-1&~(t-1)}r.d(t,{An:()=>s,Xb:()=>i,yw:()=>a})},23991:(e,t,r)=>{"use strict";function n(e){for(var t=0;t<32&&0===e.readU1();)t++;return e.readU(t)+((1<<t)-1)}function i(e){var t=n(e);return 1&t?(t+1)/2:-t/2}r.d(t,{$x:()=>i,xb:()=>n})},39381:(e,t,r)=>{"use strict";r.d(t,{E3:()=>a,Sg:()=>c,Y0:()=>u,ht:()=>o,r8:()=>i,yd:()=>s});var n=r(63939);function i(e){return n.f[2](e)}function a(e){return i(e+1)<<8|i(e)}function s(e){return i(e)<<8|i(e+1)}function o(e){return i(e)<<16|i(e+1)<<8|i(e+2)}function u(e){return a(e+2)<<16|a(e)}function c(e){return s(e)<<16|s(e+2)}},37837:(e,t,r)=>{"use strict";r.d(t,{Eb:()=>h,Gy:()=>f,aI:()=>d,cz:()=>l,sY:()=>c});var n=r(11473),i=r(63939),a=r(50932),s=r(14686),o=r(4624),u="src/avutil/util/mem.ts";function c(e){var t=n.s_.malloc(e);return t||o.h2("can not alloc buffer",u,32),t}function f(e){var t=n.s_.malloc(e);return t||o.h2("can not alloc buffer",u,40),(0,s.sO)(t,0,e),t}function h(e){n.s_.free(e)}function d(e){n.s_.free(i.f[20](e)),a.M[20](e,0)}function l(e,t){return n.s_.realloc(e,t)}},60264:(e,t,r)=>{"use strict";function n(e){return e.length>4&&0===e[0]&&0===e[1]&&(1===e[2]||0===e[2]&&1===e[3])}function i(e,t){for(var r=0,n=t;n<e.length;n++)switch(e[n]){case 0:r++;break;case 1:if(r>=2)return{offset:n-Math.min(r,3),startCode:Math.min(r+1,4)};r=0;break;default:r=0}return{offset:-1,startCode:0}}function a(e){for(var t=[],r=i(e,0),n={offset:-1,startCode:0};(n=i(e,r.offset+r.startCode)).offset>-1;)t.push(e.subarray(r.offset+r.startCode,n.offset,!0)),r=n;return t.push(e.subarray(r.offset+r.startCode,void 0,!0)),t}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;r||(r=e.length);for(var n=new Uint8Array(e.length),i=0,a=0,s=0;s<e.length;s++){if(s>=t&&s<r)if(0===e[s])i++;else if(3===e[s]&&2===i&&s+1<e.length&&e[s+1]<=3){if(++s===e.length)break;i=0===e[s]?1:0}else i=0;n[a++]=e[s]}return n.slice(0,a)}r.d(t,{BN:()=>s,Bs:()=>n,Ky:()=>i,py:()=>a})},44328:(e,t,r)=>{"use strict";r.d(t,{Vt:()=>o,iU:()=>u,k:()=>a,lb:()=>s});var n=r(63939),i=r(31658);function a(e,t,r){return e*BigInt(t.num>>>0)*BigInt(r.den>>>0)/(BigInt(t.den>>>0)*BigInt(r.num>>>0))}function s(e){return e.num/e.den}function o(e){return n.f[15](e)/n.f[15](e+4)}function u(e){var t=(0,i.A)(e.num,e.den);t<=1||(e.den/=t,e.num/=t)}},66788:(e,t,r)=>{"use strict";r.d(t,{K0:()=>s,f8:()=>o});var n=r(77231),i=r(85103),a=r(58055);function s(e){return!(e<0||e>=12)&&a.J[e].planar}function o(e,t,r,o){var u=function(e){return e<0||e>=12?0:a.J[e].bits>>3}(e),c=s(e);return!u||r<=0||t<=0?-1:(o||(o=1,r=(0,i.An)(r,32)),t>n.go/o||t*r>(n.go-o*t)/u?-1:c?(0,i.An)(r*u,o):(0,i.An)(r*u*t,o))}},95007:(e,t,r)=>{"use strict";r.d(t,{A:()=>k});var n=r(78716),i=r(81570),a=r(134),s=r(95335),o=r(72739),u=r(73783),c=r(7417),f=r(4624),h="src/cheap/allocator/AllocatorJS.ts",d=2,l=T(16),p=32,v=1+2*p,m=1,g=0,A=2,y=1,x=m+v+2,k=function(){function e(t){var r,i,o,u,c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,n.A)(this,e),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"byteOffset",void 0),(0,a.A)(this,"heapOffset",void 0),(0,a.A)(this,"heapLength",void 0),(0,a.A)(this,"int32Array",void 0),(0,a.A)(this,"updates",void 0),(0,a.A)(this,"options",void 0),(0,a.A)(this,"shared",void 0),(0,a.A)(this,"handles",void 0),this.options=s.extend({growSize:1048576,maxHeapSize:2097152e3},t),this.handles=[],this.buffer=t.buffer,this.shared=!1,this.options.memory||this.buffer instanceof ArrayBuffer||this.buffer instanceof SharedArrayBuffer?(this.byteOffset=null!==(r=t.byteOffset)&&void 0!==r?r:0,this.heapOffset=S(this.byteOffset+_(p),null!==(i=t.byteLength)&&void 0!==i?i:this.buffer.byteLength),this.heapLength=P((null!==(o=t.byteLength)&&void 0!==o?o:this.buffer.byteLength)-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,T(this.heapLength)),this.updates=new Int32Array(this.buffer,this.byteOffset,p),"function"==typeof SharedArrayBuffer&&this.buffer instanceof SharedArrayBuffer&&(this.shared=!0)):f.h2("Expected buffer to be an instance of Buffer or ArrayBuffer",h,109),c&&(this.updates.fill(m),function(e){return e[m-1]===v&&e[m+v]===v}(u=this.int32Array)||function(e){var t=m,r=v,n=x,i=e.length-(t+r+2+y);M(e,r,t),e[t+g]=1,e[t+A]=n;for(var a=1;a<p;a++)e[t+A+a]=m;M(e,i,n),e[n+g]=1,e[n+A]=t}(u),function(e){for(var t=x;t<e.length-y;){var r=C(e,t);r<2||r>=e.length-x?f.h2("Got invalid sized chunk at ".concat(_(t)," (").concat(_(r)," bytes)."),h,568):E(e,t)?b(e,t,r):w(e,t,r),t+=r+2}}(this.int32Array))}return(0,i.A)(e,[{key:"addUpdateHandle",value:function(e){o.zy(this.handles,e)||this.handles.push(e)}},{key:"removeUpdateHandle",value:function(e){o.TF(this.handles,e)}},{key:"malloc_",value:function(e){(e=I(e,7))<16&&(e=16);var t=T(e),r=this.findFreeBlock(this.int32Array,t);if(r<=m)return 0;var n=C(this.int32Array,r);return n-(t+2)>=l?function(e,t,r,n,i){var a=t+r+2,s=n-(a-t);U(e,t,n,i),e[t-1]=-r,e[t+r]=-r,e[a-1]=-s,e[a+s]=-s,F(e,a,s,i)}(this.int32Array,r,t,n,this.updates):U(this.int32Array,r,n,this.updates),_(r)+this.heapOffset}},{key:"malloc",value:function(e){this.shared&&((0,u.s2)(c.II,!0),this.checkBuffer());var t=this.malloc_(e);return this.shared&&(0,u.Tl)(c.II),t}},{key:"calloc_",value:function(e,t){var r=e*t;r=r<16?16:I(r,7);var n=this.malloc_(r);if(0===n)return 0;var i=T(n-this.heapOffset);return this.int32Array.subarray(i,i+T(r)).fill(0),n}},{key:"calloc",value:function(e,t){this.shared&&((0,u.s2)(c.II,!0),this.checkBuffer());var r=this.calloc_(e,t);return this.shared&&(0,u.Tl)(c.II),r}},{key:"realloc_",value:function(e,t){if(0===e)return this.malloc_(t);var r=e;if(0===t)return this.free_(r),0;var n=T(e-=this.heapOffset),i=n,a=0;D(this.int32Array,n)&&(a=n-(i=this.int32Array[n-1]));var s=C(this.int32Array,i)-a;if(s>=T(I(t,7)))return r;var o=this.malloc_(t);return 0===o?(this.free_(r),0):(this.int32Array.set(this.int32Array.subarray(n,n+s),T(o-this.heapOffset)),this.free_(r),o)}},{key:"realloc",value:function(e,t){return this.shared&&((0,u.s2)(c.II,!0),this.checkBuffer()),e=this.realloc_(e,t),this.shared&&(0,u.Tl)(c.II),e}},{key:"alignedAlloc_",value:function(e,t){if(e<=8)return this.malloc_(t);var r=this.malloc_(t+e-1+4);if(0===r)return 0;var n=r+e-1+4&~(e-1);return this.int32Array[T(n-this.heapOffset)-y]=T(r-this.heapOffset),n}},{key:"alignedAlloc",value:function(e,t){this.shared&&((0,u.s2)(c.II,!0),this.checkBuffer());var r=this.alignedAlloc_(e,t);return this.shared&&(0,u.Tl)(c.II),r}},{key:"free_",value:function(e){if(0!==e){var t=T(e-=this.heapOffset);if(D(this.int32Array,t)&&(t=this.int32Array[t-y]),!E(this.int32Array,t)){var r=C(this.int32Array,t),n=L(this.int32Array,t),i=function(e,t){var r=C(e,t);if(t+r+2>=e.length-2)return 0;var n=t+r+2;return e[n-y]<2?0:n}(this.int32Array,t);0!==n?0!==i?function(e,t,r,n,i,a){var s=C(e,t),o=C(e,i),u=i-t+o;U(e,t,s,a),U(e,i,o,a),e[t-y]=-u,e[i+o]=-u,F(e,t,u,a)}(this.int32Array,n,0,0,i,this.updates):O(this.int32Array,n,t,r,this.updates):0!==i?function(e,t,r,n,i){var a=C(e,t);U(e,t,a,i);var s=n+a+2;e[r-y]=-s,e[t+a]=-s,F(e,r,s,i)}(this.int32Array,i,t,r,this.updates):F(this.int32Array,t,r,this.updates)}}}},{key:"free",value:function(e){this.shared&&((0,u.s2)(c.II,!0),this.checkBuffer()),this.free_(e),this.shared&&(0,u.Tl)(c.II)}},{key:"sizeof",value:function(e){if(0===e)return 0;var t=T(e-=this.heapOffset);return D(this.int32Array,t)&&(t=this.int32Array[t-y]),_(C(this.int32Array,t))}},{key:"inspect",value:function(){return this.checkBuffer(),function(e,t){for(var r=[],n=B(e,m,t),i=x,a=0;i<e.length-y;){var s=C(e,i);(s<2||s>=e.length)&&f.h2("Got invalid sized chunk at ".concat(_(i)," (").concat(_(s),")"),h,624),E(e,i)?r.push(B(e,i,t)):(a+=_(s),r.push({type:"used",block:i,offset:_(i)+t,size:_(s)})),i+=s+2}return{header:n,blocks:r,total:_(e.length),used:a}}(this.int32Array,this.heapOffset)}},{key:"findFreeBlock",value:function(e,t){var r=this,n=function(e,t){for(var r=m,n=e[m+g];n>0;n--)for(var i=e[r+A+(n-1)];i!==m&&e[i-y]<t;)i=e[(r=i)+A+(n-1)];return r=e[r+A]}(e,t);if(n===m){if(this.options.growAllowed&&this.heapLength<this.options.maxHeapSize){var i,a,s=this.int32Array.length+1,u=0,c=0,f=0;if(this.options.onResize){var h,d,l,v=this.options.onResize(this.int32Array,this.int32Array.byteLength+I(Math.max(this.options.growSize,_(t)),7));f=S((u=null!==(h=v.byteOffset)&&void 0!==h?h:0)+_(p),null!==(d=v.byteLength)&&void 0!==d?d:v.buffer.byteLength),c=P((null!==(l=v.byteLength)&&void 0!==l?l:v.buffer.byteLength)-f),i=new Int32Array(v.buffer,f,T(c)),a=new Int32Array(v.buffer,u,p)}else{var x=new ArrayBuffer(this.int32Array.length+T(this.options.growSize));f=S(u+_(p),x.byteLength),c=P(x.byteLength-f),(i=new Int32Array(x,f,T(c))).set(this.int32Array,0),a=new Int32Array(x,u,p)}this.byteOffset=u,this.heapOffset=f,this.buffer=i.buffer,this.heapLength=c,this.int32Array=i,this.updates=a;var k=i.length-(s-1)-2;M(i,k,s);var b=L(i,s);return 0!==b?O(i,b,s,k,this.updates):F(i,s,k,this.updates),this.handles.length&&o.__(this.handles,(function(e){e(r.buffer)})),this.findFreeBlock(this.int32Array,t)}return n}return n}},{key:"getBuffer",value:function(){return this.buffer}},{key:"isAlloc",value:function(e){this.shared&&((0,u.s2)(c.II,!0),this.checkBuffer());for(var t=T(e-this.heapOffset),r=this.int32Array[m+A];r&&r!==m;){if(t>=r&&t<r+this.int32Array[r-y])return this.shared&&(0,u.Tl)(c.II),!1;r=this.int32Array[r+A]}return this.shared&&(0,u.Tl)(c.II),!0}},{key:"checkBuffer",value:function(){this.options.memory&&this.options.memory.buffer!==this.buffer&&(this.buffer=this.options.memory.buffer,this.heapLength=P(this.buffer.byteLength-this.heapOffset),this.int32Array=new Int32Array(this.buffer,this.heapOffset,T(this.heapLength)))}}]),e}();function b(e,t,r){e[t-1]!==e[t+r]&&f.h2("Block length header does not match footer (".concat(_(e[t-1])," vs ").concat(_(e[t+r]),")."),h,584);var n=e[t+g];(n<1||n>p)&&f.h2("Block ".concat(_(t)," height must be between 1 and ").concat(p,", got ").concat(n,"."),h,589);for(var i=0;i<n;i++){var a=e[t+A+i];a>=x&&!E(e,a)&&f.h2("Block ".concat(_(t)," has a pointer to a non-free block (").concat(_(a),")."),h,595)}return!0}function w(e,t,r){if(e[t-1]===e[t+r])return!0;f.h2("Block length header does not match footer (".concat(_(e[t-1])," vs ").concat(_(e[t+r]),")."),h,604)}function _(e){return e<<d>>>0}function T(e){return e>>>d}function I(e,t){return(e+t&~t)>>>0}function S(e,t){var r=t-e;return e+(I(r,7)===r?0:r-I(r,7)+8)}function P(e){return(m+v)%2||(e-=4),e}function B(e,t,r){for(var n=e[t+g],i=[],a=0;a<n;a++)i.push(e[t+A+a]);return{type:"free",block:t,offset:_(t)+r,height:n,pointers:i,size:_(e[t-1])}}function C(e,t){var r=e[t-1],n=r>>31;return r+n^n}function M(e,t,r){e[r-1]=t,e[r+t]=t}function R(e,t,r){for(var n=e[m+g],i=m,a=n;a>0;a--){for(var s=i+A+(a-1);e[s]>=x&&e[e[s]-1]<t;)s=(i=e[s])+A+(a-1);r[a-1]=i}}function U(e,t,r,n){R(e,r,n);for(var i=e[n[0]+A];i!==t&&i!==m&&e[i-1]<=r;){for(var a=e[i+g]-1;a>=0;a--)e[i+A+a]===t&&(n[a]=i);i=e[i+A]}for(var s=e[m+g],o=0;o<s&&e[n[o]+A+o]===t;o++)e[n[o]+A+o]=e[t+A+o];for(;s>0&&e[m+A+(s-1)]===m;)s--,e[m+g]=s;e[t-1]=-r,e[t+r]=-r}function E(e,t){return!(t<v||e[t-y]<0)}function D(e,t){return!(t<v||e[t-y]<0)}function L(e,t){if(t<=x)return 0;var r=e[t-2];return r<2?0:t-(2+r)}function F(e,t,r,n){R(e,r,n);for(var i=function(e,t,r,n){var i=e[m+g],a=function(){for(var e=1;Math.random()<.5&&e<p;)e+=1;return e}();if(r-1<a+1&&(a=r-2),a>i){var s=i+1;return e[m+g]=s,e[m+A+(s-1)]=m,n[s]=m,e[t+g]=s,s}return e[t+g]=a,a}(e,t,r,n),a=1;a<=i;a++){var s=n[a-1]+A+(a-1);e[t+A+(a-1)]=e[s],e[s]=t,n[a-1]=m}return e[t-1]=r,e[t+r]=r,r}function O(e,t,r,n,i){var a=r-t+n;return U(e,t,r-t-2,i),e[t-y]=-a,e[r+n]=-a,F(e,t,a,i),n}},94321:(e,t,r)=>{"use strict";r.d(t,{z:()=>s});var n=r(78716),i=r(81570),a=r(134),s=function(){function e(){(0,n.A)(this,e),(0,a.A)(this,"table",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"nodes",void 0),this.table=new WebAssembly.Table({initial:16,element:"anyfunc"}),this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}]}return(0,i.A)(e,[{key:"getPointer",value:function(){return this.pointer}},{key:"alloc",value:function(e){var t=this.findFree(e);if(t<0){var r=this.nodes[this.nodes.length-1],n=e-(r.free?r.length:0);this.table.grow(n),r.free?r.length=r.length+n:this.nodes.push({pointer:r.pointer+r.length,length:n,free:!0}),t=this.findFree(e)}var i=this.nodes[t];return i.length>e&&(this.nodes.splice(t+1,0,{pointer:i.pointer+e,length:i.length-e,free:!0}),i.length=e),i.free=!1,i.pointer}},{key:"free",value:function(e){var t=this.findNode(e),r=this.nodes[t];if(r&&!r.free){var n=this.nodes[t-1],i=this.nodes[t+1];n&&n.free?i&&i.free?(n.length+=r.length+i.length,this.nodes.splice(t,2)):(n.length+=r.length,this.nodes.splice(t,1)):i&&i.free?(r.length+=i.length,this.nodes.splice(t+1,1),r.free=!0):r.free=!0}if(1===this.nodes.length&&this.nodes[0].free){var a=new WebAssembly.Table({initial:16,element:"anyfunc"});this.pointer=6,this.nodes=[{pointer:this.pointer,length:10,free:!0}];for(var s=1;s<this.pointer;s++)a.set(s,this.table.get(s));this.table=a}}},{key:"get",value:function(e){return this.table.get(e)}},{key:"set",value:function(e,t){if(e<0||e>=this.pointer)throw new RangeError("index out of bound");this.table.set(e,t)}},{key:"inspect",value:function(){return this.nodes}},{key:"findFree",value:function(e){for(var t=-1,r=0;r<this.nodes.length;r++)if(this.nodes[r].length>=e&&this.nodes[r].free){t=r;break}return t}},{key:"findNode",value:function(e){for(var t=-1,r=0;r<this.nodes.length;r++)if(this.nodes[r].pointer===e){t=r;break}return t}}]),e}()},98564:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>m});var n,i=r(134),a=r(25182),s=r(36443),o=r.n(s),u=r(4919),c=r(4624),f=r(63939),h=r(50932),d=r(88096),l=r(5679),p=r.n(l),v="src/cheap/asm/memory.ts";function m(e){return g.apply(this,arguments)}function g(){return(g=(0,a.A)(o().mark((function e(t){var r,a,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=(0,u.E_)(p()),d.DD(s,"function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer),e.next=5,WebAssembly.instantiate(s,{env:{memory:t}});case 5:n=e.sent.instance,(0,f.$)((r={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(r,4,n.exports.readU8),5,n.exports.readU8),2,n.exports.readU8),3,n.exports.readU8),6,n.exports.readU16),7,n.exports.readU16),8,(function(e){return n.exports.read32(e)>>>0})),9,(function(e){return n.exports.read32(e)>>>0})),10,(function(e){return BigInt.asUintN(64,n.exports.read64(e))})),22,(function(e){return BigInt.asUintN(64,n.exports.read64(e))})),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(r,11,n.exports.read8),12,n.exports.read8),13,n.exports.read16),14,n.exports.read16),15,n.exports.read32),16,n.exports.read32),17,n.exports.read64),21,n.exports.read64),18,n.exports.readf32),19,n.exports.readf64),(0,i.A)(r,20,(function(e){return n.exports.read32(e)>>>0})))),(0,h.$)((a={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(a,4,n.exports.write8),5,n.exports.write8),2,n.exports.write8),3,n.exports.write8),6,n.exports.write16),7,n.exports.write16),8,n.exports.write32),9,n.exports.write32),10,n.exports.write64),22,n.exports.write64),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(a,11,n.exports.write8),12,n.exports.write8),13,n.exports.write16),14,n.exports.write16),15,n.exports.write32),16,n.exports.write32),17,n.exports.write64),21,n.exports.write64),18,n.exports.writef32),19,n.exports.writef64),(0,i.A)(a,20,n.exports.write32))),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),c.R8("memory asm not support, cannot use asm memory function",v,96);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}},26429:(e,t,r)=>{"use strict";r.d(t,{Gx:()=>h,YN:()=>f,ZI:()=>o,_7:()=>s,dP:()=>c,pw:()=>u});var n,i=r(95797),a=r(10576),s=!!i.A.thread&&!0!==a.TK.CHEAP_DISABLE_THREAD,o=16,u=1048576,c=1024,f=null!==(n=a.TK.CHEAP_HEAP_INITIAL)&&void 0!==n?n:265,h=65536},73281:(e,t,r)=>{"use strict";r.d(t,{A:()=>M});var n,i=r(134),a=r(59135),s=r(63939),o=r(50932),u=(0,a.A)();function c(e,t){n().setUint8(e,t)}function f(e){return n().getUint8(e)}function h(e,t){n().setUint16(e,t,u)}function d(e){return n().getUint16(e,u)}function l(e,t){n().setUint32(e,t,u)}function p(e){return n().getUint32(e,u)}function v(e,t){n().setBigUint64(e,t,u)}function m(e){return n().getBigUint64(e,u)}function g(e,t){n().setInt8(e,t)}function A(e){return n().getInt8(e)}function y(e,t){n().setInt16(e,t,u)}function x(e){return n().getInt16(e,u)}function k(e,t){n().setInt32(e,t,u)}function b(e){return n().getInt32(e,u)}function w(e,t){n().setBigInt64(e,t,u)}function _(e){return n().getBigInt64(e,u)}function T(e,t){n().setFloat32(e,t,u)}function I(e){return n().getFloat32(e,u)}function S(e,t){n().setFloat64(e,t,u)}function P(e){return n().getFloat64(e,u)}function B(e){return n().getUint32(e,u)}function C(e,t){return n().setUint32(e,t,u)}function M(e,t){var r,a;n=t,(0,s.$)((r={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(r,4,f),5,f),2,f),3,f),6,d),7,d),8,p),9,p),10,m),11,A),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(r,12,A),13,x),14,x),15,b),16,b),17,_),18,I),19,P),20,B),23,(function(e){return!!A(e)})),(0,i.A)(r,24,(function(e){return!!A(e)})))),(0,o.$)((a={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(a,4,c),5,c),2,c),3,c),6,h),7,h),8,l),9,l),10,v),11,g),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(a,12,g),13,y),14,y),15,k),16,k),17,w),18,T),19,S),20,C),23,(function(e,t){g(e,t?1:0)})),(0,i.A)(a,24,(function(e,t){g(e,t?1:0)}))))}},63939:(e,t,r)=>{"use strict";r.d(t,{$:()=>o,f:()=>s});var n,i=r(134),a=r(95335),s=(n={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,4,(function(e){throw new Error("unimplemented")})),5,(function(e){throw new Error("unimplemented")})),2,(function(e){throw new Error("unimplemented")})),3,(function(e){throw new Error("unimplemented")})),6,(function(e){throw new Error("unimplemented")})),7,(function(e){throw new Error("unimplemented")})),8,(function(e){throw new Error("unimplemented")})),9,(function(e){throw new Error("unimplemented")})),10,(function(e){throw new Error("unimplemented")})),11,(function(e){throw new Error("unimplemented")})),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,12,(function(e){throw new Error("unimplemented")})),13,(function(e){throw new Error("unimplemented")})),14,(function(e){throw new Error("unimplemented")})),15,(function(e){throw new Error("unimplemented")})),16,(function(e){throw new Error("unimplemented")})),17,(function(e){throw new Error("unimplemented")})),18,(function(e){throw new Error("unimplemented")})),19,(function(e){throw new Error("unimplemented")})),20,(function(e){throw new Error("unimplemented")})),0,(function(e){throw new Error("invalid operate")})),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,1,(function(e){throw new Error("invalid operate")})),22,(function(e){throw new Error("invalid operate")})),21,(function(e){throw new Error("invalid operate")})),23,(function(e){throw new Error("invalid operate")})),24,(function(e){throw new Error("invalid operate")})));function o(e){a.extend(s,e)}},50932:(e,t,r)=>{"use strict";r.d(t,{$:()=>o,M:()=>s});var n,i=r(134),a=r(95335),s=(n={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,4,(function(e,t){throw new Error("unimplemented")})),5,(function(e,t){throw new Error("unimplemented")})),2,(function(e,t){throw new Error("unimplemented")})),3,(function(e,t){throw new Error("unimplemented")})),6,(function(e,t){throw new Error("unimplemented")})),7,(function(e,t){throw new Error("unimplemented")})),8,(function(e,t){throw new Error("unimplemented")})),9,(function(e,t){throw new Error("unimplemented")})),10,(function(e,t){throw new Error("unimplemented")})),11,(function(e,t){throw new Error("unimplemented")})),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,12,(function(e,t){throw new Error("unimplemented")})),13,(function(e,t){throw new Error("unimplemented")})),14,(function(e,t){throw new Error("unimplemented")})),15,(function(e,t){throw new Error("unimplemented")})),16,(function(e,t){throw new Error("unimplemented")})),17,(function(e,t){throw new Error("unimplemented")})),18,(function(e,t){throw new Error("unimplemented")})),19,(function(e,t){throw new Error("unimplemented")})),20,(function(e,t){throw new Error("unimplemented")})),0,(function(e,t){throw new Error("invalid operate")})),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(n,1,(function(e,t){throw new Error("invalid operate")})),22,(function(e,t){throw new Error("invalid operate")})),21,(function(e,t){throw new Error("invalid operate")})),23,(function(e,t){throw new Error("invalid operate")})),24,(function(e,t){throw new Error("invalid operate")})));function o(e){a.extend(s,e)}},25323:(e,t,r)=>{"use strict";r.d(t,{X:()=>M,l:()=>C});var n=r(66681),i=r.n(n),a=r(11919),s=r.n(a),o=r(75019),u=r.n(o),c=r(99921),f=r(63939),h=r(50932),d=r(61499),l=r(6704),p=r(67672),v=r(95335),m=r(62100),g=r(72739);function A(e,t,r,n){i()(e,t,{get:r,set:n,configurable:!0,enumerable:!0})}function y(e){return function(){return f.f[20](e())}}function x(e,t,r,n){return function(){return e["__$__".concat(t)]||(e["__$__".concat(t)]=C(r(),n))}}function k(e,t){return function(){return f.f[t](e())}}function b(e,t,r,n){var i=8*l.i[t]-n-r,a=Math.pow(2,r)-1;return function(){return f.f[t](e())>>>i&a}}function w(e){return function(t){h.M[8](e(),t)}}function _(e,t,r,n){var i="__$__".concat(t);return function(t){var a=e[i]||(e[i]=C(r(),n));v.each(t,(function(e,t){a[t]=e})),e[i]=a}}function T(e,t){return function(r){h.M[t](e(),r)}}function I(e,t,r,n){for(var i=0,a=8*l.i[t],s=0;s<r;s++)i|=1<<a-1-(s+n);var o=Math.pow(2,r)-1,u=a-n-r;return function(r){var n=e(),a=f.f[t](n);h.M[t](n,a&~i|(r&o)<<u)}}function S(e,t,r){return function(){var n=t["__$__".concat(r)];return n[d.o9]=e(),n}}function P(e,t,r,n,i){var a="__$__".concat(t);return function(t){var s=e[a]||function(e,t,r){for(var n={},i=(0,c.A)(r),a=function(t){var a=(0,m.A)(t);A(n,a,x(n,a,(function(){return e()+i*t}),r),_(n,a,(function(){return e()+i*t}),r))},s=0;s<t;s++)a(s);return n}(r,n,i);s[d.o9]=r(),g.__(t,(function(e,t){s[t]=e})),e[a]=s}}function B(e,t,r,n,i){var a="__$__".concat(t);return function(t){var s=e[a]||function(e,t,r){for(var n={},i=(0,c.A)(r),a=function(t){var a=(0,m.A)(t);A(n,a,k((function(){return e()+i*t}),r),T((function(){return e()+i*t}),r))},s=0;s<t;s++)a(s);return n}(r,n,i);s[d.o9]=r(),g.__(t,(function(e,t){s[t]=e})),e[a]=s}}function C(e,t){var r=p.Pc(t)?t.prototype:t,n={};for(n[d.o9]=e,s()(n,r);;){var i=r[d.JY];if(i&&i.forEach((function(e,t){e[3]?e[1]?A(n,t,S((function(){return n[d.o9]+e[7]}),n,t),B(n,t,(function(){return n[d.o9]+e[7]}),e[4],20)):p.Pc(e[0])||p.Ik(e[0])?A(n,t,S((function(){return n[d.o9]+e[7]}),n,t),P(n,t,(function(){return n[d.o9]+e[7]}),e[4],e[0])):A(n,t,S((function(){return n[d.o9]+e[7]}),n,t),B(n,t,(function(){return n[d.o9]+e[7]}),e[4],e[0])):e[1]?A(n,t,y((function(){return n[d.o9]+e[7]})),w((function(){return n[d.o9]+e[7]}))):p.Pc(e[0])||p.Ik(e[0])?A(n,t,x(n,t,(function(){return n[d.o9]+e[7]}),e[0]),_(n,t,(function(){return n[d.o9]+e[7]}),e[0])):e[5]?A(n,t,b((function(){return n[d.o9]+e[7]}),e[0],e[6],e[8]),I((function(){return n[d.o9]+e[7]}),e[0],e[6],e[8])):A(n,t,k((function(){return n[d.o9]+e[7]}),e[0]),T((function(){return n[d.o9]+e[7]}),e[0]))})),!(r=u()(r)))break}return n}function M(e){for(var t=u()(e);;){var r=t[d.JY];if(r&&r.forEach((function(t,r){delete e[r]})),!(t=u()(t)))break}}},12085:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(66681),i=r.n(n);function a(e,t,r){i()(e,t,{value:r,writable:!1,enumerable:!1,configurable:!1})}},11473:(e,t,r)=>{"use strict";r.d(t,{GE:()=>k,KZ:()=>z,Tg:()=>G,XI:()=>_,ce:()=>I,eq:()=>O,hZ:()=>N,pv:()=>j,s_:()=>T,wE:()=>b});var n=r(25182),i=r(134),a=r(36443),s=r.n(a),o=r(39638),u=r(95007),c=r(94321),f=r(10576),h=r(26429),d=r(7417),l=r(33856),p=r(98564),v=r(82854),m=r(73281),g=r(54568),A=r(86834),y=-1,x="",k=null,b=null,w=0,_=null,T=null,I=null,S=null,P=null,B=null,C=null,M=null,R=null,U=null,E=null,D=null,L=(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({},5,M),3,M),7,R),9,U),22,E),12,S),14,P),16,B),21,C);function F(){return!(!I||I.buffer===M.buffer)}function O(){return F()&&W(I.buffer),M}function N(){return F()&&W(I.buffer),R}function z(){return F()&&W(I.buffer),D}function V(e){return F()&&W(I.buffer),L[e]}function W(e){S=new Int8Array(e),P=new Int16Array(e),B=new Int32Array(e),C=new BigInt64Array(e),M=new Uint8Array(e),R=new Uint16Array(e),U=new Uint32Array(e),E=new BigUint64Array(e),new Float32Array(e),new Float64Array(e),D=new DataView(e),L=(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({},5,M),3,M),7,R),9,U),22,E),12,S),14,P),16,B),21,C)}function j(){return Atomics.add(U,d.hb>>>2,1)}function G(e){return q.apply(this,arguments)}function q(){return(q=(0,n.A)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,m.A)((function(){return T}),z),(0,l.A)(V),I=t.memory,n=new u.A({buffer:I.buffer,memory:I,byteOffset:h.dP,maxHeapSize:64*h.Gx*1024,growAllowed:!0,onResize:function(e,t){return I.grow(t-e.byteLength>>>16),{buffer:I.buffer,byteOffset:h.dP}}},!1),T&&T.removeUpdateHandle(W),T=n,f.TK.CHeap&&(f.TK.CHeap.Allocator=T),T.addUpdateHandle(W),W(T.getBuffer()),t.stackPointer&&(w=t.stackSize,b=t.stackPointer,k=new WebAssembly.Global({value:"i32",mutable:!0},b+w),_=new c.z),y="number"==typeof t.id?t.id:Atomics.add(U,d.hb>>>2,1),x=null!==(r=t.name)&&void 0!==r?r:"anonymous",f.TK.CHeap={initThread:G,Allocator:T,Table:_,ThreadId:y,ThreadName:x,Memory:I,StackSize:w,StackTop:b,StackPointer:k,isMainThread:!1},t.disableAsm){e.next=17;break}if("function"!=typeof BigInt||BigInt===Number||!(A.A.chrome&&A.A.checkVersion(A.A.majorVersion,"85",!0)||A.A.firefox&&A.A.checkVersion(A.A.majorVersion,"78",!0)||A.A.safari&&A.A.checkVersion(A.A.majorVersion,"15",!0)||A.A.newEdge)){e.next=14;break}return e.next=14,(0,p.Ay)(I);case 14:if(!h._7||!(A.A.chrome&&A.A.checkVersion(A.A.majorVersion,"85",!0)||A.A.firefox&&A.A.checkVersion(A.A.majorVersion,"78",!0)||A.A.safari&&A.A.checkVersion(A.A.majorVersion,"15",!0)||A.A.newEdge)){e.next=17;break}return e.next=17,(0,v.Ay)(I);case 17:case"end":return e.stop()}var n}),e)})))).apply(this,arguments)}(0,o.A)()||(0,g.A)()?f.TK.CHeap={initThread:G,isMainThread:!1}:function(){var e,t,r,n,i,a,s,o;if((0,m.A)((function(){return T}),z),(0,l.A)(V),I=null!==(e=f.TK.CHeap)&&void 0!==e&&e.Memory?f.TK.CHeap.Memory:new WebAssembly.Memory({initial:h.YN,maximum:h.Gx,shared:h._7}),(T=null!==(t=f.TK.CHeap)&&void 0!==t&&t.Allocator?f.TK.CHeap.Allocator:new u.A({buffer:I.buffer,memory:I,byteOffset:h.dP,maxHeapSize:64*h.Gx*1024,growAllowed:!0,onResize:function(e,t){return I.grow(t-e.byteLength>>>16),{buffer:I.buffer,byteOffset:h.dP}}})).addUpdateHandle(W),W(T.getBuffer()),w=null!==(r=f.TK.CHeap)&&void 0!==r&&r.StackSize?f.TK.CHeap.StackSize:h.pw,b=null!==(n=f.TK.CHeap)&&void 0!==n&&n.StackTop?f.TK.CHeap.StackTop:T.malloc(w),k=null!==(i=f.TK.CHeap)&&void 0!==i&&i.StackPointer?f.TK.CHeap.StackPointer:new WebAssembly.Global({value:"i32",mutable:!0},b+w),_=null!==(a=f.TK.CHeap)&&void 0!==a&&a.Table?f.TK.CHeap.Table:new c.z,y=null!==(s=f.TK.CHeap)&&void 0!==s&&s.ThreadId?f.TK.CHeap.ThreadId:0,x=null!==(o=f.TK.CHeap)&&void 0!==o&&o.ThreadName?f.TK.CHeap.ThreadName:"main",!f.TK.CHeap)if(h._7)Atomics.store(U,d.hb>>>2,y+1),Atomics.store(B,d.II>>>2,0);else{U[d.hb>>>2]=y+1;var g=d.II>>>2;B[g]=0}"function"==typeof BigInt&&BigInt!==Number&&(A.A.chrome&&A.A.checkVersion(A.A.majorVersion,"85",!0)||A.A.firefox&&A.A.checkVersion(A.A.majorVersion,"78",!0)||A.A.safari&&A.A.checkVersion(A.A.majorVersion,"15",!0)||A.A.newEdge)&&(0,p.Ay)(I),h._7&&(A.A.chrome&&A.A.checkVersion(A.A.majorVersion,"85",!0)||A.A.firefox&&A.A.checkVersion(A.A.majorVersion,"78",!0)||A.A.safari&&A.A.checkVersion(A.A.majorVersion,"15",!0)||A.A.newEdge)&&(0,v.Ay)(I),f.TK.CHeap||(f.TK.CHeap={Allocator:T,Table:_,ThreadId:y,ThreadName:x,Memory:I,StackSize:w,StackTop:b,StackPointer:k,isMainThread:!0,threadCounter:d.hb,heapMutex:d.II})}()},80098:(e,t,r)=>{"use strict";r.d(t,{I_:()=>A,SQ:()=>y});var n=r(75019),i=r.n(n),a=r(11919),s=r.n(a),o=r(99921),u=r(63939),c=r(50932),f=r(61499),h=r(6704),d=r(67672),l=r(95335),p=r(72739),v=r(2148),m=i()({});function g(e,t){for(;;){var r=e[f.JY];if(r){var n=r.get(t);if(n)return n}if(!(e=i()(e))||e===m)return null}}function A(e,t){var r=d.Pc(t)?t.prototype:t,n={};n[f.o9]=e,s()(n,r);var i=Proxy.revocable(n,{get:function(e,t,n){if(d.Yj(t)){var i=g(r,t.replace(/^\$+/,""));if(i){var a=e[f.o9]+i[7];if(i[3]){var s=e[t];return s[f.o9]=a,s}if(i[1])return u.f[20](a);if(d.Pc(i[0])||d.Ik(i[0]))return e[t]||(e[t]=A(a,i[0]));var o=u.f[i[0]](a);return i[5]&&(o=o>>>8*h.i[i[0]]-i[8]-i[6]&Math.pow(2,i[6])-1),o}return e[t]}return e[t]},set:function(e,t,n,i){if(d.Yj(t)){var a=g(r,t.replace(/^\$+/,""));if(a){var s=e[f.o9]+a[7];if(a[3]){var m=e[t]||function(e,t,r,n){var i={};i[f.o9]=e;var a=(0,o.A)(n?20:r);return new Proxy(i,{get:function(e,t,i){if(t===f.o9)return e[f.o9];var s=(0,v.A)(t);return n?u.f[20](e[f.o9]+s*a):d.Pc(r)?e[t]:u.f[r](e[f.o9]+s*a)},set:function(e,t,i,s){if(t===f.o9)return e[f.o9]=i,!0;var o=(0,v.A)(t);if(n)c.M[20](e[f.o9]+o*a,i),e[t]=i;else if(d.Pc(r)){var u=e[t]||(e[t]=A(e[f.o9]+o*a,r));l.each(i,(function(e,t){u[t]=e})),e[t]=u}else c.M[r](e[f.o9]+o*a,i),e[t]=i;return!0}})}(s,a[4],a[0],a[1]);p.__(n,(function(e,t){m[t]=e})),e[t]=m}else if(a[1])c.M[20](s,n),e[t]=n;else if(d.Pc(a[0])||d.Ik(a[0])){var y=e[t]||(e[t]=A(s,a[0]));l.each(n,(function(e,t){y[t]=e})),e[t]=y}else{if(a[5]){for(var x=0,k=8*h.i[a[0]],b=0;b<a[6];b++)x|=1<<k-1-(b+a[8]);var w=u.f[a[0]](s);c.M[a[0]](s,w&~x|(n&Math.pow(2,a[6])-1)<<k-a[8]-a[6])}else c.M[a[0]](s,n);e[t]=n}}else e[t]=n}else e[t]=n;return!0}}),a=i.proxy,m=i.revoke;return n[f.kE]=m,a}function y(e){var t=e[f.kE];t&&t()}},52699:(e,t,r)=>{"use strict";r.d(t,{t:()=>a,z:()=>i});var n=r(11473);function i(e){return n.GE.value-=e,n.GE.value}function a(e){n.GE.value+=e}},7417:(e,t,r)=>{"use strict";r.d(t,{II:()=>c,hb:()=>u,z1:()=>o});var n,i,a=r(10576),s=1;function o(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=s;r%t;)r+=1;return s=r+e,r}var u=null!==(n=a.TK.CHeap)&&void 0!==n&&n.threadCounter?a.TK.CHeap.threadCounter:o(4,4),c=null!==(i=a.TK.CHeap)&&void 0!==i&&i.heapMutex?a.TK.CHeap.heapMutex:o(4,4)},79630:(e,t,r)=>{"use strict";r.d(t,{A:()=>y});var n=r(88435),i=r.n(n),a=r(77193),s=r(25767),o=r(43070),u=r(31060),c=r(78716),f=r(81570),h=r(134),d=r(63939),l=r(50932),p=r(11473),v=r(61403);function m(e,t,r){return t=(0,s.A)(t),(0,a.A)(e,g()?i()(t,r||[],(0,s.A)(e).constructor):t.apply(e,r))}function g(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(g=function(){return!!e})()}var A=function(){function e(t,r){(0,c.A)(this,e),(0,h.A)(this,"pointer",void 0),(0,h.A)(this,"len",void 0),this.pointer=t,this.len=r}return(0,f.A)(e,[{key:"byteLength",get:function(){return this.len}},{key:"buffer",get:function(){return(0,p.eq)().buffer}},{key:"byteOffset",get:function(){return this.pointer}},{key:"getFloat32",value:function(e,t){return(0,p.KZ)().getFloat32(this.pointer+e,t)}},{key:"getFloat64",value:function(e,t){return(0,p.KZ)().getFloat64(this.pointer+e,t)}},{key:"getInt8",value:function(e){return(0,p.KZ)().getInt8(this.pointer+e)}},{key:"getInt16",value:function(e,t){return(0,p.KZ)().getInt16(this.pointer+e,t)}},{key:"getInt32",value:function(e,t){return(0,p.KZ)().getInt32(this.pointer+e,t)}},{key:"getUint8",value:function(e){return(0,p.KZ)().getUint8(this.pointer+e)}},{key:"getUint16",value:function(e,t){return(0,p.KZ)().getUint16(this.pointer+e,t)}},{key:"getUint32",value:function(e,t){return(0,p.KZ)().getUint32(this.pointer+e,t)}},{key:"setFloat32",value:function(e,t,r){(0,p.KZ)().setFloat32(this.pointer+e,t,r)}},{key:"setFloat64",value:function(e,t,r){(0,p.KZ)().setFloat64(this.pointer+e,t,r)}},{key:"setInt8",value:function(e,t){(0,p.KZ)().setInt8(this.pointer+e,t)}},{key:"setInt16",value:function(e,t,r){(0,p.KZ)().setInt16(this.pointer+e,t,r)}},{key:"setInt32",value:function(e,t,r){(0,p.KZ)().setInt32(this.pointer+e,t,r)}},{key:"setUint8",value:function(e,t){(0,p.KZ)().setUint8(this.pointer+e,t)}},{key:"setUint16",value:function(e,t,r){(0,p.KZ)().setUint16(this.pointer+e,t,r)}},{key:"setUint32",value:function(e,t,r){(0,p.KZ)().setUint32(this.pointer+e,t,r)}},{key:"getBigInt64",value:function(e,t){return(0,p.KZ)().getBigInt64(this.pointer+e,t)}},{key:"getBigUint64",value:function(e,t){return(0,p.KZ)().getBigUint64(this.pointer+e,t)}},{key:"setBigInt64",value:function(e,t,r){(0,p.KZ)().setBigInt64(this.pointer+e,t,r)}},{key:"setBigUint64",value:function(e,t,r){(0,p.KZ)().setBigUint64(this.pointer+e,t,r)}}]),e}(),y=function(e){function t(e,r){var n;return(0,c.A)(this,t),n=m(this,t),(0,h.A)((0,o.A)(n),"pointer",void 0),(0,h.A)((0,o.A)(n),"len",void 0),n.pointer=e,n.len=r,(0,a.A)(n,n.proxy)}return(0,u.A)(t,e),(0,f.A)(t,[{key:"getIndexValue",value:function(e){return d.f[2](this.pointer+e)}},{key:"setIndexValue",value:function(e,t){l.M[2](this.pointer+e,t)}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,p.eq)().set(e,this.pointer+t)}},{key:"subarray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1?arguments[1]:void 0;return(arguments.length>2?arguments[2]:void 0)?new t(this.pointer+e,(r||this.len)-e):(0,p.eq)().subarray(this.pointer+e,this.pointer+(null!=r?r:this.len))}},{key:"slice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return(0,p.eq)().slice(this.pointer+e,this.pointer+(null!=t?t:this.len))}},{key:"length",get:function(){return this.len}},{key:"byteLength",get:function(){return this.len}},{key:"buffer",get:function(){return(0,p.eq)().buffer}},{key:"byteOffset",get:function(){return this.pointer}},{key:"view",get:function(){return new A(this.pointer,this.len)}}]),t}(v.A)},12264:(e,t,r)=>{"use strict";r.d(t,{A:()=>x});var n,i,a=r(81570),s=r(78716),o=r(134),u=r(80662),c=r.n(u),f=r(61499),h=r(12085),d=r(11473),l=r(63939),p=r(50932),v=r(99921),m=r(14686),g=r(67672),A=r(29170),y=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"prev",void 0),(0,o.A)(this,"next",void 0),(0,o.A)(this,"data",void 0)}));n=y.prototype,(i=new(c())).set("prev",{0:y,1:1,2:1,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("next",{0:y,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),i.set("data",{0:1,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,4),(0,h.A)(n,f.g7,12),(0,h.A)(n,f.JY,i);var x=function(){function e(){(0,s.A)(this,e),(0,o.A)(this,"length",0),(0,o.A)(this,"head",0),(0,o.A)(this,"tail",0)}return(0,a.A)(e,[{key:"createNode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=d.s_.malloc(12);if(p.M[20](n+4,0),p.M[20](n,0),g.ai(t))if(20===t)p.M[20](n+8,e);else{var i=d.s_.malloc((0,v.A)(t));p.M[t](i,e),p.M[20](n+8,i)}else if(r)p.M[20](n+8,e);else{var a=d.s_.malloc((0,v.A)(t));(0,m.Mr)(a,e[f.o9],(0,v.A)(t)),p.M[20](n+8,a)}return n}},{key:"getItem",value:function(e,t){return g.ai(t)?20===t?e:l.f[t](e):(0,A.A)(e,t)}},{key:"push",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.createNode(e,t,r);this.tail?(p.M[20](this.tail+4,n),p.M[20](n,this.tail),this.tail=n):(this.head=n,this.tail=n),this.length++}},{key:"pop",value:function(e){var t=this.tail,r=this.getItem(l.f[20](t+8),e);return this.length>1?(p.M[20](l.f[20](t)+4,0),this.tail=l.f[20](t)):(this.head=0,this.tail=0),this.length--,d.s_.free(l.f[20](t+8)),d.s_.free(t),r}},{key:"shift",value:function(e){var t=this.head,r=this.getItem(l.f[20](t+8),e);return this.length>1?(p.M[20](l.f[20](t+4),0),this.head=l.f[20](t+4)):(this.head=0,this.tail=0),this.length--,d.s_.free(l.f[20](t+8)),d.s_.free(t),r}},{key:"unshift",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.createNode(e,t,r);this.head?(p.M[20](this.head,n),p.M[20](n+4,this.head),this.head=n):(this.head=n,this.tail=n),this.length++}},{key:"forEach",value:function(e,t){if(this.length)for(var r=this.head,n=0;0!==r&&!1!==e(this.getItem(l.f[20](r+8),t),n);)r=l.f[20](r+4),n++}},{key:"find",value:function(e,t){if(!this.length)return 0;for(var r=this.head,n=0;0!==r;){var i=this.getItem(l.f[20](r+8),t);if(!0===e(i,n))return i;r=l.f[20](r+4),n++}return 0}},{key:"indexOf",value:function(e,t){if(!this.length)return 0;for(var r=this.head,n=0;0!==r;){if(n===e)return this.getItem(l.f[20](r+8),t);r=l.f[20](r+4),n++}return 0}},{key:"clear",value:function(e,t){if(this.length)for(var r=this.head;0!==r;){e&&e(this.getItem(l.f[20](r+8),t)),d.s_.free(l.f[20](r+8));var n=l.f[20](r+4);d.s_.free(r),r=n}this.head=0,this.tail=0,this.length=0}}]),e}();!function(e){var t=new(c());t.set("length",{0:8,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),t.set("head",{0:y,1:1,2:1,3:0,4:0,5:0,6:0,7:4,8:0}),t.set("tail",{0:y,1:1,2:1,3:0,4:0,5:0,6:0,7:8,8:0}),(0,h.A)(e,f.Og,!0),(0,h.A)(e,f.dc,4),(0,h.A)(e,f.g7,12),(0,h.A)(e,f.JY,t)}(x.prototype)},72703:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(67672);function i(e){return n.ai(e)&&e>=0}},74503:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(99921),i=r(11473),a=r(14686),s=r(95335),o=r(34677),u=r(29170);function c(e,t){var r=(0,n.A)(e),c=i.s_.malloc(r);if(!c)throw new TypeError("cannot alloc memory for struct");(0,a.sO)(c,0,r);var f=(0,u.A)(c,e),h=new e;return t&&s.extend(h,t),s.each(h,(function(e,t){(0,o.A)(e)&&(f[t]=e)})),f}},14686:(e,t,r)=>{"use strict";r.d(t,{JW:()=>d,Mr:()=>c,bg:()=>p,lH:()=>v,lW:()=>f,qW:()=>m,s3:()=>l,sO:()=>h});var n=r(11473),i=r(70812),a=r(50011),s=r(50932),o=r(79630),u=r(26429);function c(e,t,r){(0,n.eq)().set((0,n.eq)().subarray(t,t+r),e)}function f(e,t,r){(0,n.eq)().set(r.subarray(0,t),e)}function h(e,t,r){(0,n.eq)().subarray(e,e+r).fill(t)}function d(e,t){return u._7?l(e,t):new o.A(e,t)}function l(e,t){return(0,n.eq)().subarray(e,e+t)}function p(e,t){return(0,n.hZ)().subarray(e>>>1,(e>>>1)+t)}function v(e,t){var r=(0,i.b2)(e),n=Math.min(r,null!=t?t:r);return a.decode(l(e,n))}function m(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=a.encode(t),o=i.length,u=n?1:0;r&&o-u>r&&(o=r-u),f(e,o,i),n&&s.M[11](e+o,0)}},99921:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(61499),i=r(67672),a=r(6704);function s(e){return i.ai(e)?a.i[e]||0:i.Pc(e)&&e.prototype[n.Og]?e.prototype[n.g7]:0}},70812:(e,t,r)=>{"use strict";r.d(t,{b2:()=>i});var n=r(63939);function i(e){for(var t=0;n.f[4]((e+=1)-1);)t++;return t}},29170:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(61499),i=r(80098),a=r(25323),s=r(95797),o=r(67672),u=r(10534);function c(e,t){return arguments[2]&&o.Yj(arguments[2])&&(t=t.prototype,u.__(arguments[2],(function(e){var r=t[n.JY];t=r.get(e)[0]}))),s.A.proxy?(0,i.I_)(e,t):(0,a.l)(e,t)}},94300:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(11473),i=r(61499),a=r(80098),s=r(25323),o=r(95797);function u(e){var t=e[i.o9];t&&(n.s_.free(t),e[i.o9]=0,o.A.proxy?(0,a.SQ)(e):(0,s.X)(e))}},61499:(e,t,r)=>{"use strict";r.d(t,{JY:()=>c,Og:()=>a,dc:()=>o,g7:()=>s,kE:()=>f,o9:()=>u});var n=r(75062),i=r.n(n),a=i()("Struct"),s=i()("StructLength"),o=i()("StructMaxBaseTypeByteLength"),u=i()("StructAddress"),c=(i()("StructKeysQueue"),i()("StructKeysMeta")),f=(i()("StructKeysInstance"),i()("StructProxyRevoke"))},82854:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>v,KJ:()=>n,Ko:()=>p});var n,i=r(25182),a=r(36443),s=r.n(a),o=r(4919),u=r(4624),c=r(88096),f=r(19985),h=r.n(f),d=r(40046),l="src/cheap/thread/asm/atomics.ts";function p(){return!!n}function v(e){return m.apply(this,arguments)}function m(){return(m=(0,i.A)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer)){e.next=9;break}return r=(0,o.E_)(h()),c.DD(r,!0),e.next=6,WebAssembly.instantiate(r,{env:{memory:t}});case 6:n=e.sent.instance,e.next=10;break;case 9:return e.abrupt("return");case 10:(0,d.$Z)({add:function(e,t,r){switch(r){case 5:case 3:return 255&n.exports.add8(e,t);case 12:return n.exports.add8(e,t);case 14:return n.exports.add16(e,t);case 7:return 65535&n.exports.add16(e,t);case 16:return n.exports.add32(e,t);case 9:return 4294967295&n.exports.add32(e,t);case 21:return n.exports.add64(e,t);case 22:return BigInt.asUintN(64,n.exports.add64(e,t))}},sub:function(e,t,r){switch(r){case 5:case 3:return 255&n.exports.sub8(e,t);case 12:return n.exports.sub8(e,t);case 14:return n.exports.sub16(e,t);case 7:return 65535&n.exports.sub16(e,t);case 16:return n.exports.sub32(e,t);case 9:return 4294967295&n.exports.sub32(e,t);case 21:return n.exports.sub64(e,t);case 22:return BigInt.asUintN(64,n.exports.sub64(e,t))}},and:function(e,t,r){switch(r){case 5:case 3:return 255&n.exports.and8(e,t);case 12:return n.exports.and8(e,t);case 14:return n.exports.and16(e,t);case 7:return 65535&n.exports.and16(e,t);case 16:return n.exports.and32(e,t);case 9:return 4294967295&n.exports.and32(e,t);case 21:return n.exports.and64(e,t);case 22:return BigInt.asUintN(64,n.exports.and64(e,t))}},or:function(e,t,r){switch(r){case 5:case 3:return 255&n.exports.or8(e,t);case 12:return n.exports.or8(e,t);case 14:return n.exports.or16(e,t);case 7:return 65535&n.exports.or16(e,t);case 16:case 9:return n.exports.or32(e,t);case 21:return n.exports.or64(e,t);case 22:return BigInt.asUintN(64,n.exports.or64(e,t))}},xor:function(e,t,r){switch(r){case 5:case 3:return 255&n.exports.xor8(e,t);case 12:return n.exports.xor8(e,t);case 14:return n.exports.xor16(e,t);case 7:return 65535&n.exports.xor16(e,t);case 16:case 9:return n.exports.xor32(e,t);case 21:return n.exports.xor64(e,t);case 22:return BigInt.asUintN(64,n.exports.xor64(e,t))}},store:function(e,t,r){switch(r){case 5:case 12:case 3:return n.exports.store8(e,t);case 14:case 7:return n.exports.store16(e,t);case 16:case 9:return n.exports.store32(e,t);case 21:case 22:return n.exports.store64(e,t)}},load:function(e,t){switch(t){case 5:case 3:return 255&n.exports.load8(e);case 12:return n.exports.load8(e);case 14:case 7:return n.exports.load16(e);case 16:return n.exports.load32(e);case 9:return 4294967295&n.exports.load32(e);case 21:return n.exports.load64(e);case 22:return BigInt.asUintN(64,n.exports.load64(e))}},compareExchange:function(e,t,r,i){switch(i){case 5:case 3:return 255&n.exports.compare_exchange8(e,t,r);case 12:return n.exports.compare_exchange8(e,t,r);case 14:return n.exports.compare_exchange16(e,t,r);case 7:return 65535&n.exports.compare_exchange16(e,t,r);case 16:return n.exports.compare_exchange32(e,t,r);case 9:return 4294967295&n.exports.compare_exchange32(e,t,r);case 21:return n.exports.compare_exchange64(e,t,r);case 22:return BigInt.asUintN(64,n.exports.compare_exchange64(e,t,r))}},exchange:function(e,t,r){switch(r){case 5:case 3:return 255&n.exports.exchange8(e,t);case 12:return n.exports.exchange8(e,t);case 14:return n.exports.exchange16(e,t);case 7:return 65535&n.exports.exchange16(e,t);case 16:return n.exports.exchange32(e,t);case 9:return 4294967295&n.exports.exchange32(e,t);case 21:return n.exports.exchange64(e,t);case 22:return BigInt.asUintN(64,n.exports.exchange64(e,t))}},notify:function(e,t){return n.exports.notify(e,t)},wait:function(e,t){return n.exports.wait(e,t)},waitTimeout:function(e,t,r){return n.exports.waitTimeout(e,t,BigInt(r>>>0))}}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),u.R8("atomics asm not support, cannot use asm atomics function",l,284);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}},40046:(e,t,r)=>{"use strict";var n,i,a,s,o,u,c,f,h,d,l,p;function v(e){e.add&&(n=e.add),e.sub&&(i=e.sub),e.and&&(a=e.and),e.or&&(s=e.or),e.xor&&(o=e.xor),e.store&&(u=e.store),e.load&&(c=e.load),e.compareExchange&&(f=e.compareExchange),e.exchange&&(h=e.exchange),e.notify&&(d=e.notify),e.wait&&(l=e.wait),e.waitTimeout&&(p=e.waitTimeout),e.waitAsync&&e.waitAsync,e.waitTimeoutAsync&&e.waitTimeoutAsync}r.d(t,{$Z:()=>v,Hh:()=>c,I8:()=>o,M_:()=>u,Uo:()=>a,WQ:()=>n,cv:()=>h,j4:()=>p,jb:()=>i,me:()=>d,or:()=>s,p_:()=>f,uk:()=>l})},33856:(e,t,r)=>{"use strict";r.d(t,{A:()=>U});var n,i=r(25182),a=r(36443),s=r.n(a),o=r(54001),u=r.n(o),c=r(86932),f=r(7972),h=r(40046),d=r(26429),l=r(39638),p=r(86834),v=d._7||(0,l.A)()||!p.A.chrome||p.A.checkVersion(p.A.majorVersion,"94",!0);function m(e,t,r,i){if(v)return Atomics.add(n(r),e>>>i,t);var a=n(r),s=e>>>i,o=a[s];return a[s]+=t,o}function g(e,t,r,i){if(v)return Atomics.sub(n(r),e>>>i,t);var a=n(r),s=e>>>i,o=a[s];return a[s]-=t,o}function A(e,t,r,i){if(v)return Atomics.and(n(r),e>>>i,t);var a=n(r),s=e>>>i,o=a[s];return a[s]&=t,o}function y(e,t,r,i){if(v)return Atomics.or(n(r),e>>>i,t);var a=n(r),s=e>>>i,o=a[s];return a[s]|=t,o}function x(e,t,r,i){if(v)return Atomics.xor(n(r),e>>>i,t);var a=n(r),s=e>>>i,o=a[s];return a[s]^=t,o}function k(e,t,r,i){if(v)return Atomics.store(n(r),e>>>i,t);var a=n(r),s=e>>>i,o=a[s];return a[s]=t,o}function b(e,t,r){return v?Atomics.load(n(t),e>>>r):n(t)[e>>>r]}function w(e,t,r,i,a){if(v)return Atomics.compareExchange(n(i),e>>>a,t,r);var s=n(i),o=e>>>a,u=s[o];return u===t&&(s[o]=r),u}function _(e,t,r,i){if(v)return Atomics.exchange(n(r),e>>>i,t);var a=n(r),s=e>>>i,o=a[s];return a[s]=t,o}function T(e,t){return v?Atomics.notify(n(16),e>>>2,t):void 0}var I={ok:0,"not-equal":1,"timed-out":2};function S(e,t){return I[Atomics.wait(n(16),e>>>2,t)]}function P(e,t,r){return I[Atomics.wait(n(16),e>>>2,t,r)]}function B(e,t){return C.apply(this,arguments)}function C(){return(C=(0,i.A)(s().mark((function e(t,r){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Atomics.waitAsync){e.next=10;break}if(!(i=Atomics.waitAsync(n(16),t>>>2,r)).async){e.next=7;break}return e.next=5,i.value;case 5:return e.t0=e.sent,e.abrupt("return",I[e.t0]);case 7:return e.abrupt("return",I[i.value]);case 10:if(b(t)===r){e.next=14;break}return e.abrupt("return",1);case 14:if(b(t)!==r){e.next=19;break}return e.next=17,new(u())((function(e){(0,f.A)((function(){e()}))}));case 17:e.next=14;break;case 19:return e.abrupt("return",0);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,r){return R.apply(this,arguments)}function R(){return(R=(0,i.A)(s().mark((function e(t,r,i){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Atomics.waitAsync){e.next=10;break}if(!(a=Atomics.waitAsync(n(16),t>>>2,r,i)).async){e.next=7;break}return e.next=5,a.value;case 5:return e.t0=e.sent,e.abrupt("return",I[e.t0]);case 7:return e.abrupt("return",I[a.value]);case 10:if(b(t)===r){e.next=14;break}return e.abrupt("return",1);case 14:o=(0,c.A)();case 15:if(!(b(t)===r&&(0,c.A)()-o<i)){e.next=20;break}return e.next=18,new(u())((function(e){(0,f.A)((function(){e()}))}));case 18:e.next=15;break;case 20:return e.abrupt("return",b(t)!==r?0:2);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){n=e,(0,h.$Z)({add:m,sub:g,and:A,or:y,xor:x,store:k,load:b,compareExchange:w,exchange:_,notify:T,wait:S,waitTimeout:P,waitAsync:B,waitTimeoutAsync:M})}},42518:(e,t,r)=>{"use strict";r.d(t,{Ts:()=>p,XR:()=>y,mq:()=>g,uk:()=>A,vP:()=>m,zr:()=>v}),r(25182);var n,i,a=r(81570),s=r(78716),o=r(134),u=(r(36443),r(80662)),c=r.n(u),f=r(61499),h=r(12085),d=r(73783),l=r(40046);function p(e,t){return l.M_(e,0,16,2),0}function v(e){return l.M_(e,0,16,2),0}function m(e){return l.WQ(e,1,16,2),l.me(e,1),0}function g(e){return l.WQ(e,1,16,2),l.me(e,1073741824),0}function A(e,t){var r=l.Hh(e,16,2);return d.Tl(t),l.uk(e,r),d.s2(t),0}function y(e,t,r){var n=l.Hh(e,16,2);d.Tl(t);var i=l.j4(e,n,r);return d.s2(t),2===i?110:0}n=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"atomic",void 0)})).prototype,(i=new(c())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,4),(0,h.A)(n,f.g7,4),(0,h.A)(n,f.JY,i)},81574:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var n=r(6837),i=r(25182),a=r(36443),s=r.n(a),o=r(84149),u=r(10576),c=r(67672),f=u.TK;function h(e){var t,r;f.onmessage=function(a){var h,d=a.data,l=d.type,p=d.data;switch(l){case"init":if(u.TK.CHeap&&u.TK.CHeap.initThread)return void u.TK.CHeap.initThread(p).then((function(){f.postMessage({type:"ready"})}));f.postMessage({type:"ready"});break;case"run":f.postMessage({type:"running"}),r=e(p.params),h=p.port,(t=new o.Ay(h)).on(o.S3,function(){var e=(0,i.A)(s().mark((function e(i){var a,o,u,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.method,o=i.params,!c.Pc(r[a])){e.next=15;break}return e.prev=3,r[a].transfer||(r[a].transfer=[]),e.next=7,(u=r)[a].apply(u,(0,n.A)(o.params));case 7:f=e.sent,t.reply(i,f,null,r[a].transfer),r[a].transfer.length=0,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),t.reply(i,-2097152,{message:e.t0.message});case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}());break;case"stop":t&&t.destroy(),f.postMessage({type:"stopped"})}}}},26848:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var n=r(10576),i=n.TK;function a(e){var t;i.onmessage=function(r){var a=r.data,s=a.type,o=a.data;switch(s){case"init":if(n.TK.CHeap&&n.TK.CHeap.initThread)return void n.TK.CHeap.initThread(o).then((function(){i.postMessage({type:"ready"})}));i.postMessage({type:"ready"});break;case"run":t=e(o.params);break;case"stop":t&&t.then?t.then((function(e){i.postMessage({type:"stopped",data:e})})):i.postMessage({type:"stopped",data:t})}}}},67524:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var n=r(6837),i=r(25182),a=r(36443),s=r.n(a),o=r(84149),u=r(10576),c=r(67672),f=u.TK;function h(e){var t;f.onmessage=function(r){var a,h=r.data,d=h.type,l=h.data;switch(d){case"init":if(u.TK.CHeap&&u.TK.CHeap.initThread)return void u.TK.CHeap.initThread(l).then((function(){f.postMessage({type:"ready"})}));f.postMessage({type:"ready"});break;case"run":f.postMessage({type:"running"}),a=l.port,(t=new o.Ay(a)).on(o.S3,function(){var r=(0,i.A)(s().mark((function r(i){var a,o,u;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=i.method,o=i.params,!c.Pc(e[a])){r.next=15;break}return r.prev=3,e[a].transfer||(e[a].transfer=[]),r.next=7,e[a].apply(e,(0,n.A)(o.params));case 7:u=r.sent,t.reply(i,u,null,e[a].transfer),e[a].transfer.length=0,r.next=15;break;case 12:r.prev=12,r.t0=r.catch(3),t.reply(i,-2097152,{message:r.t0.message});case 15:case"end":return r.stop()}}),r,null,[[3,12]])})));return function(e){return r.apply(this,arguments)}}());break;case"stop":t&&t.destroy(),f.postMessage({type:"stopped"})}}}},73783:(e,t,r)=>{"use strict";r.d(t,{Tl:()=>A,Ts:()=>v,bh:()=>g,eu:()=>p,s2:()=>m,zr:()=>y}),r(25182);var n,i,a=r(81570),s=r(78716),o=r(134),u=(r(36443),r(80662)),c=r.n(u),f=r(61499),h=r(12085),d=r(40046),l=r(39638),p=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"atomic",void 0)}));function v(e){return d.M_(e,0,16,2),0}function m(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0!==(t=d.p_(e,0,1,16,2)))do{2!=t&&0===d.p_(e,1,2,16,2)||!r&&(0,l.A)()&&d.uk(e,2)}while(0!==(t=d.p_(e,0,2,16,2)));return 0}function g(e){return 0===d.p_(e,0,1,16,2)?0:16}function A(e){return 1!==d.jb(e,1,16,2)&&(d.M_(e,0,16,2),d.me(e,1)),0}function y(e){return d.M_(e,0,16,2),0}n=p.prototype,(i=new(c())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,4),(0,h.A)(n,f.g7,4),(0,h.A)(n,f.JY,i)},79490:(e,t,r)=>{"use strict";r.d(t,{Ts:()=>m,XR:()=>k,Zr:()=>x,bE:()=>A,uk:()=>y,zr:()=>g}),r(25182);var n,i,a=r(81570),s=r(78716),o=r(134),u=(r(36443),r(80662)),c=r.n(u),f=r(61499),h=r(12085),d=r(73783),l=r(63939),p=r(50932),v=r(40046);function m(e,t){return v.M_(e,0|t,16,2),d.Ts(e+4),0}function g(e){return d.zr(e+4),0}function A(e){return v.WQ(e,1,16,2),v.me(e,1),0}function y(e){for(;v.uk(e,0),v.jb(e,1,16,2)<=0;)v.WQ(e,1,16,2);return 0}function x(e){return d.s2(e+4),l.f[16](e)>0?(p.M[16](e,l.f[16](e)-1),d.Tl(e+4),0):(d.Tl(e+4),11)}function k(e,t){return 2!==v.j4(e,0,t)&&v.jb(e,1,16,2)<=0?(v.WQ(e,1,16,2),110):0}n=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"atomic",void 0),(0,o.A)(this,"mutex",void 0)})).prototype,(i=new(c())).set("atomic",{0:16,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("mutex",{0:d.eu,1:0,2:0,3:0,4:0,5:0,6:0,7:4,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,4),(0,h.A)(n,f.g7,8),(0,h.A)(n,f.JY,i)},88506:(e,t,r)=>{"use strict";r.d(t,{nE:()=>P,pt:()=>S});var n=r(33423),i=r(6837),a=r(25182),s=r(36443),o=r.n(s),u=r(75062),c=r.n(u),f=r(80662),h=r.n(f),d=r(54001),l=r.n(d),p=r(11473),v=r(84149),m=r(61837),g=r(26429),A=r(67672),y=r(10576),x=r(62100),k=y.TK.Worker,b=y.TK.MessageChannel;r(81574),r(26848),r(67524);var w=(0,m.A)(81574,{varName:"init"}),_=((0,m.A)(26848,{varName:"init"}),(0,m.A)(67524,{varName:"init"}),c()("revoke")),T=new(h());function I(e,t){return"".concat(e,"_").concat(t)}function S(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0,u=[];function c(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=(0,n.A)(e,r);return new(l())((function(t){var r={$worker:null,$ipc:null,$channel:null,$moduleId:(0,x.A)(s),$stackPointer:0,$instance:a,$type:"class"},n=Proxy.revocable(r,{get:function(t,n,i){if(t[n])return r[n];if(n in e.prototype&&"function"==typeof e.prototype[n]){var s=function(){return a[n].apply(a,arguments)};s.transfer=function(){return{invoke:function(){return a[n].apply(a,arguments)}}},t[n]=s}return t[n]}}),i=n.proxy,o=n.revoke;r[_]=o,t(i)}))}return t=function(){for(var t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];var f;if(s instanceof k)f=s;else{var h,d=I(s,"class");if(T.has(d))h=T.get(d).url,T.get(d).refCount++;else{var A=(0,m.A)(s,{varName:"__module_".concat(e.name,"__"),exportName:"__".concat(e.name,"__"),pointName:e.name,exportIsClass:!0}),y="\n            ".concat(A,"\n            function run(params) {\n              params.unshift(null)\n              return new (Function.prototype.bind.apply(__module_").concat(e.name,"__.__").concat(e.name,"__, params))()\n            }\n            ").concat(w,"\n            init.default(run);\n          "),S=new Blob([y],{type:"text/javascript"});h=URL.createObjectURL(S),T.set(d,{url:h,refCount:1})}f=new k(h)}var P=new b;return new(l())((function(t,c){var h,d=p.s_.alignedAlloc(g.ZI,r.stackSize?r.stackSize+g.ZI&~g.ZI:g.pw),l=function(r){var c,h,l,p,m,g=r.data,A=g.type;switch(g.data,A){case"ready":f.postMessage({type:"run",data:{port:P.port2,params:n}},[P.port2].concat((0,i.A)(u)));break;case"running":c=new v.Ay(P.port1),h={$worker:f,$ipc:c,$channel:P,$moduleId:(0,x.A)(s),$stackPointer:d,$type:"class"},l=Proxy.revocable(h,{get:function(t,r,n){if(t[r])return h[r];if(r in e.prototype&&"function"==typeof e.prototype[r]){var i=function(){var e=(0,a.A)(o().mark((function e(){var t,n,i,a=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=a.length,n=new Array(t),i=0;i<t;i++)n[i]=a[i];return e.abrupt("return",c.request(r,{params:n}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();i.transfer=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{invoke:(i=(0,a.A)(o().mark((function e(){var n,i,a,s=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=s.length,i=new Array(n),a=0;a<n;a++)i[a]=s[a];return e.abrupt("return",c.request(r,{params:i},t));case 2:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})};var i},t[r]=i}return t[r]}}),p=l.proxy,m=l.revoke,h[_]=m,t(p)}};f.onmessage=l,f.onmessage=l,f.postMessage({type:"init",data:{memory:p.ce,name:r.name||e.name,stackPointer:d,stackSize:null!==(h=r.stackSize)&&void 0!==h?h:g.pw}})}))},{run:g._7&&!r.disableWorker?t:c,transfer:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return u=n,{run:g._7&&!r.disableWorker?t:c}}}}function P(e){if(e.$worker&&(e.$worker.terminate(),e.$worker=null),e.$moduleId){if(A.Yj(e.$moduleId)){var t=I(e.$moduleId,e.$type);T.has(t)&&(T.get(t).refCount--,0===T.get(t).refCount&&(URL.revokeObjectURL(T.get(t).url),T.delete(t)))}e.$moduleId=null}if(e.$ipc&&(e.$ipc.destroy(),e.$ipc=null),e.$stackPointer&&(p.s_.free(e.$stackPointer),e.$stackPointer=0),e.$channel=null,e.$instance=null,e[_]){var r=e[_];e[_]=null,r()}}},6704:(e,t,r)=>{"use strict";r.d(t,{_:()=>o,i:()=>s});var n,i,a=r(134),s=(n={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(n,2,1),3,1),4,1),5,1),6,2),7,2),8,4),9,4),10,8),11,1),(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(n,12,1),13,2),14,2),15,4),16,4),17,8),18,4),19,8),20,4),0,4),(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(n,1,4),22,8),21,8),23,1),24,1)),o=(i={},(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(i,2,0),3,0),4,0),5,0),6,1),7,1),8,2),9,2),10,4),11,0),(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(i,12,0),13,1),14,1),15,2),16,2),17,4),18,2),19,4),20,2),1,2),(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)(i,0,2),22,4),21,4),23,0),24,0))},19094:(e,t,r)=>{"use strict";r.d(t,{A:()=>y});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(54001),f=r.n(c),h=r(11473),d=r(63939),l=r(50932),p=r(26429),v=r(14686),m=r(42518),g=r(73783),A=r(40046),y=function(){function e(t,r){(0,i.A)(this,e),(0,s.A)(this,"count",void 0),(0,s.A)(this,"url",void 0),(0,s.A)(this,"childThreads",void 0),this.count=t,this.url=r,this.childThreads=[]}var t,r;return(0,a.A)(e,[{key:"createTheadPoolEntry",value:(r=(0,n.A)(u().mark((function e(t){var r=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new(f())((function(e,n){var i=new Worker(r.url),a=h.s_.alignedAlloc(p.ZI,p.pw),s=h.s_.malloc(8);(0,v.sO)(s,0,8),l.M[15](s+4,0),l.M[15](s,2|d.f[15](s));var o=(0,h.pv)();i.onmessage=function(t){if("ready"===t.data.type){var r=a;(0,v.sO)(r,0,20),g.Ts(r+16),m.Ts(r+12),i.postMessage({type:"wait"}),e({id:o,thread:{thread:0,worker:i,stackPointer:a,threadDescriptor:s},threadWait:r})}},i.postMessage({type:"ready",data:{cheap:{memory:h.ce,stackPointer:a,stackSize:p.pw,id:o},runner:{resource:{tableSize:t.tableSize,module:t.module,initFuncs:t.initFuncs},options:{memoryBase:t.memoryBase,tableBase:t.tableBase,threadDescriptor:s,childImports:t.childImports},imports:t.childImports}}})})));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"ready",value:(t=(0,n.A)(u().mark((function e(t){var r=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f().all(new Array(this.count).fill(0).map((function(){return r.createTheadPoolEntry(t)})));case 2:this.childThreads=e.sent;case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"hasFree",value:function(){for(var e=0;e<this.childThreads.length;e++)if(0===d.f[15](this.childThreads[e].thread.threadDescriptor+4))return!0;return!1}},{key:"isPoolThread",value:function(e){for(var t=0;t<this.childThreads.length;t++)if(this.childThreads[t].thread.thread===e)return!0;return!1}},{key:"createThread",value:function(e,t,r,n){for(var i=0;i<this.childThreads.length;i++)if(0===d.f[15](this.childThreads[i].thread.threadDescriptor+4))return l.M[15](this.childThreads[i].thread.threadDescriptor+4,1),this.childThreads[i].thread.thread=e,l.M[15](e+8,2|d.f[15](e+8)),g.s2(this.childThreads[i].threadWait+16),l.M[20](this.childThreads[i].threadWait,e),l.M[20](this.childThreads[i].threadWait+4,r),l.M[20](this.childThreads[i].threadWait+8,n),g.Tl(this.childThreads[i].threadWait+16),void m.vP(this.childThreads[i].threadWait+12)}},{key:"joinThread",value:function(e,t){for(var r,n=0;n<this.childThreads.length;n++)if(this.childThreads[n].thread.thread===e){r=this.childThreads[n];break}return r?(1&d.f[15](e+8)||(A.uk(e+12,1),0!==t&&l.M[20](t,d.f[20](e+4)),l.M[15](r.thread.threadDescriptor+4,0)),0):-1}},{key:"detachThread",value:function(e){for(var t,r=0;r<this.childThreads.length;r++)if(this.childThreads[r].thread.thread===e){t=this.childThreads[r];break}return t?(l.M[15](t.thread.threadDescriptor,1|d.f[15](t.thread.threadDescriptor)),l.M[15](e+8,1|d.f[15](e+8)),0):-1}},{key:"destroy",value:function(){for(var e=0;e<this.childThreads.length;e++)h.s_.free(this.childThreads[e].thread.stackPointer),h.s_.free(this.childThreads[e].thread.threadDescriptor),this.childThreads[e].thread.worker.terminate();this.childThreads=[]}}]),e}()},16030:(e,t,r)=>{"use strict";r.d(t,{A:()=>z});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(80662),f=r.n(c),h=r(54001),d=r.n(h),l=r(63939),p=r(50932),v=r(11473),m=r(95335),g=r(72739),A=r(4624),y=r(67672),x=r(14686),k=r(14621),b=r(1708),w=r(20357),_=r(77775),T=r(61837),I=r(26429),S=r(40046),P=r(82854),B=r(80905),C=r(24565),M=r(39638),R=r(19094),U=r(42518),E=r(73783),D=r(95797),L="src/cheap/webassembly/WebAssemblyRunner.ts";r(81999);var F=(0,T.A)(81999,{varName:"init"});function O(){}var N=!1,z=function(){function e(t){var r,n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.A)(this,e),(0,s.A)(this,"resource",void 0),(0,s.A)(this,"instance",void 0),(0,s.A)(this,"options",void 0),(0,s.A)(this,"builtinMalloc",void 0),(0,s.A)(this,"memoryBase",void 0),(0,s.A)(this,"tableBase",void 0),(0,s.A)(this,"childImports",void 0),(0,s.A)(this,"childUrl",void 0),(0,s.A)(this,"childBlob",void 0),(0,s.A)(this,"childThreads",void 0),(0,s.A)(this,"imports",void 0),(0,s.A)(this,"childReadyPromises",void 0),(0,s.A)(this,"threadPool",void 0),(0,s.A)(this,"initCalling",void 0),(0,s.A)(this,"promisingMap",void 0),this.resource=t,this.builtinMalloc=[],this.initCalling=!1,this.childThreads=new(f()),this.childReadyPromises=[],this.promisingMap=new(f()),y.Yj(a.childImports)?this.childImports=a.childImports:y.Ik(a.childImports)&&a.childImports instanceof Blob&&(this.childImports=URL.createObjectURL(a.childImports)),this.memoryBase=t.dataSize?v.s_.malloc(t.dataSize):0,a.thread&&a.tableBase&&v.XI.getPointer()!==a.tableBase&&v.XI.alloc(a.tableBase-v.XI.getPointer()),this.tableBase=t.tableSize?v.XI.alloc(t.tableSize):0,this.options=a,this.imports={env:{memory:v.ce,__stack_pointer:v.GE,__indirect_function_table:v.XI.table,clock_time_get:k.WU,clock_res_get:k.Lq,random_get:k.Pp,abort:k.h2,proc_exit:function(e){A.z3("wasm module exit, code: ".concat(e),L,156)},__syscall_renameat:O,__syscall_unlinkat:O,environ_get:k.B,environ_sizes_get:k.CK,fd_close:O,fd_fdstat_get:k.LS,fd_read:O,fd_seek:O,fd_write:k.nK,emscripten_builtin_malloc:function(e){var t=v.s_.malloc(e);return n.builtinMalloc.push(t),t},emscripten_builtin_free:function(e){v.s_.free(e)},emscripten_builtin_memalign:function(e,t,r){var i=v.s_.alignedAlloc(t,r);return 0!==i?(p.M[20](e,i),n.builtinMalloc.push(i),0):-1},emscripten_memcpy_big:function(e,t,r){(0,x.Mr)(e,t,r)},__libc_malloc:function(e){return v.s_.malloc(e)},__libc_free:function(e){v.s_.free(e)},malloc:function(e){if(!0===n.initCalling){var t=v.s_.malloc(e);return n.builtinMalloc.push(t),t}return v.s_.malloc(e)},calloc:function(e,t){return v.s_.calloc(e,t)},realloc:function(e,t){return v.s_.realloc(e,t)},aligned_alloc:function(e,t){return v.s_.alignedAlloc(e,t)},free:function(e){v.s_.free(e)},posix_memalign:function(e,t,r){var n=v.s_.alignedAlloc(t,r);return 0!==n?(p.M[20](e,n),0):-1},memalign:function(e,t){return v.s_.alignedAlloc(e,t)}},"GOT.func":{malloc:new WebAssembly.Global({mutable:!0,value:"i32"},2),calloc:new WebAssembly.Global({mutable:!0,value:"i32"},3),realloc:new WebAssembly.Global({mutable:!0,value:"i32"},4),aligned_alloc:new WebAssembly.Global({mutable:!0,value:"i32"},5),free:new WebAssembly.Global({mutable:!0,value:"i32"},1)}};var o=function(e,t,r,i){if(n.threadPool&&n.threadPool.hasFree())return n.threadPool.createThread(e,t,r,i),0;n.childUrl||n.createChildUrl();var a=new Worker(n.childUrl);p.M[15](e,(0,v.pv)()),p.M[16](e+12,1),p.M[15](e+8,0),p.M[20](e+4,0);var s,o=v.s_.alignedAlloc(I.ZI,I.pw),u=v.s_.malloc(8);(0,x.sO)(u,0,8),n.childThreads.set(l.f[15](e),{thread:e,worker:a,stackPointer:o,threadDescriptor:u});var c=new(d())((function(e){s=e}));return D.A.jspi||n.childReadyPromises.push(c),a.onmessage=function(e){var t=e.data,r=t.type;t.data,"run"===r&&s(0)},a.postMessage({type:"run",data:{cheap:{memory:v.ce,stackPointer:o,stackSize:I.pw,id:l.f[15](e)},runner:{resource:{tableSize:n.resource.tableSize,module:n.resource.threadModule.module,initFuncs:n.resource.threadModule.initFuncs},options:{memoryBase:n.options.memoryBase||n.memoryBase,tableBase:n.tableBase,thread:e,threadDescriptor:u,childImports:n.childImports},func:r,args:i,imports:n.childImports,thread:e}}}),D.A.jspi?c:0};if(m.extend(this.imports.env,{wasm_pthread_create:D.A.jspi?new WebAssembly.Suspending(o):o,wasm_pthread_join2:function(e,t){if(n.threadPool&&n.threadPool.isPoolThread(e))return n.threadPool.joinThread(e,t),0;if(1&l.f[15](e+8))return n.childThreads.delete(l.f[15](e)),0;S.uk(e+12,1),0!==t&&p.M[20](t,l.f[20](e+4));var r=n.childThreads.get(l.f[15](e));return v.s_.free(r.stackPointer),v.s_.free(r.threadDescriptor),r.worker.terminate(),n.childThreads.delete(l.f[15](e)),(0,x.sO)(e,0,16),0},wasm_pthread_detach2:function(e){if(n.threadPool&&n.threadPool.isPoolThread(e))return n.threadPool.detachThread(e),0;var t=n.childThreads.get(l.f[15](e));p.M[15](t.threadDescriptor,1|l.f[15](t.threadDescriptor)),p.M[15](e+8,1|l.f[15](e+8))}}),m.extend(this.imports.env,b),m.extend(this.imports.env,w),m.extend(this.imports.env,_),this.memoryBase?m.extend(this.imports.env,{__memory_base:this.memoryBase}):a.memoryBase&&m.extend(this.imports.env,{__memory_base:a.memoryBase}),this.tableBase&&m.extend(this.imports.env,{__table_base:this.tableBase}),null!==(r=a.imports)&&void 0!==r&&r.env&&(m.extend(this.imports.env,a.imports.env),a.envKey&&a.importMap)){var u={};m.each(this.imports.env,(function(e,t){a.importMap[t]&&(u[a.importMap[t]]=e)})),this.imports[a.envKey]=u}this.imports.wasi_snapshot_preview1=this.imports.env}var t,r,o,c;return(0,a.A)(e,[{key:"createChildUrl",value:function(){var t=(0,T.A)(16030,{varName:"__WebAssemblyRunner__",exportName:"__WebAssemblyRunner__",pointName:e.name,exportIsClass:!0}),r="\n      ".concat(t,"\n      ").concat(F,"\n      var preRun;\n      ").concat(this.childImports?"\n      preRun = import('".concat(this.childImports,"')\n      "):"","\n      init.default(preRun);\n    ");this.childBlob=new Blob([r],{type:"text/javascript"}),this.childUrl=URL.createObjectURL(this.childBlob)}},{key:"overrideAtomic",value:function(){b.override({atomic_add_i8:P.KJ.exports.add8,atomic_sub_i8:P.KJ.exports.sub8,atomic_and_i8:P.KJ.exports.and8,atomic_or_i8:P.KJ.exports.or8,atomic_xor_i8:P.KJ.exports.xor8,atomic_store_i8:P.KJ.exports.store8,atomic_load_i8:P.KJ.exports.load8,atomic_compare_exchange_i8:P.KJ.exports.compare_exchange8,atomic_exchange_i8:P.KJ.exports.exchange8,atomic_add_i16:P.KJ.exports.add16,atomic_sub_i16:P.KJ.exports.sub16,atomic_and_i16:P.KJ.exports.and16,atomic_or_i16:P.KJ.exports.or16,atomic_xor_i16:P.KJ.exports.xor16,atomic_store_i16:P.KJ.exports.store16,atomic_load_i16:P.KJ.exports.load16,atomic_compare_exchange_i16:P.KJ.exports.compare_exchange16,atomic_exchange_i16:P.KJ.exports.exchange16,atomic_add_i32:P.KJ.exports.add32,atomic_sub_i32:P.KJ.exports.sub32,atomic_and_i32:P.KJ.exports.and32,atomic_or_i32:P.KJ.exports.or32,atomic_xor_i32:P.KJ.exports.xor32,atomic_store_i32:P.KJ.exports.store32,atomic_load_i32:P.KJ.exports.load32,atomic_compare_exchange_i32:P.KJ.exports.compare_exchange32,atomic_exchange_i32:P.KJ.exports.exchange32,atomic_add_i64:P.KJ.exports.add64,atomic_sub_i64:P.KJ.exports.sub64,atomic_and_i64:P.KJ.exports.and64,atomic_or_i64:P.KJ.exports.or64,atomic_xor_i64:P.KJ.exports.xor64,atomic_store_i64:P.KJ.exports.store64,atomic_load_i64:P.KJ.exports.load64,atomic_compare_exchange_i64:P.KJ.exports.compare_exchange64,atomic_exchange_i64:P.KJ.exports.exchange64,atomics_notify:P.KJ.exports.notify,atomics_wait:P.KJ.exports.wait}),m.extend(this.imports.env,b)}},{key:"run",value:(c=(0,n.A)(u().mark((function e(t,r){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.Ik(t)&&m.extend(this.options.imports,t),!(0,M.A)()||C.LK||!C.Ko()||!this.resource.threadModule){e.next=5;break}return e.next=4,C.Ts(v.ce,w.override);case 4:m.extend(this.imports.env,w);case 5:if(B.LK||!B.Ko()){e.next=8;break}return e.next=8,B.Ts(v.ce);case 8:return!N&&P.Ko()&&(N=!0,this.overrideAtomic()),e.next=11,WebAssembly.instantiate(this.resource.module,this.imports);case 11:if(this.instance=e.sent,this.initRunTime(),!(this.resource.threadModule&&this.resource.enableThreadPool&&r>0)||D.A.jspi){e.next=20;break}return this.childUrl||this.createChildUrl(),n=r,this.resource.enableThreadCountRate&&(n*=this.resource.enableThreadCountRate),this.threadPool=new R.A(n,this.childUrl),e.next=20,this.threadPool.ready({tableSize:this.resource.tableSize,module:this.resource.threadModule.module,initFuncs:this.resource.threadModule.initFuncs,memoryBase:this.options.memoryBase||this.memoryBase,tableBase:this.tableBase,childImports:this.childImports});case 20:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"runAsChild",value:(o=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.Ik(t)&&m.extend(this.options.imports,t),C.LK||!C.Ko()){e.next=5;break}return e.next=4,C.Ts(v.ce,w.override);case 4:m.extend(this.imports.env,w);case 5:!N&&P.Ko()&&(N=!0,this.overrideAtomic()),this.instance=new WebAssembly.Instance(this.resource.module,this.imports),this.initRunTime();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"childrenThreadReady",value:(r=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.childReadyPromises.length){e.next=2;break}return e.abrupt("return");case 2:return t=this.childReadyPromises,this.childReadyPromises=[],e.next=6,d().all(t);case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"initRunTime",value:function(){var e=this;this.builtinMalloc=[],this.initCalling=!0,y.YO(this.resource.initFuncs)&&g.__(this.resource.initFuncs,(function(t){var r;if(e.asm[t]&&(r=e.asm[t]),r)return r()})),this.initCalling=!1}},{key:"call",value:function(e){if(!this.asm)return-1;var t;if(this.asm[e]?t=this.asm[e]:this.options.exportMap&&this.options.exportMap[e]&&this.asm[this.options.exportMap[e]]&&(t=this.asm[this.options.exportMap[e]]),t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return t.apply(null,n)}A.z3("the wasm module has not function ".concat(e," to call"),L,597)}},{key:"callAsync",value:(t=(0,n.A)(u().mark((function e(t){var r,n,i,a,s=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.asm){e.next=2;break}return e.abrupt("return",-1);case 2:for(r=s.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=s[i];if(D.A.jspi){e.next=5;break}return e.abrupt("return",this.call.apply(this,[t].concat(n)));case 5:if(this.promisingMap.has(t)?a=this.promisingMap.get(t):(this.asm[t]?a=this.asm[t]:this.options.exportMap&&this.options.exportMap[t]&&this.asm[this.options.exportMap[t]]&&(a=this.asm[this.options.exportMap[t]]),a=WebAssembly.promising(a),this.promisingMap.set(t,a)),!a){e.next=10;break}return e.abrupt("return",a.apply(null,n));case 10:A.z3("the wasm module has not function ".concat(t," to call"),L,639);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"asm",get:function(){return this.instance&&this.instance.exports}},{key:"getInstance",value:function(){return this.instance}},{key:"destroy",value:function(){var e,t=this;null!==(e=this.builtinMalloc)&&void 0!==e&&e.length&&(g.__(this.builtinMalloc,(function(e){v.s_.free(e)})),this.builtinMalloc.length=0),this.memoryBase&&(v.s_.free(this.memoryBase),this.memoryBase=null),this.tableBase&&(v.XI.free(this.tableBase),this.tableBase=null),this.childImports&&(URL.revokeObjectURL(this.childImports),this.childImports=null),this.childUrl&&(URL.revokeObjectURL(this.childUrl),this.childUrl=null),this.childBlob=null,this.childReadyPromises.length=0,this.childThreads.size&&this.childThreads.forEach((function(e,r){1&l.f[15](e.threadDescriptor)||(A.R8("has child thread running, maybe resource leakage",L,684),e.worker.terminate(),p.M[16](e.thread+12,0),e.stackPointer&&v.s_.free(e.stackPointer),v.s_.free(e.threadDescriptor),t.childThreads.delete(r))})),this.builtinMalloc=null,this.instance=null,this.options.thread&&(this.options.threadDescriptor&&p.M[15](this.options.threadDescriptor+4,0),this.options.threadDescriptor&&(1&l.f[15](this.options.threadDescriptor)||4&l.f[15](this.options.thread+8))?2&l.f[15](this.options.threadDescriptor)||(v.wE&&v.s_.free(v.wE),v.s_.free(this.options.threadDescriptor),(0,x.sO)(this.options.thread,0,16),self.close()):(p.M[16](this.options.thread+12,0),S.me(this.options.thread+12,1))),this.threadPool&&this.threadPool.destroy(),this.threadPool=null,this.promisingMap&&(this.promisingMap.clear(),this.promisingMap=null)}}],[{key:"getTable",value:function(){return v.XI}},{key:"mutexLock",value:function(e){E.s2(e)}},{key:"mutexUnlock",value:function(e){E.Tl(e)}},{key:"condWait",value:function(e,t){U.uk(e,t)}},{key:"readPointer",value:function(e){return l.f[20](e)}},{key:"writePointer",value:function(e,t){p.M[20](e,t)}}]),e}()},76045:(e,t,r)=>{"use strict";r.d(t,{A:()=>g});var n=r(25182),i=r(54001),a=r.n(i),s=r(36443),o=r.n(s),u=r(67672),c=r(24175),f=r(34531),h=r(88096),d=r(92647),l=r(95335),p=r(26429);function v(e){return m.apply(this,arguments)}function m(){return(m=(0,n.A)(o().mark((function e(t){var r,n,i,a,s,u,c,f,d,l,v,m,g,A;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=t.ioWriter,e.next=4,t.ioReader.readUint32();case 4:return e.t1=e.sent,e.next=7,e.t0.writeUint32.call(e.t0,e.t1);case 7:return e.t2=t.ioWriter,e.next=10,t.ioReader.readUint32();case 10:return e.t3=e.sent,e.next=13,e.t2.writeUint32.call(e.t2,e.t3);case 13:if(!t.compileStopped){e.next=17;break}return t.abortController&&t.abortController.abort(),e.abrupt("break",204);case 17:return e.next=19,t.ioReader.readUint8();case 19:if(r=e.sent,!t.options.child){e.next=46;break}if(11!==r){e.next=46;break}return e.next=24,t.ioWriter.writeUint8(r);case 24:return e.next=26,(0,h.$z)(t.ioWriter,7);case 26:return e.next=28,(0,h.$z)(t.ioWriter,1);case 28:return e.next=30,(0,h.$z)(t.ioWriter,0);case 30:return e.next=32,t.ioWriter.writeUint8(65);case 32:return e.next=34,t.ioWriter.writeUint8(0);case 34:return e.next=36,t.ioWriter.writeUint8(11);case 36:return e.next=38,(0,h.$z)(t.ioWriter,1);case 38:return e.next=40,t.ioWriter.writeUint8(0);case 40:return e.next=42,(0,h.GG)(t.ioReader);case 42:return n=e.sent,e.next=45,t.ioReader.skip(n);case 45:return e.abrupt("continue",13);case 46:return e.next=48,t.ioWriter.writeUint8(r);case 48:return e.next=50,(0,h.GG)(t.ioReader);case 50:return i=e.sent,e.next=53,(0,h.$z)(t.ioWriter,i);case 53:if(a=t.ioReader.getPos(),11!==r){e.next=85;break}return e.next=57,(0,h.GG)(t.ioReader);case 57:return s=e.sent,e.next=60,(0,h.$z)(t.ioWriter,s);case 60:if(!s){e.next=83;break}return e.t4=h.$z,e.t5=t.ioWriter,e.next=65,(0,h.GG)(t.ioReader);case 65:return e.t6=e.sent,e.next=68,(0,e.t4)(e.t5,e.t6);case 68:return e.next=71,t.ioReader.readUint8();case 71:return u=e.sent,e.next=74,t.ioWriter.writeUint8(u);case 74:if(11!==u){e.next=76;break}return e.abrupt("break",78);case 76:e.next=68;break;case 78:return e.next=80,(0,h.GG)(t.ioReader);case 80:return t.data.dataSize=e.sent,e.next=83,(0,h.$z)(t.ioWriter,t.data.dataSize);case 83:e.next=198;break;case 85:if(2!==r){e.next=198;break}return e.next=88,(0,h.GG)(t.ioReader);case 88:return c=e.sent,e.next=91,(0,h.$z)(t.ioWriter,c);case 91:f=0;case 92:if(!c--){e.next=198;break}return e.next=95,(0,h.GG)(t.ioReader);case 95:return d=e.sent,e.next=98,(0,h.$z)(t.ioWriter,d);case 98:return e.t7=t.ioWriter,e.next=101,t.ioReader.readBuffer(d);case 101:return e.t8=e.sent,e.next=104,e.t7.writeBuffer.call(e.t7,e.t8);case 104:return e.next=106,(0,h.GG)(t.ioReader);case 106:return l=e.sent,e.next=109,(0,h.$z)(t.ioWriter,l);case 109:return e.t9=t.ioWriter,e.next=112,t.ioReader.readBuffer(l);case 112:return e.t10=e.sent,e.next=115,e.t9.writeBuffer.call(e.t9,e.t10);case 115:return e.next=117,t.ioReader.readUint8();case 117:return v=e.sent,e.next=120,t.ioWriter.writeUint8(v);case 120:e.t11=v,e.next=0===e.t11?123:3===e.t11?131:2===e.t11?146:1===e.t11?166:194;break;case 123:return e.t12=h.$z,e.t13=t.ioWriter,e.next=127,(0,h.GG)(t.ioReader);case 127:return e.t14=e.sent,e.next=130,(0,e.t12)(e.t13,e.t14);case 130:return e.abrupt("break",194);case 131:return e.t15=h.p7,e.t16=t.ioWriter,e.next=135,(0,h.Ee)(t.ioReader);case 135:return e.t17=e.sent,e.next=138,(0,e.t15)(e.t16,e.t17);case 138:return e.t18=h.$z,e.t19=t.ioWriter,e.next=142,(0,h.GG)(t.ioReader);case 142:return e.t20=e.sent,e.next=145,(0,e.t18)(e.t19,e.t20);case 145:return e.abrupt("break",194);case 146:return e.next=148,(0,h.GG)(t.ioReader);case 148:return m=e.sent,t.options.enableThread?m|=2:m&=-3,e.next=152,(0,h.$z)(t.ioWriter,m);case 152:return e.t21=h.$z,e.t22=t.ioWriter,e.next=156,(0,h.GG)(t.ioReader);case 156:return e.t23=e.sent,e.next=159,(0,e.t21)(e.t22,e.t23);case 159:if(!(1&m)){e.next=164;break}return e.next=162,(0,h.GG)(t.ioReader);case 162:return e.next=164,(0,h.$z)(t.ioWriter,p.Gx);case 164:return f++,e.abrupt("break",194);case 166:return e.t24=h.p7,e.t25=t.ioWriter,e.next=170,(0,h.Ee)(t.ioReader);case 170:return e.t26=e.sent,e.next=173,(0,e.t24)(e.t25,e.t26);case 173:return e.next=175,(0,h.GG)(t.ioReader);case 175:return g=e.sent,e.next=178,(0,h.$z)(t.ioWriter,g);case 178:return e.next=180,(0,h.GG)(t.ioReader);case 180:return A=e.sent,e.next=183,(0,h.$z)(t.ioWriter,A);case 183:if(t.data.tableSize=A,!(1&g)){e.next=192;break}return e.t27=h.$z,e.t28=t.ioWriter,e.next=189,(0,h.GG)(t.ioReader);case 189:return e.t29=e.sent,e.next=192,(0,e.t27)(e.t28,e.t29);case 192:return f++,e.abrupt("break",194);case 194:if(2!==f){e.next=196;break}return e.abrupt("break",198);case 196:e.next=92;break;case 198:if(!(i-Number(t.ioReader.getPos()-a))){e.next=202;break}return e.next=202,t.ioReader.pipe(t.ioWriter,i-Number(t.ioReader.getPos()-a));case 202:e.next=13;break;case 204:e.next=218;break;case 206:if(e.prev=206,e.t30=e.catch(0),-1048576===t.ioReader.error?t.bufferEnded=!0:t.error=e.t30,!t.ioReader.remainingLength()){e.next=216;break}return e.t31=t.ioWriter,e.next=213,t.ioReader.readBuffer(t.ioReader.remainingLength());case 213:return e.t32=e.sent,e.next=216,e.t31.writeBuffer.call(e.t31,e.t32);case 216:return e.next=218,t.ioWriter.flush();case 218:case"end":return e.stop()}}),e,null,[[0,206]])})))).apply(this,arguments)}function g(e){return A.apply(this,arguments)}function A(){return A=(0,n.A)(o().mark((function e(t){var r,i,s,h,m,g,A,y,x,k=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=k.length>1&&void 0!==k[1]?k[1]:{},r=l.extend({enableThread:p._7,initFuncs:r.child?[]:["__wasm_apply_data_relocs","_initialize"]},r),!u.ai(t.dataSize)||!u.ai(t.tableSize)){e.next=30;break}if(s=t.dataSize,h=t.dataSize,!u.Yj(t.source)){e.next=24;break}if(g={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"},!u.Pc(WebAssembly.compileStreaming)){e.next=13;break}return e.next=10,WebAssembly.compileStreaming(fetch(t.source,g));case 10:i=e.sent,e.next=22;break;case 13:return e.next=15,fetch(t.source,g);case 15:return A=e.sent,e.next=18,A.arrayBuffer();case 18:return m=e.sent,e.next=21,WebAssembly.compile(m);case 21:i=e.sent;case 22:e.next=28;break;case 24:return e.next=26,WebAssembly.compile(t.source);case 26:i=e.sent,m=u.sv(t.source)?t.source:t.source.buffer;case 28:e.next=48;break;case 30:if(y={ioReader:new c.A(1048576),ioWriter:new f.A(1048576),bufferEnded:!1,compileStopped:!1,error:"",abortController:null,pullResolve:null,bufferResolve:null,buffers:[],data:{},options:r},x=new Response(new ReadableStream({start:function(e){return(0,n.A)(o().mark((function r(){var i,s,c,f,h,d,l,p;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!u.Yj(t.source)){r.next=11;break}return AbortController&&(y.abortController=new AbortController),s={method:"GET",headers:{},mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade",signal:null===(i=y.abortController)||void 0===i?void 0:i.signal},r.next=5,fetch(t.source,s);case 5:(c=r.sent).ok&&c.status>=200&&c.status<=299?f=c.body.getReader():e.error("Http code invalid, ".concat(c.status," ").concat(c.statusText)),h=[],y.ioReader.onFlush=function(){var e=(0,n.A)(o().mark((function e(t){var r,n,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=0;h.length&&r<t.length;)(n=h.shift()).length>t.length-r?(t.set(n.subarray(0,t.length-r),r),h.unshift(n.subarray(t.length-r)),r=t.length):(t.set(n,r),r+=n.length);if(!(r>=t.length)){e.next=4;break}return e.abrupt("return",t.length);case 4:return e.next=6,f.read();case 6:if(i=e.sent,a=i.value,!i.done){e.next=13;break}return e.abrupt("return",r>0?r:-1048576);case 13:if(y.buffers.push(a),!(a.length>t.length-r)){e.next=20;break}return t.set(a.subarray(0,t.length-r),r),h.push(a.subarray(t.length-r)),e.abrupt("return",t.length);case 20:return t.set(a,r),r+=a.length,e.abrupt("return",r);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.next=15;break;case 11:d=0,l=t.source.byteLength,p=u.sv(t.source)?new Uint8Array(t.source):t.source,y.ioReader.onFlush=function(){var e=(0,n.A)(o().mark((function e(t){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(d>=l)){e.next=2;break}return e.abrupt("return",-1048576);case 2:return r=Math.min(t.length,l-d),t.set(p.subarray(d,d+r),0),d+=r,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();case 15:y.ioWriter.onFlush=function(){var e=(0,n.A)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y.pullResolve){e.next=4;break}return y.pullResolve(t.slice()),y.pullResolve=null,e.abrupt("return",0);case 4:return e.next=6,new(a())((function(e,t){y.bufferResolve=e}));case 6:return e.sent.enqueue(t.slice()),e.abrupt("return",0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v(y);case 17:case"end":return r.stop()}}),r)})))()},pull:function(e){return(0,n.A)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!y.error){t.next=3;break}return e.close(),t.abrupt("return");case 3:if(!y.bufferResolve){t.next=7;break}return y.bufferResolve(e),y.bufferResolve=null,t.abrupt("return");case 7:return t.t0=e,t.next=10,new(a())((function(e,t){y.pullResolve=e}));case 10:t.t1=t.sent,t.t0.enqueue.call(t.t0,t.t1),y.bufferEnded?e.close():y.error&&e.error(y.error);case 13:case"end":return t.stop()}}),t)})))()},cancel:function(e){y.compileStopped=!0}}),{headers:{"Content-Type":"application/wasm"}}),!u.Pc(WebAssembly.compileStreaming)){e.next=38;break}return e.next=35,WebAssembly.compileStreaming(x);case 35:i=e.sent,e.next=45;break;case 38:return e.t0=WebAssembly,e.next=41,x.arrayBuffer();case 41:return e.t1=e.sent,e.next=44,e.t0.compile.call(e.t0,e.t1);case 44:i=e.sent;case 45:m=u.Yj(t.source)?(0,d.A)(Uint8Array,y.buffers).buffer:u.sv(t.source)?t.source:t.source.buffer,s=y.data.tableSize,h=y.data.dataSize;case 48:if(!r.child){e.next=50;break}return e.abrupt("return",{module:i,initFuncs:r.initFuncs||[]});case 50:return e.abrupt("return",{module:i,tableSize:s,dataSize:h,initFuncs:r.initFuncs||[],buffer:m});case 51:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}},81999:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var n=r(25182),i=r(36443),a=r.n(i),s=r(10576);s.TK.imports={env:{}};var o,u,c=s.TK,f=0;function h(e){c.onmessage=function(t){var r=t.data,i=r.type,h=r.data;switch(i){case"run":c.postMessage({type:"run"}),s.TK.CHeap&&s.TK.CHeap.initThread&&s.TK.CHeap.initThread(h.cheap).then((function(){function t(){s.TK.__SELF_THREAD__=h.runner.thread,h.runner.options.imports=s.TK.imports,(o=new __WebAssemblyRunner__.__WebAssemblyRunner__(h.runner.resource,h.runner.options)).runAsChild().then((function(){__WebAssemblyRunner__.__WebAssemblyRunner__.getTable().get(h.runner.func)(h.runner.args),o.destroy()}))}e?e.then((function(){t()})):t()}));break;case"ready":u=h.runner,f=h.cheap.stackPointer,s.TK.CHeap&&s.TK.CHeap.initThread&&s.TK.CHeap.initThread(h.cheap).then((function(){e?e.then((function(){c.postMessage({type:"ready"})})):c.postMessage({type:"ready"})}));break;case"wait":var d=function(){var e=(0,n.A)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(__WebAssemblyRunner__.__WebAssemblyRunner__.mutexLock(f+16);0===__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(f);)__WebAssemblyRunner__.__WebAssemblyRunner__.condWait(f+12,f+16);return s.TK.__SELF_THREAD__=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(f),u.options.thread=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(f),u.thread=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(f),u.func=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(f+4),u.args=__WebAssemblyRunner__.__WebAssemblyRunner__.readPointer(f+8),o=new __WebAssemblyRunner__.__WebAssemblyRunner__(u.resource,u.options),e.next=9,o.runAsChild();case 9:__WebAssemblyRunner__.__WebAssemblyRunner__.getTable().get(u.func)(u.args),o.destroy(),__WebAssemblyRunner__.__WebAssemblyRunner__.writePointer(f,0),__WebAssemblyRunner__.__WebAssemblyRunner__.mutexUnlock(f+16),e.next=0;break;case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();u.options.imports=s.TK.imports,d()}}}},80905:(e,t,r)=>{"use strict";r.d(t,{Ko:()=>v,LK:()=>n,Ts:()=>m});var n,i=r(25182),a=r(36443),s=r.n(a),o=r(11473),u=r(4919),c=r(4624),f=r(35112),h=r.n(f),d=r(88096),l="src/cheap/webassembly/runtime/asm/libc.ts",p=!0;function v(){return p}function m(e){return g.apply(this,arguments)}function g(){return(g=(0,i.A)(s().mark((function e(t){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer)){e.next=14;break}return r=(0,u.E_)(h()),d.DD(r,!0),e.next=6,WebAssembly.instantiate(r,{env:{memory:t,malloc:function(e){return o.s_.malloc(e)},calloc:function(e,t){return o.s_.calloc(e,t)},realloc:function(e,t){return o.s_.realloc(e,t)},aligned_alloc:function(e,t){return o.s_.alignedAlloc(e,t)},free:function(e){o.s_.free(e)}}});case 6:n=e.sent.instance,o.XI.set(2,n.exports.malloc),o.XI.set(1,n.exports.free),o.XI.set(3,n.exports.calloc),o.XI.set(4,n.exports.realloc),o.XI.set(5,n.exports.alignedAlloc),e.next=16;break;case 14:return p=!1,e.abrupt("return");case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),p=!1,c.R8("thread asm not support, cannot use asm thread function",l,64);case 22:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}},24565:(e,t,r)=>{"use strict";r.d(t,{Ko:()=>p,LK:()=>n,Ts:()=>v});var n,i=r(25182),a=r(36443),s=r.n(a),o=r(4919),u=r(4624),c=r(47844),f=r.n(c),h=r(88096),d="src/cheap/webassembly/runtime/asm/thread.ts",l=!0;function p(){return l}function v(e,t){return m.apply(this,arguments)}function m(){return(m=(0,i.A)(s().mark((function e(t,r){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!("function"==typeof SharedArrayBuffer&&t.buffer instanceof SharedArrayBuffer)){e.next=9;break}return i=(0,o.E_)(f()),h.DD(i,!0),e.next=6,WebAssembly.instantiate(i,{env:{memory:t}});case 6:n=e.sent.instance,e.next=11;break;case 9:return l=!1,e.abrupt("return");case 11:r({wasm_pthread_mutex_lock:n.exports.lock,wasm_pthread_mutex_trylock:n.exports.trylock,wasm_pthread_mutex_unlock:n.exports.unlock,wasm_pthread_cond_wait:n.exports.wait,wasm_pthread_cond_timedwait:n.exports.timedwait,wasm_pthread_cond_signal:n.exports.signal,wasm_pthread_cond_broadcast:n.exports.broadcast}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),l=!1,u.R8("thread asm not support, cannot use asm thread function",d,67);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}},1708:(e,t,r)=>{"use strict";r.r(t),r.d(t,{atomic_add_i16:()=>p,atomic_add_i32:()=>w,atomic_add_i64:()=>R,atomic_add_i8:()=>a,atomic_and_i16:()=>m,atomic_and_i32:()=>T,atomic_and_i64:()=>E,atomic_and_i8:()=>o,atomic_compare_exchange_i16:()=>k,atomic_compare_exchange_i32:()=>C,atomic_compare_exchange_i64:()=>N,atomic_compare_exchange_i8:()=>d,atomic_exchange_i16:()=>b,atomic_exchange_i32:()=>M,atomic_exchange_i64:()=>z,atomic_exchange_i8:()=>l,atomic_load_i16:()=>x,atomic_load_i32:()=>B,atomic_load_i64:()=>O,atomic_load_i8:()=>h,atomic_or_i16:()=>g,atomic_or_i32:()=>I,atomic_or_i64:()=>D,atomic_or_i8:()=>u,atomic_store_i16:()=>y,atomic_store_i32:()=>P,atomic_store_i64:()=>F,atomic_store_i8:()=>f,atomic_sub_i16:()=>v,atomic_sub_i32:()=>_,atomic_sub_i64:()=>U,atomic_sub_i8:()=>s,atomic_xor_i16:()=>A,atomic_xor_i32:()=>S,atomic_xor_i64:()=>L,atomic_xor_i8:()=>c,atomics_notify:()=>V,atomics_wait:()=>W,atomics_wait_timeout:()=>j,override:()=>G});var n=r(40046),i=r(6704),a=function(e,t){return n.WQ(e,t,12,i._[12])},s=function(e,t){return n.jb(e,t,12,i._[12])},o=function(e,t){return n.Uo(e,t,12,i._[12])},u=function(e,t){return n.or(e,t,12,i._[12])},c=function(e,t){return n.I8(e,t,12,i._[12])},f=function(e,t){return n.M_(e,t,12,i._[12])},h=function(e){return n.Hh(e,12,i._[12])},d=function(e,t,r){return n.p_(e,t,r,12,i._[12])},l=function(e,t){return n.cv(e,t,12,i._[12])},p=function(e,t){return n.WQ(e,t,14,i._[14])},v=function(e,t){return n.jb(e,t,14,i._[14])},m=function(e,t){return n.Uo(e,t,14,i._[14])},g=function(e,t){return n.or(e,t,14,i._[14])},A=function(e,t){return n.I8(e,t,14,i._[14])},y=function(e,t){return n.M_(e,t,14,i._[14])},x=function(e){return n.Hh(e,14,i._[14])},k=function(e,t,r){return n.p_(e,t,r,14,i._[14])},b=function(e,t){return n.cv(e,t,14,i._[14])},w=function(e,t){return n.WQ(e,t,16,i._[16])},_=function(e,t){return n.jb(e,t,16,i._[16])},T=function(e,t){return n.Uo(e,t,16,i._[16])},I=function(e,t){return n.or(e,t,16,i._[16])},S=function(e,t){return n.I8(e,t,16,i._[16])},P=function(e,t){return n.M_(e,t,16,i._[16])},B=function(e){return n.Hh(e,16,i._[16])},C=function(e,t,r){return n.p_(e,t,r,16,i._[16])},M=function(e,t){return n.cv(e,t,16,i._[16])},R=function(e,t){return n.WQ(e,t,21,i._[21])},U=function(e,t){return n.jb(e,t,21,i._[21])},E=function(e,t){return n.Uo(e,t,21,i._[21])},D=function(e,t){return n.or(e,t,21,i._[21])},L=function(e,t){return n.I8(e,t,21,i._[21])},F=function(e,t){return n.M_(e,t,21,i._[21])},O=function(e){return n.Hh(e,21,i._[21])},N=function(e,t,r){return n.p_(e,t,r,21,i._[21])},z=function(e,t){return n.cv(e,t,21,i._[21])},V=function(e,t){return n.me(e,t)},W=function(e,t){return n.uk(e,t)},j=function(e,t,r){return n.j4(e,t,0|Number(0xffffffffn&r))};function G(e){e.atomic_add_i8&&(a=e.atomic_add_i8),e.atomic_sub_i8&&(s=e.atomic_sub_i8),e.atomic_and_i8&&(o=e.atomic_and_i8),e.atomic_or_i8&&(u=e.atomic_or_i8),e.atomic_xor_i8&&(c=e.atomic_xor_i8),e.atomic_store_i8&&(f=e.atomic_store_i8),e.atomic_load_i8&&(h=e.atomic_load_i8),e.atomic_compare_exchange_i8&&(d=e.atomic_compare_exchange_i8),e.atomic_exchange_i8&&(l=e.atomic_exchange_i8),e.atomic_add_i16&&(p=e.atomic_add_i16),e.atomic_sub_i16&&(v=e.atomic_sub_i16),e.atomic_and_i16&&(m=e.atomic_and_i16),e.atomic_or_i16&&(g=e.atomic_or_i16),e.atomic_xor_i16&&(A=e.atomic_xor_i16),e.atomic_store_i16&&(y=e.atomic_store_i16),e.atomic_load_i16&&(x=e.atomic_load_i16),e.atomic_compare_exchange_i16&&(k=e.atomic_compare_exchange_i16),e.atomic_exchange_i16&&(b=e.atomic_exchange_i16),e.atomic_add_i32&&(w=e.atomic_add_i32),e.atomic_sub_i32&&(_=e.atomic_sub_i32),e.atomic_and_i32&&(T=e.atomic_and_i32),e.atomic_or_i32&&(I=e.atomic_or_i32),e.atomic_xor_i32&&(S=e.atomic_xor_i32),e.atomic_store_i32&&(P=e.atomic_store_i32),e.atomic_load_i32&&(B=e.atomic_load_i32),e.atomic_compare_exchange_i32&&(C=e.atomic_compare_exchange_i32),e.atomic_exchange_i32&&(M=e.atomic_exchange_i32),e.atomic_add_i64&&(R=e.atomic_add_i64),e.atomic_sub_i64&&(U=e.atomic_sub_i64),e.atomic_and_i64&&(E=e.atomic_and_i64),e.atomic_or_i64&&(D=e.atomic_or_i64),e.atomic_xor_i64&&(L=e.atomic_xor_i64),e.atomic_store_i64&&(F=e.atomic_store_i64),e.atomic_load_i64&&(O=e.atomic_load_i64),e.atomic_compare_exchange_i64&&(N=e.atomic_compare_exchange_i64),e.atomic_exchange_i64&&(z=e.atomic_exchange_i64),e.atomics_notify&&(V=e.atomics_notify),e.atomics_wait&&(W=e.atomics_wait),e.atomics_wait_timeout&&(j=e.atomics_wait_timeout)}},14621:(e,t,r)=>{"use strict";r.d(t,{B:()=>v,CK:()=>m,LS:()=>g,Lq:()=>k,Pp:()=>b,WU:()=>x,h2:()=>y,nK:()=>A});var n,i=r(23509),a=r(50932),s=r(63939),o=r(14686),u=r(50011),c=[null,[],[]],f=0,h=28,d={},l="./this.program";function p(){if(!n){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"===("undefined"==typeof navigator?"undefined":(0,i.A)(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:l||"./this.program"};for(var t in d)e[t]=d[t];var r=[];for(var a in e)r.push(a+"="+e[a]);n=r}return n}function v(e,t){var r=0;return p().forEach((function(n,i){var s=t+r;a.M[8](e+4*i,s),function(e,t,r){for(var n=0;n<e.length;++n)a.M[4](t,128&e.charCodeAt(n)?-(256-(255&e.charCodeAt(n))):255&e.charCodeAt(n)),t+=1;a.M[4](t,0)}(n,s),r+=n.length+1})),0}function m(e,t){var r=p();a.M[8](e,(0|r.length)>>>0);var n=0;return r.forEach((function(e){n+=e.length+1})),a.M[8](t,(0|n)>>>0),0}function g(e,t){var r=0;return 0==e?r=2:1!=e&&2!=e||(r=64),a.M[11](t,2),a.M[13](t+2,1),a.M[15](t+8,0|r),a.M[15](t+12,0),a.M[17](t+16,BigInt(0)),f}function A(e,t,r,n){for(var i,o,h,d=0,l=0;l<r;l++){var p=s.f[8](t),v=s.f[8](t+4);t+=8;for(var m=0;m<v;m++)i=e,o=s.f[4](p+m),h=void 0,h=c[i],0===o||10===o?(console.log.bind(console)(u.decode(h)),h.length=0):h.push(o);d+=v}return a.M[8](n,(0|d)>>>0),f}function y(e){throw e="abort(".concat(e+="","). Build with -s ASSERTIONS=1 for more info."),new WebAssembly.RuntimeError(e)}function x(e,t,r){if(0!==e)return h;var n=(new Date).getTime();return a.M[10](r,BigInt(n)*BigInt(1e6)),f}function k(e,t){return 0!==e?h:(a.M[10](t,BigInt(1e6)),f)}function b(e,t){var r=(0,o.s3)(e,t);return crypto.getRandomValues(r),f}},20357:(e,t,r)=>{"use strict";r.r(t),r.d(t,{override:()=>C,wasm_cpu_core_count:()=>P,wasm_pthread_cond_broadcast:()=>l,wasm_pthread_cond_destroy:()=>c,wasm_pthread_cond_init:()=>u,wasm_pthread_cond_signal:()=>d,wasm_pthread_cond_timedwait:()=>h,wasm_pthread_cond_wait:()=>f,wasm_pthread_equal2:()=>I,wasm_pthread_exit:()=>T,wasm_pthread_mutex_destroy:()=>i,wasm_pthread_mutex_init:()=>n,wasm_pthread_mutex_lock:()=>a,wasm_pthread_mutex_trylock:()=>s,wasm_pthread_mutex_unlock:()=>o,wasm_pthread_once:()=>p,wasm_pthread_self2:()=>_,wasm_pthread_support:()=>S,wasm_threw_error:()=>B});var n,i,a,s,o,u,c,f,h,d,l,p,v=r(63939),m=r(50932),g=r(73783),A=r(42518),y=r(26429),x=r(11473),k=r(40046),b=r(10576),w=r(14686);function _(){return b.TK.__SELF_THREAD__}function T(e){var t=b.TK.__SELF_THREAD__;m.M[20](t+4,e),m.M[15](t+8,4|v.f[15](t+8))}function I(e,t){return v.f[15](e)===v.f[15](t)?1:0}function S(){return y._7?1:0}function P(){return navigator.hardwareConcurrency}function B(e,t){throw new Error((0,w.lH)(t))}function C(e){e.wasm_pthread_mutex_lock&&(a=e.wasm_pthread_mutex_lock),e.wasm_pthread_mutex_trylock&&(s=e.wasm_pthread_mutex_trylock),e.wasm_pthread_mutex_unlock&&(o=e.wasm_pthread_mutex_unlock),e.wasm_pthread_cond_wait&&(f=e.wasm_pthread_cond_wait),e.wasm_pthread_cond_timedwait&&(h=e.wasm_pthread_cond_timedwait),e.wasm_pthread_cond_signal&&(d=e.wasm_pthread_cond_signal),e.wasm_pthread_cond_broadcast&&(l=e.wasm_pthread_cond_broadcast)}n=function(e,t){return g.Ts(e)},i=function(e){return g.zr(e)},a=function(e){return g.s2(e)},s=function(e){return g.bh(e)},o=function(e){return g.Tl(e)},u=function(e,t){return A.Ts(e,t)},c=function(e){return A.zr(e)},f=function(e,t){return A.uk(e,t)},h=function(e,t,r){var n=1e3*Number(v.f[17](r))+v.f[15](r+8)/1e6;return A.XR(e,t,n)},d=function(e){return A.vP(e)},l=function(e){return A.mq(e)},p=function(e,t){return 0===k.WQ(e,1,16,2)&&x.XI.get(t)(),0}},77775:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Timespec:()=>p,wasm_sem_destroy:()=>m,wasm_sem_init:()=>v,wasm_sem_post:()=>x,wasm_sem_timedwait:()=>y,wasm_sem_trywait:()=>A,wasm_sem_wait:()=>g});var n,i,a=r(81570),s=r(78716),o=r(134),u=r(80662),c=r.n(u),f=r(61499),h=r(12085),d=r(63939),l=r(79490),p=(0,a.A)((function e(){(0,s.A)(this,e),(0,o.A)(this,"tvSec",void 0),(0,o.A)(this,"tvNSec",void 0)}));function v(e,t,r){return l.Ts(e,r)}function m(e){return l.zr(e)}function g(e){return l.uk(e)}function A(e){return l.Zr(e)}function y(e,t){var r=1e3*Number(d.f[17](t))+d.f[15](t+8)/1e6;return l.XR(e,r)}function x(e){return l.bE(e)}n=p.prototype,(i=new(c())).set("tvSec",{0:17,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0}),i.set("tvNSec",{0:15,1:0,2:0,3:0,4:0,5:0,6:0,7:8,8:0}),(0,h.A)(n,f.Og,!0),(0,h.A)(n,f.dc,8),(0,h.A)(n,f.g7,16),(0,h.A)(n,f.JY,i)},6331:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(78716),i=r(81570),a=r(134),s=r(10576),o=function(){function e(t,r){(0,n.A)(this,e),(0,a.A)(this,"type",void 0),(0,a.A)(this,"phase",void 0),(0,a.A)(this,"ns",void 0),(0,a.A)(this,"target",void 0),(0,a.A)(this,"originalEvent",void 0),(0,a.A)(this,"isPrevented",void 0),(0,a.A)(this,"isStopped",void 0),(0,a.A)(this,"listener",void 0),this.type=t,this.phase=e.PHASE_CURRENT,r&&(this.originalEvent=r)}return(0,i.A)(e,[{key:"preventDefault",value:function(){var e=this;if(!e.isPrevented){var t=e.originalEvent;t&&t.preventDefault(),e.isPrevented=s.rT}return e}},{key:"stopPropagation",value:function(){var e=this;if(!e.isStopped){var t=e.originalEvent;t&&t.stopPropagation(),e.isStopped=s.rT}return e}},{key:"prevent",value:function(){return this.preventDefault()}},{key:"stop",value:function(){return this.stopPropagation()}}]),e}();(0,a.A)(o,"PHASE_CURRENT",0),(0,a.A)(o,"PHASE_UPWARD",1),(0,a.A)(o,"PHASE_DOWNWARD",s.Cy)},96172:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(78716),i=r(81570),a=r(134),s=r(67672),o=r(72739),u=r(6331),c=r(95335),f=r(20525),h=r(56401),d=r(10576),l=function(){function e(t){(0,n.A)(this,e),(0,a.A)(this,"ns",void 0),(0,a.A)(this,"listeners",void 0),(0,a.A)(this,"nativeListeners",void 0),this.ns=t||d.W8,this.listeners={}}return(0,i.A)(e,[{key:"fire",value:function(e,t,r){var n=this,i=s.Yj(e)?n.parse(e):e,a=n.listeners[i.type],f=d.rT;if(a){a=c.copy(a);var l=t&&t[0]instanceof u.A?t[0]:d.ZH;o.__(a,(function(e){if(m(i.ns,e,d.rT)&&o.zy(a,e)&&(!r||r(i,t,e))){l&&(l.listener=e.fn);var s=(0,h.A)(e.fn,e.ctx,t);return l&&(l.listener=d.ZH),e.num=e.num?e.num+1:1,e.num===e.max&&n.off(i,e.fn),l&&(s===d.W8?l.prevent().stop():l.isStopped&&(s=d.W8)),s===d.W8?f=d.W8:void 0}}))}return f}},{key:"on",value:function(e,t){var r=this.listeners,n=s.Pc(t)?{fn:t}:t;if(s.Ik(n)&&s.Pc(n.fn)){var i=s.Yj(e)?this.parse(e):e;n.ns=i.ns,o.VC(r[i.type]||(r[i.type]=[]),n)}return this}},{key:"one",value:function(e,t){return s.Pc(t)?t={fn:t,max:1}:t.max=1,this.on(e,t)}},{key:"off",value:function(e,t){var r=this,n=r.listeners;if(e){var i=s.Yj(e)?r.parse(e):e,a=i.type,u=i.ns,f=v(t);a?n[a]&&function(e,t){o.__(e,(function(t,r){f(t)&&e.splice(r,1)}),d.rT),e.length||delete n[t]}(n[a],a):u&&c.each(n,(function(e,t){o.__(e,(function(t,r){m(u,t)&&e.splice(r,1)}),d.rT),e.length||delete n[t]}))}else r.listeners={}}},{key:"has",value:function(e,t){var r,n=this.listeners,i=s.Yj(e)?this.parse(e):e,a=i.type,u=i.ns,f=d.rT,h=v(t);return a?n[a]&&(r=n[a],o.__(r,(function(e){if(h(e))return f=d.W8}))):u&&c.each(n,(function(e){return o.__(e,(function(e){if(m(u,e))return f=d.W8})),f})),!f}},{key:"parse",value:function(e){var t={type:e,ns:d.u1};if(this.ns){var r=f.qh(e,d.ZG);r>=0&&(t.type=f.di(e,0,r),t.ns=f.di(e,r+1))}return t}}]),e}();function p(){return d.rT}function v(e){return s.Pc(e)?function(t){return e===t.fn}:p}function m(e,t,r){var n=t.ns;return n&&e?n===e:r?d.rT:d.W8}},84504:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(2148);function i(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t.split("."),a=e.split("."),s=0;s<a.length;s++){if(r&&s==a.length-1&&(0,n.A)(a[s])>=(0,n.A)(i[s]))return a.length>=i.length;if((0,n.A)(a[s])>(0,n.A)(i[s]))return!0;if((0,n.A)(a[s])<(0,n.A)(i[s]))return!1;if(s===i.length-1&&s===a.length-1)return r;if(s===i.length-1)return!0;if(s===a.length-1)return!1}return!0}},92647:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(42096),i=r.n(n),a=r(75062),s=r.n(a),o=r(16091),u=r.n(o),c=r(68632),f=r.n(c);function h(e,t){var r=void 0!==s()&&e[u()]||e["@@iterator"];if(!r){if(f()(e)||(r=function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?i()(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,h=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){h=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(h)throw o}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){if(!t.length)return null;if(1===t.length)return t[0];var r,n,i=0,a=h(t);try{for(a.s();!(n=a.n()).done;)i+=(r=n.value).length}catch(e){a.e(e)}finally{a.f()}var s,o=new e(i),u=0,c=h(t);try{for(c.s();!(s=c.n()).done;)r=s.value,o.set(r,u),u+=r.length}catch(e){c.e(e)}finally{c.f()}return o}},78995:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(56401),i=r(72739),a=r(10576);function s(e,t,r){var s,o,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(){var c=this;u&&(o=i.$r(arguments)),s||(u||(o=i.$r(arguments)),r&&(0,n.A)(e,c,o),s=setTimeout((function(){s=a.ZH,r||(0,n.A)(e,c,o)}),t))}}},56401:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(67672),i=r(10576);function a(e,t,r){if(n.Pc(e))return n.YO(r)?e.apply(t,r):t!==i.ZH?e.call(t,r):r!==i.ZH?e(r):e()}},8284:(e,t,r)=>{"use strict";function n(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)}))}r.d(t,{A:()=>n})},86932:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(45249),i=r.n(n);function a(){return i()()}},54568:(e,t,r)=>{"use strict";function n(){return"function"==typeof registerProcessor&&"number"==typeof sampleRate&&"number"==typeof currentFrame&&"number"==typeof currentTime}r.d(t,{A:()=>n})},34677:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(10576);function i(e){return e!==n.ZH}},59135:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n,i=r(34677);function a(){if((0,i.A)(n))return n;var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),n=256===new Int16Array(e)[0]}},20491:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(67672),i=r(62100),a=r(20525);function s(e){return n.Pc(e)&&a.zy((0,i.A)(e),"[native code]")}},39638:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(23509),i=r(34677),a=r(54568);function s(){return!("object"===("undefined"==typeof window?"undefined":(0,n.A)(window))&&(0,i.A)(window.document)||(0,a.A)())}},7972:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(23509),i=r(64236),a=r.n(i),s=r(20491),o=r(10576);(void 0===a()?"undefined":(0,n.A)(a()))===o.s0&&(0,s.A)(a())&&a();const u=("undefined"==typeof MessageChannel?"undefined":(0,n.A)(MessageChannel))===o.s0&&(0,s.A)(MessageChannel)?function(e){var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(1)}:"function"==typeof setTimeout?setTimeout:function(e){setTimeout(e)}},36:(e,t,r)=>{"use strict";function n(e,t,r){return e<t?e=t:e>r&&(e=r),e}r.d(t,{A:()=>n})},61837:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(69736),i=r.n(n),a=r(73146),s=r.n(a),o='\nfunction webpackBootstrapFunc (modules) {\n  var installedModules = {};\n  function __webpack_require__(moduleId) {\n    if(installedModules[moduleId])\n    return installedModules[moduleId].exports;\n    var module = installedModules[moduleId] = {\n      i: moduleId,\n      l: false,\n      exports: {}\n    };\n    if (!modules[moduleId]) {\n      console.log(\'can not found module:\', moduleId)\n    }\n    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n    module.l = true;\n    return module.exports;\n  }\n  __webpack_require__.m = modules;\n  __webpack_require__.c = installedModules;\n  __webpack_require__.i = function(value) { return value; };\n  __webpack_require__.d = function(exports, definition, getter) {\n    if (typeof definition === \'string\') {\n      if(!__webpack_require__.o(exports, definition)) {\n        Object.defineProperty(exports, definition, {\n          enumerable: true,\n          get: getter\n        });\n      }\n    }\n    else {\n      for(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n          Object.defineProperty(exports, key, {\n            enumerable: true,\n            get: definition[key]\n          });\n        }\n      }\n    }\n  };\n  __webpack_require__.r = function(exports) {\n    if(typeof Symbol !== \'undefined\' && Symbol.toStringTag) {\n    \tObject.defineProperty(exports, Symbol.toStringTag, { value: \'Module\' });\n    }\n    Object.defineProperty(exports, \'__esModule\', { value: true });\n  };\n  __webpack_require__.f = {};\n  __webpack_require__.e = function(chunkId) {\n    return Promise.all(Object.keys(__webpack_require__.f).reduce(function (promises, key) {\n      __webpack_require__.f[key](chunkId, promises);\n        return promises;\n    \t}, []));\n\t};\n  __webpack_require__.u = function(chunkId) {\n    return chunkId + "LIB_NAME";\n  };\n  __webpack_require__.n = function(module) {\n    var getter = module && module.__esModule ?\n      function getDefault() { return module[\'default\']; } :\n      function getModuleExports() { return module; };\n    __webpack_require__.d(getter, \'a\', getter);\n    return getter;\n  };\n  (function() {\n    var installedChunks = {\n      "main": 0\n    };\n    __webpack_require__.f.j = function(chunkId, promises) {\n      var installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n      if (installedChunkData !== 0) {\n        if(installedChunkData) {\n          promises.push(installedChunkData[2]);\n        } else {\n          if (true) {\n            var promise = new Promise(function(resolve, reject){installedChunkData = installedChunks[chunkId] = [resolve, reject]});\n            promises.push(installedChunkData[2] = promise);\n            var url = __webpack_require__.p + __webpack_require__.u(chunkId);\n            var error = new Error();\n            var loadingEnded = function(event) {\n              if(__webpack_require__.o(installedChunks, chunkId)) {\n                installedChunkData = installedChunks[chunkId];\n                if(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n                if(installedChunkData) {\n                  var errorType = event && (event.type === \'load\' ? \'missing\' : event.type);\n                  var realSrc = url;\n                  error.message = "Loading chunk " + chunkId + " failed.\\n(" + errorType + ": " + realSrc + ")";\n                  error.name = "ChunkLoadError";\n                  error.type = errorType;\n                  error.request = realSrc;\n                  installedChunkData[1](error);\n                }\n              }\n            };\n            __webpack_require__.l(url, loadingEnded);\n          }\n        }\n      }\n    };\n    var webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n    var [chunkIds, moreModules, runtime] = data;\n    var moduleId, chunkId, i = 0;\n    if (chunkIds.some(function(id){return installedChunks[id] !== 0})) {\n      for(moduleId in moreModules) {\n        if(__webpack_require__.o(moreModules, moduleId)) {\n          __webpack_require__.m[moduleId] = moreModules[moduleId];\n        }\n      }\n      if(runtime) runtime(__webpack_require__);\n    }\n    if (parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n      for (;i < chunkIds.length; i++) {\n        chunkId = chunkIds[i];\n        if (__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n          installedChunks[chunkId][0]();\n        }\n        installedChunks[chunkId] = 0;\n      }\n    }\n    var self = typeof globalThis !== undefined ? globalThis : self\n    var exportName = \'LIBRARY_EXPORT_NAME\'\n    var chunkLoadingGlobal = self["webpackChunk" + exportName] = self["webpackChunk" + exportName] || [];\n    chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\n    chunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));\n  })();\n  (function() {\n    var inProgress = {};\n    __webpack_require__.l = function(url, done) {\n      if (inProgress[url]) { inProgress[url].push(done); return; }\n        inProgress[url] = [done];\n        var onComplete = function(event) {\n          clearTimeout(timeout);\n          var doneFns = inProgress[url];\n          delete inProgress[url];\n          doneFns && doneFns.forEach(function(fn){fn(event)});\n        }\n        var timeout = setTimeout(onComplete.bind(null, undefined, { type: "timeout" }), 120000);\n      import(url).then(function() {\n        onComplete({\n          type: "load"\n        })\n      }, function (error) {\n        onComplete({\n          type: "missing"\n        })\n      });\n    };\n  })();\n  __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n  __webpack_require__.p = "ROOT_URL";\n  __webpack_require__.oe = function(err) { console.error(err); throw err; };\n  var f = __webpack_require__(__webpack_require__.s = ENTRY_MODULE);\n  return f;\n}\n',u="[\\.|\\-|\\+|\\w|/|@|!]+",c="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+u+").*?\\)";function f(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function h(e,t,n,a){var s={};s[n]=[];var o=t.toString(),h=o.match(/^(function)?\s?\w*\(\w+,\s*(\w+),\s*(\w+)\)/);if(!h)return s;var d=h[3];a.__webpack_exports_process__||(a.__webpack_require__=d,a.__webpack_exports__=h[2],a.__webpack_exports_process__=!0);for(var l,p=new RegExp("(\\\\n|\\W)"+f(d)+c,"g");l=p.exec(o);)"dll-reference"!==l[3]&&s[n].push(l[3]);for(p=new RegExp("\\("+f(d)+'\\("(dll-reference\\s('+u+'))"\\)\\)'+c,"g");l=p.exec(o);)e[l[2]]||(s[n].push(l[1]),e[l[2]]=r(l[1]).m),s[l[2]]=s[l[2]]||[],s[l[2]].push(l[4]);for(var v,m=i()(s),g=0;g<m.length;g++)for(var A=0;A<s[m[g]].length;A++)v=+s[m[g]][A],isNaN(v)||(s[m[g]][A]=+s[m[g]][A]);return s}function d(e){return i()(e).reduce((function(t,r){return t||e[r].length>0}),!1)}function l(e,t){var n={main:r.m},a=function(e,t){for(var r={main:[t]},n={main:[],__webpack_exports__:"__webpack_exports__",__webpack_require__:"__webpack_require__",__webpack_exports_process__:!1},a={main:{}};d(r);)for(var s=i()(r),o=0;o<s.length;o++){var u=s[o],c=r[u].pop();if(a[u]=a[u]||{},!a[u][c]&&e[u][c]){a[u][c]=!0,n[u]=n[u]||[],n[u].push(c);for(var f=h(e,e[u][c],u,n),l=i()(f),p=0;p<l.length;p++)r[l[p]]=r[l[p]]||[],r[l[p]]=r[l[p]].concat(f[l[p]])}}return n}(n,e),u=s()(e);return"var "+t.varName+"=("+o.replace("ENTRY_MODULE",u).replace("ROOT_URL",r.p||"").replace("LIBRARY_EXPORT_NAME","AVPlayer").replace("LIB_NAME",r.u&&r.u("")||"")+")({"+a.main.map((function(e){var r=s()(e),i=r+": "+n.main[e].toString();if(r===u&&t.exportName&&t.pointName){var o=";".concat(a.__webpack_require__,".d(\n          ").concat(a.__webpack_exports__,',\n          "').concat(t.exportName,'",\n          function() {\n            if (').concat(t.exportIsClass,") {\n              for (var key in ").concat(a.__webpack_exports__,") {\n                if (key === '").concat(t.exportName,"') {\n                  continue;\n                }\n                var v = ").concat(a.__webpack_exports__,"[key];\n                if (typeof v === 'function' && v.name === '").concat(t.pointName,"') {\n                  return v;\n                }\n              }\n            }\n            return ").concat(t.pointName,";\n          }\n        );");i=i.slice(0,i.length-1)+o+"}"}return i})).join(",")+"});"}},2148:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(67672),i=r(10576);function a(e,t){return n.sH(e)?+e:t!==i.ZH?t:0}},62100:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(10576);function i(e,t){return e!=n.Cq&&e.toString?e.toString():t!==n.ZH?t:n.u1}},61403:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(81570),i=r(78716),a=r(134),s=r(67672),o=(0,n.A)((function e(){(0,i.A)(this,e),(0,a.A)(this,"proxy",void 0),this.proxy=new Proxy(this,{get:function(e,t,r){return s.sH(t)?e.getIndexValue(+t):e[t]},set:function(e,t,r,n){return s.sH(t)?e.setIndexValue(+t,r):e[t]=r,!0}})}))},37246:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(78716),i=r(81570),a=r(134),s=r(4624),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1048576;(0,n.A)(this,e),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"bitsLeft",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"endPointer",void 0),(0,a.A)(this,"error",void 0),(0,a.A)(this,"onFlush",void 0),this.pointer=0,this.bitsLeft=8,this.size=t,this.endPointer=0,this.error=0,this.buffer=new Uint8Array(this.size)}return(0,i.A)(e,[{key:"peekU1",value:function(){(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush();var e=this.pointer,t=this.bitsLeft;return 0===t&&(e++,t=8),this.buffer[e]>>t-1&1}},{key:"readU1",value:function(){var e;return(this.remainingLength()<1||1===this.remainingLength()&&0===this.bitsLeft)&&this.flush(),this.bitsLeft--,e=this.buffer[this.pointer]>>this.bitsLeft&1,0===this.bitsLeft&&(this.pointer++,this.bitsLeft=8),e}},{key:"readU",value:function(e){for(var t=0,r=0;r<e;r++)t|=this.readU1()<<e-r-1;return t}},{key:"remainingLength",value:function(){return this.endPointer-this.pointer}},{key:"getPos",value:function(){return this.pointer}},{key:"skip",value:function(e){var t=(e-e%8)/8;this.pointer+=t;var r=e%8;this.bitsLeft<=r?(this.pointer++,this.bitsLeft=8-(r-this.bitsLeft)):this.bitsLeft-=r}},{key:"flush",value:function(){if(!this.onFlush)throw this.error=-1048574,Error("IOReader error, flush failed because of no flush callback");if(0===this.bitsLeft&&this.pointer++,!(this.size-this.remainingLength()<=0))if(this.pointer<this.endPointer){this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0);var e=this.onFlush(this.buffer.subarray(this.endPointer-this.pointer,this.size));if(e<0)throw this.error=e,Error("IOReader error, flush failed");this.endPointer=this.endPointer-this.pointer+e,this.pointer=0}else{var t=this.onFlush(this.buffer);if(this.endPointer=t,this.pointer=0,this.bitsLeft=8,t<0)throw this.error=t,Error("IOReader error, flush failed")}}},{key:"getBuffer",value:function(){return this.buffer}},{key:"appendBuffer",value:function(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{var t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,s.R8("BSReader, call appendBuffer but the buffer's size is lagger then the remaining size","src/common/io/BitReader.ts",190)}}},{key:"clear",value:function(){this.pointer=this.endPointer=0,this.bitsLeft=8,this.error=0}},{key:"skipPadding",value:function(){this.bitsLeft<8&&(this.bitsLeft=8,this.pointer++)}}]),e}()},83314:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(78716),i=r(81570),a=r(134),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1048576;(0,n.A)(this,e),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"bitPointer",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"error",void 0),(0,a.A)(this,"onFlush",void 0),this.pointer=0,this.bitPointer=0,this.size=t,this.error=0,this.buffer=new Uint8Array(this.size)}return(0,i.A)(e,[{key:"writeU1",value:function(e){(this.remainingLength()<1||1===this.remainingLength()&&this.bitPointer>=8)&&this.flush(),1&e?this.buffer[this.pointer]|=1<<7-this.bitPointer:this.buffer[this.pointer]&=~(1<<7-this.bitPointer),this.bitPointer++,8===this.bitPointer&&(this.pointer++,this.bitPointer=0)}},{key:"writeU",value:function(e,t){for(var r=0;r<e;r++)this.writeU1(t>>e-r-1&1)}},{key:"remainingLength",value:function(){return this.size-this.pointer}},{key:"flush",value:function(){if(!this.onFlush)throw this.error=-1048574,Error("BSWriter error, flush failed because of no flush callback");if(this.pointer)if(this.bitPointer&&this.pointer>1){var e=this.onFlush(this.buffer.subarray(0,this.pointer-1));if(0!==e)throw this.error=e,Error("BSWriter error, flush failed");this.buffer[0]=this.buffer[this.pointer]}else if(0===this.bitPointer){var t=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==t)throw this.error=t,Error("BSWriter error, flush failed")}this.pointer=0}},{key:"padding",value:function(){for(;0!==this.bitPointer;)this.writeU1(0)}},{key:"clear",value:function(){this.pointer=0,this.bitPointer=0,this.error=0}},{key:"getBuffer",value:function(){return this.buffer}},{key:"getPointer",value:function(){return this.pointer}}]),e}()},31865:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(78716),i=r(81570),a=r(134),s=r(92647),o=r(50011),u=function(){function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,n.A)(this,e),(0,a.A)(this,"data",void 0),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"byteStart",void 0),(0,a.A)(this,"pos",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!r}return(0,i.A)(e,[{key:"readUint8",value:function(){return this.data.getUint8(this.pos+++this.byteStart)}},{key:"readUint16",value:function(){var e=this.data.getUint16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,e}},{key:"readUint24",value:function(){return this.readUint16()<<8|this.readUint8()}},{key:"readUint32",value:function(){var e=this.data.getUint32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,e}},{key:"readUint64",value:function(){var e=BigInt(this.readUint32()),t=BigInt(this.readUint32());return this.littleEndian?t<<BigInt(32)|e:e<<BigInt(32)|t}},{key:"readInt8",value:function(){return this.data.getInt8(this.pos+++this.byteStart)}},{key:"readInt16",value:function(){var e=this.data.getInt16(this.pos+this.byteStart,this.littleEndian);return this.pos+=2,e}},{key:"readInt32",value:function(){var e=this.data.getInt32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,e}},{key:"readInt64",value:function(){var e=BigInt(this.readInt32()),t=BigInt(this.readInt32());return this.littleEndian?t<<BigInt(32)|e:e<<BigInt(32)|t}},{key:"readFloat",value:function(){var e=this.data.getFloat32(this.pos+this.byteStart,this.littleEndian);return this.pos+=4,e}},{key:"readDouble",value:function(){var e=this.data.getFloat64(this.pos+this.byteStart,this.littleEndian);return this.pos+=8,e}},{key:"readHex",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="",r=0;r<e;r++){var n=this.readUint8().toString(16);t+=1===n.length?"0"+n:n}return t}},{key:"readString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="";if(e){for(var r=this.pos,n=0;n<e&&0===this.buffer[this.pos+n];n++)r++;t=o.decode(this.buffer.subarray(r,r+e))}return this.pos+=e,t}},{key:"readLine",value:function(){for(var e="",t=this.pos;t<this.size;t++)if(10===this.buffer[t]||13===this.buffer[t]){e+=this.readString(t-this.pos);break}for(var r=this.pos;r<this.size&&(10===this.buffer[r]||13===this.buffer[r]);r++)this.readUint8();return e}},{key:"getPos",value:function(){return BigInt(this.pos)}},{key:"seek",value:function(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}},{key:"skip",value:function(e){this.seek(this.pos+e)}},{key:"back",value:function(e){this.seek(this.pos-e)}},{key:"remainingSize",value:function(){return this.size-this.pos}},{key:"readBuffer",value:function(e){e=Math.min(e,this.remainingSize());var t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=e,t}},{key:"appendBuffer",value:function(e){this.buffer=(0,s.A)(Uint8Array,[this.buffer.slice(),e.slice()]),this.data=new DataView(this.buffer.buffer),this.size+=e.byteLength,this.byteStart=0}},{key:"resetBuffer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}]),e}()},729:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(78716),i=r(81570),a=r(134),s=r(4624),o=r(50011),u=function(){function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,n.A)(this,e),(0,a.A)(this,"data",void 0),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"byteStart",void 0),(0,a.A)(this,"pos",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"littleEndian",void 0),this.buffer=t,this.data=t instanceof Uint8Array?new DataView(t.buffer):t.view,this.byteStart=t instanceof Uint8Array?t.byteOffset:0,this.pos=0,this.size=t.byteLength,this.littleEndian=!r}return(0,i.A)(e,[{key:"writeUint8",value:function(e){this.data.setUint8(this.pos+++this.byteStart,e)}},{key:"writeUint16",value:function(e){this.data.setUint16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}},{key:"writeUint24",value:function(e){var t=3840&e,r=240&e,n=15&e;this.littleEndian?(this.writeUint8(n),this.writeUint8(r),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(r),this.writeUint8(n))}},{key:"writeUint32",value:function(e){this.data.setUint32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}},{key:"writeUint64",value:function(e){var t=e&BigInt(4294967295),r=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeUint32(Number(t)),this.writeUint32(Number(r))):(this.writeUint32(Number(r)),this.writeUint32(Number(t)))}},{key:"writeInt8",value:function(e){this.data.setInt8(this.pos+++this.byteStart,e)}},{key:"writeInt16",value:function(e){this.data.setInt16(this.pos+this.byteStart,e,this.littleEndian),this.pos+=2}},{key:"writeInt32",value:function(e){this.data.setInt32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}},{key:"writeInt64",value:function(e){var t=e&BigInt(4294967295),r=(e&BigInt(4294967295)<<BigInt(32))>>BigInt(32);this.littleEndian?(this.writeInt32(Number(t)),this.writeInt32(Number(r))):(this.writeInt32(Number(r)),this.writeInt32(Number(t)))}},{key:"writeFloat",value:function(e){this.data.setFloat32(this.pos+this.byteStart,e,this.littleEndian),this.pos+=4}},{key:"writeDouble",value:function(e){this.data.setFloat64(this.pos+this.byteStart,e,this.littleEndian),this.pos+=8}},{key:"getPos",value:function(){return this.pos}},{key:"seek",value:function(e){e>this.size&&(e=this.size),this.pos=Math.max(0,e)}},{key:"skip",value:function(e){this.seek(this.pos+e)}},{key:"back",value:function(e){this.seek(this.pos-e)}},{key:"remainingSize",value:function(){return this.size-this.pos}},{key:"writeBuffer",value:function(e){var t=e.length;this.remainingSize()<t&&(t=this.remainingSize(),s.R8("the remaining buffer size is smaller then the wrote buffer, hope set ".concat(e.length,", but set ").concat(t),"src/common/io/BufferWriter.ts",211)),this.buffer.set(e,this.pos),this.pos+=e.length}},{key:"writeString",value:function(e){var t=o.encode(e);return this.writeBuffer(t),t.length}},{key:"getWroteBuffer",value:function(){return this.buffer.subarray(0,this.pos)}},{key:"resetBuffer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.buffer=e,this.data=e instanceof Uint8Array?new DataView(e.buffer):e.view,this.byteStart=e instanceof Uint8Array?e.byteOffset:0,this.pos=0,this.size=e.byteLength,this.littleEndian=!t}}]),e}()},24175:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(4624),f=r(50011),h=r(13724),d="src/common/io/IOReader.ts",l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1048576,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;if((0,i.A)(this,e),(0,s.A)(this,"data",void 0),(0,s.A)(this,"buffer",void 0),(0,s.A)(this,"pointer",void 0),(0,s.A)(this,"endPointer",void 0),(0,s.A)(this,"pos",void 0),(0,s.A)(this,"size",void 0),(0,s.A)(this,"littleEndian",void 0),(0,s.A)(this,"fileSize_",void 0),(0,s.A)(this,"error",void 0),(0,s.A)(this,"onFlush",void 0),(0,s.A)(this,"onSeek",void 0),(0,s.A)(this,"onSize",void 0),(0,s.A)(this,"flags",void 0),this.pos=BigInt(0),this.pointer=0,this.error=0,this.endPointer=0,this.littleEndian=!r,this.flags=0,n&&n.view)this.size=n.length,this.buffer=n,this.data=n.view;else if(n&&!n.byteOffset)this.size=n.length,this.buffer=n,this.data=new DataView(this.buffer.buffer);else{if(n)throw new Error("not support subarray of ArrayBuffer");this.size=Math.max(t,102400),this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}var t,r,o,l,p,v,m,g,A,y,x,k,b,w,_,T,I,S,P,B,C,M,R,U,E,D,L,F,O,N,z,V,W,j,G,q,H;return(0,a.A)(e,[{key:"readUint8",value:(H=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<1)){e.next=3;break}return e.next=3,this.flush(1);case 3:return t=this.data.getUint8(this.pointer),this.pointer++,this.pos++,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return H.apply(this,arguments)})},{key:"peekUint8",value:(q=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<1)){e.next=3;break}return e.next=3,this.flush(1);case 3:return e.abrupt("return",this.data.getUint8(this.pointer));case 4:case"end":return e.stop()}}),e,this)}))),function(){return q.apply(this,arguments)})},{key:"readUint16",value:(G=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<2)){e.next=3;break}return e.next=3,this.flush(2);case 3:return t=this.data.getUint16(this.pointer,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return G.apply(this,arguments)})},{key:"peekUint16",value:(j=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<2)){e.next=3;break}return e.next=3,this.flush(2);case 3:return e.abrupt("return",this.data.getUint16(this.pointer,this.littleEndian));case 4:case"end":return e.stop()}}),e,this)}))),function(){return j.apply(this,arguments)})},{key:"readUint24",value:(W=(0,n.A)(u().mark((function e(){var t,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<3)){e.next=3;break}return e.next=3,this.flush(3);case 3:return e.next=5,this.readUint16();case 5:return t=e.sent,e.next=8,this.readUint8();case 8:return r=e.sent,e.abrupt("return",t<<8|r);case 10:case"end":return e.stop()}}),e,this)}))),function(){return W.apply(this,arguments)})},{key:"peekUint24",value:(V=(0,n.A)(u().mark((function e(){var t,r,n,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<3)){e.next=3;break}return e.next=3,this.flush(3);case 3:return t=this.pointer,r=this.pos,e.next=7,this.readUint16();case 7:return n=e.sent,e.next=10,this.readUint8();case 10:return i=e.sent,a=n<<8|i,this.pointer=t,this.pos=r,e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)}))),function(){return V.apply(this,arguments)})},{key:"readUint32",value:(z=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<4)){e.next=3;break}return e.next=3,this.flush(4);case 3:return t=this.data.getUint32(this.pointer,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return z.apply(this,arguments)})},{key:"peekUint32",value:(N=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<4)){e.next=3;break}return e.next=3,this.flush(4);case 3:return e.abrupt("return",this.data.getUint32(this.pointer,this.littleEndian));case 4:case"end":return e.stop()}}),e,this)}))),function(){return N.apply(this,arguments)})},{key:"readUint64",value:(O=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<8)){e.next=3;break}return e.next=3,this.flush(8);case 3:return t=this.data.getBigUint64(this.pointer,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return O.apply(this,arguments)})},{key:"peekUint64",value:(F=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<8)){e.next=3;break}return e.next=3,this.flush(8);case 3:return e.abrupt("return",this.data.getBigUint64(this.pointer,this.littleEndian));case 4:case"end":return e.stop()}}),e,this)}))),function(){return F.apply(this,arguments)})},{key:"readInt8",value:(L=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<1)){e.next=3;break}return e.next=3,this.flush(1);case 3:return t=this.data.getInt8(this.pointer),this.pointer++,this.pos++,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return L.apply(this,arguments)})},{key:"peekInt8",value:(D=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<1)){e.next=3;break}return e.next=3,this.flush(1);case 3:return e.abrupt("return",this.data.getInt8(this.pointer));case 4:case"end":return e.stop()}}),e,this)}))),function(){return D.apply(this,arguments)})},{key:"readInt16",value:(E=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<2)){e.next=3;break}return e.next=3,this.flush(2);case 3:return t=this.data.getInt16(this.pointer,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return E.apply(this,arguments)})},{key:"peekInt16",value:(U=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<2)){e.next=3;break}return e.next=3,this.flush(2);case 3:return e.abrupt("return",this.data.getInt16(this.pointer,this.littleEndian));case 4:case"end":return e.stop()}}),e,this)}))),function(){return U.apply(this,arguments)})},{key:"readInt32",value:(R=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<4)){e.next=3;break}return e.next=3,this.flush(4);case 3:return t=this.data.getInt32(this.pointer,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return R.apply(this,arguments)})},{key:"peekInt32",value:(M=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<4)){e.next=3;break}return e.next=3,this.flush(4);case 3:return e.abrupt("return",this.data.getInt32(this.pointer,this.littleEndian));case 4:case"end":return e.stop()}}),e,this)}))),function(){return M.apply(this,arguments)})},{key:"readInt64",value:(C=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<8)){e.next=3;break}return e.next=3,this.flush(8);case 3:return t=this.data.getBigInt64(this.pointer,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"peekInt64",value:(B=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<8)){e.next=3;break}return e.next=3,this.flush(8);case 3:return e.abrupt("return",this.data.getBigInt64(this.pointer,this.littleEndian));case 4:case"end":return e.stop()}}),e,this)}))),function(){return B.apply(this,arguments)})},{key:"readFloat",value:(P=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<4)){e.next=3;break}return e.next=3,this.flush(4);case 3:return t=this.data.getFloat32(this.pointer,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return P.apply(this,arguments)})},{key:"peekFloat",value:(S=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<4)){e.next=3;break}return e.next=3,this.flush(4);case 3:return e.abrupt("return",this.data.getFloat32(this.pointer,this.littleEndian));case 4:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)})},{key:"readDouble",value:(I=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<8)){e.next=3;break}return e.next=3,this.flush(8);case 3:return t=this.data.getFloat64(this.pointer,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"peekDouble",value:(T=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<8)){e.next=3;break}return e.next=3,this.flush(8);case 3:return e.abrupt("return",this.data.getFloat64(this.pointer,this.littleEndian));case 4:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"readHex",value:(_=(0,n.A)(u().mark((function e(){var t,r,n,i,a=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]?a[0]:1,r="",n=0;case 3:if(!(n<t)){e.next=11;break}return e.next=6,this.readUint8();case 6:i=e.sent.toString(16),r+=1===i.length?"0"+i:i;case 8:n++,e.next=3;break;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,this)}))),function(){return _.apply(this,arguments)})},{key:"peekHex",value:(w=(0,n.A)(u().mark((function e(){var t,r,n,i,a,s,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=o.length>0&&void 0!==o[0]?o[0]:1)>this.size&&(this.error=-1048574,c.h2("peekHex, length too large",d,334)),!(this.remainingLength()<t)){e.next=5;break}return e.next=5,this.flush(t);case 5:r=this.pointer,n=this.pos,i="",a=0;case 9:if(!(a<t)){e.next=17;break}return e.next=12,this.readUint8();case 12:s=e.sent.toString(16),i+=1===s.length?"0"+s:s;case 14:a++,e.next=9;break;case 17:return this.pointer=r,this.pos=n,e.abrupt("return",i);case 20:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"readBuffer",value:(b=(0,n.A)(u().mark((function e(t,r){var n,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r||(r=new Uint8Array(t)),!(this.remainingLength()<t)){e.next=17;break}n=0,this.remainingLength()>0&&(i=this.remainingLength(),r.set(this.buffer.subarray(this.pointer,this.pointer+i),n),n+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i);case 4:if(!(t>0)){e.next=15;break}return e.next=7,this.flush();case 7:a=Math.min(this.endPointer-this.pointer,t),r.set(this.buffer.subarray(this.pointer,this.pointer+a),n),n+=a,this.pointer+=a,this.pos+=BigInt(a),t-=a,e.next=4;break;case 15:e.next=20;break;case 17:r.set(this.buffer.subarray(this.pointer,this.pointer+t),0),this.pointer+=t,this.pos+=BigInt(t);case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return b.apply(this,arguments)})},{key:"readToBuffer",value:(k=(0,n.A)(u().mark((function e(t,r){var n,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<t)){e.next=27;break}n=0,this.remainingLength()>0&&(i=this.remainingLength(),r.set(this.buffer.subarray(this.pointer,this.pointer+i),n),n+=i,this.pointer+=i,this.pos+=BigInt(i),t-=i);case 3:if(!(t>0)){e.next=24;break}return e.prev=4,e.next=7,this.flush();case 7:e.next=16;break;case 9:if(e.prev=9,e.t0=e.catch(4),-1048576!==this.error||!n){e.next=15;break}return e.abrupt("return",n);case 15:throw e.t0;case 16:a=Math.min(this.endPointer-this.pointer,t),r.set(this.buffer.subarray(this.pointer,this.pointer+a),n),n+=a,this.pointer+=a,this.pos+=BigInt(a),t-=a,e.next=3;break;case 24:return e.abrupt("return",n);case 27:return r.set(this.buffer.subarray(this.pointer,this.pointer+t),0),this.pointer+=t,this.pos+=BigInt(t),e.abrupt("return",t);case 31:case"end":return e.stop()}}),e,this,[[4,9]])}))),function(e,t){return k.apply(this,arguments)})},{key:"peekBuffer",value:(x=(0,n.A)(u().mark((function e(t,r){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t>this.size&&(this.error=-1048574,c.h2("peekBuffer, length too large",d,455)),!(this.remainingLength()<t)){e.next=4;break}return e.next=4,this.flush(t);case 4:return r||(r=new Uint8Array(t)),r.set(this.buffer.subarray(this.pointer,this.pointer+t),0),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return x.apply(this,arguments)})},{key:"readString",value:(y=(0,n.A)(u().mark((function e(){var t,r,n=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,e.next=3,this.readBuffer(t);case 3:return r=e.sent,e.abrupt("return",f.decode(r));case 5:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"peekString",value:(A=(0,n.A)(u().mark((function e(){var t,r,n=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:1,e.next=3,this.peekBuffer(t);case 3:return r=e.sent,e.abrupt("return",f.decode(r));case 5:case"end":return e.stop()}}),e,this)}))),function(){return A.apply(this,arguments)})},{key:"readLine",value:(g=(0,n.A)(u().mark((function e(){var t,r,n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="";case 1:r=!1,n=this.pointer;case 4:if(!(n<this.endPointer)){e.next=16;break}if(10!==this.buffer[n]&&13!==this.buffer[n]){e.next=13;break}if(n===this.pointer){e.next=11;break}return e.t0=t,e.next=10,this.readString(n-this.pointer);case 10:t=e.t0+=e.sent;case 11:return r=!0,e.abrupt("break",16);case 13:n++,e.next=4;break;case 16:if(r){e.next=25;break}return e.t1=t,e.next=20,this.readString(this.remainingLength());case 20:return t=e.t1+=e.sent,e.next=23,this.flush();case 23:e.next=26;break;case 25:return e.abrupt("break",28);case 26:e.next=1;break;case 28:return e.next=30,this.peekUint8();case 30:if(10!==(i=e.sent)&&13!==i){e.next=38;break}if(this.pointer++,13!==i){e.next=38;break}return e.next=36,this.peekUint8();case 36:10===(i=e.sent)&&this.pointer++;case 38:return e.abrupt("return",t);case 39:case"end":return e.stop()}}),e,this)}))),function(){return g.apply(this,arguments)})},{key:"peekLine",value:(m=(0,n.A)(u().mark((function e(){var t,r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<this.size)){e.next=10;break}return e.prev=1,e.next=4,this.flush();case 4:e.next=10;break;case 6:if(e.prev=6,e.t0=e.catch(1),-1048576===this.error){e.next=10;break}throw e.t0;case 10:t="",r=!1,n=this.pointer;case 13:if(!(n<this.endPointer)){e.next=24;break}if(10!==this.buffer[n]&&13!==this.buffer[n]){e.next=21;break}return e.t1=t,e.next=18,this.peekString(n-this.pointer);case 18:return t=e.t1+=e.sent,r=!0,e.abrupt("break",24);case 21:n++,e.next=13;break;case 24:return r||(this.error=-1048574,c.h2("peekLine, out of buffer",d,552)),e.abrupt("return",t);case 26:case"end":return e.stop()}}),e,this,[[1,6]])}))),function(){return m.apply(this,arguments)})},{key:"getPointer",value:function(){return this.pointer}},{key:"getPos",value:function(){return this.pos}},{key:"skip",value:(v=(0,n.A)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t;case 1:if(!(this.remainingLength()<t)){e.next=8;break}return t-=this.remainingLength(),this.pointer=this.endPointer,e.next=6,this.flush();case 6:e.next=1;break;case 8:this.remainingLength()>=t&&(this.pointer+=t),this.pos+=BigInt(r);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"remainingLength",value:function(){return this.endPointer-this.pointer}},{key:"flush_",value:(p=(0,n.A)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.onFlush(t);case 3:if(-1048575===(r=e.sent)){e.next=6;break}return e.abrupt("return",r);case 6:return e.next=8,new h.A(0);case 8:e.next=0;break;case 10:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"flush",value:(l=(0,n.A)(u().mark((function e(){var t,r,n,i=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:0,this.onFlush||(this.error=-1048574,c.h2("IOReader error, flush failed because of no flush callback",d,620)),!(this.size-this.remainingLength()<=0)){e.next=4;break}return e.abrupt("return");case 4:if(t=Math.min(t,this.size),this.pointer<this.endPointer?(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer):this.endPointer=0,this.pointer=0,!t){e.next=20;break}case 8:if(!(this.remainingLength()<t)){e.next=18;break}return e.next=11,this.flush_(this.buffer.subarray(this.endPointer));case 11:if(!((r=e.sent)<0)){e.next=15;break}throw this.error=r,new Error("IOReader error, flush ".concat(-1048576===r?"ended":"failed",", ret: ").concat(r));case 15:this.endPointer+=r,e.next=8;break;case 18:e.next=27;break;case 20:return e.next=22,this.flush_(this.buffer.subarray(this.endPointer));case 22:if(!((n=e.sent)<0)){e.next=26;break}throw this.error=n,new Error("IOReader error, flush ".concat(-1048576===n?"ended":"failed",", ret: ").concat(n));case 26:this.endPointer+=n;case 27:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"seek",value:(o=(0,n.A)(u().mark((function e(t){var r,n,i,a=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(a.length>2&&void 0!==a[2])||a[2],a.length>1&&void 0!==a[1]&&a[1]){e.next=18;break}if(!((n=Number(t-this.pos))<0&&Math.abs(n)<this.pointer)){e.next=10;break}return this.pointer+=n,this.pos=t,e.abrupt("return");case 10:if(!(n>0&&this.pointer+n<this.endPointer)){e.next=16;break}return this.pointer+=n,this.pos=t,e.abrupt("return");case 16:if(0!==n){e.next=18;break}return e.abrupt("return");case 18:return this.onSeek||(this.error=-1048574,c.h2("IOReader error, seek failed because of no seek callback",d,681)),this.pointer=this.endPointer=0,this.pos=t,e.next=23,this.onSeek(t);case 23:if(0!==(i=e.sent)&&(this.error=i,c.h2("IOReader error, seek failed",d,690)),!r){e.next=28;break}return e.next=28,this.flush();case 28:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"getBuffer",value:function(){return this.buffer}},{key:"appendBuffer",value:function(e){if(this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else if(this.buffer.set(this.buffer.subarray(this.pointer,this.endPointer),0),this.endPointer=this.endPointer-this.pointer,this.pointer=0,this.size-this.endPointer>=e.length)this.buffer.set(e,this.endPointer),this.endPointer+=e.length;else{var t=Math.min(this.size-this.endPointer,e.length);this.buffer.set(e.subarray(0,t),this.endPointer),this.endPointer+=t,c.R8("IOReader, call appendBuffer but the buffer's size is lagger then the remaining size",d,720)}}},{key:"reset",value:function(){this.pointer=this.endPointer=0,this.pos=BigInt(0),this.error=0}},{key:"setEndian",value:function(e){this.littleEndian=!e}},{key:"fileSize",value:(r=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.fileSize_){e.next=2;break}return e.abrupt("return",this.fileSize_);case 2:return this.onSize||(this.error=-1048574,c.h2("IOReader error, fileSize failed because of no onSize callback",d,741)),e.next=5,this.onSize();case 5:return this.fileSize_=e.sent,e.abrupt("return",this.fileSize_);case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getBufferSize",value:function(){return this.size}},{key:"pipe",value:(t=(0,n.A)(u().mark((function e(t,r){var n,i,a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=28;break}if(!(this.remainingLength()<r)){e.next=22;break}if(!(this.remainingLength()>0)){e.next=9;break}return n=this.remainingLength(),e.next=6,t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+n));case 6:this.pointer+=n,this.pos+=BigInt(n),r-=n;case 9:if(!(r>0)){e.next=20;break}return e.next=12,this.flush();case 12:return i=Math.min(this.remainingLength(),r),e.next=15,t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+i));case 15:this.pointer+=i,this.pos+=BigInt(i),r-=i,e.next=9;break;case 20:e.next=26;break;case 22:return e.next=24,t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+r));case 24:this.pointer+=r,this.pos+=BigInt(r);case 26:e.next=45;break;case 28:if(!(this.remainingLength()>0)){e.next=34;break}return a=this.remainingLength(),e.next=32,t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+a));case 32:this.pointer+=a,this.pos+=BigInt(a);case 34:return e.next=36,this.flush_(this.buffer.subarray(0));case 36:if(e.t0=e.sent,!(e.t0>0)){e.next=45;break}return s=this.remainingLength(),e.next=41,t.writeBuffer(this.buffer.subarray(this.pointer,this.pointer+s));case 41:this.pointer+=s,this.pos+=BigInt(s),e.next=34;break;case 45:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),e}()},34531:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(50011),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1048576,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;if((0,i.A)(this,e),(0,s.A)(this,"data",void 0),(0,s.A)(this,"buffer",void 0),(0,s.A)(this,"pointer",void 0),(0,s.A)(this,"pos",void 0),(0,s.A)(this,"size",void 0),(0,s.A)(this,"littleEndian",void 0),(0,s.A)(this,"error",void 0),(0,s.A)(this,"onFlush",void 0),(0,s.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!r,this.error=0,n&&n.view)this.size=n.length,this.buffer=n,this.data=n.view;else if(n&&!n.byteOffset)this.size=n.length,this.buffer=n,this.data=new DataView(this.buffer.buffer);else{if(n)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}var t,r,o,f,h,d,l,p,v,m,g,A,y,x,k,b;return(0,a.A)(e,[{key:"writeUint8",value:(b=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<1)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setUint8(this.pointer,t),this.pointer++,this.pos++;case 6:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"writeUint16",value:(k=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<2)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setUint16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return k.apply(this,arguments)})},{key:"writeUint24",value:(x=(0,n.A)(u().mark((function e(t){var r,n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<3)){e.next=3;break}return e.next=3,this.flush();case 3:if(r=(16711680&t)>>16,n=(65280&t)>>8,i=255&t,!this.littleEndian){e.next=15;break}return e.next=9,this.writeUint8(i);case 9:return e.next=11,this.writeUint8(n);case 11:return e.next=13,this.writeUint8(r);case 13:e.next=21;break;case 15:return e.next=17,this.writeUint8(r);case 17:return e.next=19,this.writeUint8(n);case 19:return e.next=21,this.writeUint8(i);case 21:case"end":return e.stop()}}),e,this)}))),function(e){return x.apply(this,arguments)})},{key:"writeUint32",value:(y=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<4)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setUint32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"writeUint64",value:(A=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<8)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setBigUint64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return A.apply(this,arguments)})},{key:"writeInt8",value:(g=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<1)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setInt8(this.pointer,t),this.pointer++,this.pos++;case 6:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"writeInt16",value:(m=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<2)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setInt16(this.pointer,t,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"writeInt32",value:(v=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<4)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setInt32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"writeInt64",value:(p=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<8)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setBigInt64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"writeFloat",value:(l=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<4)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setFloat32(this.pointer,t,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"writeDouble",value:(d=(0,n.A)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.remainingLength()<8)){e.next=3;break}return e.next=3,this.flush();case 3:this.data.setFloat64(this.pointer,t,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getPointer",value:function(){return this.pointer}},{key:"getPos",value:function(){return this.pos}},{key:"remainingLength",value:function(){return this.size-this.pointer}},{key:"writeBuffer",value:(h=(0,n.A)(u().mark((function e(t){var r,n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return");case 2:if(r=t.length,!(this.remainingLength()<r)){e.next=18;break}n=0;case 5:if(!(r>0)){e.next=16;break}return e.next=8,this.flush();case 8:i=Math.min(this.size,r),this.buffer.set(t.subarray(n,n+i),this.pointer),this.pointer+=i,this.pos+=BigInt(i),n+=i,r-=i,e.next=5;break;case 16:e.next=21;break;case 18:this.buffer.set(t,this.pointer),this.pointer+=r,this.pos+=BigInt(r);case 21:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"writeString",value:(f=(0,n.A)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.encode(t),e.next=3,this.writeBuffer(r);case 3:return e.abrupt("return",r.length);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"encodeString",value:function(e){return c.encode(e)}},{key:"flush",value:(o=(0,n.A)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.onFlush){e.next=3;break}throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");case 3:if(!this.pointer){e.next=10;break}return e.next=6,this.onFlush(this.buffer.subarray(0,this.pointer));case 6:if(0===(t=e.sent)){e.next=10;break}throw this.error=t,Error("IOWriter error, flush failed");case 10:this.pointer=0;case 11:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"flushToPos",value:(r=(0,n.A)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.onFlush){e.next=3;break}throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");case 3:if(!this.pointer){e.next=10;break}return e.next=6,this.onFlush(this.buffer.subarray(0,this.pointer),t);case 6:if(0===(r=e.sent)){e.next=10;break}throw this.error=r,Error("IOWriter error, flush failed");case 10:this.pointer=0;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"seek",value:(t=(0,n.A)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.onSeek){e.next=3;break}throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");case 3:return e.next=5,this.flush();case 5:return e.next=7,this.onSeek(t);case 7:if(0===(r=e.sent)){e.next=11;break}throw this.error=r,Error("IOWriter error, seek failed");case 11:this.pos=t;case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"seekInline",value:function(e){var t=this.pointer;this.pointer=Math.max(0,Math.min(this.size,e)),this.pos+=BigInt(this.pointer-t)}},{key:"skip",value:function(e){var t=this.pointer;this.pointer=Math.min(this.size,this.pointer+e),this.pos+=BigInt(this.pointer-t)}},{key:"back",value:function(e){var t=this.pointer;this.pointer=Math.max(0,this.pointer-e),this.pos+=BigInt(this.pointer-t)}},{key:"getBuffer",value:function(){return this.buffer.subarray(0,this.pointer)}},{key:"setEndian",value:function(e){this.littleEndian=!e}},{key:"reset",value:function(){this.pointer=0,this.pos=BigInt(0),this.error=0}},{key:"getBufferSize",value:function(){return this.size}}]),e}()},35336:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(78716),i=r(81570),a=r(134),s=r(50011),o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1048576,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;if((0,n.A)(this,e),(0,a.A)(this,"data",void 0),(0,a.A)(this,"buffer",void 0),(0,a.A)(this,"pointer",void 0),(0,a.A)(this,"pos",void 0),(0,a.A)(this,"size",void 0),(0,a.A)(this,"littleEndian",void 0),(0,a.A)(this,"error",void 0),(0,a.A)(this,"onFlush",void 0),(0,a.A)(this,"onSeek",void 0),this.pointer=0,this.pos=BigInt(0),this.size=t,this.littleEndian=!r,this.error=0,i&&i.view)this.size=i.length,this.buffer=i,this.data=i.view;else if(i&&!i.byteOffset)this.size=i.length,this.buffer=i,this.data=new DataView(this.buffer.buffer);else{if(i)throw new Error("not support subarray of ArrayBuffer");this.buffer=new Uint8Array(this.size),this.data=new DataView(this.buffer.buffer)}}return(0,i.A)(e,[{key:"writeUint8",value:function(e){this.remainingLength()<1&&this.flush(),this.data.setUint8(this.pointer,e),this.pointer++,this.pos++}},{key:"writeUint16",value:function(e){this.remainingLength()<2&&this.flush(),this.data.setUint16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}},{key:"writeUint24",value:function(e){this.remainingLength()<3&&this.flush();var t=(16711680&e)>>16,r=(65280&e)>>8,n=255&e;this.littleEndian?(this.writeUint8(n),this.writeUint8(r),this.writeUint8(t)):(this.writeUint8(t),this.writeUint8(r),this.writeUint8(n))}},{key:"writeUint32",value:function(e){this.remainingLength()<4&&this.flush(),this.data.setUint32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}},{key:"writeUint64",value:function(e){this.remainingLength()<8&&this.flush(),this.data.setBigUint64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}},{key:"writeInt8",value:function(e){this.remainingLength()<1&&this.flush(),this.data.setInt8(this.pointer,e),this.pointer++,this.pos++}},{key:"writeInt16",value:function(e){this.remainingLength()<2&&this.flush(),this.data.setInt16(this.pointer,e,this.littleEndian),this.pointer+=2,this.pos+=BigInt(2)}},{key:"writeInt32",value:function(e){this.remainingLength()<4&&this.flush(),this.data.setInt32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}},{key:"writeInt64",value:function(e){this.remainingLength()<8&&this.flush(),this.data.setBigInt64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}},{key:"writeFloat",value:function(e){this.remainingLength()<4&&this.flush(),this.data.setFloat32(this.pointer,e,this.littleEndian),this.pointer+=4,this.pos+=BigInt(4)}},{key:"writeDouble",value:function(e){this.remainingLength()<8&&this.flush(),this.data.setFloat64(this.pointer,e,this.littleEndian),this.pointer+=8,this.pos+=BigInt(8)}},{key:"getPointer",value:function(){return this.pointer}},{key:"getPos",value:function(){return this.pos}},{key:"remainingLength",value:function(){return this.size-this.pointer}},{key:"writeBuffer",value:function(e){if(e.length){var t=e.length;if(this.remainingLength()<t)for(var r=0;t>0;){this.flush();var n=Math.min(this.size,t);this.buffer.set(e.subarray(r,r+n),this.pointer),this.pointer+=n,this.pos+=BigInt(n),r+=n,t-=n}else this.buffer.set(e,this.pointer),this.pointer+=t,this.pos+=BigInt(t)}}},{key:"writeString",value:function(e){var t=s.encode(e);return this.writeBuffer(t),t.length}},{key:"encodeString",value:function(e){return s.encode(e)}},{key:"flush",value:function(){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){var e=this.onFlush(this.buffer.subarray(0,this.pointer));if(0!==e)throw this.error=e,Error("IOWriter error, flush failed")}this.pointer=0}},{key:"flushToPos",value:function(e){if(!this.onFlush)throw this.error=-1048574,Error("IOWriter error, flush failed because of no flush callback");if(this.pointer){var t=this.onFlush(this.buffer.subarray(0,this.pointer),e);if(0!==t)throw this.error=t,Error("IOWriter error, flush failed")}this.pointer=0}},{key:"seek",value:function(e){if(!this.onSeek)throw this.error=-1048574,Error("IOWriter error, seek failed because of no seek callback");this.flush();var t=this.onSeek(e);if(0!==t)throw this.error=t,Error("IOWriter error, seek failed");this.pos=e}},{key:"seekInline",value:function(e){var t=this.pointer;this.pointer=Math.max(0,Math.min(this.size,e)),this.pos+=BigInt(this.pointer-t)}},{key:"skip",value:function(e){var t=this.pointer;this.pointer=Math.min(this.size,this.pointer+e),this.pos+=BigInt(this.pointer-t)}},{key:"back",value:function(e){var t=this.pointer;this.pointer=Math.max(0,this.pointer-e),this.pos+=BigInt(this.pointer-t)}},{key:"getBuffer",value:function(){return this.buffer.subarray(0,this.pointer)}},{key:"setEndian",value:function(e){this.littleEndian=!e}},{key:"reset",value:function(){this.pointer=0,this.pos=BigInt(0),this.error=0}},{key:"getBufferSize",value:function(){return this.size}}]),e}()},50400:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(78716),i=r(81570),a=r(134),s=r(92647),o=function(){function e(){(0,n.A)(this,e),(0,a.A)(this,"queue",void 0),(0,a.A)(this,"pos",void 0),(0,a.A)(this,"startPos",void 0),(0,a.A)(this,"endPos",void 0),(0,a.A)(this,"index",void 0),(0,a.A)(this,"offset",void 0),this.queue=[],this.startPos=BigInt(0),this.endPos=BigInt(0),this.pos=BigInt(0)}return(0,i.A)(e,[{key:"push",value:function(e){if(this.pos===this.endPos)this.queue.push(e),this.endPos+=BigInt(e.length),this.pos+=BigInt(e.length);else if(e.length<this.queue[this.index].length-this.offset)this.queue[this.index].set(e,this.offset),this.offset+=e.length,this.pos+=BigInt(e.length),this.offset===this.queue[this.index].length&&(this.index++,this.offset=0),this.index===this.queue.length&&(this.index=-1,this.offset=-1,this.pos=this.endPos);else for(var t=0;t<e.length;){var r=Math.min(this.queue[this.index].length-this.offset,e.length-t);if(this.queue[this.index].set(e.subarray(t,t+r),this.offset),t+=r,this.offset+=r,this.pos+=BigInt(r),this.offset===this.queue[this.index].length){if(this.index+1===this.queue.length){if(t<e.length){var n=e.subarray(e.length-t);this.queue.push(n),this.endPos+=BigInt(n.length)}this.pos=this.endPos,this.index=-1,this.offset=-1;break}this.index++,this.offset=0}}}},{key:"seek",value:function(e){if(e<this.startPos||e>this.endPos)return!1;this.pos=e,this.index=-1,this.offset=-1;for(var t=this.startPos,r=0;r<this.queue.length;r++){if(e<=t+BigInt(this.queue[r].length)){this.index=r,this.offset=Number(e-t);break}t+=BigInt(this.queue[r].length)}return this.index<0&&(this.pos=this.endPos),!0}},{key:"flush",value:function(){this.startPos=this.endPos,this.pos=this.endPos,this.index=-1,this.offset=-1;var e=(0,s.A)(Uint8Array,this.queue);return this.queue.length=0,e}},{key:"size",get:function(){return this.queue.length}}]),e}()},45726:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(78716),i=r(81570),a=r(134),s=r(72739),o=r(4624),u="src/common/math/Matrix3.ts",c=function(){function e(t){(0,n.A)(this,e),(0,a.A)(this,"element",void 0),t?(this.element=new Float32Array(9),this.set(t)):this.element=new Float32Array([1,0,0,0,1,0,0,0,1])}return(0,i.A)(e,[{key:"rc",value:function(e,t){return this.getValue(3*t+e)}},{key:"setRC",value:function(e,t,r){this.setValue(3*t+e,r)}},{key:"getValue",value:function(e){if(e>=0&&e<9)return this.element[e];o.z3("index out of Matrix4's rang [0 - 9]",u,47)}},{key:"setValue",value:function(e,t){e>=0&&e<9?this.element[e]=t:o.z3("index out of Matrix4's rang [0 - 9]",u,56)}},{key:"setIdentity",value:function(){return this.element=new Float32Array([1,0,0,0,1,0,0,0,1]),this}},{key:"set",value:function(e){var t=this;return s.__(e,(function(e,r){t.element[r]=e})),this}},{key:"invert",value:function(){var e=this.element,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],s=e[5],o=e[6],u=e[7],c=e[8],f=c*a-s*u,h=s*o-c*i,d=u*i-a*o,l=t*f+r*h+n*d;if(0===l)return this.set([0,0,0,0,0,0,0,0,0]);var p=1/l;return e[0]=f*p,e[1]=(n*u-c*r)*p,e[2]=(s*r-n*a)*p,e[3]=h*p,e[4]=(c*t-n*o)*p,e[5]=(n*i-s*t)*p,e[6]=d*p,e[7]=(r*o-u*t)*p,e[8]=(a*t-r*i)*p,this}},{key:"toArray",value:function(){for(var e=[],t=0;t<9;t++)e[t]=this.element[t];return e}},{key:"copy",value:function(){return(new e).set(this.toArray())}}],[{key:"RowMajor",value:function(t){return new e([t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]])}},{key:"ColMajor",value:function(t){return new e(t)}}]),e}()},12535:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var n,i=r(78716),a=r(81570),s=r(134),o=r(72739),u=r(4624),c=r(1064),f="src/common/math/Matrix4.ts",h=function(){function e(t){(0,i.A)(this,e),(0,s.A)(this,"element",void 0),t?(this.element=new Float32Array(16),this.set(t)):this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return(0,a.A)(e,[{key:"rc",value:function(e,t){return this.getValue(4*t+e)}},{key:"setRC",value:function(e,t,r){this.setValue(4*t+e,r)}},{key:"getValue",value:function(e){if(e>=0&&e<=15)return this.element[e];u.z3("index out of Matrix4's rang [0 - 15]",f,58)}},{key:"setValue",value:function(e,t){e>=0&&e<=15?this.element[e]=t:u.z3("index out of Matrix4's rang [0 - 15]",f,67)}},{key:"setIdentity",value:function(){return this.element=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this}},{key:"set",value:function(e){var t=this;return o.__(e,(function(e,r){t.element[r]=e})),this}},{key:"multiply",value:function(e){var t,r,n,i,a,s,o,u;if((i=r=this.element)===(n=e.element))for(n=new Float32Array(16),t=0;t<16;t++)n[t]=i[t];for(t=0;t<4;t++)a=r[t],s=r[t+4],o=r[t+8],u=r[t+12],i[t]=a*n[0]+s*n[1]+o*n[2]+u*n[3],i[t+4]=a*n[4]+s*n[5]+o*n[6]+u*n[7],i[t+8]=a*n[8]+s*n[9]+o*n[10]+u*n[11],i[t+12]=a*n[12]+s*n[13]+o*n[14]+u*n[15];return this}},{key:"multiplyVector3",value:function(e){var t=this.element,r=e.element;return new c.P([r[0]*t[0]+r[1]*t[4]+r[2]*t[8]+t[12],r[0]*t[1]+r[1]*t[5]+r[2]*t[9]+t[13],r[0]*t[2]+r[1]*t[6]+r[2]*t[10]+t[14]])}},{key:"multiplyVector4",value:function(e){var t=this.element,r=e.element;return new c.I([r[0]*t[0]+r[1]*t[4]+r[2]*t[8]+r[3]*t[12],r[0]*t[1]+r[1]*t[5]+r[2]*t[9]+r[3]*t[13],r[0]*t[2]+r[1]*t[6]+r[2]*t[10]+r[3]*t[14],r[0]*t[3]+r[1]*t[7]+r[2]*t[11]+r[3]*t[15]])}},{key:"transpose",value:function(){var e,t;return t=(e=this.element)[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}},{key:"setInverseOf",value:function(e){var t,r,n,i,a;if(r=e.element,n=this.element,(i=new Float32Array(16))[0]=r[5]*r[10]*r[15]-r[5]*r[11]*r[14]-r[9]*r[6]*r[15]+r[9]*r[7]*r[14]+r[13]*r[6]*r[11]-r[13]*r[7]*r[10],i[1]=-r[1]*r[10]*r[15]+r[1]*r[11]*r[14]+r[9]*r[2]*r[15]-r[9]*r[3]*r[14]-r[13]*r[2]*r[11]+r[13]*r[3]*r[10],i[2]=r[1]*r[6]*r[15]-r[1]*r[7]*r[14]-r[5]*r[2]*r[15]+r[5]*r[3]*r[14]+r[13]*r[2]*r[7]-r[13]*r[3]*r[6],i[3]=-r[1]*r[6]*r[11]+r[1]*r[7]*r[10]+r[5]*r[2]*r[11]-r[5]*r[3]*r[10]-r[9]*r[2]*r[7]+r[9]*r[3]*r[6],i[4]=-r[4]*r[10]*r[15]+r[4]*r[11]*r[14]+r[8]*r[6]*r[15]-r[8]*r[7]*r[14]-r[12]*r[6]*r[11]+r[12]*r[7]*r[10],i[5]=r[0]*r[10]*r[15]-r[0]*r[11]*r[14]-r[8]*r[2]*r[15]+r[8]*r[3]*r[14]+r[12]*r[2]*r[11]-r[12]*r[3]*r[10],i[6]=-r[0]*r[6]*r[15]+r[0]*r[7]*r[14]+r[4]*r[2]*r[15]-r[4]*r[3]*r[14]-r[12]*r[2]*r[7]+r[12]*r[3]*r[6],i[7]=r[0]*r[6]*r[11]-r[0]*r[7]*r[10]-r[4]*r[2]*r[11]+r[4]*r[3]*r[10]+r[8]*r[2]*r[7]-r[8]*r[3]*r[6],i[8]=r[4]*r[9]*r[15]-r[4]*r[11]*r[13]-r[8]*r[5]*r[15]+r[8]*r[7]*r[13]+r[12]*r[5]*r[11]-r[12]*r[7]*r[9],i[9]=-r[0]*r[9]*r[15]+r[0]*r[11]*r[13]+r[8]*r[1]*r[15]-r[8]*r[3]*r[13]-r[12]*r[1]*r[11]+r[12]*r[3]*r[9],i[10]=r[0]*r[5]*r[15]-r[0]*r[7]*r[13]-r[4]*r[1]*r[15]+r[4]*r[3]*r[13]+r[12]*r[1]*r[7]-r[12]*r[3]*r[5],i[11]=-r[0]*r[5]*r[11]+r[0]*r[7]*r[9]+r[4]*r[1]*r[11]-r[4]*r[3]*r[9]-r[8]*r[1]*r[7]+r[8]*r[3]*r[5],i[12]=-r[4]*r[9]*r[14]+r[4]*r[10]*r[13]+r[8]*r[5]*r[14]-r[8]*r[6]*r[13]-r[12]*r[5]*r[10]+r[12]*r[6]*r[9],i[13]=r[0]*r[9]*r[14]-r[0]*r[10]*r[13]-r[8]*r[1]*r[14]+r[8]*r[2]*r[13]+r[12]*r[1]*r[10]-r[12]*r[2]*r[9],i[14]=-r[0]*r[5]*r[14]+r[0]*r[6]*r[13]+r[4]*r[1]*r[14]-r[4]*r[2]*r[13]-r[12]*r[1]*r[6]+r[12]*r[2]*r[5],i[15]=r[0]*r[5]*r[10]-r[0]*r[6]*r[9]-r[4]*r[1]*r[10]+r[4]*r[2]*r[9]+r[8]*r[1]*r[6]-r[8]*r[2]*r[5],0==(a=r[0]*i[0]+r[1]*i[4]+r[2]*i[8]+r[3]*i[12]))return this;for(a=1/a,t=0;t<16;t++)n[t]=i[t]*a;return this}},{key:"invert",value:function(){return this.setInverseOf(this),this}},{key:"setOrtho",value:function(e,t,r,n,i,a){var s,o,c;return e!==t&&r!==n&&i!==a||u.h2("null frustum",f,240),s=1/(t-e),o=1/(n-r),c=1/(a-i),this.set([2*s,0,0,0,0,2*o,0,0,0,0,-2*c,0,-(t+e)*s,-(n+r)*o,-(a+i)*c,1]),this}},{key:"ortho",value:function(t,r,n,i,a,s){return this.multiply((new e).setOrtho(t,r,n,i,a,s))}},{key:"setFrustum",value:function(e,t,r,n,i,a){var s,o,c;return e!==t&&r!==n&&i!==a||u.z3("null frustum",f,281),i<=0&&u.h2("near <= 0",f,284),a<=0&&u.h2("far <= 0",f,287),s=1/(t-e),o=1/(n-r),c=1/(a-i),this.set([2*i*s,0,0,0,0,2*i*o,0,0,(t+e)*s,(n+r)*o,-(a+i)*c,-1,0,0,-2*i*a*c,0]),this}},{key:"frustum",value:function(t,r,n,i,a,s){return this.multiply((new e).setOrtho(t,r,n,i,a,s))}},{key:"setPerspective",value:function(e,t,r,n){var i,a,s;return r!==n&&0!==t||u.h2("null frustum",f,328),r<=0&&u.h2("near <= 0",f,331),n<=0&&u.h2("far <= 0",f,334),e=Math.PI*e/180/2,0===(a=Math.sin(e))&&u.h2("null frustum",f,342),i=1/(n-r),s=Math.cos(e)/a,this.set([s/t,0,0,0,0,s,0,0,0,0,-(n+r)*i,-1,0,0,-2*r*n*i,0]),this}},{key:"perspective",value:function(t,r,n,i){return this.multiply((new e).setPerspective(t,r,n,i))}},{key:"setScale",value:function(e){return this.set([e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1]),this}},{key:"scale",value:function(e){var t=this.element;return t[0]*=e.x,t[1]*=e.x,t[2]*=e.x,t[3]*=e.x,t[4]*=e.y,t[5]*=e.y,t[6]*=e.y,t[7]*=e.y,t[8]*=e.z,t[9]*=e.z,t[10]*=e.z,t[11]*=e.z,this}},{key:"setTranslate",value:function(e){return this.set([1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,e.z,1]),this}},{key:"preTranslate",value:function(e){var t=this.element;return t[12]+=t[0]*e.x+t[4]*e.y+t[8]*e.z,t[13]+=t[1]*e.x+t[5]*e.y+t[9]*e.z,t[14]+=t[2]*e.x+t[6]*e.y+t[10]*e.z,t[15]+=t[3]*e.x+t[7]*e.y+t[11]*e.z,this}},{key:"postTranslate",value:function(e){var t=this.element;return t[0]+=e.x*t[3],t[1]+=e.y*t[3],t[2]+=e.z*t[3],t[4]+=e.x*t[7],t[5]+=e.y*t[7],t[6]+=e.z*t[7],t[8]+=e.x*t[11],t[9]+=e.y*t[11],t[10]+=e.z*t[11],t[12]+=e.x*t[15],t[13]+=e.y*t[15],t[14]+=e.z*t[15],this}},{key:"setRotate",value:function(e,t){var r,n,i,a,s,o,u,c,f,h,d,l,p,v;return e=Math.PI*e/180,r=t.x,n=t.y,i=t.z,a=Math.sin(e),s=Math.cos(e),0!==t.x&&0===t.y&&0===t.z?(t.x<0&&(a=-a),this.set([1,0,0,0,0,s,-a,0,0,a,s,0,0,0,0,1])):0===t.x&&0!==t.y&&0===t.z?(t.y<0&&(a=-a),this.set([s,0,a,0,0,1,0,0,-a,0,s,0,0,0,0,1])):0===t.x&&0===t.y&&0!==t.z?(t.z<0&&(a=-a),this.set([s,-a,0,0,a,s,0,0,0,0,1,0,0,0,0,1])):(1!==(o=t.magnitude)&&(r*=u=1/o,n*=u,i*=u),c=1-s,f=r*n,h=n*i,d=i*r,l=r*a,p=n*a,v=i*a,this.set([r*r*c+s,f*c+v,d*c-p,0,f*c-v,n*n*c+s,h*c+l,0,d*c+p,h*c-l,i*i*c+s,0,0,0,0,1])),this}},{key:"rotate",value:function(t,r){return this.multiply((new e).setRotate(t,r)),this}},{key:"setLookAt",value:function(e,t,r){var n,i,a,s,o,u,f,h,d,l,p;return n=t.x-e.x,i=t.y-e.y,a=t.z-e.z,n*=s=1/Math.sqrt(n*n+i*i+a*a),a*=s,o=(i*=s)*r.z-a*r.y,u=a*r.x-n*r.z,f=n*r.y-i*r.x,d=(u*=h=1/Math.sqrt(o*o+u*u+f*f))*a-(f*=h)*i,l=f*n-(o*=h)*a,p=o*i-u*n,this.set([o,d,-n,0,u,l,-i,0,f,p,-a,0,0,0,0,1]),this.preTranslate(new c.P([-e.x,-e.y,-e.z]))}},{key:"lookAt",value:function(t,r,n){return this.multiply((new e).setLookAt(t,r,n))}},{key:"toArray",value:function(){for(var e=[],t=0;t<16;t++)e[t]=this.element[t];return e}},{key:"copy",value:function(){return(new e).set(this.toArray())}}],[{key:"shared",value:function(){return n||(n=new e)}},{key:"RowMajor",value:function(t){return new e([t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]])}},{key:"ColMajor",value:function(t){return new e(t)}}]),e}()},1064:(e,t,r)=>{"use strict";r.d(t,{I:()=>o,P:()=>s});var n=r(78716),i=r(81570),a=r(134),s=function(){function e(t){(0,n.A)(this,e),(0,a.A)(this,"element",void 0),this.element=new Float32Array(3),t&&(this.element[0]=t[0],this.element[1]=t[1],this.element[2]=t[2])}return(0,i.A)(e,[{key:"normalize",value:function(){var e=this.x,t=this.y,r=this.z,n=this.magnitude;return n?(1===n||(n=1/n,this.x=e*n,this.y=t*n,this.z=r*n),this):(this.x=this.y=this.z=0,this)}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"magnitude",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"sqrMagnitude",get:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"x",get:function(){return this.element[0]},set:function(e){this.element[0]=e}},{key:"y",get:function(){return this.element[1]},set:function(e){this.element[1]=e}},{key:"z",get:function(){return this.element[2]},set:function(e){this.element[2]=e}}]),e}(),o=(0,i.A)((function e(t){(0,n.A)(this,e),(0,a.A)(this,"element",void 0),this.element=new Float32Array(4),t&&(this.element[0]=t[0],this.element[1]=t[1],this.element[2]=t[2],this.element[4]=t[3])}))},31658:(e,t,r)=>{"use strict";function n(e,t){for(;0!==t;){var r=[t,e%t];e=r[0],t=r[1]}return e}r.d(t,{A:()=>n})},66551:(e,t,r)=>{"use strict";r.d(t,{B:()=>i});var n=r(45726);function i(e,t){for(var r=new n.A([0,0,0,0,0,0,0,0,0]),i=0;i<3;i++)for(var a=0;a<3;a++){var s=e.rc(i,0)*t.rc(0,a)+e.rc(i,1)*t.rc(1,a)+e.rc(i,2)*t.rc(2,a);r.setRC(i,a,s)}return r}},60153:(e,t,r)=>{"use strict";r.d(t,{Y3:()=>i});var n=r(1064);function i(e,t){for(var r=new n.P([0,0,0]),i=0;i<3;i++)r.element[i]=e.rc(i,0)*t.x+e.rc(i,1)*t.y+e.rc(i,2)*t.z;return r}},42577:(e,t,r)=>{"use strict";r.d(t,{A:()=>m});var n=r(88435),i=r.n(n),a=r(78716),s=r(81570),o=r(77193),u=r(25767),c=r(43070),f=r(31060),h=r(26492),d=r(134);function l(e,t,r){return t=(0,u.A)(t),(0,o.A)(e,p()?i()(t,r||[],(0,u.A)(e).constructor):t.apply(e,r))}function p(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(p=function(){return!!e})()}var v=function(e){function t(){var e;(0,a.A)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=l(this,t,[].concat(n)),(0,d.A)((0,c.A)(e),"peer",void 0),(0,d.A)((0,c.A)(e),"onmessage",void 0),(0,d.A)((0,c.A)(e),"onmessageerror",void 0),e}return(0,f.A)(t,e),(0,s.A)(t,[{key:"postMessage",value:function(e,t){var r;null!==(r=this.peer)&&void 0!==r&&r.onmessage&&this.peer.onmessage({data:e})}},{key:"close",value:function(){this.peer=null}},{key:"start",value:function(){}}]),t}((0,h.A)(EventTarget)),m=(0,s.A)((function e(){(0,a.A)(this,e),(0,d.A)(this,"port1",void 0),(0,d.A)(this,"port2",void 0),this.port1=new v,this.port2=new v,this.port1.peer=this.port2,this.port2.peer=this.port1}))},84149:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>T,S3:()=>_,Wo:()=>w});var n=r(88435),i=r.n(n),a=r(25182),s=r(78716),o=r(81570),u=r(77193),c=r(25767),f=r(43070),h=r(31060),d=r(134),l=r(36443),p=r.n(l),v=r(80662),m=r.n(v),g=r(54001),A=r.n(g),y=r(96172),x=r(34677);function k(e,t,r){return t=(0,c.A)(t),(0,u.A)(e,b()?i()(t,r||[],(0,c.A)(e).constructor):t.apply(e,r))}function b(){try{var e=!Boolean.prototype.valueOf.call(i()(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}var w="notify",_="request",T=function(e){function t(e){var r;return(0,s.A)(this,t),r=k(this,t,[!0]),(0,d.A)((0,f.A)(r),"port",void 0),(0,d.A)((0,f.A)(r),"requestMap",void 0),(0,d.A)((0,f.A)(r),"seq",void 0),(0,d.A)((0,f.A)(r),"closed",void 0),r.port=e,r.port.onmessage=r.handle.bind((0,f.A)(r)),r.seq=0,r.requestMap=new(m()),r.port.start(),r.closed=!1,r}var r;return(0,h.A)(t,e),(0,o.A)(t,[{key:"handle",value:function(e){var t=e.data,r=t.type,n=t.data;if("notify"===r)this.fire(w,n);else if("reply"===r){var i=this.requestMap.get(n.seq);i&&((0,x.A)(n.result)?i.resolve(n.result):n.error?i.reject(n.error):i.resolve(void 0),this.requestMap.delete(n.seq))}else"request"===r&&this.fire(_,n)}},{key:"notify",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.port.postMessage({type:"notify",data:{method:e,params:t}},r)}},{key:"request",value:(r=(0,a.A)(p().mark((function e(t){var r,n,i=this,a=arguments;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},n=a.length>2&&void 0!==a[2]?a[2]:[],e.abrupt("return",new(A())((function(e,a){var s=i.seq++;i.requestMap.set(s,{resolve:e,reject:a}),i.port.postMessage({type:"request",data:{seq:s,method:t,params:r}},n)})));case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"reply",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i={seq:e.seq};(0,x.A)(t)?i.result=t:r&&(i.error=r),null!=n&&n.length?this.port.postMessage({type:"reply",data:i},n):this.port.postMessage({type:"reply",data:i})}},{key:"getPort",value:function(){return this.port}},{key:"destroy",value:function(){this.requestMap.size&&(this.requestMap.forEach((function(e){e.reject("ipc port close")})),this.requestMap.clear()),this.port&&(this.port.close(),this.port=null),this.closed=!0}}]),t}(y.A)},6253:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n,i=r(78716),a=r(81570),s=r(134),o=r(39638),u=r(86932),c=r(47222),f=r(78995),h=0;function d(){return n?(h++,n):(n=new c.A,h=1,n)}function l(){0!==h&&0==--h&&(n.destroy(),n=null)}var p=function(){function e(t){var r=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,i.A)(this,e),(0,s.A)(this,"messageChannel",void 0),(0,s.A)(this,"interval",void 0),(0,s.A)(this,"started",void 0),(0,s.A)(this,"timer",void 0),(0,s.A)(this,"workerTimer",void 0),(0,s.A)(this,"workerSetTimeout",void 0),(0,s.A)(this,"onClock",void 0),(0,s.A)(this,"nextTick",void 0),(0,s.A)(this,"a",void 0),(0,s.A)(this,"b",void 0),(0,s.A)(this,"beta",void 0),(0,s.A)(this,"alpha",void 0),(0,s.A)(this,"count",void 0),(0,s.A)(this,"equivalent",void 0),(0,s.A)(this,"timestamp",void 0),(0,s.A)(this,"onVisibilityChange",void 0),(0,s.A)(this,"timeoutNext",void 0),(0,s.A)(this,"running",void 0),(0,s.A)(this,"highPerformance",void 0),this.started=!1,this.interval=t,this.highPerformance=n,this.a=.2,this.b=4,this.equivalent=50,this.timestamp=0,this.nextTick=function(){if(r.started&&!r.running)if(r.running=!0,r.interval>=4||!r.highPerformance)r.timeoutTick();else if(r.interval<=0)r.messageChannel.port1.postMessage(null);else{var e=(0,u.A)();e-r.timestamp>r.equivalent&&(r.count=0,r.timestamp=e),r.count<r.beta?r.messageChannel.port1.postMessage(null):r.timeoutTick()}},this.compute(),this.messageChannel=new MessageChannel,this.handleEvent(),this.timeoutNext=function(e){e?r.workerTimer=null:r.timer=null,r.running=!1,r.count++,r.onClock?r.onClock(r.nextTick):r.nextTick()},(0,o.A)()||"hidden"!==document.visibilityState||(this.workerSetTimeout=d()),this.running=!1}return(0,a.A)(e,[{key:"compute",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.interval>0&&(this.beta=Math.ceil(this.equivalent*(1-this.b/this.interval)/(this.a-this.b)),this.alpha=Math.floor(this.equivalent/this.interval-this.beta),e&&(this.count=0))}},{key:"timeoutTick",value:function(){this.workerSetTimeout&&"hidden"===document.visibilityState&&this.interval<1e3?this.workerTimer=this.workerSetTimeout.setTimeout(this.timeoutNext,this.interval):this.timer=setTimeout(this.timeoutNext,this.interval)}},{key:"start",value:function(){this.started||(this.started=!0,this.timestamp=(0,u.A)(),this.nextTick())}},{key:"stop",value:function(){this.started=!1,this.timer&&(clearTimeout(this.timer),this.timer=null),this.workerTimer&&this.workerSetTimeout&&this.workerSetTimeout.clearTimeout(this.workerTimer),this.running=!1}},{key:"isStarted",value:function(){return this.started}},{key:"setInterval",value:function(e){this.interval=Math.max(e,0),this.compute()}},{key:"getInterval",value:function(){return this.interval}},{key:"isZeroTimeout",value:function(){return this.interval<4}},{key:"destroy",value:function(){this.stop(),this.workerSetTimeout&&(l(),this.workerSetTimeout=null),this.onVisibilityChange&&(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.onVisibilityChange=null)}},{key:"handleEvent",value:function(){var e=this;this.messageChannel.port2.onmessage=function(){e.started&&(e.running=!1,e.count++,e.onClock?e.onClock(e.nextTick):e.nextTick())},(0,o.A)()||(this.onVisibilityChange=(0,f.A)((function(t){"hidden"===document.visibilityState?(e.workerSetTimeout=d(),e.timer&&(clearTimeout(e.timer),e.timer=null,e.running=!1),e.nextTick()):(e.workerTimer&&(e.workerSetTimeout.clearTimeout(e.workerTimer),e.workerTimer=null,e.running=!1),e.timer&&(clearTimeout(e.timer),e.timer=null,e.running=!1),l(),e.workerSetTimeout=null,e.nextTick())}),20),document.addEventListener("visibilitychange",this.onVisibilityChange))}}]),e}()},39148:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(25182),i=r(78716),a=r(81570),s=r(134),o=r(36443),u=r.n(o),c=r(54001),f=r.n(c),h=r(6253),d=r(86932),l=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];(0,i.A)(this,e),(0,s.A)(this,"task",void 0),(0,s.A)(this,"count",void 0),(0,s.A)(this,"emptyCount",void 0),(0,s.A)(this,"started",void 0),(0,s.A)(this,"clock",void 0),(0,s.A)(this,"timestamp",void 0),(0,s.A)(this,"timeout",void 0),(0,s.A)(this,"interval",void 0),(0,s.A)(this,"startTimer",void 0),(0,s.A)(this,"autoInterval",void 0),(0,s.A)(this,"sync",void 0),(0,s.A)(this,"tickAfter",void 0),(0,s.A)(this,"processing",void 0),this.task=t,this.timeout=n,this.interval=a,this.autoInterval=o,this.sync=u,this.count=0,this.emptyCount=0,this.timestamp=0,this.started=!1,this.processing=!1,this.clock=new h.A(this.interval),this.clock.onClock=function(e){if(r.started)if(r.count++,r.sync)r.tickAfter&&(r.tickAfter(),r.tickAfter=null),!1===r.task()?r.stop():r.next(e);else{if(r.processing)return;r.processing=!0,r.task().then((function(t){r.processing=!1,r.tickAfter&&(r.tickAfter(),r.tickAfter=null),!1===t?r.stop():r.next(e)}))}}}var t;return(0,a.A)(e,[{key:"next",value:function(e){if(this.started){var t=(0,d.A)();if(this.autoInterval&&t-this.timestamp>50){var r=this.emptyCount/this.count;0===this.emptyCount?this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)):r<.1?this.clock.setInterval(this.clock.getInterval()-1):r>.2?this.clock.setInterval(Math.min(this.clock.getInterval()+1,20)):r>.5&&this.clock.setInterval(this.clock.getInterval()<<1),this.count=0,this.emptyCount=0,this.timestamp=t}e()}}},{key:"start",value:function(){var e=this;this.started=!0,this.timeout?this.startTimer=setTimeout((function(){e.count=0,e.emptyCount=0,e.timestamp=(0,d.A)(),e.clock.start(),e.startTimer=null}),this.timeout):(this.count=0,this.emptyCount=0,this.timestamp=(0,d.A)(),this.clock.start())}},{key:"stop",value:function(){this.started=!1,this.processing=!1,this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.stop()}},{key:"stopBeforeNextTick",value:(t=(0,n.A)(u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.startTimer&&(clearTimeout(this.startTimer),this.startTimer=null),this.clock.isStarted()){e.next=3;break}return e.abrupt("return");case 3:if(!this.sync){e.next=9;break}this.started=!1,this.processing=!1,this.clock.stop(),e.next=10;break;case 9:return e.abrupt("return",new(f())((function(e){t.tickAfter=function(){t.started=!1,t.processing=!1,t.clock.stop(),e()}})));case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"isStarted",value:function(){return this.started}},{key:"emptyTask",value:function(){this.emptyCount++}},{key:"isZeroTimeout",value:function(){var e;return null===(e=this.clock)||void 0===e?void 0:e.isZeroTimeout()}},{key:"restart",value:function(){this.clock&&(this.stop(),this.clock.setInterval(this.interval),this.start())}},{key:"resetInterval",value:function(){this.clock.setInterval(Math.max(this.clock.getInterval()>>1,this.interval)),this.emptyCount=0,this.count=0,this.timestamp=(0,d.A)()}},{key:"destroy",value:function(){this.stop(),this.task=null,this.timeout=null,this.interval=null}}]),e}()},13724:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(78716),i=r(81570),a=r(134),s=r(45249),o=r.n(s),u=function(){function e(t){(0,n.A)(this,e),(0,a.A)(this,"timeout",void 0),(0,a.A)(this,"timer",void 0),(0,a.A)(this,"resolve",void 0),(0,a.A)(this,"reject",void 0),(0,a.A)(this,"startTime",void 0),this.timeout=t}return(0,i.A)(e,[{key:"then",value:function(e,t){var r=this;this.resolve=e,this.reject=t,this.startTime=o()(),this.timer=setTimeout((function(){r.resolve(o()()-r.startTime),r.timer=null}),1e3*this.timeout)}},{key:"stop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.timer&&(clearTimeout(this.timer),this.timer=null,this.resolve&&e?this.resolve(o()()-this.startTime):this.reject&&!e&&this.reject(o()()-this.startTime))}},{key:"reset",value:function(e){var t=this;e&&(this.timeout=e),this.timer&&(clearTimeout(this.timer),this.timer=setTimeout((function(){t.resolve(o()()-t.startTime),t.timer=null}),1e3*this.timeout))}}]),e}()},54058:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(78716),i=r(81570),a=r(134),s=function(){function e(t,r,i){(0,n.A)(this,e),(0,a.A)(this,"task",void 0),(0,a.A)(this,"timeout",void 0),(0,a.A)(this,"interval",void 0),(0,a.A)(this,"timer",void 0),this.task=t,this.timeout=r,this.interval=i}return(0,i.A)(e,[{key:"start",value:function(){var e=this;e.stop();var t=e.timeout,r=e.interval;null==t&&(t=r),e.timer=setTimeout((function t(){!1!==e.task()&&e.timer?e.timer=setTimeout(t,e.interval):e.stop()}),t)}},{key:"stop",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"updateInterval",value:function(e){this.interval=e}},{key:"isStarted",value:function(){return!!this.timer}},{key:"destroy",value:function(){this.stop(),this.task=this.timeout=this.interval=null}}]),e}()},47222:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(78716),i=r(81570),a=r(134),s=r(80662),o=r.n(s),u=r(61837);r(7903);var c=function(){function e(){var t=this;(0,n.A)(this,e),(0,a.A)(this,"worker",void 0),(0,a.A)(this,"workerUrl",void 0),(0,a.A)(this,"taskMap",void 0),(0,a.A)(this,"id",void 0),this.id=0,this.taskMap=new(o());var r="\n      ".concat((0,u.A)(7903,{varName:"workerSetTimeoutTask"}),"\n      workerSetTimeoutTask.default(self)\n    "),i=new Blob([r],{type:"text/javascript"});this.workerUrl=URL.createObjectURL(i),this.worker=new Worker(this.workerUrl),this.worker.addEventListener("message",(function(e){var r=e.data,n=r.type,i=r.id;if("pong"===n){var a=t.taskMap.get(i);a&&a(!0)}}))}return(0,i.A)(e,[{key:"setTimeout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.id++;return this.taskMap.set(r,e),this.worker.postMessage({type:"ping",data:{timeout:t,id:r}}),r}},{key:"clearTimeout",value:function(e){this.taskMap.delete(e)}},{key:"destroy",value:function(){this.worker&&(this.worker.terminate(),this.worker=null),this.workerUrl&&(URL.revokeObjectURL(this.workerUrl),this.workerUrl=null),this.taskMap&&(this.taskMap.clear(),this.taskMap=null)}}]),e}()},38724:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(78716),i=r(81570),a=r(134),s=r(6253),o=function(){function e(t,r,i){var o=this;(0,n.A)(this,e),(0,a.A)(this,"task",void 0),(0,a.A)(this,"timeout",void 0),(0,a.A)(this,"interval",void 0),(0,a.A)(this,"clock",void 0),(0,a.A)(this,"started",void 0),(0,a.A)(this,"timer",void 0),this.task=t,this.timeout=r,this.interval=i,this.started=!1,this.clock=new s.A(this.interval,!1),this.clock.onClock=function(e){o.started&&!1===o.task()?o.stop():e()}}return(0,i.A)(e,[{key:"start",value:function(){var e=this;this.started=!0,this.timeout>0?this.timer=setTimeout((function(){e.timer=null,e.clock.start()}),this.timeout):this.clock.start()}},{key:"stop",value:function(){this.started=!1,this.clock.stop(),this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"isStarted",value:function(){return this.started}},{key:"updateInterval",value:function(e){this.interval=e,this.clock.setInterval(e)}},{key:"destroy",value:function(){this.clock&&(this.stop(),this.clock.destroy(),this.clock=null),this.started=!1,this.task=this.timeout=this.interval=null}}]),e}()},7903:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(78716),i=r(81570),a=r(134),s=r(4624),o="src/common/timer/workerSetTimeoutTask.ts",u=function(){function e(t){(0,n.A)(this,e),(0,a.A)(this,"worker",void 0),this.worker=t,this.handleEvents()}return(0,i.A)(e,[{key:"handleEvents",value:function(){var e=this;this.worker.addEventListener("message",(function(t){var r,n=t.data.data;setTimeout((function(){e.worker.postMessage({type:"pong",id:n.id})}),Math.max(null!==(r=n.timeout)&&void 0!==r?r:0,4))}))}}]),e}();function c(e){try{new u(e)}catch(e){s.z3("new WorkerSetTimeout failed",o,32)}}},72739:(e,t,r)=>{"use strict";r.d(t,{$r:()=>h,El:()=>d,TF:()=>c,VC:()=>u,_:()=>l,__:()=>s,zy:()=>f});var n=r(67672),i=r(10576),a=r(56401);function s(e,t,r){if(e){var n=e.length;if(n)if(r)for(var a=n-1;a>=0&&t(e[a],a)!==i.W8;a--);else for(var s=0;s<n&&t(e[s],s)!==i.W8;s++);}}function o(e,t){e[e.length]=t}function u(e,t){!function(e,t,r){n.YO(t)?s(t,(function(t){r(e,t)})):r(e,t)}(e,t,o)}function c(e,t,r){var n=0;return s(e,(function(a,s){(r===i.W8?a==t:a===t)&&(e.splice(s,1),n++)}),i.rT),n}function f(e,t,r){return function(e,t,r){var n=i.Cy;return s(e,(function(e,a){if(r===i.W8?e==t:e===t)return n=a,i.W8})),n}(e,t,r)>=0}function h(e){return n.YO(e)?e:(0,a.A)(i.Ml.slice,e)}function d(e,t){for(var r=0,n=e.length-1,i=-1;r<=n;){var a=(r+n)/2>>>0,s=t(e[a]);if(0===s){i=a;break}1===s?r=a+1:(n=a-1,i=a)}return i}function l(e,t,r){var n=d(e,r);n>-1?e.splice(n,0,t):e.push(t)}},90932:(e,t,r)=>{"use strict";r.d(t,{l:()=>i});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";function i(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.length,i=0,a=0,s="",o=0;o<r;o++)for(a=a<<8|e[o],i+=8;i>=5;)s+=n[a>>>i-5&31],i-=5;if(i>0&&(s+=n[a<<5-i&31]),t)for(;s.length%8!=0;)s+="=";return s}},4919:(e,t,r)=>{"use strict";r.d(t,{E_:()=>a});var n=r(72739),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function a(e){for(var t="function"==typeof atob?atob(e):function(e){function t(e){var t=i.indexOf(e);return-1===t?0:t}for(var r="",n=0;n<e.length;){var a=t(e[n++]),s=t(e[n++]),o=t(e[n++]),u=t(e[n++]),c=a<<2|s>>4,f=(15&s)<<4|o>>2,h=(3&o)<<6|u;r+=String.fromCharCode(c),64!==o&&(r+=String.fromCharCode(f)),64!==u&&(r+=String.fromCharCode(h))}return r}(e),r=new Uint8Array(t.length),n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}var s={};n.__(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],(function(e,t){s[e]=t}))},43607:(e,t,r)=>{"use strict";function n(e){return e>0?e:-e}function i(e,t){return e>t?e:t}function a(e,t){return e>t?t:e}r.d(t,{T9:()=>i,jk:()=>a,tn:()=>n})},86834:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(23509),i=r(29967),a=r.n(i),s=r(72739),o=r(67672),u=r(84504);var c,f,h,d=(c=("object"===("undefined"==typeof navigator?"undefined":(0,n.A)(navigator))&&navigator.userAgent||"").toLowerCase(),(0,s.__)([["alipay",/alipay/],["wechat",/micromessenger/],["dingtalk",/dingtalk[ \/]([\d_.]+)/],["baiduApp",/baiduboxapp/],["baidu",/baidubrowser/],["baidu",/bdbrowser/],["uc",/ucbrowser/],["uc",/ucweb/],["qq",/qqbrowser/],["qqApp",/qq/],["ie",/iemobile[ \/]([\d_.]+)/],["ie",/msie[ \/]([\d_.]+)/],["ie",/trident[ \/]([\d_.]+)/,4],["edge",/edge[ \/]([\d_.]+)/],["newEdge",/edg[ \/]([\d_.]+)/],["chrome",/chrome[ \/]([\d_.]+)/],["firefox",/firefox[ \/]([\d_.]+)/],["opera",/opera(?:.*version)?[ \/]([\d_.]+)/],["safari",/version[ \/]([\d_.]+) safari/],["safari",/version[ \/]([\d_.]+) \S* safari/],["safari",/safari/]],(function(e){var t=e[1].exec(c);if(t)return f=e[0],(h=t[1])&&(h=h.replace(/_/g,"."),e[2]&&(h=a()(h,10)+e[2]+".0")),!1})),{name:f||"",version:h||"",majorVersion:({}[f]||function(e){return o.Yj(e)&&e.split(".").shift()||""})(h),checkVersion:{}[f]||u.A});d.name&&(d[d.name]=!0);const l=d},10576:(e,t,r)=>{"use strict";r.d(t,{Cq:()=>u,Cy:()=>f,M_:()=>v,Ml:()=>A,TK:()=>m,W8:()=>o,ZG:()=>l,ZH:()=>c,aV:()=>h,jf:()=>p,rT:()=>s,s0:()=>d,u1:()=>y,x7:()=>g});var n=r(23509),i=r(7403),a=r.n(i),s=!0,o=!1,u=null,c=void 0,f=-1,h="undefined",d="function",l=".",p=("undefined"==typeof window?"undefined":(0,n.A)(window))!==h?window:c,v=(("undefined"==typeof document?"undefined":(0,n.A)(document))!==h&&document,("undefined"==typeof globalThis?"undefined":(0,n.A)(globalThis))!==h?globalThis:(void 0===r.g?"undefined":(0,n.A)(r.g))!==h?r.g:p),m=("undefined"==typeof self?"undefined":(0,n.A)(self))!==h?self:v,g=function(){},A=(a()({}),a()([])),y=""},67672:(e,t,r)=>{"use strict";r.d(t,{Ik:()=>h,Pc:()=>c,Qd:()=>A,YO:()=>f,Yj:()=>d,ai:()=>l,o:()=>p,sH:()=>m,sv:()=>y,zM:()=>v});var n=r(23509),i=r(68632),a=r.n(i),s=r(88032),o=r.n(s),u=r(10576);function c(e){return(0,n.A)(e)===u.s0}function f(e){return a()(e)}function h(e){return e!==u.Cq&&"object"===(0,n.A)(e)}function d(e){return"string"==typeof e}function l(e){return"number"==typeof e&&!isNaN(e)}function p(e){return"bigint"==typeof e}function v(e){return"boolean"==typeof e}function m(e){return l(e)||d(e)&&!isNaN(o()(e))&&isFinite(+e)}var g={}.hasOwnProperty;function A(e){if(!h(e)||e.nodeType||e===e.window)return!1;if(e.constructor&&!g.call(e,"constructor")&&!g.call(e.constructor.prototype||{},"isPrototypeOf"))return!1;var t;for(t in e);return void 0===t||g.call(e,t)}function y(e){return e instanceof ArrayBuffer}},10534:(e,t,r)=>{"use strict";r.d(t,{__:()=>a});var n=r(10576),i={};function a(e,t){for(var r=i.hasOwnProperty(e)?i[e]:i[e]=e.split(n.ZG),a=0,s=r.length-1;a<=s&&t(r[a],a===s)!==n.W8;a++);}},4624:(e,t,r)=>{"use strict";r.d(t,{R8:()=>k,V$:()=>g,Yz:()=>y,h2:()=>w,pq:()=>x,rD:()=>u,z3:()=>b});var n=r(23509),i=r(10576),a=r(62100),s=0,o=1,u=2,c=3,f=4,h=5,d=("undefined"==typeof console?"undefined":(0,n.A)(console))!==i.aV?console:i.Cq,l=/common/.test((0,a.A)(i.x7))?u:c,p=(i.jf&&/edge|msie|trident/i.test(i.jf.navigator.userAgent),i.u1),v=d?p?function(e,t,r){d.log(p+e,r,t)}:function(e,t){d.log(e,t)}:i.x7;function m(){if(i.M_){var e=i.TK.COMMON_LOG_LEVEL;if(e>=s&&e<=h)return e}return l}function g(e){i.TK.COMMON_LOG_LEVEL=e}function A(e){return"background-color:".concat(e,";border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;")}function y(e,t,r){m()<=o&&v("[".concat(arguments[1],"][line ").concat(arguments[2],"] [debug]"),e,A("#999"))}function x(e,t,r){m()<=u&&v("[".concat(arguments[1],"][line ").concat(arguments[2],"] [info]"),e,A("#2db7f5"))}function k(e,t,r){m()<=c&&v("[".concat(arguments[1],"][line ").concat(arguments[2],"] [warn]"),e,A("#f90"))}function b(e,t,r){m()<=f&&v("[".concat(arguments[1],"][line ").concat(arguments[2],"] [error]"),e,A("#ed4014"))}function w(e,t,r){if(m()<=h)throw b(e,t,r),new Error("[".concat(arguments[1],"][line ").concat(arguments[2],"] [fatal]: ").concat(e))}},95335:(e,t,r)=>{"use strict";r.r(t),r.d(t,{clear:()=>v,copy:()=>y,diff:()=>_,each:()=>p,extend:()=>g,falsy:()=>w,get:()=>x,has:()=>b,keys:()=>f,merge:()=>A,param:()=>T,reverse:()=>P,set:()=>k,sort:()=>l,toArray:()=>I,update:()=>S});var n=r(69736),i=r.n(n),a=r(67672),s=r(72739),o=r(10576),u=r(10534),c=r(34677);function f(e){return(0,c.A)(e)?i()(e):[]}function h(e,t){return e.length-t.length}function d(e,t){return t.length-e.length}function l(e,t){return f(e).sort(t?d:h)}function p(e,t){for(var r in e)if(t(e[r],r)===o.W8)break}function v(e){p(e,(function(t,r){delete e[r]}))}function m(e,t){return a.Ik(e)?a.Ik(t)?(p(t,(function(t,r){e[r]=t})),e):e:t}function g(e,t,r){return m(m(e,t),r)}function A(e,t){return e&&t?g(g({},e),t):e||t}function y(e,t){var r=e;return a.YO(e)?t?(r=[],s.__(e,(function(e,n){r[n]=y(e,t)}))):r=e.slice():a.Ik(e)&&(r={},p(e,(function(e,n){r[n]=t?y(e,t):e}))),r}function x(e,t,r){var n;return u.__(t,(function(t,r){if(e==o.Cq)return n=o.ZH,o.W8;var i=e[t],a=i!==o.ZH;r?n=a?i:o.ZH:e=i})),n===o.ZH&&(n=r),n}function k(e,t,r,n){u.__(t,(function(t,i){if(i)e[t]=r;else if(e[t])e=e[t];else{if(!n)return o.W8;e=e[t]={}}}))}function b(e,t){return e[t]!==o.ZH}function w(e){return!a.Ik(e)||a.YO(e)||!f(e).length}function _(e,t){var r=[];return p(e,(function(e,n){a.YO(e)||a.Qd(e)?(null==t[n]||_(e,t[n]).length>0)&&r.push(n):e!==t[n]&&r.push(n)})),r}function T(e){var t=[],r=function(e,r){r=a.Pc(r)?r():null==r?"":r,t[t.length]=encodeURIComponent(e)+"="+encodeURIComponent(r)};return(a.YO(e)||a.Qd(e))&&(a.YO(e)?s.__(e,(function(e,t){r(t,e)})):p(e,(function(e,t){r(t,e)}))),t.join("&").replace(/%20/g,"+")}function I(e){var t=[];return p(e,(function(e){t.push(e)})),t}function S(e,t){if(a.Ik(e)&&a.Ik(t))return p(t,(function(r,n){a.Ik(r)&&a.Ik(e[n])?S(e[n],r):e[n]=t[n]})),e}function P(e){var t={};return p(e,(function(e,r){t[e]=r})),t}},44690:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n,i,a,s=r(23509),o=r(72739),u=(n=("object"===("undefined"==typeof navigator?"undefined":(0,s.A)(navigator))&&navigator.userAgent||"").toLowerCase(),(0,o.__)([["iphone",/iphone os ([\d_.]+)/],["ipad",/ipad; cpu os ([\d_.]+)/],["itouch",/itouch; cpu os ([\d_.]+)/],["android",/android ([\d_.]+)/],["wp",/windows phone ([\d_.]+)/],["windows",/windows nt ([\d_.]+)/],["linux",/linux/],["mac",/mac os x ([\d_.]+)/]],(function(e){var t=e[1].exec(n);if(t)return i=e[0],(a=t[1])&&(a=a.replace(/_/g,".")),!1})),{name:i||"",version:a||""});u.name&&(u[u.name]=!0,{iphone:1,ipad:1,itouch:1}[u.name]&&(u.ios=!0));const c=u},20525:(e,t,r)=>{"use strict";r.d(t,{GP:()=>h,di:()=>u,qh:()=>c,zy:()=>f});var n=r(29967),i=r.n(n),a=r(67672),s=r(10576),o=r(62100);function u(e,t,r){return a.ai(r)?t===r?s.u1:e.slice(t,r):e.slice(t)}function c(e,t,r){return e.indexOf(t,r!==s.ZH?r:0)}function f(e,t){return c(e,t)>=0}function h(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=0,s=r.length;return e.replace(/(%[sdvx%])|(%0(\d)+[dx])/g,(function(e){if(a>=s)return e;var t=r[a++];if(/%0(\d)+[dx]/g.test(e)){var n=i()(e.substring(1)),u="d"===e[e.length-1]?(0,o.A)(Number(t)):Number(t).toString(16);return n>u.length&&(u=new Array(n-u.length).fill("0").join("")+u),u}switch(e){case"%%":return"%";case"%s":return String(t);case"%d":return(0,o.A)(Number(t));case"%v":return"";case"%x":return Number(t).toString(16)}return e}))}},95797:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(23509),i=r(86834);const a=function(){var e="function"==typeof Blob,t="object"===("undefined"==typeof WebAssembly?"undefined":(0,n.A)(WebAssembly))&&"function"==typeof WebAssembly.instantiate,r="function"==typeof fetch,a="object"===("undefined"==typeof document?"undefined":(0,n.A)(document))&&document.createElement("canvas"),s=a&&!!a.getContext("webgl"),o="function"==typeof OffscreenCanvas,u="function"==typeof Worker,c="function"==typeof ArrayBuffer,f="object"===("undefined"==typeof Atomics?"undefined":(0,n.A)(Atomics)),h="function"==typeof AudioContext||"function"==typeof webkitAudioContext,d="function"==typeof AudioWorklet,l="function"==typeof VideoDecoder,p="function"==typeof VideoEncoder,v="function"==typeof AudioDecoder,m="function"==typeof AudioEncoder,g="function"==typeof SharedArrayBuffer,A="function"==typeof MediaSource||"function"==typeof ManagedMediaSource,y="function"==typeof Proxy,x=u&&g&&f&&y,k="function"==typeof WebAssembly.Suspending&&"function"==typeof WebAssembly.promising;i.A.safari&&!i.A.checkVersion(i.A.majorVersion,"11",!0)&&(t=!1),i.A.chrome&&!i.A.checkVersion(i.A.majorVersion,"94",!0)&&(l=!1,v=!1),i.A.safari&&!i.A.checkVersion(i.A.majorVersion,"17",!0)&&(l=!1);var b="object"===("undefined"==typeof navigator?"undefined":(0,n.A)(navigator))&&"object"===(0,n.A)(navigator.gpu),w="function"==typeof MediaSourceHandle,_=t&&"function"==typeof WebAssembly.Global;return{browser:i.A,blob:e,wasm:t,fetch:r,webgl:s,worker:u,mse:A,arrayBuffer:c,audioContext:h,audioWorklet:d,videoDecoder:l,videoEncoder:p,audioDecoder:v,audioEncoder:m,atomics:f,shareArrayBuffer:g,thread:x,webgpu:b,offscreenCanvas:o,workerMSE:w,webAssemblyGlobal:_,jspi:k,proxy:y,simd:(i.A.chrome||i.A.newEdge)&&i.A.checkVersion(i.A.majorVersion,"91",!0)||i.A.firefox&&i.A.checkVersion(i.A.majorVersion,"89",!0)||i.A.safari&&i.A.checkVersion(i.A.version,"16.4",!0),wasmBaseSupported:r&&t&&s&&h&&c&&_}}()},50011:(e,t,r)=>{"use strict";r.r(t),r.d(t,{decode:()=>s,encode:()=>a});var n="function"==typeof TextEncoder?new TextEncoder:null,i="function"==typeof TextDecoder?new TextDecoder:null;function a(e){if(n)return n.encode(e);for(var t=[],r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),i<=127?t.push(i):i<=2047?(t.push(192|i>>6),t.push(128|63&i)):i<=65535?(t.push(224|i>>12),t.push(128|i>>6&63),t.push(128|63&i)):(t.push(240|i>>18),t.push(128|i>>12&63),t.push(128|i>>6&63),t.push(128|63&i))}return new Uint8Array(t)}function s(e){if(e instanceof Uint8Array&&i&&!("function"==typeof SharedArrayBuffer&&e.buffer instanceof SharedArrayBuffer))return i.decode(e);for(var t="",r=0;r<e.length;){var n=e[r++>>>0];if(128&n){var a=63&e[r++>>>0];if(192!=(224&n)){var s=63&e[r++>>>0];if((n=224==(240&n)?(15&n)<<12|a<<6|s:(7&n)<<18|a<<12|s<<6|63&e[r++>>>0])<65536)t+=String.fromCharCode(n);else{var o=n-65536;t+=String.fromCharCode(55296|o>>10,56320|1023&o)}}else t+=String.fromCharCode((31&n)<<6|a)}else t+=String.fromCharCode(n)}return t}},54825:(e,t,r)=>{"use strict";function n(e){if(!(e=e.trim()))return-BigInt(1);var t=e.split(":"),r=BigInt(0);return 3===t.length&&(r+=BigInt(+t.shift().trim())*BigInt(36e5)),r+=BigInt(+t.shift().trim())*BigInt(6e4),t=t.shift().trim().split("."),(r+=BigInt(+t.shift().trim())*BigInt(1e3))+BigInt(+t.shift().trim())}function i(e){if(!(e=e.trim()))return-BigInt(1);var t=e.split(":"),r=BigInt(0);return 3===t.length&&(r+=BigInt(+t.shift().trim())*BigInt(36e5)),r+=BigInt(+t.shift().trim())*BigInt(6e4),t=t.shift().trim().split(","),(r+=BigInt(+t.shift().trim())*BigInt(1e3))+BigInt(+t.shift().trim())}r.d(t,{j:()=>n,t:()=>i})},8507:(e,t,r)=>{"use strict";function n(e){for(var t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],r={},n=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(e),i=14;i--;){var a;r[t[i]]=null!==(a=n[i])&&void 0!==a?a:""}return{protocol:r.protocol,file:r.file,host:r.host,port:r.port,user:r.user,password:r.password,origin:"".concat(r.protocol,"://").concat(r.authority),pathname:r.path,search:"?".concat(r.query),hash:r.anchor?"#".concat(r.anchor):""}}r.d(t,{ll:()=>h,qg:()=>n}),r(73146);var i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s=/^(?=([^\/?#]*))\1([^]*)$/,o=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/;function u(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}function c(e){var t=o.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null}function f(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")}function h(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=c(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=f(n.path),u(n)}var i=c(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=f(i.path),u(i)):t;var a=c(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var o=s.exec(a.path);a.netLoc=o[1],a.path=o[2]}a.netLoc&&!a.path&&(a.path="/");var h={scheme:a.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(h.netLoc=a.netLoc,"/"!==i.path[0]))if(i.path){var d=a.path,l=d.substring(0,d.lastIndexOf("/")+1)+i.path;h.path=f(l)}else h.path=a.path,i.params||(h.params=a.params,i.query||(h.query=a.query));return null===h.path&&(h.path=r.alwaysNormalize?f(i.path):i.path),u(h)}},88096:(e,t,r)=>{"use strict";r.d(t,{$z:()=>v,DD:()=>g,Ee:()=>h,GG:()=>u,p7:()=>l});var n=r(25182),i=r(36443),a=r.n(i),s=r(31865);function o(e){for(var t=0,r=0;;){var n=e.readUint8();if(t|=(127&n)<<r,r+=7,!(128&n))break}return t}function u(e){return c.apply(this,arguments)}function c(){return(c=(0,n.A)(a().mark((function e(t){var r,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,n=0;case 2:return e.next=5,t.readUint8();case 5:if(i=e.sent,r|=(127&i)<<n,n+=7,128&i){e.next=10;break}return e.abrupt("break",12);case 10:e.next=2;break;case 12:return e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){for(var t,r=0,n=0;r|=(127&(t=e.readUint8()))<<n,n+=7,128&t;);return 64&t&&(r|=-1<<n),r}function h(e){return d.apply(this,arguments)}function d(){return(d=(0,n.A)(a().mark((function e(t){var r,n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,n=0;case 2:return e.next=5,t.readUint8();case 5:if(i=e.sent,r|=(127&i)<<n,n+=7,128&i){e.next=10;break}return e.abrupt("break",12);case 10:e.next=2;break;case 12:return 64&i&&(r|=-1<<n),e.abrupt("return",r);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e,t){return p.apply(this,arguments)}function p(){return(p=(0,n.A)(a().mark((function e(t,r){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!0;case 1:if(!n){e.next=9;break}return i=127&r,0==(r>>=7)&&!(64&i)||-1===r&&64&i?n=!1:i|=128,e.next=7,t.writeUint8(i);case 7:e.next=1;break;case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t){return m.apply(this,arguments)}function m(){return(m=(0,n.A)(a().mark((function e(t,r){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=127&r,0!=(r>>=7)&&(n|=128),e.next=5,t.writeUint8(n);case 5:if(0!==r){e.next=0;break}case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t){var r=new s.A(e,!0);for(r.skip(8);r.remainingSize();){var n=r.readUint8(),i=o(r);if(2===n){for(var a=o(r);a--;){var u=o(r);r.skip(u);var c=o(r);switch(r.skip(c),r.readUint8()){case 0:o(r);break;case 3:f(r),o(r);break;case 2:var h=Number(r.getPos());return void(e[h]=t?2|e[h]:-3&e[h]);case 1:f(r);var d=o(r);o(r),1&d&&o(r)}}return}r.skip(i)}}},79331:(e,t,r)=>{"use strict";r.d(t,{A:()=>w});var n=r(69736),i=r.n(n),a=r(44301),s=r.n(a),o=r(82731),u=r.n(o),c=r(59614),f=r.n(c),h=r(969),d=r.n(h),l=r(66681),p=r.n(l),v=r(134),m=r(68632),g=r.n(m),A=r(72739);function y(e,t){var r=i()(e);if(s()){var n=s()(e);t&&(n=n.filter((function(t){return u()(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){(0,v.A)(e,t,r[t])})):f()?d()(e,f()(r)):y(Object(r)).forEach((function(t){p()(e,t,u()(r,t))}))}return e}var k={aloneValueName:"_@attribute"},b=[" ","/",'"',"'","<",">"];function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k;e=(e=(e=(e=e.replace(/<!--[\s\S]*?-->/g,"")).replace(/[\n\t\r]/g,"")).replace(/>[ \t]+</g,"><")).replace(/<\?[^>]*\?>/g,"");var r=[],n=0;function i(e,n){var i=r[r.length-1];i&&(e===t.aloneValueName||null==i.obj[t.aloneValueName]?null==i.obj[e]?i.obj[e]=n:g()(i.obj[e])?i.obj[e].push(n):i.obj[e]=[i.obj[e],n]:i.obj[t.aloneValueName]=[i.obj[t.aloneValueName],x({tagName:e},n)])}function a(t){for(;n<e.length;){if(e[n]===t)return!0;n++}return!1}function s(){o();for(var t="";n<e.length&&!A.zy(b,e[n]);)t+=e[n],n++;return t}function o(){for(;n<e.length&&/\s|\r|\n/.test(e[n]);)n++}var u=/\s/,c=/'/,f=/"/;function h(){if(n>=e.length)return!0;o();var t=u;'"'!==e[n]&&"'"!=e[n]||(t='"'===e[n]?f:c,n++);for(var r="";n<e.length;){if(t.test(e[n])){n++;break}r+=e[n],n++}return r}function d(){o();for(var t="";n<e.length&&"<"!==e[n];)t+=e[n],n++;return t}function l(){for(;"<"===e[n];){var t=n;if(n++,o(),"/"!==e[n]){n=t;break}if(n++,s()===r[r.length-1].tag){if(r.length>1){var u=r.pop();i(u.tag,u.obj)}a(">"),n++,o()}else r.pop(),a(">"),n++,o()}}return function u(){if(!(n>=e.length)){var c=n;if(o(),"<"!==e[n])return n=c,i(t.aloneValueName,d()),l(),u();var f=a("<");if(f){c=n,n++;var p=s();if(r.push({obj:{},tag:p,start:c}),function(){for(;o(),">"!==e[n]&&"/"!==e[n];){var t=s();if(!t)break;"="===t[t.length-1]?t=t.substring(0,t.length-1):(a("="),n++),i(t,h())}}(),o(),"/"===e[n]){if(n++,r.length>1){var v=r.pop();i(v.tag,v.obj)}return a(">"),n++,l(),u()}(f=a(">"))&&(n++,o(),"<"!==e[n]&&(i(t.aloneValueName,d()),o()),l(),u())}}}(),(0,v.A)({},r[0].tag,r[0].obj)}},34268:(e,t,r)=>{"use strict";var n=r(25182),i=r(134),a=r(36443),s=r.n(a),o=r(54001),u=r.n(o),c=r(84149),f=r(87503),h=r(67672),d=r(4624),l=r(44690),p=l.A.windows||l.A.mac||l.A.linux?10:20;class v extends f.A{constructor(){var e;super(),e=this,(0,i.A)(this,"pullIPC",void 0),(0,i.A)(this,"frontBuffer",void 0),(0,i.A)(this,"backBuffer",void 0),(0,i.A)(this,"channels",void 0),(0,i.A)(this,"backBufferOffset",void 0),(0,i.A)(this,"ended",void 0),(0,i.A)(this,"frontBuffered",void 0),(0,i.A)(this,"pause",void 0),(0,i.A)(this,"firstRendered",void 0),(0,i.A)(this,"stopped",void 0),(0,i.A)(this,"afterPullResolve",void 0),this.ended=!1,this.pause=!0,this.ipcPort.on(c.S3,function(){var t=(0,n.A)(s().mark((function t(r){var n,i,a,o,f,h,d;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r.method,t.next="init"===t.t0?3:"start"===t.t0?5:"restart"===t.t0?24:"clear"===t.t0?43:"stop"===t.t0?46:"pause"===t.t0?53:"unpause"===t.t0?56:59;break;case 3:return e.ipcPort.reply(r),t.abrupt("break",59);case 5:return n=r.params,i=n.port,a=n.channels,e.channels=a,e.pullIPC=new c.Ay(i),o=[],f=[],t.next=12,e.pull(o);case 12:return t.next=14,e.pull(f);case 14:return e.frontBuffer=f,e.backBuffer=o,e.backBufferOffset=0,e.ended=!1,e.frontBuffered=!0,e.pause=!1,e.firstRendered=!1,e.stopped=!1,e.ipcPort.reply(r),t.abrupt("break",59);case 24:if(e.ended){t.next=27;break}return e.ipcPort.reply(r),t.abrupt("return");case 27:return h=[],d=[],t.next=31,e.pull(h);case 31:return t.next=33,e.pull(d);case 33:return e.frontBuffer=d,e.backBuffer=h,e.backBufferOffset=0,e.ended=!1,e.frontBuffered=!0,e.pause=!1,e.firstRendered=!1,e.stopped=!1,e.ipcPort.reply(r),t.abrupt("break",59);case 43:return e.backBufferOffset=p,e.ipcPort.reply(r),t.abrupt("break",59);case 46:if(e.ended||e.pause){t.next=49;break}return t.next=49,new(u())((t=>{e.afterPullResolve=t}));case 49:return e.stopped=!0,e.pullIPC.destroy(),e.ipcPort.reply(r),t.abrupt("break",59);case 53:return e.pause=!0,e.ipcPort.reply(r),t.abrupt("break",59);case 56:return e.pause=!1,e.ipcPort.reply(r),t.abrupt("break",59);case 59:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}pull(e){var t=this;return(0,n.A)(s().mark((function r(){var n,i,a;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.pullIPC.request("pullBuffer",{nbSamples:128*p});case 2:if(n=r.sent,h.ai(n))t.ended=!0;else for(i=new Float32Array(n),a=0;a<t.channels;a++)e[a]=i.subarray(a*p*128,(a+1)*p*128);t.afterPullResolve&&t.afterPullResolve();case 5:case"end":return r.stop()}}),r)})))()}swapBuffer(){return!!this.frontBuffered&&(this.backBuffer=this.frontBuffer,this.backBufferOffset=0,this.frontBuffer=[],this.frontBuffered=!1,this.pull(this.frontBuffer).then((()=>{this.frontBuffered=!0})),!0)}process(e,t,r){if(this.stopped)return!1;if(this.backBuffer&&!this.pause){if(this.backBufferOffset===p){if(this.ended)return this.backBuffer=null,this.frontBuffer=null,d.pq("audio source ended","src/avrender/pcm/AudioSourceWorkletProcessor.ts",199),this.ipcPort.notify("ended"),!0;if(!this.swapBuffer())return this.ipcPort.notify("stutter"),!0}for(var n=t[0],i=0;i<this.channels;i++)n[i].set(this.backBuffer[i].subarray(128*this.backBufferOffset,128*(this.backBufferOffset+1)),0);this.backBufferOffset++,this.firstRendered||(this.firstRendered=!0,this.ipcPort.notify("firstRendered"))}return!0}}registerProcessor("audio-source-processor",v)},5676:(e,t,r)=>{"use strict";var n=r(25182),i=r(134),a=r(36443),s=r.n(a),o=r(54001),u=r.n(o),c=r(63939),f=r(50932),h=r(84149),d=r(87503),l=r(11473),p=r(37837),v=r(4624),m=r(44690),g=m.A.windows||m.A.mac||m.A.linux?10:20;class A extends d.A{constructor(){var e;super(),e=this,(0,i.A)(this,"pullIPC",void 0),(0,i.A)(this,"frontBuffer",void 0),(0,i.A)(this,"backBuffer",void 0),(0,i.A)(this,"channels",void 0),(0,i.A)(this,"backBufferOffset",void 0),(0,i.A)(this,"ended",void 0),(0,i.A)(this,"frontBuffered",void 0),(0,i.A)(this,"firstRendered",void 0),(0,i.A)(this,"float32",void 0),(0,i.A)(this,"pause",void 0),(0,i.A)(this,"stopped",void 0),(0,i.A)(this,"afterPullResolve",void 0),this.ended=!1,this.pause=!0,this.ipcPort.on(h.S3,function(){var t=(0,n.A)(s().mark((function t(r){var n,i,a,o,c,f,d,p;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r.method,t.next="init"===t.t0?3:"start"===t.t0?8:"restart"===t.t0?28:"stop"===t.t0?48:"clear"===t.t0?59:"pause"===t.t0?62:"unpause"===t.t0?65:68;break;case 3:return n=r.params.memory,t.next=6,(0,l.Tg)({memory:n,disableAsm:!0});case 6:return e.ipcPort.reply(r),t.abrupt("break",68);case 8:return i=r.params,a=i.port,o=i.channels,e.channels=o,e.pullIPC=new h.Ay(a),c=e.allocBuffer(),f=e.allocBuffer(),t.next=15,e.pullIPC.request("pull",{buffer:f});case 15:return t.next=17,e.pullIPC.request("pull",{buffer:c});case 17:return e.frontBuffer=c,e.backBuffer=f,e.backBufferOffset=0,e.ended=!1,e.pause=!1,e.frontBuffered=!0,e.firstRendered=!1,e.stopped=!1,e.float32=new Float32Array((0,l.eq)().buffer),e.ipcPort.reply(r),t.abrupt("break",68);case 28:if(e.ended){t.next=31;break}return e.ipcPort.reply(r),t.abrupt("return");case 31:return d=e.allocBuffer(),p=e.allocBuffer(),t.next=35,e.pullIPC.request("pull",{buffer:p});case 35:return t.next=37,e.pullIPC.request("pull",{buffer:d});case 37:return e.frontBuffer=d,e.backBuffer=p,e.backBufferOffset=0,e.ended=!1,e.pause=!1,e.frontBuffered=!0,e.firstRendered=!1,e.stopped=!1,e.float32=new Float32Array((0,l.eq)().buffer),e.ipcPort.reply(r),t.abrupt("break",68);case 48:if(e.ended||e.pause){t.next=51;break}return t.next=51,new(u())((t=>{e.afterPullResolve=t}));case 51:return e.freeBuffer(e.backBuffer),e.freeBuffer(e.frontBuffer),e.backBuffer=0,e.frontBuffer=0,e.stopped=!0,e.pullIPC.destroy(),e.ipcPort.reply(r),t.abrupt("break",68);case 59:return e.backBufferOffset=g,e.ipcPort.reply(r),t.abrupt("break",68);case 62:return e.pause=!0,e.ipcPort.reply(r),t.abrupt("break",68);case 65:return e.pause=!1,e.ipcPort.reply(r),t.abrupt("break",68);case 68:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}allocBuffer(){var e=(0,p.Gy)(40);f.M[20](e,(0,p.Gy)(4*this.channels));for(var t=(0,p.Gy)(512*g*this.channels),r=0;r<this.channels;r++)f.M[20](c.f[20](e)+4*r,t+128*g*4*r);return f.M[15](e+12,128*g),e}freeBuffer(e){e&&((0,p.aI)(c.f[20](e)),(0,p.aI)(e),(0,p.Eb)(e))}pull(){var e=this;return(0,n.A)(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.pullIPC.request("pull",{buffer:e.frontBuffer});case 2:t.sent<0&&(e.ended=!0),e.afterPullResolve&&e.afterPullResolve();case 5:case"end":return t.stop()}}),t)})))()}swapBuffer(){if(!this.frontBuffered)return!1;var e=this.backBuffer;return this.backBuffer=this.frontBuffer,this.frontBuffer=e,this.backBufferOffset=0,this.frontBuffered=!1,this.pull().then((()=>{this.frontBuffered=!0})),!0}process(e,t,r){if(this.stopped)return!1;if(this.backBuffer&&!this.pause){if(this.backBufferOffset===g){if(this.ended)return this.freeBuffer(this.backBuffer),this.freeBuffer(this.frontBuffer),this.backBuffer=0,this.frontBuffer=0,v.pq("audio source ended","src/avrender/pcm/AudioSourceWorkletProcessor2.ts",239),this.ipcPort.notify("ended"),!0;if(!this.swapBuffer())return this.ipcPort.notify("stutter"),!0}for(var n=t[0],i=0;i<this.channels;i++)n[i].set(this.float32.subarray((c.f[20](c.f[20](this.backBuffer)+4*i)>>>2)+128*this.backBufferOffset,(c.f[20](c.f[20](this.backBuffer)+4*i)>>>2)+128*(this.backBufferOffset+1)),0);this.backBufferOffset++,this.firstRendered||(this.firstRendered=!0,this.ipcPort.notify("firstRendered"))}return!0}}registerProcessor("audio-source-processor",A)},87503:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(25182),i=r(134),a=r(36443),s=r.n(a),o=r(84149);class u extends AudioWorkletProcessor{constructor(){super(),(0,i.A)(this,"ipcPort",void 0),this.ipcPort=new o.Ay(this.port)}request(e,t,r){var i=this;return(0,n.A)(s().mark((function n(){return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",i.ipcPort.request(e,t,r));case 1:case"end":return n.stop()}}),n)})))()}notify(e,t,r){this.ipcPort.notify(e,t,r)}}},74385:(e,t,r)=>{r(97863),r(25263),e.exports=r(46438).Array.from},37149:(e,t,r)=>{r(18355),e.exports=r(46438).Array.isArray},87172:(e,t,r)=>{r(23204),e.exports=r(46438).Date.now},85079:(e,t,r)=>{var n=r(46438),i=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},92861:(e,t,r)=>{r(78978),r(97863),r(7914),r(96050),r(28337),r(74674),r(62223),e.exports=r(46438).Map},11837:(e,t,r)=>{r(21489),e.exports=r(46438).Number.isNaN},28271:(e,t,r)=>{r(31951);var n=r(46438).Object;e.exports=function(e,t){return n.create(e,t)}},83760:(e,t,r)=>{r(59792);var n=r(46438).Object;e.exports=function(e,t){return n.defineProperties(e,t)}},92696:(e,t,r)=>{r(74712);var n=r(46438).Object;e.exports=function(e,t,r){return n.defineProperty(e,t,r)}},22948:(e,t,r)=>{r(51780),e.exports=r(46438).Object.freeze},3706:(e,t,r)=>{r(47386);var n=r(46438).Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}},34281:(e,t,r)=>{r(59454),e.exports=r(46438).Object.getOwnPropertyDescriptors},77654:(e,t,r)=>{r(19626),e.exports=r(46438).Object.getOwnPropertySymbols},62160:(e,t,r)=>{r(18128),e.exports=r(46438).Object.getPrototypeOf},47567:(e,t,r)=>{r(96847),e.exports=r(46438).Object.keys},21724:(e,t,r)=>{r(4284),e.exports=r(46438).Object.setPrototypeOf},27279:(e,t,r)=>{r(95828),e.exports=r(46438).parseFloat},25216:(e,t,r)=>{r(65331),e.exports=r(46438).parseInt},34750:(e,t,r)=>{r(78978),r(97863),r(7914),r(91229),r(2639),r(46121),e.exports=r(46438).Promise},27440:(e,t,r)=>{r(24562),e.exports=r(46438).Reflect.construct},80345:(e,t,r)=>{r(28351),e.exports=r(46438).Reflect.get},31707:(e,t,r)=>{r(66801),e.exports=r(46438).setImmediate},16560:(e,t,r)=>{r(19626),r(78978),r(42860),r(60716),e.exports=r(46438).Symbol},54220:(e,t,r)=>{r(97863),r(7914),e.exports=r(84336).f("iterator")},39967:(e,t,r)=>{e.exports=r(84336).f("toPrimitive")},25219:e=>{e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},12560:e=>{e.exports=function(){}},2832:e=>{e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},80812:(e,t,r)=>{var n=r(24401);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},77076:(e,t,r)=>{var n=r(95838);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},84448:(e,t,r)=>{var n=r(65133),i=r(70181),a=r(72917);e.exports=function(e){return function(t,r,s){var o,u=n(t),c=i(u.length),f=a(s,c);if(e&&r!=r){for(;c>f;)if((o=u[f++])!=o)return!0}else for(;c>f;f++)if((e||f in u)&&u[f]===r)return e||f||0;return!e&&-1}}},48219:(e,t,r)=>{var n=r(58852),i=r(7001),a=r(66310),s=r(70181),o=r(99244);e.exports=function(e,t){var r=1==e,u=2==e,c=3==e,f=4==e,h=6==e,d=5==e||h,l=t||o;return function(t,o,p){for(var v,m,g=a(t),A=i(g),y=n(o,p,3),x=s(A.length),k=0,b=r?l(t,x):u?l(t,0):void 0;x>k;k++)if((d||k in A)&&(m=y(v=A[k],k,g),e))if(r)b[k]=m;else if(m)switch(e){case 3:return!0;case 5:return v;case 6:return k;case 2:b.push(v)}else if(f)return!1;return h?-1:c||f?f:b}}},49742:(e,t,r)=>{var n=r(24401),i=r(15461),a=r(30254)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},99244:(e,t,r)=>{var n=r(49742);e.exports=function(e,t){return new(n(e))(t)}},15786:(e,t,r)=>{"use strict";var n=r(25219),i=r(24401),a=r(20709),s=[].slice,o={};e.exports=Function.bind||function(e){var t=n(this),r=s.call(arguments,1),u=function(){var n=r.concat(s.call(arguments));return this instanceof u?function(e,t,r){if(!(t in o)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";o[t]=Function("F,a","return new F("+n.join(",")+")")}return o[t](e,r)}(t,n.length,n):a(t,n,e)};return i(t.prototype)&&(u.prototype=t.prototype),u}},44968:(e,t,r)=>{var n=r(93417),i=r(30254)("toStringTag"),a="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,s;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:a?n(t):"Object"==(s=n(t))&&"function"==typeof t.callee?"Arguments":s}},93417:e=>{var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},95933:(e,t,r)=>{"use strict";var n=r(78423).f,i=r(22087),a=r(30953),s=r(58852),o=r(2832),u=r(95838),c=r(88839),f=r(20322),h=r(45274),d=r(58219),l=r(75172).fastKey,p=r(6096),v=d?"_s":"size",m=function(e,t){var r,n=l(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,c){var f=e((function(e,n){o(e,f,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[v]=0,null!=n&&u(n,r,e[c],e)}));return a(f.prototype,{clear:function(){for(var e=p(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var r=p(this,t),n=m(r,e);if(n){var i=n.n,a=n.p;delete r._i[n.i],n.r=!0,a&&(a.n=i),i&&(i.p=a),r._f==n&&(r._f=i),r._l==n&&(r._l=a),r[v]--}return!!n},forEach:function(e){p(this,t);for(var r,n=s(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!m(p(this,t),e)}}),d&&n(f.prototype,"size",{get:function(){return p(this,t)[v]}}),f},def:function(e,t,r){var n,i,a=m(e,t);return a?a.v=r:(e._l=a={i:i=l(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=a),n&&(n.n=a),e[v]++,"F"!==i&&(e._i[i]=a)),e},getEntry:m,setStrong:function(e,t,r){c(e,t,(function(e,r){this._t=p(e,t),this._k=r,this._l=void 0}),(function(){for(var e=this,t=e._k,r=e._l;r&&r.r;)r=r.p;return e._t&&(e._l=r=r?r.n:e._t._f)?f(0,"keys"==t?r.k:"values"==t?r.v:[r.k,r.v]):(e._t=void 0,f(1))}),r?"entries":"values",!r,!0),h(t)}}},5874:(e,t,r)=>{var n=r(44968),i=r(77076);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},99373:(e,t,r)=>{"use strict";var n=r(66670),i=r(88535),a=r(75172),s=r(81984),o=r(2677),u=r(30953),c=r(95838),f=r(2832),h=r(24401),d=r(1356),l=r(78423).f,p=r(48219)(0),v=r(58219);e.exports=function(e,t,r,m,g,A){var y=n[e],x=y,k=g?"set":"add",b=x&&x.prototype,w={};return v&&"function"==typeof x&&(A||b.forEach&&!s((function(){(new x).entries().next()})))?(x=t((function(t,r){f(t,x,e,"_c"),t._c=new y,null!=r&&c(r,g,t[k],t)})),p("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(e){var t="add"==e||"set"==e;!(e in b)||A&&"clear"==e||o(x.prototype,e,(function(r,n){if(f(this,x,e),!t&&A&&!h(r))return"get"==e&&void 0;var i=this._c[e](0===r?0:r,n);return t?this:i}))})),A||l(x.prototype,"size",{get:function(){return this._c.size}})):(x=m.getConstructor(t,e,g,k),u(x.prototype,r),a.NEED=!0),d(x,e),w[e]=x,i(i.G+i.W+i.F,w),A||m.setStrong(x,e,g),x}},46438:e=>{var t=e.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},31891:(e,t,r)=>{"use strict";var n=r(78423),i=r(86260);e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},58852:(e,t,r)=>{var n=r(25219);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},87608:e=>{e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},58219:(e,t,r)=>{e.exports=!r(81984)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},3802:(e,t,r)=>{var n=r(24401),i=r(66670).document,a=n(i)&&n(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},77956:e=>{e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},36473:(e,t,r)=>{var n=r(54311),i=r(59820),a=r(36569);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var s,o=r(e),u=a.f,c=0;o.length>c;)u.call(e,s=o[c++])&&t.push(s);return t}},88535:(e,t,r)=>{var n=r(66670),i=r(46438),a=r(58852),s=r(2677),o=r(75509),u="prototype",c=function(e,t,r){var f,h,d,l=e&c.F,p=e&c.G,v=e&c.S,m=e&c.P,g=e&c.B,A=e&c.W,y=p?i:i[t]||(i[t]={}),x=y[u],k=p?n:v?n[t]:(n[t]||{})[u];for(f in p&&(r=t),r)(h=!l&&k&&void 0!==k[f])&&o(y,f)||(d=h?k[f]:r[f],y[f]=p&&"function"!=typeof k[f]?r[f]:g&&h?a(d,n):A&&k[f]==d?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t[u]=e[u],t}(d):m&&"function"==typeof d?a(Function.call,d):d,m&&((y.virtual||(y.virtual={}))[f]=d,e&c.R&&x&&!x[f]&&s(x,f,d)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},81984:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},95838:(e,t,r)=>{var n=r(58852),i=r(27904),a=r(12828),s=r(80812),o=r(70181),u=r(55298),c={},f={},h=e.exports=function(e,t,r,h,d){var l,p,v,m,g=d?function(){return e}:u(e),A=n(r,h,t?2:1),y=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(a(g)){for(l=o(e.length);l>y;y++)if((m=t?A(s(p=e[y])[0],p[1]):A(e[y]))===c||m===f)return m}else for(v=g.call(e);!(p=v.next()).done;)if((m=i(v,A,p.value,t))===c||m===f)return m};h.BREAK=c,h.RETURN=f},66670:e=>{var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},75509:e=>{var t={}.hasOwnProperty;e.exports=function(e,r){return t.call(e,r)}},2677:(e,t,r)=>{var n=r(78423),i=r(86260);e.exports=r(58219)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},76260:(e,t,r)=>{var n=r(66670).document;e.exports=n&&n.documentElement},32484:(e,t,r)=>{e.exports=!r(58219)&&!r(81984)((function(){return 7!=Object.defineProperty(r(3802)("div"),"a",{get:function(){return 7}}).a}))},20709:e=>{e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},7001:(e,t,r)=>{var n=r(93417);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},12828:(e,t,r)=>{var n=r(20210),i=r(30254)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||a[i]===e)}},15461:(e,t,r)=>{var n=r(93417);e.exports=Array.isArray||function(e){return"Array"==n(e)}},24401:e=>{e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},27904:(e,t,r)=>{var n=r(80812);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var a=e.return;throw void 0!==a&&n(a.call(e)),t}}},48248:(e,t,r)=>{"use strict";var n=r(22087),i=r(86260),a=r(1356),s={};r(2677)(s,r(30254)("iterator"),(function(){return this})),e.exports=function(e,t,r){e.prototype=n(s,{next:i(1,r)}),a(e,t+" Iterator")}},88839:(e,t,r)=>{"use strict";var n=r(74742),i=r(88535),a=r(61331),s=r(2677),o=r(20210),u=r(48248),c=r(1356),f=r(66123),h=r(30254)("iterator"),d=!([].keys&&"next"in[].keys()),l="keys",p="values",v=function(){return this};e.exports=function(e,t,r,m,g,A,y){u(r,t,m);var x,k,b,w=function(e){if(!d&&e in S)return S[e];switch(e){case l:case p:return function(){return new r(this,e)}}return function(){return new r(this,e)}},_=t+" Iterator",T=g==p,I=!1,S=e.prototype,P=S[h]||S["@@iterator"]||g&&S[g],B=P||w(g),C=g?T?w("entries"):B:void 0,M="Array"==t&&S.entries||P;if(M&&(b=f(M.call(new e)))!==Object.prototype&&b.next&&(c(b,_,!0),n||"function"==typeof b[h]||s(b,h,v)),T&&P&&P.name!==p&&(I=!0,B=function(){return P.call(this)}),n&&!y||!d&&!I&&S[h]||s(S,h,B),o[t]=B,o[_]=v,g)if(x={values:T?B:w(p),keys:A?B:w(l),entries:C},y)for(k in x)k in S||a(S,k,x[k]);else i(i.P+i.F*(d||I),t,x);return x}},27899:(e,t,r)=>{var n=r(30254)("iterator"),i=!1;try{var a=[7][n]();a.return=function(){i=!0},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var a=[7],s=a[n]();s.next=function(){return{done:r=!0}},a[n]=function(){return s},e(a)}catch(e){}return r}},20322:e=>{e.exports=function(e,t){return{value:t,done:!!e}}},20210:e=>{e.exports={}},74742:e=>{e.exports=!0},75172:(e,t,r)=>{var n=r(19191)("meta"),i=r(24401),a=r(75509),s=r(78423).f,o=0,u=Object.isExtensible||function(){return!0},c=!r(81984)((function(){return u(Object.preventExtensions({}))})),f=function(e){s(e,n,{value:{i:"O"+ ++o,w:{}}})},h=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,n)){if(!u(e))return"F";if(!t)return"E";f(e)}return e[n].i},getWeak:function(e,t){if(!a(e,n)){if(!u(e))return!0;if(!t)return!1;f(e)}return e[n].w},onFreeze:function(e){return c&&h.NEED&&u(e)&&!a(e,n)&&f(e),e}}},53792:(e,t,r)=>{var n=r(66670),i=r(8036).set,a=n.MutationObserver||n.WebKitMutationObserver,s=n.process,o=n.Promise,u="process"==r(93417)(s);e.exports=function(){var e,t,r,c=function(){var n,i;for(u&&(n=s.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(u)r=function(){s.nextTick(c)};else if(!a||n.navigator&&n.navigator.standalone)if(o&&o.resolve){var f=o.resolve(void 0);r=function(){f.then(c)}}else r=function(){i.call(n,c)};else{var h=!0,d=document.createTextNode("");new a(c).observe(d,{characterData:!0}),r=function(){d.data=h=!h}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},11642:(e,t,r)=>{"use strict";var n=r(25219);function i(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)}e.exports.f=function(e){return new i(e)}},22087:(e,t,r)=>{var n=r(80812),i=r(90082),a=r(77956),s=r(4566)("IE_PROTO"),o=function(){},u="prototype",c=function(){var e,t=r(3802)("iframe"),n=a.length;for(t.style.display="none",r(76260).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;n--;)delete c[u][a[n]];return c()};e.exports=Object.create||function(e,t){var r;return null!==e?(o[u]=n(e),r=new o,o[u]=null,r[s]=e):r=c(),void 0===t?r:i(r,t)}},78423:(e,t,r)=>{var n=r(80812),i=r(32484),a=r(10752),s=Object.defineProperty;t.f=r(58219)?Object.defineProperty:function(e,t,r){if(n(e),t=a(t,!0),n(r),i)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},90082:(e,t,r)=>{var n=r(78423),i=r(80812),a=r(54311);e.exports=r(58219)?Object.defineProperties:function(e,t){i(e);for(var r,s=a(t),o=s.length,u=0;o>u;)n.f(e,r=s[u++],t[r]);return e}},81033:(e,t,r)=>{var n=r(36569),i=r(86260),a=r(65133),s=r(10752),o=r(75509),u=r(32484),c=Object.getOwnPropertyDescriptor;t.f=r(58219)?c:function(e,t){if(e=a(e),t=s(t,!0),u)try{return c(e,t)}catch(e){}if(o(e,t))return i(!n.f.call(e,t),e[t])}},36309:(e,t,r)=>{var n=r(65133),i=r(1743).f,a={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==a.call(e)?function(e){try{return i(e)}catch(e){return s.slice()}}(e):i(n(e))}},1743:(e,t,r)=>{var n=r(85081),i=r(77956).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},59820:(e,t)=>{t.f=Object.getOwnPropertySymbols},66123:(e,t,r)=>{var n=r(75509),i=r(66310),a=r(4566)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},85081:(e,t,r)=>{var n=r(75509),i=r(65133),a=r(84448)(!1),s=r(4566)("IE_PROTO");e.exports=function(e,t){var r,o=i(e),u=0,c=[];for(r in o)r!=s&&n(o,r)&&c.push(r);for(;t.length>u;)n(o,r=t[u++])&&(~a(c,r)||c.push(r));return c}},54311:(e,t,r)=>{var n=r(85081),i=r(77956);e.exports=Object.keys||function(e){return n(e,i)}},36569:(e,t)=>{t.f={}.propertyIsEnumerable},47331:(e,t,r)=>{var n=r(88535),i=r(46438),a=r(81984);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],s={};s[e]=t(r),n(n.S+n.F*a((function(){r(1)})),"Object",s)}},41510:(e,t,r)=>{var n=r(1743),i=r(59820),a=r(80812),s=r(66670).Reflect;e.exports=s&&s.ownKeys||function(e){var t=n.f(a(e)),r=i.f;return r?t.concat(r(e)):t}},49709:(e,t,r)=>{var n=r(66670).parseFloat,i=r(24269).trim;e.exports=1/n(r(80459)+"-0")!=-1/0?function(e){var t=i(String(e),3),r=n(t);return 0===r&&"-"==t.charAt(0)?-0:r}:n},15722:(e,t,r)=>{var n=r(66670).parseInt,i=r(24269).trim,a=r(80459),s=/^[-+]?0[xX]/;e.exports=8!==n(a+"08")||22!==n(a+"0x16")?function(e,t){var r=i(String(e),3);return n(r,t>>>0||(s.test(r)?16:10))}:n},41704:e=>{e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},61037:(e,t,r)=>{var n=r(80812),i=r(24401),a=r(11642);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=a.f(e);return(0,r.resolve)(t),r.promise}},86260:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},30953:(e,t,r)=>{var n=r(2677);e.exports=function(e,t,r){for(var i in t)r&&e[i]?e[i]=t[i]:n(e,i,t[i]);return e}},61331:(e,t,r)=>{e.exports=r(2677)},643:(e,t,r)=>{"use strict";var n=r(88535),i=r(25219),a=r(58852),s=r(95838);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,o,u=arguments[1];return i(this),(t=void 0!==u)&&i(u),null==e?new this:(r=[],t?(n=0,o=a(u,arguments[2],2),s(e,!1,(function(e){r.push(o(e,n++))}))):s(e,!1,r.push,r),new this(r))}})}},44398:(e,t,r)=>{"use strict";var n=r(88535);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},32074:(e,t,r)=>{var n=r(24401),i=r(80812),a=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r(58852)(Function.call,r(81033).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return a(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:a}},45274:(e,t,r)=>{"use strict";var n=r(66670),i=r(46438),a=r(78423),s=r(58219),o=r(30254)("species");e.exports=function(e){var t="function"==typeof i[e]?i[e]:n[e];s&&t&&!t[o]&&a.f(t,o,{configurable:!0,get:function(){return this}})}},1356:(e,t,r)=>{var n=r(78423).f,i=r(75509),a=r(30254)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,a)&&n(e,a,{configurable:!0,value:t})}},4566:(e,t,r)=>{var n=r(96308)("keys"),i=r(19191);e.exports=function(e){return n[e]||(n[e]=i(e))}},96308:(e,t,r)=>{var n=r(46438),i=r(66670),a="__core-js_shared__",s=i[a]||(i[a]={});(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(74742)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},85614:(e,t,r)=>{var n=r(80812),i=r(25219),a=r(30254)("species");e.exports=function(e,t){var r,s=n(e).constructor;return void 0===s||null==(r=n(s)[a])?t:i(r)}},43172:(e,t,r)=>{var n=r(49383),i=r(87608);e.exports=function(e){return function(t,r){var a,s,o=String(i(t)),u=n(r),c=o.length;return u<0||u>=c?e?"":void 0:(a=o.charCodeAt(u))<55296||a>56319||u+1===c||(s=o.charCodeAt(u+1))<56320||s>57343?e?o.charAt(u):a:e?o.slice(u,u+2):s-56320+(a-55296<<10)+65536}}},24269:(e,t,r)=>{var n=r(88535),i=r(87608),a=r(81984),s=r(80459),o="["+s+"]",u=RegExp("^"+o+o+"*"),c=RegExp(o+o+"*$"),f=function(e,t,r){var i={},o=a((function(){return!!s[e]()||""!=""[e]()})),u=i[e]=o?t(h):s[e];r&&(i[r]=u),n(n.P+n.F*o,"String",i)},h=f.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(u,"")),2&t&&(e=e.replace(c,"")),e};e.exports=f},80459:e=>{e.exports="\t\n\v\f\r \u2028\u2029\ufeff"},8036:(e,t,r)=>{var n,i,a,s=r(58852),o=r(20709),u=r(76260),c=r(3802),f=r(66670),h=f.process,d=f.setImmediate,l=f.clearImmediate,p=f.MessageChannel,v=f.Dispatch,m=0,g={},A="onreadystatechange",y=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},x=function(e){y.call(e.data)};d&&l||(d=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return g[++m]=function(){o("function"==typeof e?e:Function(e),t)},n(m),m},l=function(e){delete g[e]},"process"==r(93417)(h)?n=function(e){h.nextTick(s(y,e,1))}:v&&v.now?n=function(e){v.now(s(y,e,1))}:p?(a=(i=new p).port2,i.port1.onmessage=x,n=s(a.postMessage,a,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(n=function(e){f.postMessage(e+"","*")},f.addEventListener("message",x,!1)):n=A in c("script")?function(e){u.appendChild(c("script"))[A]=function(){u.removeChild(this),y.call(e)}}:function(e){setTimeout(s(y,e,1),0)}),e.exports={set:d,clear:l}},72917:(e,t,r)=>{var n=r(49383),i=Math.max,a=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):a(e,t)}},49383:e=>{var t=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:t)(e)}},65133:(e,t,r)=>{var n=r(7001),i=r(87608);e.exports=function(e){return n(i(e))}},70181:(e,t,r)=>{var n=r(49383),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},66310:(e,t,r)=>{var n=r(87608);e.exports=function(e){return Object(n(e))}},10752:(e,t,r)=>{var n=r(24401);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},19191:e=>{var t=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+r).toString(36))}},80218:(e,t,r)=>{var n=r(66670).navigator;e.exports=n&&n.userAgent||""},6096:(e,t,r)=>{var n=r(24401);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},67816:(e,t,r)=>{var n=r(66670),i=r(46438),a=r(74742),s=r(84336),o=r(78423).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||o(t,e,{value:s.f(e)})}},84336:(e,t,r)=>{t.f=r(30254)},30254:(e,t,r)=>{var n=r(96308)("wks"),i=r(19191),a=r(66670).Symbol,s="function"==typeof a;(e.exports=function(e){return n[e]||(n[e]=s&&a[e]||(s?a:i)("Symbol."+e))}).store=n},55298:(e,t,r)=>{var n=r(44968),i=r(30254)("iterator"),a=r(20210);e.exports=r(46438).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||a[n(e)]}},25263:(e,t,r)=>{"use strict";var n=r(58852),i=r(88535),a=r(66310),s=r(27904),o=r(12828),u=r(70181),c=r(31891),f=r(55298);i(i.S+i.F*!r(27899)((function(e){Array.from(e)})),"Array",{from:function(e){var t,r,i,h,d=a(e),l="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,m=void 0!==v,g=0,A=f(d);if(m&&(v=n(v,p>2?arguments[2]:void 0,2)),null==A||l==Array&&o(A))for(r=new l(t=u(d.length));t>g;g++)c(r,g,m?v(d[g],g):d[g]);else for(h=A.call(d),r=new l;!(i=h.next()).done;g++)c(r,g,m?s(h,v,[i.value,g],!0):i.value);return r.length=g,r}})},18355:(e,t,r)=>{var n=r(88535);n(n.S,"Array",{isArray:r(15461)})},52293:(e,t,r)=>{"use strict";var n=r(12560),i=r(20322),a=r(20210),s=r(65133);e.exports=r(88839)(Array,"Array",(function(e,t){this._t=s(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),a.Arguments=a.Array,n("keys"),n("values"),n("entries")},23204:(e,t,r)=>{var n=r(88535);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},96050:(e,t,r)=>{"use strict";var n=r(95933),i=r(6096),a="Map";e.exports=r(99373)(a,(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=n.getEntry(i(this,a),e);return t&&t.v},set:function(e,t){return n.def(i(this,a),0===e?0:e,t)}},n,!0)},21489:(e,t,r)=>{var n=r(88535);n(n.S,"Number",{isNaN:function(e){return e!=e}})},31951:(e,t,r)=>{var n=r(88535);n(n.S,"Object",{create:r(22087)})},59792:(e,t,r)=>{var n=r(88535);n(n.S+n.F*!r(58219),"Object",{defineProperties:r(90082)})},74712:(e,t,r)=>{var n=r(88535);n(n.S+n.F*!r(58219),"Object",{defineProperty:r(78423).f})},51780:(e,t,r)=>{var n=r(24401),i=r(75172).onFreeze;r(47331)("freeze",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},47386:(e,t,r)=>{var n=r(65133),i=r(81033).f;r(47331)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(n(e),t)}}))},18128:(e,t,r)=>{var n=r(66310),i=r(66123);r(47331)("getPrototypeOf",(function(){return function(e){return i(n(e))}}))},96847:(e,t,r)=>{var n=r(66310),i=r(54311);r(47331)("keys",(function(){return function(e){return i(n(e))}}))},4284:(e,t,r)=>{var n=r(88535);n(n.S,"Object",{setPrototypeOf:r(32074).set})},78978:()=>{},95828:(e,t,r)=>{var n=r(88535),i=r(49709);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},65331:(e,t,r)=>{var n=r(88535),i=r(15722);n(n.G+n.F*(parseInt!=i),{parseInt:i})},91229:(e,t,r)=>{"use strict";var n,i,a,s,o=r(74742),u=r(66670),c=r(58852),f=r(44968),h=r(88535),d=r(24401),l=r(25219),p=r(2832),v=r(95838),m=r(85614),g=r(8036).set,A=r(53792)(),y=r(11642),x=r(41704),k=r(80218),b=r(61037),w="Promise",_=u.TypeError,T=u.process,I=T&&T.versions,S=I&&I.v8||"",P=u[w],B="process"==f(T),C=function(){},M=i=y.f,R=!!function(){try{var e=P.resolve(1),t=(e.constructor={})[r(30254)("species")]=function(e){e(C,C)};return(B||"function"==typeof PromiseRejectionEvent)&&e.then(C)instanceof t&&0!==S.indexOf("6.6")&&-1===k.indexOf("Chrome/66")}catch(e){}}(),U=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},E=function(e,t){if(!e._n){e._n=!0;var r=e._c;A((function(){for(var n=e._v,i=1==e._s,a=0,s=function(t){var r,a,s,o=i?t.ok:t.fail,u=t.resolve,c=t.reject,f=t.domain;try{o?(i||(2==e._h&&F(e),e._h=1),!0===o?r=n:(f&&f.enter(),r=o(n),f&&(f.exit(),s=!0)),r===t.promise?c(_("Promise-chain cycle")):(a=U(r))?a.call(r,u,c):u(r)):c(n)}catch(e){f&&!s&&f.exit(),c(e)}};r.length>a;)s(r[a++]);e._c=[],e._n=!1,t&&!e._h&&D(e)}))}},D=function(e){g.call(u,(function(){var t,r,n,i=e._v,a=L(e);if(a&&(t=x((function(){B?T.emit("unhandledRejection",i,e):(r=u.onunhandledrejection)?r({promise:e,reason:i}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",i)})),e._h=B||L(e)?2:1),e._a=void 0,a&&t.e)throw t.v}))},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},F=function(e){g.call(u,(function(){var t;B?T.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})}))},O=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),E(t,!0))},N=function(e){var t,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw _("Promise can't be resolved itself");(t=U(e))?A((function(){var n={_w:r,_d:!1};try{t.call(e,c(N,n,1),c(O,n,1))}catch(e){O.call(n,e)}})):(r._v=e,r._s=1,E(r,!1))}catch(e){O.call({_w:r,_d:!1},e)}}};R||(P=function(e){p(this,P,w,"_h"),l(e),n.call(this);try{e(c(N,this,1),c(O,this,1))}catch(e){O.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(30953)(P.prototype,{then:function(e,t){var r=M(m(this,P));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=B?T.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&E(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new n;this.promise=e,this.resolve=c(N,e,1),this.reject=c(O,e,1)},y.f=M=function(e){return e===P||e===s?new a(e):i(e)}),h(h.G+h.W+h.F*!R,{Promise:P}),r(1356)(P,w),r(45274)(w),s=r(46438)[w],h(h.S+h.F*!R,w,{reject:function(e){var t=M(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(o||!R),w,{resolve:function(e){return b(o&&this===s?P:this,e)}}),h(h.S+h.F*!(R&&r(27899)((function(e){P.all(e).catch(C)}))),w,{all:function(e){var t=this,r=M(t),n=r.resolve,i=r.reject,a=x((function(){var r=[],a=0,s=1;v(e,!1,(function(e){var o=a++,u=!1;r.push(void 0),s++,t.resolve(e).then((function(e){u||(u=!0,r[o]=e,--s||n(r))}),i)})),--s||n(r)}));return a.e&&i(a.v),r.promise},race:function(e){var t=this,r=M(t),n=r.reject,i=x((function(){v(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return i.e&&n(i.v),r.promise}})},24562:(e,t,r)=>{var n=r(88535),i=r(22087),a=r(25219),s=r(80812),o=r(24401),u=r(81984),c=r(15786),f=(r(66670).Reflect||{}).construct,h=u((function(){function e(){}return!(f((function(){}),[],e)instanceof e)})),d=!u((function(){f((function(){}))}));n(n.S+n.F*(h||d),"Reflect",{construct:function(e,t){a(e),s(t);var r=arguments.length<3?e:a(arguments[2]);if(d&&!h)return f(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(c.apply(e,n))}var u=r.prototype,l=i(o(u)?u:Object.prototype),p=Function.apply.call(e,l,t);return o(p)?p:l}})},28351:(e,t,r)=>{var n=r(81033),i=r(66123),a=r(75509),s=r(88535),o=r(24401),u=r(80812);s(s.S,"Reflect",{get:function e(t,r){var s,c,f=arguments.length<3?t:arguments[2];return u(t)===f?t[r]:(s=n.f(t,r))?a(s,"value")?s.value:void 0!==s.get?s.get.call(f):void 0:o(c=i(t))?e(c,r,f):void 0}})},97863:(e,t,r)=>{"use strict";var n=r(43172)(!0);r(88839)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})}))},19626:(e,t,r)=>{"use strict";var n=r(66670),i=r(75509),a=r(58219),s=r(88535),o=r(61331),u=r(75172).KEY,c=r(81984),f=r(96308),h=r(1356),d=r(19191),l=r(30254),p=r(84336),v=r(67816),m=r(36473),g=r(15461),A=r(80812),y=r(24401),x=r(66310),k=r(65133),b=r(10752),w=r(86260),_=r(22087),T=r(36309),I=r(81033),S=r(59820),P=r(78423),B=r(54311),C=I.f,M=P.f,R=T.f,U=n.Symbol,E=n.JSON,D=E&&E.stringify,L="prototype",F=l("_hidden"),O=l("toPrimitive"),N={}.propertyIsEnumerable,z=f("symbol-registry"),V=f("symbols"),W=f("op-symbols"),j=Object[L],G="function"==typeof U&&!!S.f,q=n.QObject,H=!q||!q[L]||!q[L].findChild,Y=a&&c((function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=C(j,t);n&&delete j[t],M(e,t,r),n&&e!==j&&M(j,t,n)}:M,Q=function(e){var t=V[e]=_(U[L]);return t._k=e,t},$=G&&"symbol"==typeof U.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof U},K=function(e,t,r){return e===j&&K(W,t,r),A(e),t=b(t,!0),A(r),i(V,t)?(r.enumerable?(i(e,F)&&e[F][t]&&(e[F][t]=!1),r=_(r,{enumerable:w(0,!1)})):(i(e,F)||M(e,F,w(1,{})),e[F][t]=!0),Y(e,t,r)):M(e,t,r)},J=function(e,t){A(e);for(var r,n=m(t=k(t)),i=0,a=n.length;a>i;)K(e,r=n[i++],t[r]);return e},X=function(e){var t=N.call(this,e=b(e,!0));return!(this===j&&i(V,e)&&!i(W,e))&&(!(t||!i(this,e)||!i(V,e)||i(this,F)&&this[F][e])||t)},Z=function(e,t){if(e=k(e),t=b(t,!0),e!==j||!i(V,t)||i(W,t)){var r=C(e,t);return!r||!i(V,t)||i(e,F)&&e[F][t]||(r.enumerable=!0),r}},ee=function(e){for(var t,r=R(k(e)),n=[],a=0;r.length>a;)i(V,t=r[a++])||t==F||t==u||n.push(t);return n},te=function(e){for(var t,r=e===j,n=R(r?W:k(e)),a=[],s=0;n.length>s;)!i(V,t=n[s++])||r&&!i(j,t)||a.push(V[t]);return a};G||(o((U=function(){if(this instanceof U)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(r){this===j&&t.call(W,r),i(this,F)&&i(this[F],e)&&(this[F][e]=!1),Y(this,e,w(1,r))};return a&&H&&Y(j,e,{configurable:!0,set:t}),Q(e)})[L],"toString",(function(){return this._k})),I.f=Z,P.f=K,r(1743).f=T.f=ee,r(36569).f=X,S.f=te,a&&!r(74742)&&o(j,"propertyIsEnumerable",X,!0),p.f=function(e){return Q(l(e))}),s(s.G+s.W+s.F*!G,{Symbol:U});for(var re="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;re.length>ne;)l(re[ne++]);for(var ie=B(l.store),ae=0;ie.length>ae;)v(ie[ae++]);s(s.S+s.F*!G,"Symbol",{for:function(e){return i(z,e+="")?z[e]:z[e]=U(e)},keyFor:function(e){if(!$(e))throw TypeError(e+" is not a symbol!");for(var t in z)if(z[t]===e)return t},useSetter:function(){H=!0},useSimple:function(){H=!1}}),s(s.S+s.F*!G,"Object",{create:function(e,t){return void 0===t?_(e):J(_(e),t)},defineProperty:K,defineProperties:J,getOwnPropertyDescriptor:Z,getOwnPropertyNames:ee,getOwnPropertySymbols:te});var se=c((function(){S.f(1)}));s(s.S+s.F*se,"Object",{getOwnPropertySymbols:function(e){return S.f(x(e))}}),E&&s(s.S+s.F*(!G||c((function(){var e=U();return"[null]"!=D([e])||"{}"!=D({a:e})||"{}"!=D(Object(e))}))),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(y(t)||void 0!==e)&&!$(e))return g(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!$(t))return t}),n[1]=t,D.apply(E,n)}}),U[L][O]||r(2677)(U[L],O,U[L].valueOf),h(U,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},62223:(e,t,r)=>{r(643)("Map")},74674:(e,t,r)=>{r(44398)("Map")},28337:(e,t,r)=>{var n=r(88535);n(n.P+n.R,"Map",{toJSON:r(5874)("Map")})},59454:(e,t,r)=>{var n=r(88535),i=r(41510),a=r(65133),s=r(81033),o=r(31891);n(n.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=a(e),u=s.f,c=i(n),f={},h=0;c.length>h;)void 0!==(r=u(n,t=c[h++]))&&o(f,t,r);return f}})},2639:(e,t,r)=>{"use strict";var n=r(88535),i=r(46438),a=r(66670),s=r(85614),o=r(61037);n(n.P+n.R,"Promise",{finally:function(e){var t=s(this,i.Promise||a.Promise),r="function"==typeof e;return this.then(r?function(r){return o(t,e()).then((function(){return r}))}:e,r?function(r){return o(t,e()).then((function(){throw r}))}:e)}})},46121:(e,t,r)=>{"use strict";var n=r(88535),i=r(11642),a=r(41704);n(n.S,"Promise",{try:function(e){var t=i.f(this),r=a(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},42860:(e,t,r)=>{r(67816)("asyncIterator")},60716:(e,t,r)=>{r(67816)("observable")},7914:(e,t,r)=>{r(52293);for(var n=r(66670),i=r(2677),a=r(20210),s=r(30254)("toStringTag"),o="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<o.length;u++){var c=o[u],f=n[c],h=f&&f.prototype;h&&!h[s]&&i(h,s,c),a[c]=a.Array}},66801:(e,t,r)=>{var n=r(88535),i=r(8036);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},14397:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n="precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 point;\nattribute vec4 color;\nvarying vec4 v_color;\n\nuniform mat4 rotateMatrix;\n\nvoid main(void){\n  gl_Position = rotateMatrix * vec4(point, 1.0);\n  v_color = color;\n}\n"},57914:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n="\nstruct Meta {\n  max: u32,\n  width: u32,\n  height: u32\n};\n\n@group(0) @binding(0) var<uniform> metaData: Meta;\n@group(0) @binding(1) var input: texture_2d<u32>;\n@group(0) @binding(2) var output: texture_storage_2d<r32float, write>;\n\n@compute @workgroup_size(8, 8) fn main(\n  @builtin(workgroup_id) workgroup_id: vec3<u32>,\n  @builtin(local_invocation_id) local_invocation_id: vec3<u32>\n) {\n  var x = workgroup_id.x * 8 + local_invocation_id.x;\n  var y = workgroup_id.y * 8 + local_invocation_id.y;\n  if (x < metaData.width && y < metaData.height) {\n    var value: u32 = textureLoad(input, vec2(x, y), 0).x;\n    var low = value & 0xff;\n    var high = (value >> 8) & 0xff;\n    value = (low << 8) | high;\n    var value_no: f32 = f32(value) / f32(metaData.max);\n    textureStore(output, vec2(x, y), vec4(value_no, 0, 0, 0));\n  }\n}"},62496:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n="\nstruct Meta {\n  max: u32,\n  width: u32,\n  height: u32\n};\n\n@group(0) @binding(0) var<uniform> metaData: Meta;\n@group(0) @binding(1) var input: texture_2d<u32>;\n@group(0) @binding(2) var output: texture_storage_2d<r32float, write>;\n\n@compute @workgroup_size(8, 8) fn main(\n  @builtin(workgroup_id) workgroup_id: vec3<u32>,\n  @builtin(local_invocation_id) local_invocation_id: vec3<u32>\n) {\n  var x = workgroup_id.x * 8 + local_invocation_id.x;\n  var y = workgroup_id.y * 8 + local_invocation_id.y;\n  if (x < metaData.width && y < metaData.height) {\n    var value: u32 = textureLoad(input, vec2(x, y), 0).x;\n    var value_no: f32 = f32(value) / f32(metaData.max);\n    textureStore(output, vec2(x, y), vec4(value_no, 0, 0, 0));\n  }\n}"},23195:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n="\n@group(0) @binding(1) var eTexture: texture_external;\n@group(0) @binding(2) var s: sampler;\n\n@fragment\nfn main(@location(0) in_texcoord: vec4<f32>) -> @location(0) vec4<f32> {\n  return textureSampleBaseClampToEdge(eTexture, s, in_texcoord.xy);\n}"},54895:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});const n="struct PositionColorInput {\n    @location(0) in_position_3d: vec3<f32>,\n    @location(1) in_color_rgba: vec4<f32>\n};\n\nstruct PositionColorOutput {\n    @builtin(position) coords_output: vec4<f32>,\n    @location(0) color_output: vec4<f32>\n};\n\nstruct RotateMatrix {\n    matrix: mat4x4<f32>\n};\n\n@group(0) @binding(0) var<uniform> rotateMatrix: RotateMatrix;\n\n@vertex\nfn main(input: PositionColorInput) -> PositionColorOutput {\n    var output: PositionColorOutput;\n    output.color_output = input.in_color_rgba;\n    output.coords_output = rotateMatrix.matrix * vec4<f32>(input.in_position_3d, 1.0);\n    return output;\n}"},5679:e=>{e.exports="AGFzbQEAAAABKQhgAn9/AGACf34AYAJ/fQBgAn98AGABfwF/YAF/AX5gAX8BfWABfwF8AhIBA2VudgZtZW1vcnkCAwGAgAQDDw4AAAABAgMEBAQEBAUGBweIAQ4Gd3JpdGU4AAAHd3JpdGUxNgABB3dyaXRlMzIAAgd3cml0ZTY0AAMId3JpdGVmMzIABAh3cml0ZWY2NAAFBXJlYWQ4AAYGcmVhZFU4AAcGcmVhZDE2AAgHcmVhZFUxNgAJBnJlYWQzMgAKBnJlYWQ2NAALB3JlYWRmMzIADAdyZWFkZjY0AA0KfQ4JACAAIAE6AAALCQAgACABOwEACwkAIAAgATYCAAsJACAAIAE3AwALCQAgACABOAIACwkAIAAgATkDAAsHACAALAAACwcAIAAtAAALBwAgAC4BAAsHACAALwEACwcAIAAoAgALBwAgACkDAAsHACAAKgIACwcAIAArAwAL"},19985:e=>{e.exports="AGFzbQEAAAABLAdgAX8Bf2ABfwF+YAJ/fwF/YAJ/fgF+YAN/f38Bf2ADf35+AX5gA39/fgF/AhIBA2VudgZtZW1vcnkCAwGAgAQDKCcAAAABAgICAwICAgMCAgIDAgICAwICAgMCAgIDAgICAwQEBAUCAgYHhgMnBWxvYWQ4AAAGbG9hZDE2AAEGbG9hZDMyAAIGbG9hZDY0AAMGc3RvcmU4AAQHc3RvcmUxNgAFB3N0b3JlMzIABgdzdG9yZTY0AAcEYWRkOAAIBWFkZDE2AAkFYWRkMzIACgVhZGQ2NAALBHN1YjgADAVzdWIxNgANBXN1YjMyAA4Fc3ViNjQADwRhbmQ4ABAFYW5kMTYAEQVhbmQzMgASBWFuZDY0ABMDb3I4ABQEb3IxNgAVBG9yMzIAFgRvcjY0ABcEeG9yOAAYBXhvcjE2ABkFeG9yMzIAGgV4b3I2NAAbCWV4Y2hhbmdlOAAcCmV4Y2hhbmdlMTYAHQpleGNoYW5nZTMyAB4KZXhjaGFuZ2U2NAAfEWNvbXBhcmVfZXhjaGFuZ2U4ACASY29tcGFyZV9leGNoYW5nZTE2ACESY29tcGFyZV9leGNoYW5nZTMyACISY29tcGFyZV9leGNoYW5nZTY0ACMGbm90aWZ5ACQEd2FpdAAlC3dhaXRUaW1lb3V0ACYKugMnCAAgAP4SAAALCAAgAP4TAQALCAAgAP4QAgALCAAgAP4RAwALDAAgACAB/hkAACABCwwAIAAgAf4aAQAgAQsMACAAIAH+FwIAIAELDAAgACAB/hgDACABCwoAIAAgAf4gAAALCgAgACAB/iEBAAsKACAAIAH+HgIACwoAIAAgAf4fAwALCgAgACAB/icAAAsKACAAIAH+KAEACwoAIAAgAf4lAgALCgAgACAB/iYDAAsKACAAIAH+LgAACwoAIAAgAf4vAQALCgAgACAB/iwCAAsKACAAIAH+LQMACwoAIAAgAf41AAALCgAgACAB/jYBAAsKACAAIAH+MwIACwoAIAAgAf40AwALCgAgACAB/jwAAAsKACAAIAH+PQEACwoAIAAgAf46AgALCgAgACAB/jsDAAsKACAAIAH+QwAACwoAIAAgAf5EAQALCgAgACAB/kECAAsKACAAIAH+QgMACwwAIAAgASAC/koAAAsMACAAIAEgAv5LAQALDAAgACABIAL+SAIACwwAIAAgASAC/kkDAAsKACAAIAH+AAIACwwAIAAgAUJ//gECAAsMACAAIAEgAv4BAgAL"},35112:e=>{e.exports="AGFzbQEAAAABEANgAX8Bf2ABfwBgAn9/AX8CWQYDZW52Bm1lbW9yeQIDAYCABANlbnYGbWFsbG9jAAADZW52BGZyZWUAAQNlbnYGY2FsbG9jAAIDZW52B3JlYWxsb2MAAgNlbnYNYWxpZ25lZF9hbGxvYwACAwYFAAECAgIHMwUGbWFsbG9jAAUEZnJlZQAGBmNhbGxvYwAHB3JlYWxsb2MACAxhbGlnbmVkQWxsb2MACQoqBQYAIAAQAAsGACAAEAELCAAgACABEAILCAAgACABEAMLCAAgACABEAML"},47844:e=>{e.exports="AGFzbQEAAAABEwNgAX8Bf2ACf38Bf2ADf39/AX8CEgEDZW52Bm1lbW9yeQIDAYCABAMIBwAAAAECAAAHQwcEbG9jawAAB3RyeWxvY2sAAQZ1bmxvY2sAAgR3YWl0AAMJdGltZWR3YWl0AAQGc2lnbmFsAAUJYnJvYWRjYXN0AAYKjgIHVgEBfyAAQQBBAf5IAgAhASABQQBHBEADQCABQQJGBH9BAQUgAEEBQQL+SAIAQQBHCwRAIABBAkJ//gECABoLIABBAEEC/kgCACEBIAFBAEcNAAsLQQALFwAgAEEAQQH+SAIAQQBGBH9BAAVBEAsLIwAgAEEB/iUCAEEBRwRAIABBAP4XAgAgAEEB/gACABoLQQALHQAgACAA/hACACABEAIaQn/+AQIAGiABEAAaQQALKQAgACAA/hACACABEAIaIAIpAwD+AQIAIAEQABpBAkYEf0HwAAVBAAsLFgAgAEEB/h4CABogAEEB/gACABpBAAsaACAAQQH+HgIAGiAAQYCAgIAE/gACABpBAAs="},42096:(e,t,r)=>{e.exports=r(74385)},68632:(e,t,r)=>{e.exports=r(37149)},45249:(e,t,r)=>{e.exports=r(87172)},73146:(e,t,r)=>{e.exports=r(85079)},80662:(e,t,r)=>{e.exports=r(92861)},7210:(e,t,r)=>{e.exports=r(11837)},969:(e,t,r)=>{e.exports=r(83760)},66681:(e,t,r)=>{e.exports=r(92696)},7403:(e,t,r)=>{e.exports=r(22948)},82731:(e,t,r)=>{e.exports=r(3706)},59614:(e,t,r)=>{e.exports=r(34281)},44301:(e,t,r)=>{e.exports=r(77654)},75019:(e,t,r)=>{e.exports=r(62160)},69736:(e,t,r)=>{e.exports=r(47567)},11919:(e,t,r)=>{e.exports=r(21724)},88032:(e,t,r)=>{e.exports=r(27279)},29967:(e,t,r)=>{e.exports=r(25216)},54001:(e,t,r)=>{e.exports=r(34750)},88435:(e,t,r)=>{e.exports=r(27440)},64236:(e,t,r)=>{e.exports=r(31707)},75062:(e,t,r)=>{e.exports=r(16560)},16091:(e,t,r)=>{e.exports=r(54220)},43660:(e,t,r)=>{var n=r(803).default,i=r(92696),a=r(16560),s=r(28271),o=r(62160),u=r(21724),c=r(34750);function f(){"use strict";e.exports=f=function(){return r},e.exports.__esModule=!0,e.exports.default=e.exports;var t,r={},h=Object.prototype,d=h.hasOwnProperty,l=i||function(e,t,r){e[t]=r.value},p="function"==typeof a?a:{},v=p.iterator||"@@iterator",m=p.asyncIterator||"@@asyncIterator",g=p.toStringTag||"@@toStringTag";function A(e,t,r){return i(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{A({},"")}catch(t){A=function(e,t,r){return e[t]=r}}function y(e,t,r,n){var i=t&&t.prototype instanceof I?t:I,a=s(i.prototype),o=new O(n||[]);return l(a,"_invoke",{value:E(e,r,o)}),a}function x(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=y;var k="suspendedStart",b="suspendedYield",w="executing",_="completed",T={};function I(){}function S(){}function P(){}var B={};A(B,v,(function(){return this}));var C=o&&o(o(N([])));C&&C!==h&&d.call(C,v)&&(B=C);var M=P.prototype=I.prototype=s(B);function R(e){["next","throw","return"].forEach((function(t){A(e,t,(function(e){return this._invoke(t,e)}))}))}function U(e,t){function r(i,a,s,o){var u=x(e[i],e,a);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==n(f)&&d.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):t.resolve(f).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,o)}))}o(u.arg)}var i;l(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(a,a):a()}})}function E(e,r,n){var i=k;return function(a,s){if(i===w)throw new Error("Generator is already running");if(i===_){if("throw"===a)throw s;return{value:t,done:!0}}for(n.method=a,n.arg=s;;){var o=n.delegate;if(o){var u=D(o,n);if(u){if(u===T)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===k)throw i=_,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=w;var c=x(e,r,n);if("normal"===c.type){if(i=n.done?_:b,c.arg===T)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=_,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),T;var a=x(i,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,T;var s=a.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,T):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,T)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function F(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[v];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(d.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return S.prototype=P,l(M,"constructor",{value:P,configurable:!0}),l(P,"constructor",{value:S,configurable:!0}),S.displayName=A(P,g,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return u?u(e,P):(e.__proto__=P,A(e,g,"GeneratorFunction")),e.prototype=s(M),e},r.awrap=function(e){return{__await:e}},R(U.prototype),A(U.prototype,m,(function(){return this})),r.AsyncIterator=U,r.async=function(e,t,n,i,a){void 0===a&&(a=c);var s=new U(y(e,t,n,i),a);return r.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},R(M),A(M,g,"Generator"),A(M,v,(function(){return this})),A(M,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=N,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(F),!e)for(var r in this)"t"===r.charAt(0)&&d.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,i){return s.type="throw",s.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var o=d.call(a,"catchLoc"),u=d.call(a,"finallyLoc");if(o&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&d.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,T):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),T},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),F(r),T}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;F(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:N(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),T}},r}e.exports=f,e.exports.__esModule=!0,e.exports.default=e.exports},803:(e,t,r)=>{var n=r(16560),i=r(54220);function a(t){return e.exports=a="function"==typeof n&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof n&&e.constructor===n&&e!==n.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},36443:(e,t,r)=>{var n=r(43660)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},27880:(e,t,r)=>{"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{A:()=>n})},12812:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(37149);function i(e){if(n(e))return e}},79256:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(37149),i=r(27880);function a(e){if(n(e))return(0,i.A)(e)}},43070:(e,t,r)=>{"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{A:()=>n})},25182:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(34750);function i(e,t,r,i,a,s,o){try{var u=e[s](o),c=u.value}catch(e){return void r(e)}u.done?t(c):n.resolve(c).then(i,a)}function a(e){return function(){var t=this,r=arguments;return new n((function(n,a){var s=e.apply(t,r);function o(e){i(s,n,a,o,u,"next",e)}function u(e){i(s,n,a,o,u,"throw",e)}o(void 0)}))}}},78716:(e,t,r)=>{"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,{A:()=>n})},33423:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(27440),i=r(34963),a=r(30685);function s(e,t,r){if((0,a.A)())return n.apply(null,arguments);var s=[null];s.push.apply(s,t);var o=new(e.bind.apply(e,s));return r&&(0,i.A)(o,r.prototype),o}},81570:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(92696),i=r(87361);function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),n(e,(0,i.A)(a.key),a)}}function s(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),n(e,"prototype",{writable:!1}),e}},134:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(92696),i=r(87361);function a(e,t,r){return(t=(0,i.A)(t))in e?n(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},60394:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(80345),i=r(3706),a=r(41473);function s(){return s="undefined"!=typeof Reflect&&n?n.bind():function(e,t,r){var n=(0,a.A)(e,t);if(n){var s=i(n,t);return s.get?s.get.call(arguments.length<3?e:r):s.value}},s.apply(this,arguments)}},25767:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(21724),i=r(62160);function a(e){return a=n?i.bind():function(e){return e.__proto__||i(e)},a(e)}},31060:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(28271),i=r(92696),a=r(34963);function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=n(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),i(e,"prototype",{writable:!1}),t&&(0,a.A)(e,t)}},73423:(e,t,r)=>{"use strict";function n(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}r.d(t,{A:()=>n})},30685:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(27440);function i(){try{var e=!Boolean.prototype.valueOf.call(n(Boolean,[],(function(){})))}catch(e){}return(i=function(){return!!e})()}},58114:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(16560),i=r(54220),a=r(74385);function s(e){if(void 0!==n&&null!=e[i]||null!=e["@@iterator"])return a(e)}},92503:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(16560),i=r(54220);function a(e,t){var r=null==e?null:void 0!==n&&e[i]||e["@@iterator"];if(null!=r){var a,s,o,u,c=[],f=!0,h=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;f=!1}else for(;!(f=(a=o.call(r)).done)&&(c.push(a.value),c.length!==t);f=!0);}catch(e){h=!0,s=e}finally{try{if(!f&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(h)throw s}}return c}}},82297:(e,t,r)=>{"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(t,{A:()=>n})},48396:(e,t,r)=>{"use strict";function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(t,{A:()=>n})},77193:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(23509),i=r(43070);function a(e,t){if(t&&("object"===(0,n.A)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.A)(e)}},34963:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(21724);function i(e,t){return i=n?n.bind():function(e,t){return e.__proto__=t,e},i(e,t)}},6550:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(12812),i=r(92503),a=r(60773),s=r(82297);function o(e,t){return(0,n.A)(e)||(0,i.A)(e,t)||(0,a.A)(e,t)||(0,s.A)()}},41473:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(25767);function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,n.A)(e)););return e}},6837:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(79256),i=r(58114),a=r(60773),s=r(48396);function o(e){return(0,n.A)(e)||(0,i.A)(e)||(0,a.A)(e)||(0,s.A)()}},91908:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(23509),i=r(39967);function a(e,t){if("object"!=(0,n.A)(e)||!e)return e;var r=e[i];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=(0,n.A)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}},87361:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(23509),i=r(91908);function a(e){var t=(0,i.A)(e,"string");return"symbol"==(0,n.A)(t)?t:String(t)}},23509:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(16560),i=r(54220);function a(e){return a="function"==typeof n&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof n&&e.constructor===n&&e!==n.prototype?"symbol":typeof e},a(e)}},60773:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var n=r(74385),i=r(27880);function a(e,t){if(e){if("string"==typeof e)return(0,i.A)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?n(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,i.A)(e,t):void 0}}},26492:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var n=r(92861),i=r(28271),a=r(25767),s=r(34963),o=r(73423),u=r(33423);function c(e){var t="function"==typeof n?new n:void 0;return c=function(e){if(null===e||!(0,o.A)(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return(0,u.A)(e,arguments,(0,a.A)(this).constructor)}return r.prototype=i(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,s.A)(r,e)},c(e)}},65749:(e,t,r)=>{"use strict";function n(e){var t=e.toLowerCase().trim().split(/\s*;\s*/);return"banner"===t[0]?{name:t[0],delay:1*t[1]||0,leftToRight:1*t[2]||0,fadeAwayWidth:1*t[3]||0}:/^scroll\s/.test(t[0])?{name:t[0],y1:Math.min(1*t[1],1*t[2]),y2:Math.max(1*t[1],1*t[2]),delay:1*t[3]||0,fadeAwayHeight:1*t[4]||0}:""!==e?{name:e}:null}function i(e){return e?e.toLowerCase().replace(/([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?)/g," $1 ").replace(/([mnlbspc])/g," $1 ").trim().replace(/\s+/g," ").split(/\s(?=[mnlbspc])/).map((function(e){return e.split(" ").filter((function(e,t){return!(t&&isNaN(1*e))}))})):[]}r.d(t,{wE:()=>I});var a=["b","i","u","s","fsp","k","K","kf","ko","kt","fe","q","p","pbo","a","an","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"].map((function(e){return{name:e,regex:new RegExp("^"+e+"-?\\d")}}));function s(e){for(var t,r={},n=0;n<a.length;n++){var o=a[n],u=o.name;if(o.regex.test(e))return r[u]=1*e.slice(u.length),r}if(/^fn/.test(e))r.fn=e.slice(2);else if(/^r/.test(e))r.r=e.slice(1);else if(/^fs[\d+-]/.test(e))r.fs=e.slice(2);else if(/^\d?c&?H?[0-9a-fA-F]+|^\d?c$/.test(e)){var c=e.match(/^(\d?)c&?H?(\w*)/),f=c[1],h=c[2];r["c"+(f||1)]=h&&("000000"+h).slice(-6)}else if(/^\da&?H?[0-9a-fA-F]+/.test(e)){var d=e.match(/^(\d)a&?H?([0-9a-f]+)/i),l=d[1],p=d[2];r["a"+l]=("00"+p).slice(-2)}else if(/^alpha&?H?[0-9a-fA-F]+/.test(e))t=e.match(/^alpha&?H?([0-9a-f]+)/i),r.alpha=t[1],r.alpha=("00"+r.alpha).slice(-2);else if(/^(?:pos|org|move|fad|fade)\([^)]+/.test(e)){var v=e.match(/^(\w+)\((.*?)\)?$/),m=v[1],g=v[2];r[m]=g.trim().split(/\s*,\s*/).map(Number)}else if(/^i?clip\([^)]+/.test(e)){var A=e.match(/^i?clip\((.*?)\)?$/)[1].trim().split(/\s*,\s*/);r.clip={inverse:/iclip/.test(e),scale:1,drawing:null,dots:null},1===A.length&&(r.clip.drawing=i(A[0])),2===A.length&&(r.clip.scale=1*A[0],r.clip.drawing=i(A[1])),4===A.length&&(r.clip.dots=A.map(Number))}else if(/^t\(/.test(e)){var y=e.match(/^t\((.*?)\)?$/)[1].trim().replace(/\\.*/,(function(e){return e.replace(/,/g,"\n")})).split(/\s*,\s*/);if(!y[0])return r;r.t={t1:0,t2:0,accel:1,tags:y[y.length-1].replace(/\n/g,",").split("\\").slice(1).map(s)},2===y.length&&(r.t.accel=1*y[0]),3===y.length&&(r.t.t1=1*y[0],r.t.t2=1*y[1]),4===y.length&&(r.t.t1=1*y[0],r.t.t2=1*y[1],r.t.accel=1*y[2])}return r}function o(e){for(var t=[],r=0,n="",i=e.split("\\").slice(1).concat("").join("\\"),a=0;a<i.length;a++){var o=i[a];"("===o&&r++,")"===o&&r--,r<0&&(r=0),r||"\\"!==o?n+=o:(n&&t.push(n),n="")}return t.map(s)}function u(e){var t=e.split(/{([^{}]*?)}/),r=[];t[0].length&&r.push({tags:[],text:t[0],drawing:[]});for(var n=1;n<t.length;n+=2){var a=o(t[n]),s=a.reduce((function(e,t){return void 0===t.p?e:!!t.p}),!1);r.push({tags:a,text:s?"":t[n+1],drawing:s?i(t[n+1]):[]})}return{raw:e,combined:r.map((function(e){return e.text})).join(""),parsed:r}}function c(e,t){var r=e.split(",");if(r.length>t.length){var i=r.slice(t.length-1).join();(r=r.slice(0,t.length-1)).push(i)}for(var a,s={},o=0;o<r.length;o++){var c=t[o],f=r[o].trim();switch(c){case"Layer":case"MarginL":case"MarginR":case"MarginV":s[c]=1*f;break;case"Start":case"End":s[c]=(void 0,3600*(a=f.split(":"))[0]+60*a[1]+1*a[2]);break;case"Effect":s[c]=n(f);break;case"Text":s[c]=u(f);break;default:s[c]=f}}return s}var f=["Name","Fontname","Fontsize","PrimaryColour","SecondaryColour","OutlineColour","BackColour","Bold","Italic","Underline","StrikeOut","ScaleX","ScaleY","Spacing","Angle","BorderStyle","Outline","Shadow","Alignment","MarginL","MarginR","MarginV","Encoding"],h=["Layer","Start","End","Style","Name","MarginL","MarginR","MarginV","Effect","Text"];function d(e){var t=f.concat(h);return e.match(/Format\s*:\s*(.*)/i)[1].split(/\s*,\s*/).map((function(e){return t.find((function(t){return t.toLowerCase()===e.toLowerCase()}))||e}))}function l(e,t){var r=e.match(/Style\s*:\s*(.*)/i)[1].split(/\s*,\s*/);return Object.assign.apply(Object,[{}].concat(t.map((function(e,t){var n;return(n={})[e]=r[t],n}))))}function p(e){var t={type:null,prev:null,next:null,points:[]};/[mnlbs]/.test(e[0])&&(t.type=e[0].toUpperCase().replace("N","L").replace("B","C"));for(var r=e.length-!(1&e.length),n=1;n<r;n+=2)t.points.push({x:1*e[n],y:1*e[n+1]});return t}function v(e){return!(!e.points.length||!e.type||/C|S/.test(e.type)&&e.points.length<3)}function m(e){return e.map((function(e){return e.type+e.points.map((function(e){return e.x+","+e.y})).join(",")})).join("")}function g(e){for(var t,r=[],n=0;n<e.length;){var i=e[n],a=p(i);if(v(a)){if("S"===a.type){var s=(r[n-1]||{points:[{x:0,y:0}]}).points.slice(-1)[0],o=s.x,u=s.y;a.points.unshift({x:o,y:u})}n&&(a.prev=r[n-1].type,r[n-1].next=a.type),r.push(a),n++}else{if(n&&"S"===r[n-1].type){var c={p:a.points,c:r[n-1].points.slice(0,3)};r[n-1].points=r[n-1].points.concat((c[i[0]]||[]).map((function(e){return{x:e.x,y:e.y}})))}e.splice(n,1)}}var f=(t=[]).concat.apply(t,r.map((function(e){var t=e.type,r=e.points,n=e.prev,i=e.next;return"S"===t?function(e,t,r){var n=[],i=[0,2/3,1/3,0],a=[0,1/3,2/3,0],s=[0,1/6,2/3,1/6],o=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},u=[e[e.length-1].x,e[0].x,e[1].x,e[2].x],c=[e[e.length-1].y,e[0].y,e[1].y,e[2].y];n.push({type:"M"===t?"M":"L",points:[{x:o(s,u),y:o(s,c)}]});for(var f=3;f<e.length;f++)u=[e[f-3].x,e[f-2].x,e[f-1].x,e[f].x],c=[e[f-3].y,e[f-2].y,e[f-1].y,e[f].y],n.push({type:"C",points:[{x:o(i,u),y:o(i,c)},{x:o(a,u),y:o(a,c)},{x:o(s,u),y:o(s,c)}]});if("L"===r||"C"===r){var h=e[e.length-1];n.push({type:"L",points:[{x:h.x,y:h.y}]})}return n}(r,n,i):{type:t,points:r}})));return Object.assign({instructions:f,d:m(f)},function(e){var t,r=1/0,n=1/0,i=-1/0,a=-1/0;return(t=[]).concat.apply(t,e.map((function(e){return e.points}))).forEach((function(e){var t=e.x,s=e.y;r=Math.min(r,t),n=Math.min(n,s),i=Math.max(i,t),a=Math.max(a,s)})),{minX:r,minY:n,width:i-r,height:a-n}}(r))}var A=["fs","fsp","clip","c1","c2","c3","c4","a1","a2","a3","a4","alpha","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"];function y(e,t,r){var n,i,a;void 0===r&&(r={});var s=e[t];if(void 0===s)return null;if("pos"===t||"org"===t)return 2===s.length?((n={})[t]={x:s[0],y:s[1]},n):null;if("move"===t){var o=s[0],u=s[1],c=s[2],f=s[3],h=s[4];void 0===h&&(h=0);var d=s[5];return void 0===d&&(d=0),4===s.length||6===s.length?{move:{x1:o,y1:u,x2:c,y2:f,t1:h,t2:d}}:null}if("fad"===t||"fade"===t)return 2===s.length?{fade:{type:"fad",t1:s[0],t2:s[1]}}:7===s.length?{fade:{type:"fade",a1:s[0],a2:s[1],a3:s[2],t1:s[3],t2:s[4],t3:s[5],t4:s[6]}}:null;if("clip"===t){var l=s.inverse,p=s.scale,v=s.drawing,m=s.dots;return v?{clip:{inverse:l,scale:p,drawing:g(v),dots:m}}:m?{clip:{inverse:l,scale:p,drawing:v,dots:{x1:m[0],y1:m[1],x2:m[2],y2:m[3]}}}:null}if(/^[xy]?(bord|shad)$/.test(t)&&(s=Math.max(s,0)),"bord"===t)return{xbord:s,ybord:s};if("shad"===t)return{xshad:s,yshad:s};if(/^c\d$/.test(t))return(i={})[t]=s||r[t],i;if("alpha"===t)return{a1:s,a2:s,a3:s,a4:s};if("fr"===t)return{frz:s};if("fs"===t)return{fs:/^\+|-/.test(s)?(1*s>-10?1+s/10:1)*r.fs:1*s};if("K"===t)return{kf:s};if("t"===t){var x=s.t1,k=s.accel,b=s.tags,w=s.t2||1e3*(r.end-r.start),_={};return b.forEach((function(e){var t=Object.keys(e)[0];~A.indexOf(t)&&("clip"!==t||e[t].dots)&&Object.assign(_,y(e,t,r))})),{t:{t1:x,t2:w,accel:k,tag:_}}}return(a={})[t]=s,a}var x=[null,1,2,3,null,7,8,9,null,4,5,6],k=["r","a","an","pos","org","move","fade","fad","clip"];function b(e){for(var t,r,n,i,a,s,o,u=e.styles,c=e.style,f=e.parsed,h=e.start,d=e.end,l=[],p={style:c,fragments:[]},v={},m=0;m<f.length;m++){for(var A=f[m],b=A.tags,w=A.text,_=A.drawing,T=void 0,I=0;I<b.length;I++){var S=b[I];T=void 0===S.r?T:S.r}for(var P={tag:void 0===T?(o=v,JSON.parse(JSON.stringify(Object.assign({},o,{k:void 0,kf:void 0,ko:void 0,kt:void 0})))):{},text:w,drawing:_.length?g(_):null},B=0;B<b.length;B++){var C=b[B];t=t||x[C.a||0]||C.an,r=r||y(C,"pos"),n=n||y(C,"org"),i=i||y(C,"move"),a=a||y(C,"fade")||y(C,"fad"),s=y(C,"clip")||s;var M=Object.keys(C)[0];if(M&&!~k.indexOf(M)){var R=u[c].tag,U=y(C,M,{start:h,end:d,c1:R.c1,c2:R.c2,c3:R.c3,c4:R.c4,fs:v.fs||R.fs});"t"===M?(P.tag.t=P.tag.t||[],P.tag.t.push(U.t)):Object.assign(P.tag,U)}}if(v=P.tag,void 0!==T&&(l.push(p),p={style:u[T]?T:c,fragments:[]}),P.text||P.drawing){var E=p.fragments[p.fragments.length-1]||{};E.text&&P.text&&!Object.keys(P.tag).length?E.text+=P.text:p.fragments.push(P)}}return l.push(p),Object.assign({alignment:t,slices:l},r,n,i,a,s)}function w(e){for(var t=e.styles,r=e.dialogues,n=1/0,i=[],a=0;a<r.length;a++){var s=r[a];if(!(s.Start>=s.End)){t[s.Style]||(s.Style="Default");var o=t[s.Style].style,u=b({styles:t,style:s.Style,parsed:s.Text.parsed,start:s.Start,end:s.End}),c=u.alignment||o.Alignment;n=Math.min(n,s.Layer),i.push(Object.assign({layer:s.Layer,start:s.Start,end:s.End,style:s.Style,name:s.Name,margin:{left:s.MarginL||o.MarginL,right:s.MarginR||o.MarginR,vertical:s.MarginV||o.MarginV},effect:s.Effect},u,{alignment:c}))}}for(var f=0;f<i.length;f++)i[f].layer-=n;return i.sort((function(e,t){return e.start-t.start||e.end-t.end}))}var _={Name:"Default",Fontname:"Arial",Fontsize:"20",PrimaryColour:"&H00FFFFFF&",SecondaryColour:"&H000000FF&",OutlineColour:"&H00000000&",BackColour:"&H00000000&",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"2",Shadow:"2",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"1"};function T(e){if(/^(&|H|&H)[0-9a-f]{6,}/i.test(e)){var t=e.match(/&?H?([0-9a-f]{2})?([0-9a-f]{6})/i);return[t[1]||"00",t[2]]}var r=parseInt(e,10);if(!isNaN(r)){var n=-2147483648;if(r<n)return["00","000000"];var i=n<=r&&r<=2147483647?("00000000"+(r<0?r+4294967296:r).toString(16)).slice(-8):String(r).slice(0,8);return[i.slice(0,2),i.slice(2)]}return["00","000000"]}function I(e,t){void 0===t&&(t={});var r=function(e){for(var t={info:{},styles:{format:[],style:[]},events:{format:[],comment:[],dialogue:[]}},r=e.split(/\r?\n/),n=0,i=0;i<r.length;i++){var a=r[i].trim();if(!/^;/.test(a)&&(/^\[Script Info\]/i.test(a)?n=1:/^\[V4\+? Styles\]/i.test(a)?n=2:/^\[Events\]/i.test(a)?n=3:/^\[.*\]/.test(a)&&(n=0),0!==n)){if(1===n&&/:/.test(a)){var s=a.match(/(.*?)\s*:\s*(.*)/),o=s[1],u=s[2];t.info[o]=u}if(2===n&&(/^Format\s*:/i.test(a)&&(t.styles.format=d(a)),/^Style\s*:/i.test(a)&&t.styles.style.push(l(a,t.styles.format))),3===n&&(/^Format\s*:/i.test(a)&&(t.events.format=d(a)),/^(?:Comment|Dialogue)\s*:/i.test(a))){var f=a.match(/^(\w+?)\s*:\s*(.*)/i),h=f[1],p=f[2];t.events[h.toLowerCase()].push(c(p,t.events.format))}}}return t}(e),n=function(e){for(var t=e.info,r=e.style,n=e.defaultStyle,i={},a=[Object.assign({},n,{Name:"Default"})].concat(r),s=function(e){var r=Object.assign({},_,a[e]);/^(\*+)Default$/.test(r.Name)&&(r.Name="Default"),Object.keys(r).forEach((function(e){"Name"===e||"Fontname"===e||/Colour/.test(e)||(r[e]*=1)}));var n=T(r.PrimaryColour),s=n[0],o=n[1],u=T(r.SecondaryColour),c=u[0],f=u[1],h=T(r.OutlineColour),d=h[0],l=h[1],p=T(r.BackColour),v=p[0],m=p[1],g={fn:r.Fontname,fs:r.Fontsize,c1:o,a1:s,c2:f,a2:c,c3:l,a3:d,c4:m,a4:v,b:Math.abs(r.Bold),i:Math.abs(r.Italic),u:Math.abs(r.Underline),s:Math.abs(r.StrikeOut),fscx:r.ScaleX,fscy:r.ScaleY,fsp:r.Spacing,frz:r.Angle,xbord:r.Outline,ybord:r.Outline,xshad:r.Shadow,yshad:r.Shadow,fe:r.Encoding,q:/^[0-3]$/.test(t.WrapStyle)?1*t.WrapStyle:2};i[r.Name]={style:r,tag:g}},o=0;o<a.length;o++)s(o);return i}({info:r.info,style:r.styles.style,defaultStyle:t.defaultStyle||{}});return{info:r.info,width:1*r.info.PlayResX||null,height:1*r.info.PlayResY||null,collisions:r.info.Collisions||"Normal",styles:n,dialogues:w({styles:n,dialogues:r.events.dialogue})}}var S={M:"m",L:"l",C:"b"};var P=function(e){return function(t){return function(r){return""+t+e+"&H"+r+"&"}}},B=P("c"),C=P("a"),M={c1:B(1),c2:B(2),c3:B(3),c4:B(4),a1:C(1),a2:C(2),a3:C(3),a4:C(4),pos:function(e){return"pos("+[e.x,e.y]+")"},org:function(e){return"org("+[e.x,e.y]+")"},move:function(e){return"move("+[e.x1,e.y1,e.x2,e.y2,e.t1,e.t2]+")"},fade:function(e){return"fad"===e.type?"fad("+[e.t1,e.t2]+")":"fade("+[e.a1,e.a2,e.a3,e.t1,e.t2,e.t3,e.t4]+")"},clip:function(e){return(e.inverse?"i":"")+"clip("+(e.dots?""+[e.dots.x1,e.dots.y1,e.dots.x2,e.dots.y2]:(1===e.scale?"":e.scale+",")+e.drawing.instructions.map((function(e){var t,r=e.type,n=e.points;return(t=[S[r]]).concat.apply(t,n.map((function(e){return[e.x,e.y]}))).join(" ")})).join(" "))+")"},t:function(e){return e.map((function(e){return"t("+[e.t1,e.t2,e.accel,(t=e.tag,Object.keys(t).map((function(e){return"\\"+(M[e]||function(t){return""+e+t})(t[e])})).join(""))]+")";var t})).join("\\")}}},49963:(e,t,r)=>{"use strict";r.d(t,{b:()=>i});var n=r(32517);function i({styles:e,dialogues:t}){let r=1/0;const i=[];for(let a=0;a<t.length;a++){const s=t[a];if(s.Start>=s.End)continue;e[s.Style]||(s.Style="Default");const o=e[s.Style].style,u=(0,n.t)({styles:e,style:s.Style,parsed:s.Text.parsed,start:s.Start,end:s.End}),c=u.alignment||o.Alignment;r=Math.min(r,s.Layer),i.push(Object.assign({layer:s.Layer,start:s.Start,end:s.End,style:s.Style,name:s.Name,margin:{left:s.MarginL||o.MarginL,right:s.MarginR||o.MarginR,vertical:s.MarginV||o.MarginV},effect:s.Effect},u,{alignment:c}))}for(let e=0;e<i.length;e++)i[e].layer-=r;return i.sort(((e,t)=>e.start-t.start||e.end-t.end))}},98786:(e,t,r)=>{"use strict";function n(e){const t={type:null,prev:null,next:null,points:[]};/[mnlbs]/.test(e[0])&&(t.type=e[0].toUpperCase().replace("N","L").replace("B","C"));for(let r=e.length-!(1&e.length),n=1;n<r;n+=2)t.points.push({x:1*e[n],y:1*e[n+1]});return t}function i(e){return!(!e.points.length||!e.type||/C|S/.test(e.type)&&e.points.length<3)}function a(e){return e.map((({type:e,points:t})=>e+t.map((({x:e,y:t})=>`${e},${t}`)).join(","))).join("")}function s(e){const t=[];let r=0;for(;r<e.length;){const a=e[r],s=n(a);if(i(s)){if("S"===s.type){const{x:e,y:n}=(t[r-1]||{points:[{x:0,y:0}]}).points.slice(-1)[0];s.points.unshift({x:e,y:n})}r&&(s.prev=t[r-1].type,t[r-1].next=s.type),t.push(s),r++}else{if(r&&"S"===t[r-1].type){const e={p:s.points,c:t[r-1].points.slice(0,3)};t[r-1].points=t[r-1].points.concat((e[a[0]]||[]).map((({x:e,y:t})=>({x:e,y:t}))))}e.splice(r,1)}}const s=[].concat(...t.map((({type:e,points:t,prev:r,next:n})=>"S"===e?function(e,t,r){const n=[],i=[0,2/3,1/3,0],a=[0,1/3,2/3,0],s=[0,1/6,2/3,1/6],o=(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3];let u=[e[e.length-1].x,e[0].x,e[1].x,e[2].x],c=[e[e.length-1].y,e[0].y,e[1].y,e[2].y];n.push({type:"M"===t?"M":"L",points:[{x:o(s,u),y:o(s,c)}]});for(let t=3;t<e.length;t++)u=[e[t-3].x,e[t-2].x,e[t-1].x,e[t].x],c=[e[t-3].y,e[t-2].y,e[t-1].y,e[t].y],n.push({type:"C",points:[{x:o(i,u),y:o(i,c)},{x:o(a,u),y:o(a,c)},{x:o(s,u),y:o(s,c)}]});if("L"===r||"C"===r){const t=e[e.length-1];n.push({type:"L",points:[{x:t.x,y:t.y}]})}return n}(t,r,n):{type:e,points:t})));return Object.assign({instructions:s,d:a(s)},function(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;return[].concat(...e.map((({points:e})=>e))).forEach((({x:e,y:a})=>{t=Math.min(t,e),r=Math.min(r,a),n=Math.max(n,e),i=Math.max(i,a)})),{minX:t,minY:r,width:n-t,height:i-r}}(t))}r.d(t,{EB:()=>s})},78040:(e,t,r)=>{"use strict";r.d(t,{W:()=>a});const n={Name:"Default",Fontname:"Arial",Fontsize:"20",PrimaryColour:"&H00FFFFFF&",SecondaryColour:"&H000000FF&",OutlineColour:"&H00000000&",BackColour:"&H00000000&",Bold:"0",Italic:"0",Underline:"0",StrikeOut:"0",ScaleX:"100",ScaleY:"100",Spacing:"0",Angle:"0",BorderStyle:"1",Outline:"2",Shadow:"2",Alignment:"2",MarginL:"10",MarginR:"10",MarginV:"10",Encoding:"1"};function i(e){if(/^(&|H|&H)[0-9a-f]{6,}/i.test(e)){const[,t,r]=e.match(/&?H?([0-9a-f]{2})?([0-9a-f]{6})/i);return[t||"00",r]}const t=parseInt(e,10);if(!Number.isNaN(t)){const e=-2147483648;if(t<e)return["00","000000"];const r=e<=t&&t<=2147483647?`00000000${(t<0?t+4294967296:t).toString(16)}`.slice(-8):String(t).slice(0,8);return[r.slice(0,2),r.slice(2)]}return["00","000000"]}function a({info:e,style:t,defaultStyle:r}){const a={},s=[Object.assign({},r,{Name:"Default"})].concat(t);for(let t=0;t<s.length;t++){const r=Object.assign({},n,s[t]);/^(\*+)Default$/.test(r.Name)&&(r.Name="Default"),Object.keys(r).forEach((e=>{"Name"===e||"Fontname"===e||/Colour/.test(e)||(r[e]*=1)}));const[o,u]=i(r.PrimaryColour),[c,f]=i(r.SecondaryColour),[h,d]=i(r.OutlineColour),[l,p]=i(r.BackColour),v={fn:r.Fontname,fs:r.Fontsize,c1:u,a1:o,c2:f,a2:c,c3:d,a3:h,c4:p,a4:l,b:Math.abs(r.Bold),i:Math.abs(r.Italic),u:Math.abs(r.Underline),s:Math.abs(r.StrikeOut),fscx:r.ScaleX,fscy:r.ScaleY,fsp:r.Spacing,frz:r.Angle,xbord:r.Outline,ybord:r.Outline,xshad:r.Shadow,yshad:r.Shadow,fe:r.Encoding,q:/^[0-3]$/.test(e.WrapStyle)?1*e.WrapStyle:2};a[r.Name]={style:r,tag:v}}return a}},64484:(e,t,r)=>{"use strict";r.d(t,{k:()=>a});var n=r(98786);const i=["fs","fsp","clip","c1","c2","c3","c4","a1","a2","a3","a4","alpha","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"];function a(e,t,r={}){let s=e[t];if(void 0===s)return null;if("pos"===t||"org"===t)return 2===s.length?{[t]:{x:s[0],y:s[1]}}:null;if("move"===t){const[e,t,r,n,i=0,a=0]=s;return 4===s.length||6===s.length?{move:{x1:e,y1:t,x2:r,y2:n,t1:i,t2:a}}:null}if("fad"===t||"fade"===t){if(2===s.length){const[e,t]=s;return{fade:{type:"fad",t1:e,t2:t}}}if(7===s.length){const[e,t,r,n,i,a,o]=s;return{fade:{type:"fade",a1:e,a2:t,a3:r,t1:n,t2:i,t3:a,t4:o}}}return null}if("clip"===t){const{inverse:e,scale:t,drawing:r,dots:i}=s;if(r)return{clip:{inverse:e,scale:t,drawing:(0,n.EB)(r),dots:i}};if(i){const[n,a,s,o]=i;return{clip:{inverse:e,scale:t,drawing:r,dots:{x1:n,y1:a,x2:s,y2:o}}}}return null}if(/^[xy]?(bord|shad)$/.test(t)&&(s=Math.max(s,0)),"bord"===t)return{xbord:s,ybord:s};if("shad"===t)return{xshad:s,yshad:s};if(/^c\d$/.test(t))return{[t]:s||r[t]};if("alpha"===t)return{a1:s,a2:s,a3:s,a4:s};if("fr"===t)return{frz:s};if("fs"===t)return{fs:/^\+|-/.test(s)?(1*s>-10?1+s/10:1)*r.fs:1*s};if("K"===t)return{kf:s};if("t"===t){const{t1:e,accel:t,tags:n}=s,o=s.t2||1e3*(r.end-r.start),u={};return n.forEach((e=>{const t=Object.keys(e)[0];~i.indexOf(t)&&("clip"!==t||e[t].dots)&&Object.assign(u,a(e,t,r))})),{t:{t1:e,t2:o,accel:t,tag:u}}}return{[t]:s}}},32517:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});var n=r(98786),i=r(64484);const a=[null,1,2,3,null,7,8,9,null,4,5,6],s=["r","a","an","pos","org","move","fade","fad","clip"];function o({styles:e,style:t,parsed:r,start:o,end:u}){let c,f,h,d,l,p;const v=[];let m={style:t,fragments:[]},g={};for(let y=0;y<r.length;y++){const{tags:x,text:k,drawing:b}=r[y];let w;for(let e=0;e<x.length;e++){const t=x[e];w=void 0===t.r?w:t.r}const _={tag:void 0===w?(A=g,JSON.parse(JSON.stringify(Object.assign({},A,{k:void 0,kf:void 0,ko:void 0,kt:void 0})))):{},text:k,drawing:b.length?(0,n.EB)(b):null};for(let r=0;r<x.length;r++){const n=x[r];c=c||a[n.a||0]||n.an,f=f||(0,i.k)(n,"pos"),h=h||(0,i.k)(n,"org"),d=d||(0,i.k)(n,"move"),l=l||(0,i.k)(n,"fade")||(0,i.k)(n,"fad"),p=(0,i.k)(n,"clip")||p;const v=Object.keys(n)[0];if(v&&!~s.indexOf(v)){const r=e[t].tag,{c1:a,c2:s,c3:c,c4:f}=r,h=g.fs||r.fs,d=(0,i.k)(n,v,{start:o,end:u,c1:a,c2:s,c3:c,c4:f,fs:h});"t"===v?(_.tag.t=_.tag.t||[],_.tag.t.push(d.t)):Object.assign(_.tag,d)}}if(g=_.tag,void 0!==w&&(v.push(m),m={style:e[w]?w:t,fragments:[]}),_.text||_.drawing){const e=m.fragments[m.fragments.length-1]||{};e.text&&_.text&&!Object.keys(_.tag).length?e.text+=_.text:m.fragments.push(_)}}var A;return v.push(m),Object.assign({alignment:c,slices:v},f,h,d,l,p)}},74672:(e,t,r)=>{"use strict";function n(e){return e?e.toLowerCase().replace(/([+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?)/g," $1 ").replace(/([mnlbspc])/g," $1 ").trim().replace(/\s+/g," ").split(/\s(?=[mnlbspc])/).map((e=>e.split(" ").filter(((e,t)=>!(t&&Number.isNaN(1*e)))))):[]}r.d(t,{O:()=>n})},44453:(e,t,r)=>{"use strict";function n(e){const t=e.toLowerCase().trim().split(/\s*;\s*/);return"banner"===t[0]?{name:t[0],delay:1*t[1]||0,leftToRight:1*t[2]||0,fadeAwayWidth:1*t[3]||0}:/^scroll\s/.test(t[0])?{name:t[0],y1:Math.min(1*t[1],1*t[2]),y2:Math.max(1*t[1],1*t[2]),delay:1*t[3]||0,fadeAwayHeight:1*t[4]||0}:""!==e?{name:e}:null}r.d(t,{d:()=>n})},53534:(e,t,r)=>{"use strict";r.d(t,{E:()=>a});var n=r(74672);const i=["b","i","u","s","fsp","k","K","kf","ko","kt","fe","q","p","pbo","a","an","fscx","fscy","fax","fay","frx","fry","frz","fr","be","blur","bord","xbord","ybord","shad","xshad","yshad"].map((e=>({name:e,regex:new RegExp(`^${e}-?\\d`)})));function a(e){const t={};for(let r=0;r<i.length;r++){const{name:n,regex:a}=i[r];if(a.test(e))return t[n]=1*e.slice(n.length),t}if(/^fn/.test(e))t.fn=e.slice(2);else if(/^r/.test(e))t.r=e.slice(1);else if(/^fs[\d+-]/.test(e))t.fs=e.slice(2);else if(/^\d?c&?H?[0-9a-fA-F]+|^\d?c$/.test(e)){const[,r,n]=e.match(/^(\d?)c&?H?(\w*)/);t[`c${r||1}`]=n&&`000000${n}`.slice(-6)}else if(/^\da&?H?[0-9a-fA-F]+/.test(e)){const[,r,n]=e.match(/^(\d)a&?H?([0-9a-f]+)/i);t[`a${r}`]=`00${n}`.slice(-2)}else if(/^alpha&?H?[0-9a-fA-F]+/.test(e))[,t.alpha]=e.match(/^alpha&?H?([0-9a-f]+)/i),t.alpha=`00${t.alpha}`.slice(-2);else if(/^(?:pos|org|move|fad|fade)\([^)]+/.test(e)){const[,r,n]=e.match(/^(\w+)\((.*?)\)?$/);t[r]=n.trim().split(/\s*,\s*/).map(Number)}else if(/^i?clip\([^)]+/.test(e)){const r=e.match(/^i?clip\((.*?)\)?$/)[1].trim().split(/\s*,\s*/);t.clip={inverse:/iclip/.test(e),scale:1,drawing:null,dots:null},1===r.length&&(t.clip.drawing=(0,n.O)(r[0])),2===r.length&&(t.clip.scale=1*r[0],t.clip.drawing=(0,n.O)(r[1])),4===r.length&&(t.clip.dots=r.map(Number))}else if(/^t\(/.test(e)){const r=e.match(/^t\((.*?)\)?$/)[1].trim().replace(/\\.*/,(e=>e.replace(/,/g,"\n"))).split(/\s*,\s*/);if(!r[0])return t;t.t={t1:0,t2:0,accel:1,tags:r[r.length-1].replace(/\n/g,",").split("\\").slice(1).map(a)},2===r.length&&(t.t.accel=1*r[0]),3===r.length&&(t.t.t1=1*r[0],t.t.t2=1*r[1]),4===r.length&&(t.t.t1=1*r[0],t.t.t2=1*r[1],t.t.accel=1*r[2])}return t}},27637:(e,t,r)=>{"use strict";r.d(t,{r:()=>i});var n=r(53534);function i(e){const t=[];let r=0,i="";const a=e.split("\\").slice(1).concat("").join("\\");for(let e=0;e<a.length;e++){const n=a[e];"("===n&&r++,")"===n&&r--,r<0&&(r=0),r||"\\"!==n?i+=n:(i&&t.push(i),i="")}return t.map(n.E)}},93935:(e,t,r)=>{"use strict";r.d(t,{r:()=>a});var n=r(74672),i=r(27637);function a(e){const t=e.split(/{([^{}]*?)}/),r=[];t[0].length&&r.push({tags:[],text:t[0],drawing:[]});for(let e=1;e<t.length;e+=2){const a=(0,i.r)(t[e]),s=a.reduce(((e,t)=>void 0===t.p?e:!!t.p),!1);r.push({tags:a,text:s?"":t[e+1],drawing:s?(0,n.O)(t[e+1]):[]})}return{raw:e,combined:r.map((e=>e.text)).join(""),parsed:r}}},21194:(e,t,r)=>{"use strict";r.d(t,{By:()=>s,IU:()=>a});var n=r(47924),i=r(77334);function a(e){const{box:t}=e;for(;t.lastChild;)t.lastChild.remove();e.actives=[],e.space=[]}function s(e,t){const{video:r,box:s,svg:o,layoutRes:u}=t;return function(){const c=r.clientWidth,f=r.clientHeight,h=u.width||r.videoWidth||c,d=u.height||r.videoHeight||f,l=t.scriptRes.width,p=t.scriptRes.height;let v=l,m=p;const g=Math.min(c/h,f/d);"video_width"===e.resampling&&(m=l/h*d),"video_height"===e.resampling&&(v=p/d*h),t.scale=Math.min(c/v,f/m),"script_width"===e.resampling&&(t.scale=g*(h/v)),"script_height"===e.resampling&&(t.scale=g*(d/m));const A=t.scale*v,y=t.scale*m;t.width=A,t.height=y,t.resampledRes={width:v,height:m};const x=`width:${A}px;height:${y}px;top:${(f-y)/2}px;left:${(c-A)/2}px;`;s.style.cssText=x,s.style.setProperty("--ass-scale",t.scale),s.style.setProperty("--ass-scale-stroke",t.sbas?t.scale:1),o.style.cssText=x,function(e){return function(){a(e);const{video:t,dialogues:r}=e,s=t.currentTime-e.delay;e.index=(()=>{for(let e=0;e<r.length;e+=1)if(s<r[e].end)return e;return(r.length||1)-1})(),function(e){const{video:t,dialogues:r,actives:a}=e,s=t.currentTime-e.delay;for(let e=a.length-1;e>=0;e-=1){const t=a[e],{end:r}=t;r<s&&(t.$div.remove(),a.splice(e,1))}for(;e.index<r.length&&s>=r[e.index].start;){if(s<r[e.index].end){const s=(0,n.U)(r[e.index],e);t.paused||(0,i.MA)(s,"play"),a.push(s)}e.index+=1}}(e)}}(t)()}}},23873:(e,t,r)=>{"use strict";r.d(t,{nq:()=>h,w7:()=>d});var n=r(77334),i=r(77658),a=r(39923),s=r(57131);function o({effect:e,duration:t}){const{name:r,delay:n,leftToRight:i}=e;return"banner"===r?[0,`calc(var(--ass-scale) * ${t/(n||1)*(i?1:-1)}px)`].map(((e,t)=>({offset:t,transform:`translateX(${e})`}))):r.startsWith("scroll")?[{offset:0,transform:"translateY(-100%)"},{offset:1,transform:`translateY(calc(var(--ass-scale) * ${t/(n||1)*(/up/.test(r)?-1:1)}px))`}]:[]}function u({move:e,duration:t,dialogue:r}){const{x1:n,y1:i,x2:a,y2:s,t1:o,t2:u}=e,c=[o,u||t],f=r.pos||{x:0,y:0};return[[n,i],[a,s]].map((([e,t])=>[e-f.x,t-f.y])).map((([e,r],n)=>({offset:Math.min(c[n]/t,1),transform:`translate(calc(var(--ass-scale) * ${e}px), calc(var(--ass-scale) * ${r}px))`})))}function c(e,t){if("fad"===e.type){const{t1:r,t2:n}=e,i=[];return r&&i.push([0,0]),r<t?(n<=t&&i.push([r/t,1]),r+n<t&&i.push([(t-n)/t,1]),n>t?i.push([0,(n-t)/n]):r+n>t&&i.push([(r+.5)/t,1-(r+n-t)/n]),n&&i.push([1,0])):i.push([1,t/r]),i.map((([e,t])=>({offset:e,opacity:t})))}const{a1:r,a2:n,a3:i,t1:a,t2:s,t3:o,t4:u}=e,c=[r,n,i].map((e=>1-e/255));return[0,a,s,o,u,t].map((e=>e/t)).map(((e,t)=>({offset:e,opacity:c[t>>1]}))).filter((({offset:e})=>e<=1))}function f({fromTag:e,tag:t,fragment:r}){const n={...e,...t};return r.drawing&&(Object.assign(n,{p:0,fscx:(t.fscx||e.fscx)/e.fscx*100,fscy:(t.fscy||e.fscy)/e.fscy*100}),Object.assign(e,{fscx:100,fscy:100})),Object.fromEntries((0,s.l1)(n))}function h(e){return[["real-fs",(0,i.F)(e.fn,e.fs)],["tag-fs",e.fs],["tag-fsp",e.fsp],["fill-color",(0,n.qG)(e.a1+e.c1)]].filter((([,e])=>e)).map((([e,t])=>[`--ass-${e}`,t]))}function d(e,t){const{start:r,end:n,effect:i,move:s,fade:d,slices:l}=e,p=1e3*(n-r),v=[...i&&!s?o({effect:i,duration:p}):[],...s?u({move:s,duration:p,dialogue:e}):[],...d?c(d,p):[]].sort(((e,t)=>e.offset-t.offset));v.length>0&&Object.assign(e,{keyframes:v}),l.forEach((e=>{const r=t.styles[e.style].tag;e.fragments.forEach((e=>{if(!e.tag.t||0===e.tag.t.length)return;const n={...r,...e.tag},i=(s=e.tag.t,s.reduceRight(((e,t)=>{let r=!1;return e.map((e=>(r=t.t1===e.t1&&t.t2===e.t2&&t.accel===e.accel,{...e,...r?{tag:{...e.tag,...t.tag}}:{}}))).concat(r?[]:t)}),[])).sort(((e,t)=>e.t2-t.t2||e.t1-t.t1));var s;i[0].t1>0&&i.unshift({t1:0,t2:i[0].t1,tag:n}),i.reduce(((e,t)=>{const r={...e,...t.tag};return r.t=null,Object.assign(t.tag,r),r}),{});const o=Math.max(p,...i.map((({t2:e})=>e))),u=i.map((({t2:r,tag:i})=>({offset:r/o,...Object.fromEntries(h({...i,a1:i.a1||n.a1,c1:i.c1||n.c1})),...Object.fromEntries((0,a.K)({...n,...i},t.sbas?t.scale:1)),...f({fromTag:n,tag:i,fragment:e})}))).sort(((e,t)=>e.offset-t.offset));u.length>0&&Object.assign(e,{keyframes:u,duration:o})}))}))}window.CSS.registerProperty&&(["real-fs","tag-fs","tag-fsp"].forEach((e=>{window.CSS.registerProperty({name:`--ass-${e}`,syntax:"<number>",inherits:!0,initialValue:"0"})})),window.CSS.registerProperty({name:"--ass-fill-color",syntax:"<color>",inherits:!0,initialValue:"transparent"}))},60913:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});var n=r(77334);function i(e,t){const{id:r,clip:i}=e;if(!i)return{};const{width:a,height:s}=t.scriptRes;!function(e,t,r,i,a){if(e.querySelector(`#${r}`))return;let s="";if(null!==t.dots){let{x1:e,y1:r,x2:n,y2:o}=t.dots;e/=i,r/=a,n/=i,o/=a,s=`M${e},${r}L${e},${o},${n},${o},${n},${r}Z`}null!==t.drawing&&(s=t.drawing.instructions.map((({type:e,points:t})=>e+t.map((({x:e,y:t})=>`${e/i},${t/a}`)).join(","))).join(""));const o=1/(1<<t.scale-1);t.inverse&&(s+=`M0,0L0,${o},${o},${o},${o},0,0,0Z`);const u=(0,n.An)("clipPath",[["id",r],["clipPathUnits","objectBoundingBox"]]);u.append((0,n.An)("path",[["d",s],["transform",`scale(${o})`],["clip-rule","evenodd"]])),e.append(u)}(t.defs,i,r,a,s);const o=document.createElement("div");return t.box.insertBefore(o,e.$div),o.append(e.$div),o.className="ASS-clip-area",o.style.clipPath=`url(#${r})`,{$div:o}}},21643:(e,t,r)=>{"use strict";r.d(t,{p:()=>u});var n=r(77334),i=r(82873),a=r(23873),s=r(39923),o=r(57131);function u(e,t){const{video:r,styles:u}=t,c=document.createElement("div");c.className="ASS-dialogue";const f=document.createDocumentFragment(),{align:h,slices:d,start:l,end:p}=e;[["--ass-align-h",["left","center","right"][h.h]],["--ass-align-v",["bottom","center","top"][h.v]]].forEach((([e,t])=>{c.style.setProperty(e,t)}));const v={duration:1e3*(p-l),delay:1e3*Math.min(0,l-(r.currentTime-t.delay)),fill:"forwards"},m=[];return d.forEach((e=>{const r=u[e.style].tag,c=u[e.style].style.BorderStyle;e.fragments.forEach((e=>{const{text:u,drawing:h}=e,d={...r,...e.tag};let l="";const p=[];if(!h){p.push(...(0,a.nq)(d));const e=t.sbas?t.scale:1;p.push(...(0,s.K)(d,e)),l+=`font-family:"${d.fn}";`,l+=d.b?`font-weight:${1===d.b?"bold":d.b};`:"",l+=d.i?"font-style:italic;":"",l+=d.u||d.s?`text-decoration:${d.u?"underline":""} ${d.s?"line-through":""};`:""}if(h&&d.pbo){const e=-d.pbo*(d.fscy||100)/100;l+=`vertical-align:calc(var(--ass-scale) * ${e}px);`}p.push(...(0,o.l1)(d));const g=[d,...(d.t||[]).map((e=>e.tag))],A=o.r8.some((e=>g.some((t=>t[e])))),y=o.IZ.some((e=>g.some((t=>void 0!==t[e]&&100!==t[e])))),x=o.ge.some((e=>g.some((t=>t[e]))));(function(e,t){return e.replace(/\\h/g," ").replace(/\\N/g,"\n").replace(/\\n/g,2===t?"\n":" ")})(u,d.q).split("\n").forEach(((a,s)=>{const o=document.createElement("span"),u=document.createElement("span");if(o.dataset.wrapStyle=d.q,o.dataset.borderStyle=c,(y||x)&&(y&&(u.dataset.scale=""),x&&(u.dataset.skew=""),u.textContent=a),A&&(o.dataset.rotate=""),h){o.dataset.drawing="";const n=(0,i.v)(e,r,t);if(!n)return;o.style.cssText=n.cssText,o.append(n.$svg)}else{if(o.dataset.text="",s&&f.append(document.createElement("br")),!a)return;y||x?o.append(u):o.textContent=a;const e=y||x?u:o;(d.xbord||d.ybord||d.xshad||d.yshad)&&(e.dataset.text=a)}if(o.style.cssText+=l,p.forEach((([e,t])=>{o.style.setProperty(e,t)})),e.keyframes){const t=(0,n.dT)(o,e.keyframes,{...v,duration:e.duration});m.push(t)}f.append(o)}))}))})),e.keyframes&&m.push((0,n.dT)(c,e.keyframes,v)),c.append(f),{$div:c,animations:m}}},82873:(e,t,r)=>{"use strict";r.d(t,{v:()=>a});var n=r(77334),i=r(39923);function a(e,t,r){if(!e.drawing.d)return null;const a={...t,...e.tag},{minX:s,minY:o,width:u,height:c}=e.drawing,f=r.scale/(1<<a.p-1),h=(a.fscx?a.fscx/100:1)*f,d=(a.fscy?a.fscy/100:1)*f,l=a.blur||a.be||0,p=a.xbord+(a.xshad<0?-a.xshad:0)+l,v=a.ybord+(a.yshad<0?-a.yshad:0)+l,m=u*h+2*a.xbord+Math.abs(a.xshad)+2*l,g=c*d+2*a.ybord+Math.abs(a.yshad)+2*l,A=(0,n.An)("svg",[["width",m],["height",g],["viewBox",`${-p} ${-v} ${m} ${g}`]]),y=r.sbas?r.scale:1,x=`ASS-${(0,n.uR)()}`,k=(0,n.An)("defs");k.append((0,i.h)(a,x,y)),A.append(k);const b=`ASS-${(0,n.uR)()}`,w=(0,n.An)("symbol",[["id",b],["viewBox",`${s} ${o} ${u} ${c}`]]);return w.append((0,n.An)("path",[["d",e.drawing.d]])),A.append(w),A.append((0,n.An)("use",[["width",u*h],["height",c*d],["xlink:href",`#${b}`],["filter",`url(#${x})`]])),A.style.cssText=`position:absolute;left:${s*h-p}px;top:${o*d-v}px;`,{$svg:A,cssText:`position:relative;width:${u*h}px;height:${c*d}px;`}}},77658:(e,t,r)=>{"use strict";r.d(t,{F:()=>o,Y:()=>n});const n=document.createElement("div");n.className="ASS-fix-font-size";const i=document.createElement("span");i.textContent="0",n.append(i);const a=2048,s=Object.create(null);function o(e,t){return s[e]||(i.style.fontFamily=e,s[e]=i.clientHeight),t*a/s[e]}},51776:(e,t,r)=>{"use strict";function n(e,t){const{scale:r}=t,{effect:n,move:i,align:a,width:s,height:o,margin:u,slices:c}=e;let f=0,h=0;if(n&&"banner"===n.name)f=n.lefttoright?-s:t.width,h=[t.height-o-u.vertical,(t.height-o)/2,u.vertical][a.v];else if(e.pos||i){const t=e.pos||{x:0,y:0},n=r*t.x,i=r*t.y;f=[n,n-s/2,n-s][a.h],h=[i-o,i-o/2,i][a.v]}else f=[0,(t.width-s)/2,t.width-s-r*u.right][a.h],h=c.some((e=>e.fragments.some((({keyframes:e})=>e?.length))))?[t.height-o-u.vertical,(t.height-o)/2,u.vertical][a.v]:function(e,t){const{video:r,space:n,scale:i}=t,{layer:a,margin:s,width:o,height:u,alignment:c,end:f}=e,h=t.width-Math.trunc(i*(s.left+s.right)),d=t.height,l=Math.trunc(i*s.vertical),p=100*r.currentTime;n[a]=n[a]||{left:{width:new Uint16Array(d+1),end:new Uint32Array(d+1)},center:{width:new Uint16Array(d+1),end:new Uint32Array(d+1)},right:{width:new Uint16Array(d+1),end:new Uint32Array(d+1)}};const v=n[a],m=["right","left","center"][c%3];let g=0,A=0;const y=e=>(g=(e=>{const t=v.left.width[e],r=v.center.width[e],n=v.right.width[e],i=v.left.end[e],a=v.center.end[e],s=v.right.end[e];return"left"===m&&(i>p&&t||a>p&&r&&2*o+r>h||s>p&&n&&o+n>h)||"center"===m&&(i>p&&t&&2*t+o>h||a>p&&r||s>p&&n&&2*n+o>h)||"right"===m&&(i>p&&t&&t+o>h||a>p&&r&&2*o+r>h||s>p&&n)})(e)?0:g+1,g>=u&&(A=e,!0));if(c<=3){A=d-l-1;for(let e=A;e>l&&!y(e);e-=1);}else if(c>=7){A=l+1;for(let e=A;e<d-l&&!y(e);e+=1);}else{A=d-u>>1;for(let e=A;e<d-l&&!y(e);e+=1);}c>3&&(A-=u-1);for(let e=A;e<A+u;e+=1)v[m].width[e]=o,v[m].end[e]=100*f;return A}(e,t);return{x:f,y:h}}r.d(t,{E:()=>n})},47924:(e,t,r)=>{"use strict";r.d(t,{U:()=>c});var n=r(60913),i=r(21643),a=r(51776),s=r(59950),o=r(57131),u=r(38298);function c(e,t){const{$div:r,animations:c}=(0,i.p)(e,t);Object.assign(e,{$div:r,animations:c}),t.box.append(r);const{width:f}=r.getBoundingClientRect();Object.assign(e,{width:f}),r.style.cssText+=(0,s._)(e);const{height:h}=r.getBoundingClientRect();Object.assign(e,{height:h});const{x:d,y:l}=(0,a.E)(e,t);return Object.assign(e,{x:d,y:l}),r.style.cssText+=`width:${f}px;height:${h}px;left:${d}px;top:${l}px;`,(0,o.Lu)(e,t.scale),Object.assign(e,(0,n.C)(e,t)),e.effect?.name?.startsWith("scroll")&&Object.assign(e,(0,u.j)(e,t)),e}},38298:(e,t,r)=>{"use strict";function n(e,t){const r=document.createElement("div");r.className="ASS-scroll-area",t.box.insertBefore(r,e.$div),r.append(e.$div);const{height:n}=t.scriptRes,{name:i,y1:a,y2:s}=e.effect,o=Math.min(a,s)/n*100,u=(n-Math.max(a,s))/n*100;r.style.cssText+=`top:${o}%;bottom:${u}%;`;const c=/up/.test(i);return e.$div.style.cssText+=c?"top:100%;":"top:0%;",{$div:r}}r.d(t,{j:()=>n})},39923:(e,t,r)=>{"use strict";r.d(t,{K:()=>s,h:()=>i});var n=r(77334);function i(e,t,r){const i=e.xbord||e.ybord,a=e.xshad||e.yshad,s="FF"!==e.a1,o=e.blur||e.be||0,u=(0,n.An)("filter",[["id",t]]);u.append((0,n.An)("feGaussianBlur",[["stdDeviation",i?0:o],["in","SourceGraphic"],["result","sg_b"]])),u.append((0,n.An)("feFlood",[["flood-color",(0,n.qG)(e.a1+e.c1)],["result","c1"]])),u.append((0,n.An)("feComposite",[["operator","in"],["in","c1"],["in2","sg_b"],["result","main"]])),i&&(u.append((0,n.An)("feMorphology",[["radius",`${e.xbord*r} ${e.ybord*r}`],["operator","dilate"],["in","SourceGraphic"],["result","dil"]])),u.append((0,n.An)("feGaussianBlur",[["stdDeviation",o],["in","dil"],["result","dil_b"]])),u.append((0,n.An)("feComposite",[["operator","out"],["in","dil_b"],["in2","SourceGraphic"],["result","dil_b_o"]])),u.append((0,n.An)("feFlood",[["flood-color",(0,n.qG)(e.a3+e.c3)],["result","c3"]])),u.append((0,n.An)("feComposite",[["operator","in"],["in","c3"],["in2","dil_b_o"],["result","border"]]))),a&&(i||s)&&(u.append((0,n.An)("feOffset",[["dx",e.xshad*r],["dy",e.yshad*r],["in",i?"dil":"SourceGraphic"],["result","off"]])),u.append((0,n.An)("feGaussianBlur",[["stdDeviation",o],["in","off"],["result","off_b"]])),s||(u.append((0,n.An)("feOffset",[["dx",e.xshad*r],["dy",e.yshad*r],["in","SourceGraphic"],["result","sg_off"]])),u.append((0,n.An)("feComposite",[["operator","out"],["in","off_b"],["in2","sg_off"],["result","off_b_o"]]))),u.append((0,n.An)("feFlood",[["flood-color",(0,n.qG)(e.a4+e.c4)],["result","c4"]])),u.append((0,n.An)("feComposite",[["operator","in"],["in","c4"],["in2",s?"off_b":"off_b_o"],["result","shadow"]])));const c=(0,n.An)("feMerge",[]);return a&&(i||s)&&c.append((0,n.An)("feMergeNode",[["in","shadow"]])),i&&c.append((0,n.An)("feMergeNode",[["in","border"]])),c.append((0,n.An)("feMergeNode",[["in","main"]])),u.append(c),u}function a([e,t]){return[[0,0],[0,1],[1,0],[1,1]].filter((([r,n])=>(r||e)&&(n||t))).map((([r,n])=>[(r||-1)*e,(n||-1)*t]))}function s(e,t){const r=(0,n.qG)(`00${e.c3}`),i=e.xbord*t,s=e.ybord*t,o=(0,n.qG)(`00${e.c4}`),u=e.blur||e.be||0,c=function(e,t){if(e===t)return[];const r=Math.min(e,t),n=Math.max(e,t);return Array.from({length:Math.ceil(n)-1},((e,t)=>t+1)).concat(n).map((e=>[(n-e)/n*r,e])).map((([r,n])=>e>t?[n,r]:[r,n])).flatMap(a)}(i,s);return[["border-width",2*Math.min(i,s)+"px"],["border-color",r],["border-opacity",(0,n.KA)(e.a3)],["border-delta",c.map((([e,t])=>`${e}px ${t}px ${r}`)).join(",")],["shadow-color",o],["shadow-opacity",(0,n.KA)(e.a4)],["shadow-delta",c.map((([e,t])=>`${e}px ${t}px ${o}`)).join(",")],["tag-blur",u],["tag-xbord",e.xbord],["tag-ybord",e.ybord],["tag-xshad",e.xshad],["tag-yshad",e.yshad]].map((([e,t])=>[`--ass-${e}`,t]))}window.CSS.registerProperty&&(window.CSS.registerProperty({name:"--ass-border-width",syntax:"<length>",inherits:!0,initialValue:"0px"}),["border-color","shadow-color"].forEach((e=>{window.CSS.registerProperty({name:`--ass-${e}`,syntax:"<color>",inherits:!0,initialValue:"transparent"})})),["border-opacity","shadow-opacity"].forEach((e=>{window.CSS.registerProperty({name:`--ass-${e}`,syntax:"<number>",inherits:!0,initialValue:"1"})})),["blur","xbord","ybord","xshad","yshad"].forEach((e=>{window.CSS.registerProperty({name:`--ass-tag-${e}`,syntax:"<number>",inherits:!0,initialValue:"0"})})))},59950:(e,t,r)=>{"use strict";function n(e){const{layer:t,align:r,effect:n,pos:i,margin:a}=e;let s="";return t&&(s+=`z-index:${t};`),s+=`text-align:${["left","center","right"][r.h]};`,n||(s+=`max-width:calc(100% - var(--ass-scale) * ${a.left+a.right}px);`,i||(0!==r.h&&(s+=`margin-right:calc(var(--ass-scale) * ${a.right}px);`),2!==r.h&&(s+=`margin-left:calc(var(--ass-scale) * ${a.left}px);`))),s}r.d(t,{_:()=>n})},57131:(e,t,r)=>{"use strict";r.d(t,{IZ:()=>i,Lu:()=>o,ge:()=>a,l1:()=>s,r8:()=>n});const n=["frx","fry","frz"],i=["fscx","fscy"],a=["fax","fay"];function s(e){return[...[...n,...a].map((t=>[`--ass-tag-${t}`,`${e[t]||0}`])),...i.map((t=>[`--ass-tag-${t}`,e.p?1:(e[t]||100)/100]))]}function o(e,t){const{align:r,width:n,height:i,x:a,y:s,$div:o}=e,u={};e.org?(u.x=e.org.x*t,u.y=e.org.y*t):(u.x=[a,a+n/2,a+n][r.h],u.y=[s+i,s+i/2,s][r.v]);for(let e=o.childNodes.length-1;e>=0;e-=1){const t=o.childNodes[e];if(""===t.dataset.rotate){const e=u.x-a-t.offsetLeft,r=u.y-s-t.offsetTop;t.style.cssText+=`transform-origin:${e}px ${r}px;`}}}window.CSS.registerProperty&&([...n,...a].forEach((e=>{window.CSS.registerProperty({name:`--ass-tag-${e}`,syntax:"<number>",inherits:!0,initialValue:0})})),i.forEach((e=>{window.CSS.registerProperty({name:`--ass-tag-${e}`,syntax:"<number>",inherits:!0,initialValue:1})})))},77334:(e,t,r)=>{"use strict";function n(e){return 1-`0x${e}`/255}function i(e){const t=e.match(/(\w\w)(\w\w)(\w\w)(\w\w)/),r=n(t[1]),i=+`0x${t[2]}`,a=+`0x${t[3]}`;return`rgba(${+`0x${t[4]}`},${a},${i},${r})`}function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=Math.trunc(16*Math.random());return("x"===e?t:3&t|8).toString(16)}))}function s(e,t=[]){const r=document.createElementNS("http://www.w3.org/2000/svg",e);for(let e=0;e<t.length;e+=1){const n=t[e];r.setAttributeNS("xlink:href"===n[0]?"http://www.w3.org/1999/xlink":null,n[0],n[1])}return r}function o(e,t,r){const n=e.animate(t,r);return n.pause(),n}function u(e,t){(e.animations||[]).forEach((e=>{e[t]()}))}r.d(t,{An:()=>s,KA:()=>n,MA:()=>u,dT:()=>o,qG:()=>i,uR:()=>a})}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var a=n[e]={exports:{}};return r[e](a,a.exports,i),a.exports}i.m=r,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>e+".avplayer.js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="AVPlayer:",i.l=(r,n,a,s)=>{if(e[r])e[r].push(n);else{var o,u;if(void 0!==a)for(var c=document.getElementsByTagName("script"),f=0;f<c.length;f++){var h=c[f];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+a){o=h;break}}o||(u=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",t+a),o.src=r),e[r]=[n];var d=(t,n)=>{o.onerror=o.onload=null,clearTimeout(l);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(n))),t)return t(n)},l=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),u&&document.head.appendChild(o)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={792:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var a=new Promise(((r,i)=>n=e[t]=[r,i]));r.push(n[2]=a);var s=i.p+i.u(t),o=new Error;i.l(s,(r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,n[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,a,[s,o,u]=r,c=0;if(s.some((t=>0!==e[t]))){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);u&&u(i)}for(t&&t(r);c<s.length;c++)a=s[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkAVPlayer=self.webpackChunkAVPlayer||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var a=i(61634);return a.default})()));